function createMethod(methodName){return function(){throw new Error('The "'+methodName+"\" method is not available on the playback technology's API")}}function setInnerText(element,text){var textProperty="innerText"in element?"innerText":"textContent";element[textProperty]=text}!function(a,b){function cy(a){return f.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}function cu(a){if(!cj[a]){var b=c.body,d=f("<"+a+">").appendTo(b),e=d.css("display");d.remove(),("none"===e||""===e)&&(ck||(ck=c.createElement("iframe"),ck.frameBorder=ck.width=ck.height=0),b.appendChild(ck),cl&&ck.createElement||(cl=(ck.contentWindow||ck.contentDocument).document,cl.write((f.support.boxModel?"<!doctype html>":"")+"<html><body>"),cl.close()),d=cl.createElement(a),cl.body.appendChild(d),e=f.css(d,"display"),b.removeChild(ck)),cj[a]=e}return cj[a]}function ct(a,b){var c={};return f.each(cp.concat.apply([],cp.slice(0,b)),function(){c[this]=a}),c}function cs(){cq=b}function cr(){return setTimeout(cs,0),cq=f.now()}function ci(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ch(){try{return new a.XMLHttpRequest}catch(b){}}function cb(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var g,h,j,l,m,n,o,p,d=a.dataTypes,e={},i=d.length,k=d[0];for(g=1;i>g;g++){if(1===g)for(h in a.converters)"string"==typeof h&&(e[h.toLowerCase()]=a.converters[h]);if(l=k,k=d[g],"*"===k)k=l;else if("*"!==l&&l!==k){if(m=l+" "+k,n=e[m]||e["* "+k],!n){p=b;for(o in e)if(j=o.split(" "),(j[0]===l||"*"===j[0])&&(p=e[j[1]+" "+k])){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}return c}function ca(a,c,d){var h,i,j,k,e=a.contents,f=a.dataTypes,g=a.responseFields;for(i in g)i in d&&(c[g[i]]=d[i]);for(;"*"===f[0];)f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}return j?(j!==f[0]&&f.unshift(j),d[j]):void 0}function b_(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bD.test(a)?d(a,e):b_(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==f.type(b))d(a,b);else for(var e in b)b_(a+"["+e+"]",b[e],c,d)}function b$(a,c){var d,e,g=f.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((g[d]?a:e||(e={}))[d]=c[d]);e&&f.extend(!0,a,e)}function bZ(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;for(var l,h=a[f],i=0,j=h?h.length:0,k=a===bS;j>i&&(k||!l);i++)l=h[i](c,d,e),"string"==typeof l&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=bZ(a,c,d,e,l,g)));return(k||!l)&&!g["*"]&&(l=bZ(a,c,d,e,"*",g)),l}function bY(a){return function(b,c){if("string"!=typeof b&&(c=b,b="*"),f.isFunction(c))for(var h,i,j,d=b.toLowerCase().split(bO),e=0,g=d.length;g>e;e++)h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}function bB(a,b,c){var d="width"===b?a.offsetWidth:a.offsetHeight,e="width"===b?1:0,g=4;if(d>0){if("border"!==c)for(;g>e;e+=2)c||(d-=parseFloat(f.css(a,"padding"+bx[e]))||0),"margin"===c?d+=parseFloat(f.css(a,c+bx[e]))||0:d-=parseFloat(f.css(a,"border"+bx[e]+"Width"))||0;return d+"px"}if(d=by(a,b),(0>d||null==d)&&(d=a.style[b]),bt.test(d))return d;if(d=parseFloat(d)||0,c)for(;g>e;e+=2)d+=parseFloat(f.css(a,"padding"+bx[e]))||0,"padding"!==c&&(d+=parseFloat(f.css(a,"border"+bx[e]+"Width"))||0),"margin"===c&&(d+=parseFloat(f.css(a,c+bx[e]))||0);return d+"px"}function bo(a){var b=c.createElement("div");return bh.appendChild(b),b.innerHTML=a.outerHTML,b.firstChild}function bn(a){var b=(a.nodeName||"").toLowerCase();"input"===b?bm(a):"script"!==b&&"undefined"!=typeof a.getElementsByTagName&&f.grep(a.getElementsByTagName("input"),bm)}function bm(a){("checkbox"===a.type||"radio"===a.type)&&(a.defaultChecked=a.checked)}function bl(a){return"undefined"!=typeof a.getElementsByTagName?a.getElementsByTagName("*"):"undefined"!=typeof a.querySelectorAll?a.querySelectorAll("*"):[]}function bk(a,b){var c;1===b.nodeType&&(b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase(),"object"===c?b.outerHTML=a.outerHTML:"input"!==c||"checkbox"!==a.type&&"radio"!==a.type?"option"===c?b.selected=a.defaultSelected:"input"===c||"textarea"===c?b.defaultValue=a.defaultValue:"script"===c&&b.text!==a.text&&(b.text=a.text):(a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value)),b.removeAttribute(f.expando),b.removeAttribute("_submit_attached"),b.removeAttribute("_change_attached"))}function bj(a,b){if(1===b.nodeType&&f.hasData(a)){var c,d,e,g=f._data(a),h=f._data(b,g),i=g.events;if(i){delete h.handle,h.events={};for(c in i)for(d=0,e=i[c].length;e>d;d++)f.event.add(b,c,i[c][d])}h.data&&(h.data=f.extend({},h.data))}}function bi(a){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function U(a){var b=V.split("|"),c=a.createDocumentFragment();if(c.createElement)for(;b.length;)c.createElement(b.pop());return c}function T(a,b,c){if(b=b||0,f.isFunction(b))return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return f.grep(a,function(a){return a===b===c});if("string"==typeof b){var d=f.grep(a,function(a){return 1===a.nodeType});if(O.test(b))return f.filter(b,d,!c);b=f.filter(b,d)}return f.grep(a,function(a){return f.inArray(a,b)>=0===c})}function S(a){return!a||!a.parentNode||11===a.parentNode.nodeType}function K(){return!0}function J(){return!1}function n(a,b,c){var d=b+"defer",e=b+"queue",g=b+"mark",h=f._data(a,d);!(!h||"queue"!==c&&f._data(a,e)||"mark"!==c&&f._data(a,g)||!setTimeout(function(){!f._data(a,e)&&!f._data(a,g)&&(f.removeData(a,d,!0),h.fire())},0))}function m(a){for(var b in a)if(("data"!==b||!f.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function l(a,c,d){if(d===b&&1===a.nodeType){var e="data-"+c.replace(k,"-$1").toLowerCase();if(d=a.getAttribute(e),"string"==typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:f.isNumeric(d)?+d:j.test(d)?f.parseJSON(d):d}catch(g){}f.data(a,c,d)}else d=b}return d}function h(a){var c,d,b=g[a]={};for(a=a.split(/\s+/),c=0,d=a.length;d>c;c++)b[a[c]]=!0;return b}var c=a.document,d=a.navigator,e=a.location,f=function(){function J(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){return void setTimeout(J,1)}e.ready()}}var h,z,A,B,e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,i=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,n=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,p=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,q=/(?:^|:|,)(?:\s*\[)+/g,r=/(webkit)[ \/]([\w.]+)/,s=/(opera)(?:.*version)?[ \/]([\w.]+)/,t=/(msie) ([\w.]+)/,u=/(mozilla)(?:.*? rv:([\w.]+))?/,v=/-([a-z]|[0-9])/gi,w=/^-ms-/,x=function(a,b){return(b+"").toUpperCase()},y=d.userAgent,C=Object.prototype.toString,D=Object.prototype.hasOwnProperty,E=Array.prototype.push,F=Array.prototype.slice,G=String.prototype.trim,H=Array.prototype.indexOf,I={};return e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a)return this;if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if("body"===a&&!d&&c.body)return this.context=c,this[0]=c.body,this.selector=a,this.length=1,this;if("string"==typeof a){if(g="<"!==a.charAt(0)||">"!==a.charAt(a.length-1)||a.length<3?i.exec(a):[null,a,null],g&&(g[1]||!d)){if(g[1])return d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=m.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes),e.merge(this,a);if(h=c.getElementById(g[2]),h&&h.parentNode){if(h.id!==g[2])return f.find(a);this.length=1,this[0]=h}return this.context=c,this.selector=a,this}return!d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}return e.isFunction(a)?f.ready(a):(a.selector!==b&&(this.selector=a.selector,this.context=a.context),e.makeArray(a,this))},selector:"",jquery:"1.7.2",length:0,size:function(){return this.length},toArray:function(){return F.call(this,0)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();return e.isArray(a)?E.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,"find"===b?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")"),d},each:function(a,b){return e.each(this,a,b)},ready:function(a){return e.bindReady(),A.add(a),this},eq:function(a){return a=+a,-1===a?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(F.apply(this,arguments),"slice",F.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:E,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;for("boolean"==typeof i&&(l=i,i=arguments[1]||{},j=2),"object"!=typeof i&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);k>j;j++)if(null!=(a=arguments[j]))for(c in a)d=i[c],f=a[c],i!==f&&(l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f));return i},e.extend({noConflict:function(b){return a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f),e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body)return setTimeout(e.ready,1);if(e.isReady=!0,a!==!0&&--e.readyWait>0)return;A.fireWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").off("ready")}},bindReady:function(){if(!A){if(A=e.Callbacks("once memory"),"complete"===c.readyState)return setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener("DOMContentLoaded",B,!1),a.addEventListener("load",e.ready,!1);else if(c.attachEvent){c.attachEvent("onreadystatechange",B),a.attachEvent("onload",e.ready);var b=!1;try{b=null==a.frameElement}catch(d){}c.documentElement.doScroll&&b&&J()}}},isFunction:function(a){return"function"===e.type(a)},isArray:Array.isArray||function(a){return"array"===e.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return null==a?String(a):I[C.call(a)]||"object"},isPlainObject:function(a){if(!a||"object"!==e.type(a)||a.nodeType||e.isWindow(a))return!1;try{if(a.constructor&&!D.call(a,"constructor")&&!D.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||D.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw new Error(a)},parseJSON:function(b){return"string"==typeof b&&b?(b=e.trim(b),a.JSON&&a.JSON.parse?a.JSON.parse(b):n.test(b.replace(o,"@").replace(p,"]").replace(q,""))?new Function("return "+b)():void e.error("Invalid JSON: "+b)):null},parseXML:function(c){if("string"!=typeof c||!c)return null;var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(g){d=b}return(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&e.error("Invalid XML: "+c),d},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(w,"ms-").replace(v,x)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d)if(i){for(f in a)if(c.apply(a[f],d)===!1)break}else for(;h>g&&c.apply(a[g++],d)!==!1;);else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(;h>g&&c.call(a[g],g,a[g++])!==!1;);return a},trim:G?function(a){return null==a?"":G.call(a)}:function(a){return null==a?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(null!=a){var d=e.type(a);null==a.length||"string"===d||"function"===d||"regexp"===d||e.isWindow(a)?E.call(c,a):e.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(H)return H.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=a.length,e=0;if("number"==typeof c.length)for(var f=c.length;f>e;e++)a[d++]=c[e];else for(;c[e]!==b;)a[d++]=c[e++];return a.length=d,a},grep:function(a,b,c){var e,d=[];c=!!c;for(var f=0,g=a.length;g>f;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&"number"==typeof j&&(j>0&&a[0]&&a[j-1]||0===j||e.isArray(a));if(k)for(;j>i;i++)f=c(a[i],i,d),null!=f&&(h[h.length]=f);else for(g in a)f=c(a[g],g,d),null!=f&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if("string"==typeof c){var d=a[c];c=a,a=d}if(!e.isFunction(a))return b;var f=F.call(arguments,2),g=function(){return a.apply(c,f.concat(F.call(arguments)))};return g.guid=a.guid=a.guid||g.guid||e.guid++,g},access:function(a,c,d,f,g,h,i){var j,k=null==d,l=0,m=a.length;if(d&&"object"==typeof d){for(l in d)e.access(a,c,l,d[l],1,h,f);g=1}else if(f!==b){if(j=i===b&&e.isFunction(f),k&&(j?(j=c,c=function(a,b,c){return j.call(e(a),c)}):(c.call(a,f),c=null)),c)for(;m>l;l++)c(a[l],d,j?f.call(a[l],l,c(a[l],d)):f,i);g=1}return g?a:k?c.call(a):m?c(a[0],d):h},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=r.exec(a)||s.exec(a)||t.exec(a)||a.indexOf("compatible")<0&&u.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){return f&&f instanceof e&&!(f instanceof a)&&(f=a(f)),e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){I["[object "+b+"]"]=b.toLowerCase()}),z=e.uaMatch(y),z.browser&&(e.browser[z.browser]=!0,e.browser.version=z.version),e.browser.webkit&&(e.browser.safari=!0),j.test(" ")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?B=function(){c.removeEventListener("DOMContentLoaded",B,!1),e.ready()}:c.attachEvent&&(B=function(){"complete"===c.readyState&&(c.detachEvent("onreadystatechange",B),e.ready())}),e}(),g={};f.Callbacks=function(a){a=a?g[a]||h(a):{};var e,i,j,k,l,m,c=[],d=[],n=function(b){var d,e,g,h;for(d=0,e=b.length;e>d;d++)g=b[d],h=f.type(g),"array"===h?n(g):"function"===h&&(!a.unique||!p.has(g))&&c.push(g)},o=function(b,f){for(f=f||[],e=!a.memory||[b,f],i=!0,j=!0,m=k||0,k=0,l=c.length;c&&l>m;m++)if(c[m].apply(b,f)===!1&&a.stopOnFalse){e=!0;break}j=!1,c&&(a.once?e===!0?p.disable():c=[]:d&&d.length&&(e=d.shift(),p.fireWith(e[0],e[1])))},p={add:function(){if(c){var a=c.length;n(arguments),j?l=c.length:e&&e!==!0&&(k=a,o(e[0],e[1]))}return this},remove:function(){if(c)for(var b=arguments,d=0,e=b.length;e>d;d++)for(var f=0;f<c.length&&(b[d]!==c[f]||(j&&l>=f&&(l--,m>=f&&m--),c.splice(f--,1),!a.unique));f++);return this},has:function(a){if(c)for(var b=0,d=c.length;d>b;b++)if(a===c[b])return!0;return!1},empty:function(){return c=[],this},disable:function(){return c=d=e=b,this},disabled:function(){return!c},lock:function(){return d=b,(!e||e===!0)&&p.disable(),this},locked:function(){return!d},fireWith:function(b,c){return d&&(j?a.once||d.push([b,c]):(!a.once||!e)&&o(b,c)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!i}};return p};var i=[].slice;f.extend({Deferred:function(a){var j,b=f.Callbacks("once memory"),c=f.Callbacks("once memory"),d=f.Callbacks("memory"),e="pending",g={resolve:b,reject:c,notify:d},h={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){return i.done(a).fail(b).progress(c),this},always:function(){return i.done.apply(i,arguments).fail.apply(i,arguments),this},pipe:function(a,b,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var g,c=b[0],e=b[1];i[a](f.isFunction(c)?function(){g=c.apply(this,arguments),g&&f.isFunction(g.promise)?g.promise().then(d.resolve,d.reject,d.notify):d[e+"With"](this===i?d:this,[g])}:d[e])})}).promise()},promise:function(a){if(null==a)a=h;else for(var b in h)a[b]=h[b];return a}},i=h.promise({});for(j in g)i[j]=g[j].fire,i[j+"With"]=g[j].fireWith;return i.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock),a&&a.call(i,i),i},when:function(a){function m(a){return function(b){e[a]=arguments.length>1?i.call(arguments,0):b,j.notifyWith(k,e)}}function l(a){return function(c){b[a]=arguments.length>1?i.call(arguments,0):c,--g||j.resolveWith(j,b)}}var b=i.call(arguments,0),c=0,d=b.length,e=Array(d),g=d,j=1>=d&&a&&f.isFunction(a.promise)?a:f.Deferred(),k=j.promise();if(d>1){for(;d>c;c++)b[c]&&b[c].promise&&f.isFunction(b[c].promise)?b[c].promise().then(l(c),j.reject,m(c)):--g;g||j.resolveWith(j,b)}else j!==a&&j.resolveWith(j,d?[a]:[]);return k}}),f.support=function(){{var b,d,e,g,h,i,j,k,m,n,o,p=c.createElement("div");c.documentElement}if(p.setAttribute("className","t"),p.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",d=p.getElementsByTagName("*"),e=p.getElementsByTagName("a")[0],!d||!d.length||!e)return{};g=c.createElement("select"),h=g.appendChild(c.createElement("option")),i=p.getElementsByTagName("input")[0],b={leadingWhitespace:3===p.firstChild.nodeType,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:"/a"===e.getAttribute("href"),opacity:/^0.55/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:"on"===i.value,optSelected:h.selected,getSetAttribute:"t"!==p.className,enctype:!!c.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==c.createElement("nav").cloneNode(!0).outerHTML,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,pixelMargin:!0},f.boxModel=b.boxModel="CSS1Compat"===c.compatMode,i.checked=!0,b.noCloneChecked=i.cloneNode(!0).checked,g.disabled=!0,b.optDisabled=!h.disabled;try{delete p.test}catch(r){b.deleteExpando=!1}if(!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",function(){b.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick")),i=c.createElement("input"),i.value="t",i.setAttribute("type","radio"),b.radioValue="t"===i.value,i.setAttribute("checked","checked"),i.setAttribute("name","t"),p.appendChild(i),j=c.createDocumentFragment(),j.appendChild(p.lastChild),b.checkClone=j.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=i.checked,j.removeChild(i),j.appendChild(p),p.attachEvent)for(n in{submit:1,change:1,focusin:1})m="on"+n,o=m in p,o||(p.setAttribute(m,"return;"),o="function"==typeof p[m]),b[n+"Bubbles"]=o;return j.removeChild(p),j=g=h=p=i=null,f(function(){var d,e,g,i,j,l,m,n,q,r,s,t,u=c.getElementsByTagName("body")[0];!u||(m=1,t="padding:0;margin:0;border:",r="position:absolute;top:0;left:0;width:1px;height:1px;",s=t+"0;visibility:hidden;",n="style='"+r+t+"5px solid #000;",q="<div "+n+"display:block;'><div style='"+t+"0;display:block;overflow:hidden;'></div></div><table "+n+"' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>",d=c.createElement("div"),d.style.cssText=s+"width:0;height:0;position:static;top:0;margin-top:"+m+"px",u.insertBefore(d,u.firstChild),p=c.createElement("div"),d.appendChild(p),p.innerHTML="<table><tr><td style='"+t+"0;display:none'></td><td>t</td></tr></table>",k=p.getElementsByTagName("td"),o=0===k[0].offsetHeight,k[0].style.display="",k[1].style.display="none",b.reliableHiddenOffsets=o&&0===k[0].offsetHeight,a.getComputedStyle&&(p.innerHTML="",l=c.createElement("div"),l.style.width="0",l.style.marginRight="0",p.style.width="2px",p.appendChild(l),b.reliableMarginRight=0===(parseInt((a.getComputedStyle(l,null)||{marginRight:0}).marginRight,10)||0)),"undefined"!=typeof p.style.zoom&&(p.innerHTML="",p.style.width=p.style.padding="1px",p.style.border=0,p.style.overflow="hidden",p.style.display="inline",p.style.zoom=1,b.inlineBlockNeedsLayout=3===p.offsetWidth,p.style.display="block",p.style.overflow="visible",p.innerHTML="<div style='width:5px;'></div>",b.shrinkWrapBlocks=3!==p.offsetWidth),p.style.cssText=r+s,p.innerHTML=q,e=p.firstChild,g=e.firstChild,i=e.nextSibling.firstChild.firstChild,j={doesNotAddBorder:5!==g.offsetTop,doesAddBorderForTableAndCells:5===i.offsetTop},g.style.position="fixed",g.style.top="20px",j.fixedPosition=20===g.offsetTop||15===g.offsetTop,g.style.position=g.style.top="",e.style.overflow="hidden",e.style.position="relative",j.subtractsBorderForOverflowNotVisible=-5===g.offsetTop,j.doesNotIncludeMarginInBodyOffset=u.offsetTop!==m,a.getComputedStyle&&(p.style.marginTop="1%",b.pixelMargin="1%"!==(a.getComputedStyle(p,null)||{marginTop:0}).marginTop),"undefined"!=typeof d.style.zoom&&(d.style.zoom=1),u.removeChild(d),l=p=d=null,f.extend(b,j))}),b}();var j=/^(?:\{.*\}|\[.*\])$/,k=/([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){return a=a.nodeType?f.cache[a[f.expando]]:a[f.expando],!!a&&!m(a)},data:function(a,c,d,e){if(f.acceptData(a)){var g,h,i,j=f.expando,k="string"==typeof c,l=a.nodeType,m=l?f.cache:a,n=l?a[j]:a[j]&&j,o="events"===c;if(!(n&&m[n]&&(o||e||m[n].data)||!k||d!==b))return;return n||(l?a[j]=n=++f.uuid:n=j),m[n]||(m[n]={},l||(m[n].toJSON=f.noop)),("object"==typeof c||"function"==typeof c)&&(e?m[n]=f.extend(m[n],c):m[n].data=f.extend(m[n].data,c)),g=h=m[n],e||(h.data||(h.data={}),h=h.data),d!==b&&(h[f.camelCase(c)]=d),o&&!h[c]?g.events:(k?(i=h[c],null==i&&(i=h[f.camelCase(c)])):i=h,i)}},removeData:function(a,b,c){if(f.acceptData(a)){var d,e,g,h=f.expando,i=a.nodeType,j=i?f.cache:a,k=i?a[h]:h;if(!j[k])return;if(b&&(d=c?j[k]:j[k].data)){f.isArray(b)||(b in d?b=[b]:(b=f.camelCase(b),b=b in d?[b]:b.split(" ")));for(e=0,g=b.length;g>e;e++)delete d[b[e]];if(!(c?m:f.isEmptyObject)(d))return}if(!c&&(delete j[k].data,!m(j[k])))return;f.support.deleteExpando||!j.setInterval?delete j[k]:j[k]=null,i&&(f.support.deleteExpando?delete a[h]:a.removeAttribute?a.removeAttribute(h):a[h]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),f.fn.extend({data:function(a,c){var d,e,g,h,i,j=this[0],k=0,m=null;if(a===b){if(this.length&&(m=f.data(j),1===j.nodeType&&!f._data(j,"parsedAttrs"))){for(g=j.attributes,i=g.length;i>k;k++)h=g[k].name,0===h.indexOf("data-")&&(h=f.camelCase(h.substring(5)),l(j,h,m[h]));f._data(j,"parsedAttrs",!0)}return m}return"object"==typeof a?this.each(function(){f.data(this,a)}):(d=a.split(".",2),d[1]=d[1]?"."+d[1]:"",e=d[1]+"!",f.access(this,function(c){return c===b?(m=this.triggerHandler("getData"+e,[d[0]]),m===b&&j&&(m=f.data(j,a),m=l(j,a,m)),m===b&&d[1]?this.data(d[0]):m):(d[1]=c,void this.each(function(){var b=f(this);b.triggerHandler("setData"+e,d),f.data(this,a,c),b.triggerHandler("changeData"+e,d)}))},null,c,arguments.length>1,null,!1))},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",f._data(a,b,(f._data(a,b)||0)+1))},_unmark:function(a,b,c){if(a!==!0&&(c=b,b=a,a=!1),b){c=c||"fx";var d=c+"mark",e=a?0:(f._data(b,d)||1)-1;e?f._data(b,d,e):(f.removeData(b,d,!0),n(b,c,"mark"))}},queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=f._data(a,b),c&&(!d||f.isArray(c)?d=f._data(a,b,f.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e={};"inprogress"===d&&(d=c.shift()),d&&("fx"===b&&c.unshift("inprogress"),f._data(a,b+".run",e),d.call(a,function(){f.dequeue(a,b)},e)),c.length||(f.removeData(a,b+"queue "+b+".run",!0),n(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){var d=2;return"string"!=typeof a&&(c=a,a="fx",d--),arguments.length<d?f.queue(this[0],a):c===b?this:this.each(function(){var b=f.queue(this,a,c);"fx"===a&&"inprogress"!==b[0]&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){return a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}"string"!=typeof a&&(c=a,a=b),a=a||"fx";for(var l,d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark";g--;)(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f.Callbacks("once memory"),!0))&&(h++,l.add(m));return m(),d.promise(c)}});var w,x,y,o=/[\n\t\r]/g,p=/\s+/,q=/\r/g,r=/^(?:button|input)$/i,s=/^(?:button|input|object|select|textarea)$/i,t=/^a(?:rea)?$/i,u=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,v=f.support.getSetAttribute;f.fn.extend({attr:function(a,b){return f.access(this,f.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,f.prop,a,b,arguments.length>1)},removeProp:function(a){return a=f.propFix[a]||a,this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,h,i;if(f.isFunction(a))return this.each(function(b){f(this).addClass(a.call(this,b,this.className))});if(a&&"string"==typeof a)for(b=a.split(p),c=0,d=this.length;d>c;c++)if(e=this[c],1===e.nodeType)if(e.className||1!==b.length){for(g=" "+e.className+" ",h=0,i=b.length;i>h;h++)~g.indexOf(" "+b[h]+" ")||(g+=b[h]+" ");e.className=f.trim(g)}else e.className=a;return this},removeClass:function(a){var c,d,e,g,h,i,j;if(f.isFunction(a))return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))});if(a&&"string"==typeof a||a===b)for(c=(a||"").split(p),d=0,e=this.length;e>d;d++)if(g=this[d],1===g.nodeType&&g.className)if(a){for(h=(" "+g.className+" ").replace(o," "),i=0,j=c.length;j>i;i++)h=h.replace(" "+c[i]+" "," ");g.className=f.trim(h)}else g.className="";return this},toggleClass:function(a,b){var c=typeof a,d="boolean"==typeof b;return this.each(f.isFunction(a)?function(c){f(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c)for(var e,g=0,h=f(this),i=b,j=a.split(p);e=j[g++];)i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e);else("undefined"===c||"boolean"===c)&&(this.className&&f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(o," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,g=this[0];return arguments.length?(e=f.isFunction(a),this.each(function(d){var h,g=f(this);1===this.nodeType&&(h=e?a.call(this,d,g.val()):a,null==h?h="":"number"==typeof h?h+="":f.isArray(h)&&(h=f.map(h,function(a){return null==a?"":a+""})),c=f.valHooks[this.type]||f.valHooks[this.nodeName.toLowerCase()],c&&"set"in c&&c.set(this,h,"value")!==b||(this.value=h))})):g?(c=f.valHooks[g.type]||f.valHooks[g.nodeName.toLowerCase()],c&&"get"in c&&(d=c.get(g,"value"))!==b?d:(d=g.value,"string"==typeof d?d.replace(q,""):null==d?"":d)):void 0}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,g=a.selectedIndex,h=[],i=a.options,j="select-one"===a.type;if(0>g)return null;for(c=j?g:0,d=j?g+1:i.length;d>c;c++)if(e=i[c],!(!e.selected||(f.support.optDisabled?e.disabled:null!==e.getAttribute("disabled"))||e.parentNode.disabled&&f.nodeName(e.parentNode,"optgroup"))){if(b=f(e).val(),j)return b;h.push(b)}return j&&!h.length&&i.length?f(i[g]).val():h},set:function(a,b){var c=f.makeArray(b);return f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1),c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var g,h,i,j=a.nodeType;return a&&3!==j&&8!==j&&2!==j?e&&c in f.attrFn?f(a)[c](d):"undefined"==typeof a.getAttribute?f.prop(a,c,d):(i=1!==j||!f.isXMLDoc(a),i&&(c=c.toLowerCase(),h=f.attrHooks[c]||(u.test(c)?x:w)),d!==b?null===d?void f.removeAttr(a,c):h&&"set"in h&&i&&(g=h.set(a,d,c))!==b?g:(a.setAttribute(c,""+d),d):h&&"get"in h&&i&&null!==(g=h.get(a,c))?g:(g=a.getAttribute(c),null===g?b:g)):void 0},removeAttr:function(a,b){var c,d,e,g,h,i=0;if(b&&1===a.nodeType)for(d=b.toLowerCase().split(p),g=d.length;g>i;i++)e=d[i],e&&(c=f.propFix[e]||e,h=u.test(e),h||f.attr(a,e,""),a.removeAttribute(v?e:c),h&&c in a&&(a[c]=!1))},attrHooks:{type:{set:function(a,b){if(r.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&"radio"===b&&f.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}},value:{get:function(a,b){return w&&f.nodeName(a,"button")?w.get(a,b):b in a?a.value:null},set:function(a,b,c){return w&&f.nodeName(a,"button")?w.set(a,b,c):void(a.value=b)}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,g,h,i=a.nodeType;return a&&3!==i&&8!==i&&2!==i?(h=1!==i||!f.isXMLDoc(a),h&&(c=f.propFix[c]||c,g=f.propHooks[c]),d!==b?g&&"set"in g&&(e=g.set(a,d,c))!==b?e:a[c]=d:g&&"get"in g&&null!==(e=g.get(a,c))?e:a[c]):void 0},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):s.test(a.nodeName)||t.test(a.nodeName)&&a.href?0:b}}}}),f.attrHooks.tabindex=f.propHooks.tabIndex,x={get:function(a,c){var d,e=f.prop(a,c);return e===!0||"boolean"!=typeof e&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;return b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase())),c}},v||(y={name:!0,id:!0,coords:!0},w=f.valHooks.button={get:function(a,c){var d;return d=a.getAttributeNode(c),d&&(y[c]?""!==d.nodeValue:d.specified)?d.nodeValue:b},set:function(a,b,d){var e=a.getAttributeNode(d);return e||(e=c.createAttribute(d),a.setAttributeNode(e)),e.nodeValue=b+""}},f.attrHooks.tabindex.set=w.set,f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}})}),f.attrHooks.contenteditable={get:w.get,set:function(a,b,c){""===b&&(b="false"),w.set(a,b,c)}}),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return null===d?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}})),f.support.enctype||(f.propFix.enctype="encoding"),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return null===a.getAttribute("value")?"on":a.value
}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){return f.isArray(b)?a.checked=f.inArray(f(a).val(),b)>=0:void 0}})});var z=/^(?:textarea|input|select)$/i,A=/^([^\.]*)?(?:\.(.+))?$/,B=/(?:^|\s)hover(\.\S+)?\b/,C=/^key/,D=/^(?:mouse|contextmenu)|click/,E=/^(?:focusinfocus|focusoutblur)$/,F=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,G=function(a){var b=F.exec(a);return b&&(b[1]=(b[1]||"").toLowerCase(),b[3]=b[3]&&new RegExp("(?:^|\\s)"+b[3]+"(?:\\s|$)")),b},H=function(a,b){var c=a.attributes||{};return!(b[1]&&a.nodeName.toLowerCase()!==b[1]||b[2]&&(c.id||{}).value!==b[2]||b[3]&&!b[3].test((c["class"]||{}).value))},I=function(a){return f.event.special.hover?a:a.replace(B,"mouseenter$1 mouseleave$1")};f.event={add:function(a,c,d,e,g){var h,i,j,k,l,m,n,o,p,r,s;if(3!==a.nodeType&&8!==a.nodeType&&c&&d&&(h=f._data(a))){for(d.handler&&(p=d,d=p.handler,g=p.selector),d.guid||(d.guid=f.guid++),j=h.events,j||(h.events=j={}),i=h.handle,i||(h.handle=i=function(a){return"undefined"==typeof f||a&&f.event.triggered===a.type?b:f.event.dispatch.apply(i.elem,arguments)},i.elem=a),c=f.trim(I(c)).split(" "),k=0;k<c.length;k++)l=A.exec(c[k])||[],m=l[1],n=(l[2]||"").split(".").sort(),s=f.event.special[m]||{},m=(g?s.delegateType:s.bindType)||m,s=f.event.special[m]||{},o=f.extend({type:m,origType:l[1],data:e,handler:d,guid:d.guid,selector:g,quick:g&&G(g),namespace:n.join(".")},p),r=j[m],r||(r=j[m]=[],r.delegateCount=0,s.setup&&s.setup.call(a,e,n,i)!==!1||(a.addEventListener?a.addEventListener(m,i,!1):a.attachEvent&&a.attachEvent("on"+m,i))),s.add&&(s.add.call(a,o),o.handler.guid||(o.handler.guid=d.guid)),g?r.splice(r.delegateCount++,0,o):r.push(o),f.event.global[m]=!0;a=null}},global:{},remove:function(a,b,c,d,e){var h,i,j,k,l,m,n,o,p,q,r,s,g=f.hasData(a)&&f._data(a);if(g&&(o=g.events)){for(b=f.trim(I(b||"")).split(" "),h=0;h<b.length;h++)if(i=A.exec(b[h])||[],j=k=i[1],l=i[2],j){for(p=f.event.special[j]||{},j=(d?p.delegateType:p.bindType)||j,r=o[j]||[],m=r.length,l=l?new RegExp("(^|\\.)"+l.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null,n=0;n<r.length;n++)s=r[n],!(!e&&k!==s.origType||c&&c.guid!==s.guid||l&&!l.test(s.namespace)||d&&d!==s.selector&&("**"!==d||!s.selector)||(r.splice(n--,1),s.selector&&r.delegateCount--,!p.remove||!p.remove.call(a,s)));0===r.length&&m!==r.length&&((!p.teardown||p.teardown.call(a,l)===!1)&&f.removeEvent(a,j,g.handle),delete o[j])}else for(j in o)f.event.remove(a,j+b[h],c,d,!0);f.isEmptyObject(o)&&(q=g.handle,q&&(q.elem=null),f.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){if(!e||3!==e.nodeType&&8!==e.nodeType){var j,k,l,m,n,o,p,q,r,s,h=c.type||c,i=[];if(E.test(h+f.event.triggered))return;if(h.indexOf("!")>=0&&(h=h.slice(0,-1),k=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort()),(!e||f.event.customEvent[h])&&!f.event.global[h])return;if(c="object"==typeof c?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.isTrigger=!0,c.exclusive=k,c.namespace=i.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,o=h.indexOf(":")<0?"on"+h:"",!e){j=f.cache;for(l in j)j[l].events&&j[l].events[h]&&f.event.trigger(c,d,j[l].handle.elem,!0);return}if(c.result=b,c.target||(c.target=e),d=null!=d?f.makeArray(d):[],d.unshift(c),p=f.event.special[h]||{},p.trigger&&p.trigger.apply(e,d)===!1)return;if(r=[[e,p.bindType||h]],!g&&!p.noBubble&&!f.isWindow(e)){for(s=p.delegateType||h,m=E.test(s+h)?e:e.parentNode,n=null;m;m=m.parentNode)r.push([m,s]),n=m;n&&n===e.ownerDocument&&r.push([n.defaultView||n.parentWindow||a,s])}for(l=0;l<r.length&&!c.isPropagationStopped();l++)m=r[l][0],c.type=r[l][1],q=(f._data(m,"events")||{})[c.type]&&f._data(m,"handle"),q&&q.apply(m,d),q=o&&m[o],q&&f.acceptData(m)&&q.apply(m,d)===!1&&c.preventDefault();return c.type=h,!(g||c.isDefaultPrevented()||p._default&&p._default.apply(e.ownerDocument,d)!==!1||"click"===h&&f.nodeName(e,"a")||!f.acceptData(e)||!o||!e[h]||("focus"===h||"blur"===h)&&0===c.target.offsetWidth||f.isWindow(e)||(n=e[o],n&&(e[o]=null),f.event.triggered=h,e[h](),f.event.triggered=b,!n||!(e[o]=n))),c.result}},dispatch:function(c){c=f.event.fix(c||a.event);var k,l,m,n,o,p,q,r,s,t,d=(f._data(this,"events")||{})[c.type]||[],e=d.delegateCount,g=[].slice.call(arguments,0),h=!c.exclusive&&!c.namespace,i=f.event.special[c.type]||{},j=[];if(g[0]=c,c.delegateTarget=this,!i.preDispatch||i.preDispatch.call(this,c)!==!1){if(e&&(!c.button||"click"!==c.type))for(n=f(this),n.context=this.ownerDocument||this,m=c.target;m!=this;m=m.parentNode||this)if(m.disabled!==!0){for(p={},r=[],n[0]=m,k=0;e>k;k++)s=d[k],t=s.selector,p[t]===b&&(p[t]=s.quick?H(m,s.quick):n.is(t)),p[t]&&r.push(s);r.length&&j.push({elem:m,matches:r})}for(d.length>e&&j.push({elem:this,matches:d.slice(e)}),k=0;k<j.length&&!c.isPropagationStopped();k++)for(q=j[k],c.currentTarget=q.elem,l=0;l<q.matches.length&&!c.isImmediatePropagationStopped();l++)s=q.matches[l],(h||!c.namespace&&!s.namespace||c.namespace_re&&c.namespace_re.test(s.namespace))&&(c.data=s.data,c.handleObj=s,o=((f.event.special[s.origType]||{}).handle||s.handler).apply(q.elem,g),o!==b&&(c.result=o,o===!1&&(c.preventDefault(),c.stopPropagation())));return i.postDispatch&&i.postDispatch.call(this,c),c.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,d){var e,f,g,h=d.button,i=d.fromElement;return null==a.pageX&&null!=d.clientX&&(e=a.target.ownerDocument||c,f=e.documentElement,g=e.body,a.pageX=d.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=d.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?d.toElement:i),!a.which&&h!==b&&(a.which=1&h?1:2&h?3:4&h?2:0),a}},fix:function(a){if(a[f.expando])return a;var d,e,g=a,h=f.event.fixHooks[a.type]||{},i=h.props?this.props.concat(h.props):this.props;for(a=f.Event(g),d=i.length;d;)e=i[--d],a[e]=g[e];return a.target||(a.target=g.srcElement||c),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey===b&&(a.metaKey=a.ctrlKey),h.filter?h.filter(a,g):a},special:{ready:{setup:f.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=f.extend(new f.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?f.event.trigger(e,null,b):f.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},f.event.handle=f.event.dispatch,f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){return this instanceof f.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?K:J):this.type=a,b&&f.extend(this,b),this.timeStamp=a&&a.timeStamp||f.now(),this[f.expando]=!0,void 0):new f.Event(a,b)},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=K;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=K;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=K,this.stopPropagation()},isDefaultPrevented:J,isPropagationStopped:J,isImmediatePropagationStopped:J},f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={delegateType:b,bindType:b,handle:function(a){{var h,c=this,d=a.relatedTarget,e=a.handleObj;e.selector}return(!d||d!==c&&!f.contains(c,d))&&(a.type=e.origType,h=e.handler.apply(this,arguments),a.type=b),h}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(){return f.nodeName(this,"form")?!1:void f.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=f.nodeName(c,"input")||f.nodeName(c,"button")?c.form:b;d&&!d._submit_attached&&(f.event.add(d,"submit._submit",function(a){a._submit_bubble=!0}),d._submit_attached=!0)})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&f.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return f.nodeName(this,"form")?!1:void f.event.remove(this,"._submit")}}),f.support.changeBubbles||(f.event.special.change={setup:function(){return z.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(f.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),f.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,f.event.simulate("change",this,a,!0))})),!1):void f.event.add(this,"beforeactivate._change",function(a){var b=a.target;z.test(b.nodeName)&&!b._change_attached&&(f.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&f.event.simulate("change",this.parentNode,a,!0)}),b._change_attached=!0)})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return f.event.remove(this,"._change"),z.test(this.nodeName)}}),f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){var d=0,e=function(a){f.event.simulate(b,a.target,f.event.fix(a),!0)};f.event.special[b]={setup:function(){0===d++&&c.addEventListener(a,e,!0)},teardown:function(){0===--d&&c.removeEventListener(a,e,!0)}}}),f.fn.extend({on:function(a,c,d,e,g){var h,i;if("object"==typeof a){"string"!=typeof c&&(d=d||c,c=b);for(i in a)this.on(i,c,d,a[i],g);return this}if(null==d&&null==e?(e=c,d=c=b):null==e&&("string"==typeof c?(e=d,d=b):(e=d,d=c,c=b)),e===!1)e=J;else if(!e)return this;return 1===g&&(h=e,e=function(a){return f().off(a),h.apply(this,arguments)},e.guid=h.guid||(h.guid=f.guid++)),this.each(function(){f.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;return f(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this}if("object"==typeof a){for(var g in a)this.off(g,c,a[g]);return this}return(c===!1||"function"==typeof c)&&(d=c,c=b),d===!1&&(d=J),this.each(function(){f.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){return f(this.context).on(a,this.selector,b,c),this},die:function(a,b){return f(this.context).off(a,this.selector||"**",b),this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1==arguments.length?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){return this[0]?f.event.trigger(a,b,this[0],!0):void 0},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f._data(this,"lastToggle"+a.guid)||0)%d;return f._data(this,"lastToggle"+a.guid,e+1),c.preventDefault(),b[e].apply(this,arguments)||!1};for(e.guid=c;d<b.length;)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){f.fn[b]=function(a,c){return null==c&&(c=a,a=null),arguments.length>0?this.on(b,null,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0),C.test(b)&&(f.event.fixHooks[b]=f.event.keyHooks),D.test(b)&&(f.event.fixHooks[b]=f.event.mouseHooks)}),function(){function x(a,b,c,e,f,g){for(var h=0,i=e.length;i>h;h++){var j=e[h];if(j){var k=!1;for(j=j[a];j;){if(j[d]===c){k=e[j.sizset];break}if(1===j.nodeType)if(g||(j[d]=c,j.sizset=h),"string"!=typeof b){if(j===b){k=!0;break}}else if(m.filter(b,[j]).length>0){k=j;break}j=j[a]}e[h]=k}}}function w(a,b,c,e,f,g){for(var h=0,i=e.length;i>h;h++){var j=e[h];if(j){var k=!1;for(j=j[a];j;){if(j[d]===c){k=e[j.sizset];break}if(1===j.nodeType&&!g&&(j[d]=c,j.sizset=h),j.nodeName.toLowerCase()===b){k=j;break}j=j[a]}e[h]=k}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d="sizcache"+(Math.random()+"").replace(".",""),e=0,g=Object.prototype.toString,h=!1,i=!0,j=/\\/g,k=/\r\n/g,l=/\W/;[0,0].sort(function(){return i=!1,0});var m=function(b,d,e,f){e=e||[],d=d||c;var h=d;if(1!==d.nodeType&&9!==d.nodeType)return[];if(!b||"string"!=typeof b)return e;var i,j,k,l,n,q,r,t,u=!0,v=m.isXML(d),w=[],x=b;do if(a.exec(""),i=a.exec(x),i&&(x=i[3],w.push(i[1]),i[2])){l=i[3];break}while(i);if(w.length>1&&p.exec(b))if(2===w.length&&o.relative[w[0]])j=y(w[0]+w[1],d,f);else for(j=o.relative[w[0]]?[d]:m(w.shift(),d);w.length;)b=w.shift(),o.relative[b]&&(b+=w.shift()),j=y(b,j,f);else if(!f&&w.length>1&&9===d.nodeType&&!v&&o.match.ID.test(w[0])&&!o.match.ID.test(w[w.length-1])&&(n=m.find(w.shift(),d,v),d=n.expr?m.filter(n.expr,n.set)[0]:n.set[0]),d)for(n=f?{expr:w.pop(),set:s(f)}:m.find(w.pop(),1!==w.length||"~"!==w[0]&&"+"!==w[0]||!d.parentNode?d:d.parentNode,v),j=n.expr?m.filter(n.expr,n.set):n.set,w.length>0?k=s(j):u=!1;w.length;)q=w.pop(),r=q,o.relative[q]?r=w.pop():q="",null==r&&(r=d),o.relative[q](k,r,v);else k=w=[];if(k||(k=j),k||m.error(q||b),"[object Array]"===g.call(k))if(u)if(d&&1===d.nodeType)for(t=0;null!=k[t];t++)k[t]&&(k[t]===!0||1===k[t].nodeType&&m.contains(d,k[t]))&&e.push(j[t]);else for(t=0;null!=k[t];t++)k[t]&&1===k[t].nodeType&&e.push(j[t]);else e.push.apply(e,k);else s(k,e);return l&&(m(l,h,e,f),m.uniqueSort(e)),e};m.uniqueSort=function(a){if(u&&(h=i,a.sort(u),h))for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1);return a},m.matches=function(a,b){return m(a,null,null,b)},m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0},m.find=function(a,b,c){var d,e,f,g,h,i;if(!a)return[];for(e=0,f=o.order.length;f>e;e++)if(h=o.order[e],(g=o.leftMatch[h].exec(a))&&(i=g[1],g.splice(1,1),"\\"!==i.substr(i.length-1)&&(g[1]=(g[1]||"").replace(j,""),d=o.find[h](g,b,c),null!=d))){a=a.replace(o.match[h],"");break}return d||(d="undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName("*"):[]),{set:d,expr:a}},m.filter=function(a,c,d,e){for(var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);a&&c.length;){for(h in o.filter)if(null!=(f=o.leftMatch[h].exec(a))&&f[2]){if(k=o.filter[h],l=f[1],g=!1,f.splice(1,1),"\\"===l.substr(l.length-1))continue;if(s===r&&(r=[]),o.preFilter[h])if(f=o.preFilter[h](f,s,d,r,e,t)){if(f===!0)continue}else g=i=!0;if(f)for(n=0;null!=(j=s[n]);n++)j&&(i=k(j,f,n,s),p=e^i,d&&null!=i?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0));if(i!==b){if(d||(s=r),a=a.replace(o.match[h],""),!g)return[];break}}if(a===q){if(null!=g)break;m.error(a)}q=a}return s},m.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)};var n=m.getText=function(a){var b,c,d=a.nodeType,e="";if(d){if(1===d||9===d||11===d){if("string"==typeof a.textContent)return a.textContent;if("string"==typeof a.innerText)return a.innerText.replace(k,"");for(a=a.firstChild;a;a=a.nextSibling)e+=n(a)}else if(3===d||4===d)return a.nodeValue}else for(b=0;c=a[b];b++)8!==c.nodeType&&(e+=n(c));return e},o=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c="string"==typeof b,d=c&&!l.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var h,f=0,g=a.length;g>f;f++)if(h=a[f]){for(;(h=h.previousSibling)&&1!==h.nodeType;);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&m.filter(b,a,!0)},">":function(a,b){var c,d="string"==typeof b,e=0,f=a.length;if(d&&!l.test(b)){for(b=b.toLowerCase();f>e;e++)if(c=a[e]){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}else{for(;f>e;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&m.filter(b,a,!0)}},"":function(a,b,c){var d,f=e++,g=x;"string"==typeof b&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("parentNode",b,f,a,d,c)},"~":function(a,b,c){var d,f=e++,g=x;"string"==typeof b&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("previousSibling",b,f,a,d,c)}},find:{ID:function(a,b,c){if("undefined"!=typeof b.getElementById&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if("undefined"!=typeof b.getElementsByName){for(var c=[],d=b.getElementsByName(a[1]),e=0,f=d.length;f>e;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return 0===c.length?null:c}},TAG:function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a[1]):void 0}},preFilter:{CLASS:function(a,b,c,d,e,f){if(a=" "+a[1].replace(j,"")+" ",f)return a;for(var h,g=0;null!=(h=b[g]);g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(j,"")},TAG:function(a){return a[1].replace(j,"").toLowerCase()},CHILD:function(a){if("nth"===a[1]){a[2]||m.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec("even"===a[2]&&"2n"||"odd"===a[2]&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&m.error(a[0]);return a[0]=e++,a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(j,"");return!f&&o.attrMap[g]&&(a[1]=o.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(j,""),"~="===a[2]&&(a[4]=" "+a[4]+" "),a},PSEUDO:function(b,c,d,e,f){if("not"===b[1]){if(!((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))){var g=m.filter(b[3],c,d,!0^f);return d||e.push.apply(e,g),!1}b[3]=m(b[3],null,null,c)}else if(o.match.POS.test(b[0])||o.match.CHILD.test(b[0]))return!0;return b},POS:function(a){return a.unshift(!0),a}},filters:{enabled:function(a){return a.disabled===!1&&"hidden"!==a.type},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return"input"===a.nodeName.toLowerCase()&&"text"===c&&(b===c||null===b)},radio:function(a){return"input"===a.nodeName.toLowerCase()&&"radio"===a.type},checkbox:function(a){return"input"===a.nodeName.toLowerCase()&&"checkbox"===a.type},file:function(a){return"input"===a.nodeName.toLowerCase()&&"file"===a.type},password:function(a){return"input"===a.nodeName.toLowerCase()&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return("input"===b||"button"===b)&&"submit"===a.type},image:function(a){return"input"===a.nodeName.toLowerCase()&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return("input"===b||"button"===b)&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return 0===b},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=o.filters[e];if(f)return f(a,c,b,d);if("contains"===e)return(a.textContent||a.innerText||n([a])||"").indexOf(b[3])>=0;if("not"===e){for(var g=b[3],h=0,i=g.length;i>h;h++)if(g[h]===a)return!1;return!0}m.error(e)},CHILD:function(a,b){var c,e,f,g,i,j,k=b[1],l=a;switch(k){case"only":case"first":for(;l=l.previousSibling;)if(1===l.nodeType)return!1;if("first"===k)return!0;l=a;case"last":for(;l=l.nextSibling;)if(1===l.nodeType)return!1;return!0;case"nth":if(c=b[2],e=b[3],1===c&&0===e)return!0;if(f=b[0],g=a.parentNode,g&&(g[d]!==f||!a.nodeIndex)){for(i=0,l=g.firstChild;l;l=l.nextSibling)1===l.nodeType&&(l.nodeIndex=++i);g[d]=f}return j=a.nodeIndex-e,0===c?0===j:j%c===0&&j/c>=0}},ID:function(a,b){return 1===a.nodeType&&a.getAttribute("id")===b},TAG:function(a,b){return"*"===b&&1===a.nodeType||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=m.attr?m.attr(a,c):o.attrHandle[c]?o.attrHandle[c](a):null!=a[c]?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return null==d?"!="===f:!f&&m.attr?null!=d:"="===f?e===g:"*="===f?e.indexOf(g)>=0:"~="===f?(" "+e+" ").indexOf(g)>=0:g?"!="===f?e!==g:"^="===f?0===e.indexOf(g):"$="===f?e.substr(e.length-g.length)===g:"|="===f?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=o.setFilters[e];return f?f(a,c,b,d):void 0}}},p=o.match.POS,q=function(a,b){return"\\"+(b-0+1)};for(var r in o.match)o.match[r]=new RegExp(o.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),o.leftMatch[r]=new RegExp(/(^(?:.|\r|\n)*?)/.source+o.match[r].source.replace(/\\(\d+)/g,q));o.match.globalPOS=p;var s=function(a,b){return a=Array.prototype.slice.call(a,0),b?(b.push.apply(b,a),b):a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(t){s=function(a,b){var c=0,d=b||[];if("[object Array]"===g.call(a))Array.prototype.push.apply(d,a);else if("number"==typeof a.length)for(var e=a.length;e>c;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var u,v;c.documentElement.compareDocumentPosition?u=function(a,b){return a===b?(h=!0,0):a.compareDocumentPosition&&b.compareDocumentPosition?4&a.compareDocumentPosition(b)?-1:1:a.compareDocumentPosition?-1:1}:(u=function(a,b){if(a===b)return h=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,i=b.parentNode,j=g;if(g===i)return v(a,b);if(!g)return-1;if(!i)return 1;for(;j;)e.unshift(j),j=j.parentNode;for(j=i;j;)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;c>k&&d>k;k++)if(e[k]!==f[k])return v(e[k],f[k]);return k===c?v(a,f[k],-1):v(e[k],b,1)},v=function(a,b,c){if(a===b)return c;for(var d=a.nextSibling;d;){if(d===b)return-1;d=d.nextSibling}return 1}),function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(o.find.ID=function(a,c,d){if("undefined"!=typeof c.getElementById&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||"undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},o.filter.ID=function(a,b){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return 1===a.nodeType&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(o.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if("*"===a[1]){for(var d=[],e=0;c[e];e++)1===c[e].nodeType&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&"undefined"!=typeof a.firstChild.getAttribute&&"#"!==a.firstChild.getAttribute("href")&&(o.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=m,b=c.createElement("div"),d="__sizzle__";if(b.innerHTML="<p class='TEST'></p>",!b.querySelectorAll||0!==b.querySelectorAll(".TEST").length){m=function(b,e,f,g){if(e=e||c,!g&&!m.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(1===e.nodeType||9===e.nodeType)){if(h[1])return s(e.getElementsByTagName(b),f);if(h[2]&&o.find.CLASS&&e.getElementsByClassName)return s(e.getElementsByClassName(h[2]),f)}if(9===e.nodeType){if("body"===b&&e.body)return s([e.body],f);if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode)return s([],f);if(i.id===h[3])return s([i],f)}try{return s(e.querySelectorAll(b),f)}catch(j){}}else if(1===e.nodeType&&"object"!==e.nodeName.toLowerCase()){var k=e,l=e.getAttribute("id"),n=l||d,p=e.parentNode,q=/^\s*[+~]/.test(b);l?n=n.replace(/'/g,"\\$&"):e.setAttribute("id",n),q&&p&&(e=e.parentNode);try{if(!q||p)return s(e.querySelectorAll("[id='"+n+"'] "+b),f)}catch(r){}finally{l||k.removeAttribute("id")}}}return a(b,e,f,g)};for(var e in a)m[e]=a[e];b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,"[test!='']:sizzle")}catch(f){e=!0}m.matchesSelector=function(a,c){if(c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']"),!m.isXML(a))try{if(e||!o.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&11!==a.document.nodeType)return f}}catch(g){}return m(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");if(a.innerHTML="<div class='test e'></div><div class='test'></div>",a.getElementsByClassName&&0!==a.getElementsByClassName("e").length){if(a.lastChild.className="e",1===a.getElementsByClassName("e").length)return;o.order.splice(1,0,"CLASS"),o.find.CLASS=function(a,b,c){return"undefined"==typeof b.getElementsByClassName||c?void 0:b.getElementsByClassName(a[1])},a=null}}(),m.contains=c.documentElement.contains?function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?function(a,b){return!!(16&a.compareDocumentPosition(b))}:function(){return!1},m.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?"HTML"!==b.nodeName:!1};var y=function(a,b,c){for(var d,e=[],f="",g=b.nodeType?[b]:b;d=o.match.PSEUDO.exec(a);)f+=d[0],a=a.replace(o.match.PSEUDO,"");a=o.relative[a]?a+"*":a;for(var h=0,i=g.length;i>h;h++)m(a,g[h],e,c);return m.filter(f,e)};m.attr=f.attr,m.selectors.attrMap={},f.find=m,f.expr=m.selectors,f.expr[":"]=f.expr.filters,f.unique=m.uniqueSort,f.text=m.getText,f.isXMLDoc=m.isXML,f.contains=m.contains}();var L=/Until$/,M=/^(?:parents|prevUntil|prevAll)/,N=/,/,O=/^.[^:#\[\.,]*$/,P=Array.prototype.slice,Q=f.expr.match.globalPOS,R={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var c,d,b=this;if("string"!=typeof a)return f(a).filter(function(){for(c=0,d=b.length;d>c;c++)if(f.contains(b[c],this))return!0});var g,h,i,e=this.pushStack("","find",a);for(c=0,d=this.length;d>c;c++)if(g=e.length,f.find(a,this[c],e),c>0)for(h=g;h<e.length;h++)for(i=0;g>i;i++)if(e[i]===e[h]){e.splice(h--,1);break}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;c>a;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(T(this,a,!1),"not",a)},filter:function(a){return this.pushStack(T(this,a,!0),"filter",a)},is:function(a){return!!a&&("string"==typeof a?Q.test(a)?f(a,this.context).index(this[0])>=0:f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var d,e,c=[],g=this[0];if(f.isArray(a)){for(var h=1;g&&g.ownerDocument&&g!==b;){for(d=0;d<a.length;d++)f(g).is(a[d])&&c.push({selector:a[d],elem:g,level:h});g=g.parentNode,h++}return c}var i=Q.test(a)||"string"!=typeof a?f(a,b||this.context):0;for(d=0,e=this.length;e>d;d++)for(g=this[d];g;){if(i?i.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}if(g=g.parentNode,!g||!g.ownerDocument||g===b||11===g.nodeType)break}return c=c.length>1?f.unique(c):c,this.pushStack(c,"closest",a)},index:function(a){return a?"string"==typeof a?f.inArray(this[0],f(a)):f.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(a,b){var c="string"==typeof a?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(S(c[0])||S(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c);return L.test(a)||(d=c),d&&"string"==typeof d&&(e=f.filter(d,e)),e=this.length>1&&!R[a]?f.unique(e):e,(this.length>1||N.test(d))&&M.test(a)&&(e=e.reverse()),this.pushStack(e,a,P.call(arguments).join(","))}}),f.extend({filter:function(a,b,c){return c&&(a=":not("+a+")"),1===b.length?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){for(var e=[],g=a[c];g&&9!==g.nodeType&&(d===b||1!==g.nodeType||!f(g).is(d));)1===g.nodeType&&e.push(g),g=g[c];return e},nth:function(a,b,c){b=b||1;for(var e=0;a&&(1!==a.nodeType||++e!==b);a=a[c]);return a},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});var V="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",W=/ jQuery\d+="(?:\d+|null)"/g,X=/^\s+/,Y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Z=/<([\w:]+)/,$=/<tbody/i,_=/<|&#?\w+;/,ba=/<(?:script|style)/i,bb=/<(?:script|object|embed|option|style)/i,bc=new RegExp("<(?:"+V+")[\\s/>]","i"),bd=/checked\s*(?:[^=]|=\s*.checked.)/i,be=/\/(java|ecma)script/i,bf=/^\s*<!(?:\[CDATA\[|\-\-)/,bg={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bh=U(c);bg.optgroup=bg.option,bg.tbody=bg.tfoot=bg.colgroup=bg.caption=bg.thead,bg.th=bg.td,f.support.htmlSerialize||(bg._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){return f.access(this,function(a){return a===b?f.text(this):this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);
this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(f.isFunction(a)?function(b){f(this).wrapInner(a.call(this,b))}:function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=f.isFunction(a);return this.each(function(c){f(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){1===this.nodeType&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){1===this.nodeType&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f.clean(arguments);return a.push.apply(a,this.toArray()),this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);return a.push.apply(a,f.clean(arguments)),a}},remove:function(a,b){for(var d,c=0;null!=(d=this[c]);c++)(!a||f.filter(a,[d]).length)&&(!b&&1===d.nodeType&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d));return this},empty:function(){for(var b,a=0;null!=(b=this[a]);a++)for(1===b.nodeType&&f.cleanData(b.getElementsByTagName("*"));b.firstChild;)b.removeChild(b.firstChild);return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return f.clone(this,a,b)})},html:function(a){return f.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b)return 1===c.nodeType?c.innerHTML.replace(W,""):null;if(!("string"!=typeof a||ba.test(a)||!f.support.leadingWhitespace&&X.test(a)||bg[(Z.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(Y,"<$1></$2>");try{for(;e>d;d++)c=this[d]||{},1===c.nodeType&&(f.cleanData(c.getElementsByTagName("*")),c.innerHTML=a);c=0}catch(g){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(a){return this[0]&&this[0].parentNode?f.isFunction(a)?this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))}):("string"!=typeof a&&(a=f(a).detach()),this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})):this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&3===arguments.length&&"string"==typeof j&&bd.test(j))return this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(j))return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(this[0]){if(i=j&&j.parentNode,e=f.support.parentNode&&i&&11===i.nodeType&&i.childNodes.length===this.length?{fragment:i}:f.buildFragment(a,this,k),h=e.fragment,g=1===h.childNodes.length?h=h.firstChild:h.firstChild,g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;m>l;l++)d.call(c?bi(this[l],g):this[l],e.cacheable||m>1&&n>l?f.clone(h,!0,!0):h)}k.length&&f.each(k,function(a,b){b.src?f.ajax({type:"GET",global:!1,url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bf,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)})}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i,j=a[0];return b&&b[0]&&(i=b[0].ownerDocument||b[0]),i.createDocumentFragment||(i=c),1===a.length&&"string"==typeof j&&j.length<512&&i===c&&"<"===j.charAt(0)&&!bb.test(j)&&(f.support.checkClone||!bd.test(j))&&(f.support.html5Clone||!bc.test(j))&&(g=!0,h=f.fragments[j],h&&1!==h&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[j]=h?e:1),{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=1===this.length&&this[0].parentNode;if(g&&11===g.nodeType&&1===g.childNodes.length&&1===e.length)return e[b](this[0]),this;for(var h=0,i=e.length;i>h;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d,e,g,h=f.support.html5Clone||f.isXMLDoc(a)||!bc.test("<"+a.nodeName+">")?a.cloneNode(!0):bo(a);if(!(f.support.noCloneEvent&&f.support.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||f.isXMLDoc(a)))for(bk(a,h),d=bl(a),e=bl(h),g=0;d[g];++g)e[g]&&bk(d[g],e[g]);if(b&&(bj(a,h),c))for(d=bl(a),e=bl(h),g=0;d[g];++g)bj(d[g],e[g]);return d=e=null,h},clean:function(a,b,d,e){var g,h,i,j=[];b=b||c,"undefined"==typeof b.createElement&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||c);for(var l,k=0;null!=(l=a[k]);k++)if("number"==typeof l&&(l+=""),l){if("string"==typeof l)if(_.test(l)){l=l.replace(Y,"<$1></$2>");var r,m=(Z.exec(l)||["",""])[1].toLowerCase(),n=bg[m]||bg._default,o=n[0],p=b.createElement("div"),q=bh.childNodes;for(b===c?bh.appendChild(p):U(b).appendChild(p),p.innerHTML=n[1]+l+n[2];o--;)p=p.lastChild;if(!f.support.tbody){var s=$.test(l),t="table"!==m||s?"<table>"!==n[1]||s?[]:p.childNodes:p.firstChild&&p.firstChild.childNodes;for(i=t.length-1;i>=0;--i)f.nodeName(t[i],"tbody")&&!t[i].childNodes.length&&t[i].parentNode.removeChild(t[i])}!f.support.leadingWhitespace&&X.test(l)&&p.insertBefore(b.createTextNode(X.exec(l)[0]),p.firstChild),l=p.childNodes,p&&(p.parentNode.removeChild(p),q.length>0&&(r=q[q.length-1],r&&r.parentNode&&r.parentNode.removeChild(r)))}else l=b.createTextNode(l);var u;if(!f.support.appendChecked)if(l[0]&&"number"==typeof(u=l.length))for(i=0;u>i;i++)bn(l[i]);else bn(l);l.nodeType?j.push(l):j=f.merge(j,l)}if(d)for(g=function(a){return!a.type||be.test(a.type)},k=0;j[k];k++)if(h=j[k],e&&f.nodeName(h,"script")&&(!h.type||be.test(h.type)))e.push(h.parentNode?h.parentNode.removeChild(h):h);else{if(1===h.nodeType){var v=f.grep(h.getElementsByTagName("script"),g);j.splice.apply(j,[k+1,0].concat(v))}d.appendChild(h)}return j},cleanData:function(a){for(var b,c,i,d=f.cache,e=f.event.special,g=f.support.deleteExpando,h=0;null!=(i=a[h]);h++)if((!i.nodeName||!f.noData[i.nodeName.toLowerCase()])&&(c=i[f.expando])){if(b=d[c],b&&b.events){for(var j in b.events)e[j]?f.event.remove(i,j):f.removeEvent(i,j,b.handle);b.handle&&(b.handle.elem=null)}g?delete i[f.expando]:i.removeAttribute&&i.removeAttribute(f.expando),delete d[c]}}});var by,bz,bA,bp=/alpha\([^)]*\)/i,bq=/opacity=([^)]*)/,br=/([A-Z]|^ms)/g,bs=/^[\-+]?(?:\d*\.)?\d+$/i,bt=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,bu=/^([\-+])=([\-+.\de]+)/,bv=/^margin/,bw={position:"absolute",visibility:"hidden",display:"block"},bx=["Top","Right","Bottom","Left"];f.fn.css=function(a,c){return f.access(this,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)},a,c,arguments.length>1)},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=by(a,"opacity");return""===c?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];if(c=f.cssProps[i]||i,d===b)return k&&"get"in k&&(g=k.get(a,!1,e))!==b?g:j[c];if(h=typeof d,"string"===h&&(g=bu.exec(d))&&(d=+(g[1]+1)*+g[2]+parseFloat(f.css(a,c)),h="number"),null==d||"number"===h&&isNaN(d))return;if("number"===h&&!f.cssNumber[i]&&(d+="px"),!(k&&"set"in k&&(d=k.set(a,d))===b))try{j[c]=d}catch(l){}}},css:function(a,c,d){var e,g;return c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,"cssFloat"===c&&(c="float"),g&&"get"in g&&(e=g.get(a,!0,d))!==b?e:by?by(a,c):void 0},swap:function(a,b,c){var e,f,d={};for(f in b)d[f]=a.style[f],a.style[f]=b[f];e=c.call(a);for(f in b)a.style[f]=d[f];return e}}),f.curCSS=f.css,c.defaultView&&c.defaultView.getComputedStyle&&(bz=function(a,b){var c,d,e,g,h=a.style;return b=b.replace(br,"-$1").toLowerCase(),(d=a.ownerDocument.defaultView)&&(e=d.getComputedStyle(a,null))&&(c=e.getPropertyValue(b),""===c&&!f.contains(a.ownerDocument.documentElement,a)&&(c=f.style(a,b))),!f.support.pixelMargin&&e&&bv.test(b)&&bt.test(c)&&(g=h.width,h.width=c,c=e.width,h.width=g),c}),c.documentElement.currentStyle&&(bA=function(a,b){var c,d,e,f=a.currentStyle&&a.currentStyle[b],g=a.style;return null==f&&g&&(e=g[b])&&(f=e),bt.test(f)&&(c=g.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),g.left="fontSize"===b?"1em":f,f=g.pixelLeft+"px",g.left=c,d&&(a.runtimeStyle.left=d)),""===f?"auto":f}),by=bz||bA,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){return c?0!==a.offsetWidth?bB(a,b,d):f.swap(a,bw,function(){return bB(a,b,d)}):void 0},set:function(a,b){return bs.test(b)?b+"px":b}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return bq.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNumeric(b)?"alpha(opacity="+100*b+")":"",g=d&&d.filter||c.filter||"";c.zoom=1,b>=1&&""===f.trim(g.replace(bp,""))&&(c.removeAttribute("filter"),d&&!d.filter)||(c.filter=bp.test(g)?g.replace(bp,e):g+" "+e)}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){return f.swap(a,{display:"inline-block"},function(){return b?by(a,"margin-right"):a.style.marginRight})}})}),f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return 0===b&&0===c||!f.support.reliableHiddenOffsets&&"none"===(a.style&&a.style.display||f.css(a,"display"))},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)}),f.each({margin:"",padding:"",border:"Width"},function(a,b){f.cssHooks[a+b]={expand:function(c){var d,e="string"==typeof c?c.split(" "):[c],f={};for(d=0;4>d;d++)f[a+bx[d]+b]=e[d]||e[d-2]||e[0];return f}}});var bU,bV,bC=/%20/g,bD=/\[\]$/,bE=/\r?\n/g,bF=/#.*$/,bG=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,bH=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bI=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bJ=/^(?:GET|HEAD)$/,bK=/^\/\//,bL=/\?/,bM=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bN=/^(?:select|textarea)/i,bO=/\s+/,bP=/([?&])_=[^&]*/,bQ=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bR=f.fn.load,bS={},bT={},bW=["*/"]+["*"];try{bU=e.href}catch(bX){bU=c.createElement("a"),bU.href="",bU=bU.href}bV=bQ.exec(bU.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if("string"!=typeof a&&bR)return bR.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):"object"==typeof c&&(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;return f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bM,"")).find(g):c)),d&&i.each(d,[c,b,a])}}),this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bN.test(this.nodeName)||bH.test(this.type))}).map(function(a,b){var c=f(this).val();return null==c?null:f.isArray(c)?f.map(c,function(a){return{name:b.name,value:a.replace(bE,"\r\n")}}):{name:b.name,value:c.replace(bE,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.on(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){return f.isFunction(d)&&(g=g||e,e=d,d=b),f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){return b?b$(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),b$(a,b),a},ajaxSettings:{url:bU,isLocal:bI.test(bV[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":bW},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:bY(bS),ajaxTransport:bY(bT),ajax:function(a,c){function w(a,c,l,m){if(2!==s){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a>0?4:0;var o,r,u,y,z,w=c,x=l?ca(d,v,l):b;if(a>=200&&300>a||304===a)if(d.ifModified&&((y=v.getResponseHeader("Last-Modified"))&&(f.lastModified[k]=y),(z=v.getResponseHeader("Etag"))&&(f.etag[k]=z)),304===a)w="notmodified",o=!0;else try{r=cb(d,x),w="success",o=!0}catch(A){w="parsererror",u=A}else u=w,(!w||a)&&(w="error",0>a&&(a=0));v.status=a,v.statusText=""+(c||w),o?h.resolveWith(e,[r,w,v]):h.rejectWith(e,[v,w,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.fireWith(e,[v,w]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}"object"==typeof a&&(c=a,a=b),c=c||{};var k,n,o,p,q,r,t,u,d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f.Callbacks("once memory"),j=d.statusCode||{},l={},m={},s=0,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return 2===s?n:null},getResponseHeader:function(a){var c;if(2===s){if(!o)for(o={};c=bG.exec(n);)o[c[1].toLowerCase()]=c[2];c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){return s||(d.mimeType=a),this},abort:function(a){return a=a||"abort",p&&p.abort(a),w(0,a),this}};if(h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.add,v.statusCode=function(a){if(a){var b;if(2>s)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},d.url=((a||d.url)+"").replace(bF,"").replace(bK,bV[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bO),null==d.crossDomain&&(r=bQ.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bV[1]&&r[2]==bV[2]&&(r[3]||("http:"===r[1]?80:443))==(bV[3]||("http:"===bV[1]?80:443)))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=f.param(d.data,d.traditional)),bZ(bS,d,c,v),2===s)return!1;if(t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bJ.test(d.type),t&&0===f.active++&&f.event.trigger("ajaxStart"),!d.hasContent&&(d.data&&(d.url+=(bL.test(d.url)?"&":"?")+d.data,delete d.data),k=d.url,d.cache===!1)){var x=f.now(),y=d.url.replace(bP,"$1_="+x);d.url=y+(y===d.url?(bL.test(d.url)?"&":"?")+"_="+x:"")}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+bW+"; q=0.01":""):d.accepts["*"]);for(u in d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||2===s))return v.abort(),!1;for(u in{success:1,error:1,complete:1})v[u](d[u]);if(p=bZ(bT,d,c,v)){v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){if(!(2>s))throw z;w(-1,z)}}else w(-1,"No Transport");return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(c===b&&(c=f.ajaxSettings.traditional),f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var g in a)b_(g,a[g],c,e);return d.join("&").replace(bC,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var cc=f.now(),cd=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+cc++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e="string"==typeof b.data&&/^application\/x\-www\-form\-urlencoded/.test(b.contentType);if("jsonp"===b.dataTypes[0]||b.jsonp!==!1&&(cd.test(b.url)||e&&cd.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";return b.jsonp!==!1&&(j=j.replace(cd,l),b.url===j&&(e&&(k=k.replace(cd,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){return g||f.error(h+" was not called"),g[0]},b.dataTypes[0]="json","script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){return f.globalEval(a),a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){(c||!d.readyState||/loaded|complete/.test(d.readyState))&&(d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success"))},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var cg,ce=a.ActiveXObject?function(){for(var a in cg)cg[a](0,1)}:!1,cf=0;f.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&ch()||ci()}:ch,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var i,j,h=c.xhr();if(c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async),c.xhrFields)for(j in c.xhrFields)h[j]=c.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||4===h.readyState))if(d=b,i&&(h.onreadystatechange=f.noop,ce&&delete cg[i]),e)4!==h.readyState&&h.abort();else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n);try{m.text=h.responseText}catch(a){}try{k=h.statusText}catch(o){k=""}j||!c.isLocal||c.crossDomain?1223===j&&(j=204):j=m.text?200:404}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},c.async&&4!==h.readyState?(i=++cf,ce&&(cg||(cg={},f(a).unload(ce)),cg[i]=d),h.onreadystatechange=d):d()},abort:function(){d&&d(0,1)}}}});var ck,cl,co,cq,cj={},cm=/^(?:toggle|show|hide)$/,cn=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,cp=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];f.fn.extend({show:function(a,b,c){var d,e;if(a||0===a)return this.animate(ct("show",3),a,b,c);for(var g=0,h=this.length;h>g;g++)d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&"none"===e&&(e=d.style.display=""),(""===e&&"none"===f.css(d,"display")||!f.contains(d.ownerDocument.documentElement,d))&&f._data(d,"olddisplay",cu(d.nodeName)));for(g=0;h>g;g++)d=this[g],d.style&&(e=d.style.display,(""===e||"none"===e)&&(d.style.display=f._data(d,"olddisplay")||""));return this},hide:function(a,b,c){if(a||0===a)return this.animate(ct("hide",3),a,b,c);for(var d,e,g=0,h=this.length;h>g;g++)d=this[g],d.style&&(e=f.css(d,"display"),"none"!==e&&!f._data(d,"olddisplay")&&f._data(d,"olddisplay",e));for(g=0;h>g;g++)this[g].style&&(this[g].style.display="none");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d="boolean"==typeof a;return f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):null==a||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(ct("toggle",3),a,b,c),this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function g(){e.queue===!1&&f._mark(this);var g,h,i,j,k,l,m,n,o,p,q,b=f.extend({},e),c=1===this.nodeType,d=c&&f(this).is(":hidden");b.animatedProperties={};for(i in a)if(g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]),(k=f.cssHooks[g])&&"expand"in k){l=k.expand(a[g]),delete a[g];for(i in l)i in a||(a[i]=l[i])}for(g in a){if(h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing","hide"===h&&d||"show"===h&&!d)return b.complete.call(this);c&&("height"===g||"width"===g)&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],"inline"===f.css(this,"display")&&"none"===f.css(this,"float")&&(f.support.inlineBlockNeedsLayout&&"inline"!==cu(this.nodeName)?this.style.zoom=1:this.style.display="inline-block"))}null!=b.overflow&&(this.style.overflow="hidden");for(i in a)j=new f.fx(this,b,i),h=a[i],cm.test(h)?(q=f._data(this,"toggle"+i)||("toggle"===h?d?"show":"hide":0),q?(f._data(this,"toggle"+i,"show"===q?"hide":"show"),j[q]()):j[h]()):(m=cn.exec(h),n=j.cur(),m?(o=parseFloat(m[2]),p=m[3]||(f.cssNumber[i]?"":"px"),"px"!==p&&(f.style(this,i,(o||1)+p),n=(o||1)/j.cur()*n,f.style(this,i,n+p)),m[1]&&(o=("-="===m[1]?-1:1)*o+n),j.custom(n,o,p)):j.custom(n,h,""));return!0}var e=f.speed(b,c,d);return f.isEmptyObject(a)?this.each(e.complete,[!1]):(a=f.extend({},a),e.queue===!1?this.each(g):this.queue(e.queue,g))},stop:function(a,c,d){return"string"!=typeof a&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){function h(a,b,c){var e=b[c];f.removeData(a,c,!0),e.stop(d)}var b,c=!1,e=f.timers,g=f._data(this);if(d||f._unmark(!0,this),null==a)for(b in g)g[b]&&g[b].stop&&b.indexOf(".run")===b.length-4&&h(this,g,b);else g[b=a+".run"]&&g[b].stop&&h(this,g,b);for(b=e.length;b--;)e[b].elem===this&&(null==a||e[b].queue===a)&&(d?e[b](!0):e[b].saveState(),c=!0,e.splice(b,1));(!d||!c)&&f.dequeue(this,a)})}}),f.each({slideDown:ct("show",1),slideUp:ct("hide",1),slideToggle:ct("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&"object"==typeof a?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};return d.duration=f.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(a){f.isFunction(d.old)&&d.old.call(this),d.queue?f.dequeue(this,d.queue):a!==!1&&f._unmark(this)},d},easing:{linear:function(a){return a},swing:function(a){return-Math.cos(a*Math.PI)/2+.5}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(null!=this.elem[this.prop]&&(!this.elem.style||null==this.elem.style[this.prop]))return this.elem[this.prop];var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?b&&"auto"!==b?b:0:a},custom:function(a,c,d){function h(a){return e.step(a)}var e=this,g=f.fx;this.startTime=cq||cr(),this.end=c,this.now=this.start=a,this.pos=this.state=0,this.unit=d||this.unit||(f.cssNumber[this.prop]?"":"px"),h.queue=this.options.queue,h.elem=this.elem,h.saveState=function(){f._data(e.elem,"fxshow"+e.prop)===b&&(e.options.hide?f._data(e.elem,"fxshow"+e.prop,e.start):e.options.show&&f._data(e.elem,"fxshow"+e.prop,e.end))},h()&&f.timers.push(h)&&!co&&(co=setInterval(g.tick,g.interval))},show:function(){var a=f._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||f.style(this.elem,this.prop),this.options.show=!0,a!==b?this.custom(this.cur(),a):this.custom("width"===this.prop||"height"===this.prop?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f._data(this.elem,"fxshow"+this.prop)||f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b,c,d,e=cq||cr(),g=!0,h=this.elem,i=this.options;if(a||e>=i.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),i.animatedProperties[this.prop]=!0;for(b in i.animatedProperties)i.animatedProperties[b]!==!0&&(g=!1);if(g){if(null!=i.overflow&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){h.style["overflow"+b]=i.overflow[a]}),i.hide&&f(h).hide(),i.hide||i.show)for(b in i.animatedProperties)f.style(h,b,i.orig[b]),f.removeData(h,"fxshow"+b,!0),f.removeData(h,"toggle"+b,!0);d=i.complete,d&&(i.complete=!1,d.call(h))}return!1}return 1/0==i.duration?this.now=e:(c=e-this.startTime,this.state=c/i.duration,this.pos=f.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update(),!0}},f.extend(f.fx,{tick:function(){for(var a,b=f.timers,c=0;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||f.fx.stop()},interval:13,stop:function(){clearInterval(co),co=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&null!=a.elem.style[a.prop]?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),f.each(cp.concat.apply([],cp),function(a,b){b.indexOf("margin")&&(f.fx.step[b]=function(a){f.style(a.elem,b,Math.max(0,a.now)+a.unit)})}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cv,cw=/^t(?:able|d|h)$/i,cx=/^(?:body|html)$/i;cv="getBoundingClientRect"in c.documentElement?function(a,b,c,d){try{d=a.getBoundingClientRect()}catch(e){}if(!d||!f.contains(c,a))return d?{top:d.top,left:d.left}:{top:0,left:0};var g=b.body,h=cy(b),i=c.clientTop||g.clientTop||0,j=c.clientLeft||g.clientLeft||0,k=h.pageYOffset||f.support.boxModel&&c.scrollTop||g.scrollTop,l=h.pageXOffset||f.support.boxModel&&c.scrollLeft||g.scrollLeft,m=d.top+k-i,n=d.left+l-j;return{top:m,left:n}}:function(a,b,c){for(var d,e=a.offsetParent,g=a,h=b.body,i=b.defaultView,j=i?i.getComputedStyle(a,null):a.currentStyle,k=a.offsetTop,l=a.offsetLeft;(a=a.parentNode)&&a!==h&&a!==c&&(!f.support.fixedPosition||"fixed"!==j.position);)d=i?i.getComputedStyle(a,null):a.currentStyle,k-=a.scrollTop,l-=a.scrollLeft,a===e&&(k+=a.offsetTop,l+=a.offsetLeft,f.support.doesNotAddBorder&&(!f.support.doesAddBorderForTableAndCells||!cw.test(a.nodeName))&&(k+=parseFloat(d.borderTopWidth)||0,l+=parseFloat(d.borderLeftWidth)||0),g=e,e=a.offsetParent),f.support.subtractsBorderForOverflowNotVisible&&"visible"!==d.overflow&&(k+=parseFloat(d.borderTopWidth)||0,l+=parseFloat(d.borderLeftWidth)||0),j=d;return("relative"===j.position||"static"===j.position)&&(k+=h.offsetTop,l+=h.offsetLeft),f.support.fixedPosition&&"fixed"===j.position&&(k+=Math.max(c.scrollTop,h.scrollTop),l+=Math.max(c.scrollLeft,h.scrollLeft)),{top:k,left:l}},f.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){f.offset.setOffset(this,a,b)});var c=this[0],d=c&&c.ownerDocument;return d?c===d.body?f.offset.bodyOffset(c):cv(c,d,d.documentElement):null},f.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;return f.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0),{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");"static"===d&&(a.style.position="relative");var m,n,e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=("absolute"===d||"fixed"===d)&&f.inArray("auto",[h,i])>-1,k={},l={};j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),null!=b.top&&(k.top=b.top-g.top+m),null!=b.left&&(k.left=b.left-g.left+n),"using"in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=cx.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0,{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||c.body;a&&!cx.test(a.nodeName)&&"static"===f.css(a,"position");)a=a.offsetParent;return a})}}),f.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);f.fn[a]=function(e){return f.access(this,function(a,e,g){var h=cy(a);return g===b?h?c in h?h[c]:f.support.boxModel&&h.document.documentElement[e]||h.document.body[e]:a[e]:void(h?h.scrollTo(d?f(h).scrollLeft():g,d?g:f(h).scrollTop()):a[e]=g)},a,e,arguments.length,null)}}),f.each({Height:"height",Width:"width"},function(a,c){var d="client"+a,e="scroll"+a,g="offset"+a;f.fn["inner"+a]=function(){var a=this[0];return a?a.style?parseFloat(f.css(a,c,"padding")):this[c]():null},f.fn["outer"+a]=function(a){var b=this[0];return b?b.style?parseFloat(f.css(b,c,a?"margin":"border")):this[c]():null},f.fn[c]=function(a){return f.access(this,function(a,c,h){var i,j,k,l;return f.isWindow(a)?(i=a.document,j=i.documentElement[d],f.support.boxModel&&j||i.body&&i.body[d]||j):9===a.nodeType?(i=a.documentElement,i[d]>=i[e]?i[d]:Math.max(a.body[e],i[e],a.body[g],i[g])):h===b?(k=f.css(a,c),l=parseFloat(k),f.isNumeric(l)?l:k):void f(a).css(c,h)},c,a,arguments.length,null)}}),a.jQuery=a.$=f,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return f})}(window),function($){$.cookie=function(key,value,options){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(value))||null===value||void 0===value)){if(options=$.extend({},options),(null===value||void 0===value)&&(options.expires=-1),"number"==typeof options.expires){var days=options.expires,t=options.expires=new Date;t.setDate(t.getDate()+days)}return value=String(value),document.cookie=[encodeURIComponent(key),"=",options.raw?value:encodeURIComponent(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join("")}options=value||{};for(var pair,decode=options.raw?function(s){return s}:decodeURIComponent,pairs=document.cookie.split("; "),i=0;pair=pairs[i]&&pairs[i].split("=");i++)if(decode(pair[0])===key)return decode(pair[1]||"");return null}}(jQuery),function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,h=e.reduce,v=e.reduceRight,d=e.filter,g=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,_=Object.keys,j=i.bind,w=function(n){return n instanceof w?n:this instanceof w?void(this._wrapped=n):new w(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=w),exports._=w):n._=w,w.VERSION="1.4.4";var A=w.each=w.forEach=function(n,t,e){if(null!=n)if(s&&n.forEach===s)n.forEach(t,e);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(t.call(e,n[u],u,n)===r)return
}else for(var a in n)if(w.has(n,a)&&t.call(e,n[a],a,n)===r)return};w.map=w.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e[e.length]=t.call(r,n,u,i)}),e)};var O="Reduce of empty array with no initial value";w.reduce=w.foldl=w.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduce===h)return e&&(t=w.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(O);return r},w.reduceRight=w.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduceRight===v)return e&&(t=w.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=w.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(O);return r},w.find=w.detect=function(n,t,r){var e;return E(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},w.filter=w.select=function(n,t,r){var e=[];return null==n?e:d&&n.filter===d?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&(e[e.length]=n)}),e)},w.reject=function(n,t,r){return w.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},w.every=w.all=function(n,t,e){t||(t=w.identity);var u=!0;return null==n?u:g&&n.every===g?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var E=w.some=w.any=function(n,t,e){t||(t=w.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};w.contains=w.include=function(n,t){return null==n?!1:y&&n.indexOf===y?-1!=n.indexOf(t):E(n,function(n){return n===t})},w.invoke=function(n,t){var r=o.call(arguments,2),e=w.isFunction(t);return w.map(n,function(n){return(e?t:n[t]).apply(n,r)})},w.pluck=function(n,t){return w.map(n,function(n){return n[t]})},w.where=function(n,t,r){return w.isEmpty(t)?r?null:[]:w[r?"find":"filter"](n,function(n){for(var r in t)if(t[r]!==n[r])return!1;return!0})},w.findWhere=function(n,t){return w.where(n,t,!0)},w.max=function(n,t,r){if(!t&&w.isArray(n)&&n[0]===+n[0]&&65535>n.length)return Math.max.apply(Math,n);if(!t&&w.isEmpty(n))return-1/0;var e={computed:-1/0,value:-1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a>=e.computed&&(e={value:n,computed:a})}),e.value},w.min=function(n,t,r){if(!t&&w.isArray(n)&&n[0]===+n[0]&&65535>n.length)return Math.min.apply(Math,n);if(!t&&w.isEmpty(n))return 1/0;var e={computed:1/0,value:1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;e.computed>a&&(e={value:n,computed:a})}),e.value},w.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=w.random(r++),e[r-1]=e[t],e[t]=n}),e};var k=function(n){return w.isFunction(n)?n:function(t){return t[n]}};w.sortBy=function(n,t,r){var e=k(t);return w.pluck(w.map(n,function(n,t,u){return{value:n,index:t,criteria:e.call(r,n,t,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||void 0===r)return 1;if(e>r||void 0===e)return-1}return n.index<t.index?-1:1}),"value")};var F=function(n,t,r,e){var u={},i=k(t||w.identity);return A(n,function(t,a){var o=i.call(r,t,a,n);e(u,o,t)}),u};w.groupBy=function(n,t,r){return F(n,t,r,function(n,t,r){(w.has(n,t)?n[t]:n[t]=[]).push(r)})},w.countBy=function(n,t,r){return F(n,t,r,function(n,t){w.has(n,t)||(n[t]=0),n[t]++})},w.sortedIndex=function(n,t,r,e){r=null==r?w.identity:k(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;u>r.call(e,n[o])?i=o+1:a=o}return i},w.toArray=function(n){return n?w.isArray(n)?o.call(n):n.length===+n.length?w.map(n,w.identity):w.values(n):[]},w.size=function(n){return null==n?0:n.length===+n.length?n.length:w.keys(n).length},w.first=w.head=w.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:o.call(n,0,t)},w.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},w.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},w.rest=w.tail=w.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},w.compact=function(n){return w.filter(n,w.identity)};var R=function(n,t,r){return A(n,function(n){w.isArray(n)?t?a.apply(r,n):R(n,t,r):r.push(n)}),r};w.flatten=function(n,t){return R(n,t,[])},w.without=function(n){return w.difference(n,o.call(arguments,1))},w.uniq=w.unique=function(n,t,r,e){w.isFunction(t)&&(e=r,r=t,t=!1);var u=r?w.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:w.contains(a,r))||(a.push(r),i.push(n[e]))}),i},w.union=function(){return w.uniq(c.apply(e,arguments))},w.intersection=function(n){var t=o.call(arguments,1);return w.filter(w.uniq(n),function(n){return w.every(t,function(t){return w.indexOf(t,n)>=0})})},w.difference=function(n){var t=c.apply(e,o.call(arguments,1));return w.filter(n,function(n){return!w.contains(t,n)})},w.zip=function(){for(var n=o.call(arguments),t=w.max(w.pluck(n,"length")),r=Array(t),e=0;t>e;e++)r[e]=w.pluck(n,""+e);return r},w.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},w.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=w.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y)return n.indexOf(t,r);for(;u>e;e++)if(n[e]===t)return e;return-1},w.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(b&&n.lastIndexOf===b)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},w.range=function(n,t,r){1>=arguments.length&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=Array(e);e>u;)i[u++]=n,n+=r;return i},w.bind=function(n,t){if(n.bind===j&&j)return j.apply(n,o.call(arguments,1));var r=o.call(arguments,2);return function(){return n.apply(t,r.concat(o.call(arguments)))}},w.partial=function(n){var t=o.call(arguments,1);return function(){return n.apply(this,t.concat(o.call(arguments)))}},w.bindAll=function(n){var t=o.call(arguments,1);return 0===t.length&&(t=w.functions(n)),A(t,function(t){n[t]=w.bind(n[t],n)}),n},w.memoize=function(n,t){var r={};return t||(t=w.identity),function(){var e=t.apply(this,arguments);return w.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},w.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},w.defer=function(n){return w.delay.apply(w,[n,1].concat(o.call(arguments,1)))},w.throttle=function(n,t){var r,e,u,i,a=0,o=function(){a=new Date,u=null,i=n.apply(r,e)};return function(){var c=new Date,l=t-(c-a);return r=this,e=arguments,0>=l?(clearTimeout(u),u=null,a=c,i=n.apply(r,e)):u||(u=setTimeout(o,l)),i}},w.debounce=function(n,t,r){var e,u;return function(){var i=this,a=arguments,o=function(){e=null,r||(u=n.apply(i,a))},c=r&&!e;return clearTimeout(e),e=setTimeout(o,t),c&&(u=n.apply(i,a)),u}},w.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},w.wrap=function(n,t){return function(){var r=[n];return a.apply(r,arguments),t.apply(this,r)}},w.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},w.after=function(n,t){return 0>=n?t():function(){return 1>--n?t.apply(this,arguments):void 0}},w.keys=_||function(n){if(n!==Object(n))throw new TypeError("Invalid object");var t=[];for(var r in n)w.has(n,r)&&(t[t.length]=r);return t},w.values=function(n){var t=[];for(var r in n)w.has(n,r)&&t.push(n[r]);return t},w.pairs=function(n){var t=[];for(var r in n)w.has(n,r)&&t.push([r,n[r]]);return t},w.invert=function(n){var t={};for(var r in n)w.has(n,r)&&(t[n[r]]=r);return t},w.functions=w.methods=function(n){var t=[];for(var r in n)w.isFunction(n[r])&&t.push(r);return t.sort()},w.extend=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},w.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},w.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n)w.contains(r,u)||(t[u]=n[u]);return t},w.defaults=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)null==n[r]&&(n[r]=t[r])}),n},w.clone=function(n){return w.isObject(n)?w.isArray(n)?n.slice():w.extend({},n):n},w.tap=function(n,t){return t(n),n};var I=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof w&&(n=n._wrapped),t instanceof w&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t))return!1;switch(u){case"[object String]":return n==t+"";case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;r.push(n),e.push(t);var a=0,o=!0;if("[object Array]"==u){if(a=n.length,o=a==t.length)for(;a--&&(o=I(n[a],t[a],r,e)););}else{var c=n.constructor,f=t.constructor;if(c!==f&&!(w.isFunction(c)&&c instanceof c&&w.isFunction(f)&&f instanceof f))return!1;for(var s in n)if(w.has(n,s)&&(a++,!(o=w.has(t,s)&&I(n[s],t[s],r,e))))break;if(o){for(s in t)if(w.has(t,s)&&!a--)break;o=!a}}return r.pop(),e.pop(),o};w.isEqual=function(n,t){return I(n,t,[],[])},w.isEmpty=function(n){if(null==n)return!0;if(w.isArray(n)||w.isString(n))return 0===n.length;for(var t in n)if(w.has(n,t))return!1;return!0},w.isElement=function(n){return!(!n||1!==n.nodeType)},w.isArray=x||function(n){return"[object Array]"==l.call(n)},w.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){w["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),w.isArguments(arguments)||(w.isArguments=function(n){return!(!n||!w.has(n,"callee"))}),"function"!=typeof/./&&(w.isFunction=function(n){return"function"==typeof n}),w.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},w.isNaN=function(n){return w.isNumber(n)&&n!=+n},w.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},w.isNull=function(n){return null===n},w.isUndefined=function(n){return void 0===n},w.has=function(n,t){return f.call(n,t)},w.noConflict=function(){return n._=t,this},w.identity=function(n){return n},w.times=function(n,t,r){for(var e=Array(n),u=0;n>u;u++)e[u]=t.call(r,u);return e},w.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};var M={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};M.unescape=w.invert(M.escape);var S={escape:RegExp("["+w.keys(M.escape).join("")+"]","g"),unescape:RegExp("("+w.keys(M.unescape).join("|")+")","g")};w.each(["escape","unescape"],function(n){w[n]=function(t){return null==t?"":(""+t).replace(S[n],function(t){return M[n][t]})}}),w.result=function(n,t){if(null==n)return null;var r=n[t];return w.isFunction(r)?r.call(n):r},w.mixin=function(n){A(w.functions(n),function(t){var r=w[t]=n[t];w.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),D.call(this,r.apply(w,n))}})};var N=0;w.uniqueId=function(n){var t=++N+"";return n?n+t:t},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var T=/(.)^/,q={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;w.template=function(n,t,r){var e;r=w.defaults({},r,w.templateSettings);var u=RegExp([(r.escape||T).source,(r.interpolate||T).source,(r.evaluate||T).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(B,function(n){return"\\"+q[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=Function(r.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t)return e(t,w);var c=function(n){return e.call(this,n,w)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},w.chain=function(n){return w(n).chain()};var D=function(n){return this._chain?w(n).chain():n};w.mixin(w),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];w.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],D.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];w.prototype[n]=function(){return D.call(this,t.apply(this._wrapped,arguments))}}),w.extend(w.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this);var requirejs,require,define;!function(Z){function H(b){return"[object Function]"===L.call(b)}function I(b){return"[object Array]"===L.call(b)}function y(b,c){if(b){var d;for(d=0;d<b.length&&(!b[d]||!c(b[d],d,b));d+=1);}}function M(b,c){if(b){var d;for(d=b.length-1;d>-1&&(!b[d]||!c(b[d],d,b));d-=1);}}function s(b,c){return ga.call(b,c)}function l(b,c){return s(b,c)&&b[c]}function F(b,c){for(var d in b)if(s(b,d)&&c(b[d],d))break}function Q(b,c,d,h){return c&&F(c,function(c,j){(d||!s(b,j))&&(h&&"string"!=typeof c?(b[j]||(b[j]={}),Q(b[j],c,d,h)):b[j]=c)}),b}function u(b,c){return function(){return c.apply(b,arguments)}}function aa(b){throw b}function ba(b){if(!b)return b;var c=Z;return y(b.split("."),function(b){c=c[b]}),c}function A(b,c,d,h){return c=Error(c+"\nhttp://requirejs.org/docs/errors.html#"+b),c.requireType=b,c.requireModules=h,d&&(c.originalError=d),c}function ha(b){function c(a,f,b){var e,m,c,g,d,h,j,i=f&&f.split("/");e=i;var n=k.map,p=n&&n["*"];if(a&&"."===a.charAt(0))if(f){for(e=l(k.pkgs,f)?i=[f]:i.slice(0,i.length-1),f=a=e.concat(a.split("/")),e=0;f[e];e+=1)if(m=f[e],"."===m)f.splice(e,1),e-=1;else if(".."===m){if(1===e&&(".."===f[2]||".."===f[0]))break;e>0&&(f.splice(e-1,2),e-=2)}e=l(k.pkgs,f=a[0]),a=a.join("/"),e&&a===f+"/"+e.main&&(a=f)}else 0===a.indexOf("./")&&(a=a.substring(2));if(b&&n&&(i||p)){for(f=a.split("/"),e=f.length;e>0;e-=1){if(c=f.slice(0,e).join("/"),i)for(m=i.length;m>0;m-=1)if((b=l(n,i.slice(0,m).join("/")))&&(b=l(b,c))){g=b,d=e;break}if(g)break;!h&&p&&l(p,c)&&(h=l(p,c),j=e)}!g&&h&&(g=h,d=j),g&&(f.splice(0,d,g),a=f.join("/"))}return a}function d(a){z&&y(document.getElementsByTagName("script"),function(f){return f.getAttribute("data-requiremodule")===a&&f.getAttribute("data-requirecontext")===i.contextName?(f.parentNode.removeChild(f),!0):void 0})}function h(a){var f=l(k.paths,a);return f&&I(f)&&1<f.length?(d(a),f.shift(),i.require.undef(a),i.require([a]),!0):void 0}function $(a){var f,b=a?a.indexOf("!"):-1;return b>-1&&(f=a.substring(0,b),a=a.substring(b+1,a.length)),[f,a]}function n(a,f,b,e){var m,B,g=null,d=f?f.name:null,h=a,j=!0,k="";return a||(j=!1,a="_@r"+(L+=1)),a=$(a),g=a[0],a=a[1],g&&(g=c(g,d,e),B=l(r,g)),a&&(g?k=B&&B.normalize?B.normalize(a,function(a){return c(a,d,e)}):c(a,d,e):(k=c(a,d,e),a=$(k),g=a[0],k=a[1],b=!0,m=i.nameToUrl(k))),b=!g||B||b?"":"_unnormalized"+(M+=1),{prefix:g,name:k,parentMap:f,unnormalized:!!b,url:m,originalName:h,isDefine:j,id:(g?g+"!"+k:k)+b}}function q(a){var f=a.id,b=l(p,f);return b||(b=p[f]=new i.Module(a)),b}function t(a,f,b){var e=a.id,m=l(p,e);!s(r,e)||m&&!m.defineEmitComplete?(m=q(a),m.error&&"error"===f?b(m.error):m.on(f,b)):"defined"===f&&b(r[e])}function v(a,f){var b=a.requireModules,e=!1;f?f(a):(y(b,function(f){(f=l(p,f))&&(f.error=a,f.events.error&&(e=!0,f.emit("error",a)))}),e||j.onError(a))}function w(){R.length&&(ia.apply(G,[G.length-1,0].concat(R)),R=[])}function x(a){delete p[a],delete T[a]}function E(a,f,b){var e=a.map.id;a.error?a.emit("error",a.error):(f[e]=!0,y(a.depMaps,function(e,c){var g=e.id,d=l(p,g);d&&!a.depMatched[c]&&!b[g]&&(l(f,g)?(a.defineDep(c,r[g]),a.check()):E(d,f,b))}),b[e]=!0)}function C(){var a,f,b,e,m=(b=1e3*k.waitSeconds)&&i.startTime+b<(new Date).getTime(),c=[],g=[],j=!1,l=!0;if(!U){if(U=!0,F(T,function(b){if(a=b.map,f=a.id,b.enabled&&(a.isDefine||g.push(b),!b.error))if(!b.inited&&m)h(f)?j=e=!0:(c.push(f),d(f));else if(!b.inited&&b.fetched&&a.isDefine&&(j=!0,!a.prefix))return l=!1}),m&&c.length)return b=A("timeout","Load timeout for modules: "+c,null,c),b.contextName=i.contextName,v(b);l&&y(g,function(a){E(a,{},{})}),m&&!e||!j||!z&&!da||V||(V=setTimeout(function(){V=0,C()},50)),U=!1}}function D(a){s(r,a[0])||q(n(a[0],null,!0)).init(a[1],a[2])}function J(a){var a=a.currentTarget||a.srcElement,b=i.onScriptLoad;return a.detachEvent&&!W?a.detachEvent("onreadystatechange",b):a.removeEventListener("load",b,!1),b=i.onScriptError,(!a.detachEvent||W)&&a.removeEventListener("error",b,!1),{node:a,id:a&&a.getAttribute("data-requiremodule")}}function K(){var a;for(w();G.length;){if(a=G.shift(),null===a[0])return v(A("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));D(a)}}var U,X,i,N,V,k={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},p={},T={},Y={},G=[],r={},S={},L=1,M=1;return N={require:function(a){return a.require?a.require:a.require=i.makeRequire(a.map)},exports:function(a){return a.usingExports=!0,a.map.isDefine?a.exports?a.exports:a.exports=r[a.map.id]={}:void 0},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){var b=l(k.pkgs,a.map.id);return(b?l(k.config,a.map.id+"/"+b.main):l(k.config,a.map.id))||{}},exports:r[a.map.id]}}},X=function(a){this.events=l(Y,a.id)||{},this.map=a,this.shim=l(k.shim,a.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},X.prototype={init:function(a,b,c,e){e=e||{},this.inited||(this.factory=b,c?this.on("error",c):this.events.error&&(c=u(this,function(a){this.emit("error",a)})),this.depMaps=a&&a.slice(0),this.errback=c,this.inited=!0,this.ignore=e.ignore,e.enabled||this.enabled?this.enable():this.check())},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0,i.startTime=(new Date).getTime();var a=this.map;if(!this.shim)return a.prefix?this.callPlugin():this.load();i.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],u(this,function(){return a.prefix?this.callPlugin():this.load()}))}},load:function(){var a=this.map.url;S[a]||(S[a]=!0,i.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,b,c=this.map.id;b=this.depExports;var e=this.exports,m=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,1>this.depCount&&!this.defined){if(H(m)){if(this.events.error&&this.map.isDefine||j.onError!==aa)try{e=i.execCb(c,m,b,e)}catch(d){a=d}else e=i.execCb(c,m,b,e);if(this.map.isDefine&&((b=this.module)&&void 0!==b.exports&&b.exports!==this.exports?e=b.exports:void 0===e&&this.usingExports&&(e=this.exports)),a)return a.requireMap=this.map,a.requireModules=this.map.isDefine?[this.map.id]:null,a.requireType=this.map.isDefine?"define":"require",v(this.error=a)}else e=m;this.exports=e,this.map.isDefine&&!this.ignore&&(r[c]=e,j.onResourceLoad)&&j.onResourceLoad(i,this.map,this.depMaps),x(c),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var a=this.map,b=a.id,d=n(a.prefix);this.depMaps.push(d),t(d,"defined",u(this,function(e){var m,d;d=this.map.name;var g=this.map.parentMap?this.map.parentMap.name:null,h=i.makeRequire(a.parentMap,{enableBuildCallback:!0});this.map.unnormalized?(e.normalize&&(d=e.normalize(d,function(a){return c(a,g,!0)})||""),e=n(a.prefix+"!"+d,this.map.parentMap),t(e,"defined",u(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),(d=l(p,e.id))&&(this.depMaps.push(e),this.events.error&&d.on("error",u(this,function(a){this.emit("error",a)})),d.enable())):(m=u(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),m.error=u(this,function(a){this.inited=!0,this.error=a,a.requireModules=[b],F(p,function(a){0===a.map.id.indexOf(b+"_unnormalized")&&x(a.map.id)}),v(a)}),m.fromText=u(this,function(e,c){var d=a.name,g=n(d),B=O;c&&(e=c),B&&(O=!1),q(g),s(k.config,b)&&(k.config[d]=k.config[b]);try{j.exec(e)}catch(ca){return v(A("fromtexteval","fromText eval for "+b+" failed: "+ca,ca,[b]))}B&&(O=!0),this.depMaps.push(g),i.completeLoad(d),h([d],m)}),e.load(a.name,h,m,k))})),i.enable(d,this),this.pluginMaps[d.id]=d},enable:function(){T[this.map.id]=this,this.enabling=this.enabled=!0,y(this.depMaps,u(this,function(a,b){var c,e;if("string"==typeof a){if(a=n(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[b]=a,c=l(N,a.id))return void(this.depExports[b]=c(this));this.depCount+=1,t(a,"defined",u(this,function(a){this.defineDep(b,a),this.check()})),this.errback&&t(a,"error",u(this,this.errback))}c=a.id,e=p[c],!s(N,c)&&e&&!e.enabled&&i.enable(a,this)})),F(this.pluginMaps,u(this,function(a){var b=l(p,a.id);b&&!b.enabled&&i.enable(a,this)})),this.enabling=!1,this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]),c.push(b)},emit:function(a,b){y(this.events[a],function(a){a(b)}),"error"===a&&delete this.events[a]}},i={config:k,contextName:b,registry:p,defined:r,urlFetched:S,defQueue:G,Module:X,makeModuleMap:n,nextTick:j.nextTick,onError:v,configure:function(a){a.baseUrl&&"/"!==a.baseUrl.charAt(a.baseUrl.length-1)&&(a.baseUrl+="/");var b=k.pkgs,c=k.shim,e={paths:!0,config:!0,map:!0};F(a,function(a,b){e[b]?"map"===b?(k.map||(k.map={}),Q(k[b],a,!0,!0)):Q(k[b],a,!0):k[b]=a}),a.shim&&(F(a.shim,function(a,b){I(a)&&(a={deps:a}),!a.exports&&!a.init||a.exportsFn||(a.exportsFn=i.makeShimExports(a)),c[b]=a}),k.shim=c),a.packages&&(y(a.packages,function(a){a="string"==typeof a?{name:a}:a,b[a.name]={name:a.name,location:a.location||a.name,main:(a.main||"main").replace(ja,"").replace(ea,"")}}),k.pkgs=b),F(p,function(a,b){!a.inited&&!a.map.unnormalized&&(a.map=n(b))}),(a.deps||a.callback)&&i.require(a.deps||[],a.callback)},makeShimExports:function(a){return function(){var b;return a.init&&(b=a.init.apply(Z,arguments)),b||a.exports&&ba(a.exports)}},makeRequire:function(a,f){function d(e,c,h){var g,k;return f.enableBuildCallback&&c&&H(c)&&(c.__requireJsBuild=!0),"string"==typeof e?H(c)?v(A("requireargs","Invalid require call"),h):a&&s(N,e)?N[e](p[a.id]):j.get?j.get(i,e,a,d):(g=n(e,a,!1,!0),g=g.id,s(r,g)?r[g]:v(A("notloaded",'Module name "'+g+'" has not been loaded yet for context: '+b+(a?"":". Use require([])")))):(K(),i.nextTick(function(){K(),k=q(n(null,a)),k.skipMap=f.skipMap,k.init(e,c,h,{enabled:!0}),C()}),d)}return f=f||{},Q(d,{isBrowser:z,toUrl:function(b){var d,f=b.lastIndexOf("."),g=b.split("/")[0];return-1!==f&&("."!==g&&".."!==g||f>1)&&(d=b.substring(f,b.length),b=b.substring(0,f)),i.nameToUrl(c(b,a&&a.id,!0),d,!0)},defined:function(b){return s(r,n(b,a,!1,!0).id)},specified:function(b){return b=n(b,a,!1,!0).id,s(r,b)||s(p,b)}}),a||(d.undef=function(b){w();var c=n(b,a,!0),f=l(p,b);delete r[b],delete S[c.url],delete Y[b],f&&(f.events.defined&&(Y[b]=f.events),x(b))}),d},enable:function(a){l(p,a.id)&&q(a).enable()},completeLoad:function(a){var b,c,e=l(k.shim,a)||{},d=e.exports;for(w();G.length;){if(c=G.shift(),null===c[0]){if(c[0]=a,b)break;b=!0}else c[0]===a&&(b=!0);D(c)}if(c=l(p,a),!b&&!s(r,a)&&c&&!c.inited){if(k.enforceDefine&&(!d||!ba(d)))return h(a)?void 0:v(A("nodefine","No define call for "+a,null,[a]));D([a,e.deps||[],e.exportsFn])}C()},nameToUrl:function(a,b,c){var e,d,h,g,i,n;if(j.jsExtRegExp.test(a))g=a+(b||"");else{for(e=k.paths,d=k.pkgs,g=a.split("/"),i=g.length;i>0;i-=1){if(n=g.slice(0,i).join("/"),h=l(d,n),n=l(e,n)){I(n)&&(n=n[0]),g.splice(0,i,n);break}if(h){a=a===h.name?h.location+"/"+h.main:h.location,g.splice(0,i,a);break}}g=g.join("/"),g+=b||(/\?/.test(g)||c?"":".js"),g=("/"===g.charAt(0)||g.match(/^[\w\+\.\-]+:/)?"":k.baseUrl)+g}return k.urlArgs?g+((-1===g.indexOf("?")?"?":"&")+k.urlArgs):g},load:function(a,b){j.load(i,a,b)},execCb:function(a,b,c,e){return b.apply(e,c)},onScriptLoad:function(a){("load"===a.type||ka.test((a.currentTarget||a.srcElement).readyState))&&(P=null,a=J(a),i.completeLoad(a.id))},onScriptError:function(a){var b=J(a);return h(b.id)?void 0:v(A("scripterror","Script error for: "+b.id,a,[b.id]))}},i.require=i.makeRequire(),i}var j,w,x,C,J,D,P,K,q,fa,la=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,ma=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,ea=/\.js$/,ja=/^\.\//;w=Object.prototype;var L=w.toString,ga=w.hasOwnProperty,ia=Array.prototype.splice,z=!("undefined"==typeof window||!navigator||!window.document),da=!z&&"undefined"!=typeof importScripts,ka=z&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,W="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),E={},t={},R=[],O=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(H(requirejs))return;t=requirejs,requirejs=void 0}"undefined"!=typeof require&&!H(require)&&(t=require,require=void 0),j=requirejs=function(b,c,d,h){var q,n="_";return!I(b)&&"string"!=typeof b&&(q=b,I(c)?(b=c,c=d,d=h):b=[]),q&&q.context&&(n=q.context),(h=l(E,n))||(h=E[n]=j.s.newContext(n)),q&&h.configure(q),h.require(b,c,d)},j.config=function(b){return j(b)},j.nextTick="undefined"!=typeof setTimeout?function(b){setTimeout(b,4)}:function(b){b()},require||(require=j),j.version="2.1.8",j.jsExtRegExp=/^\/|:|\?|\.js$/,j.isBrowser=z,w=j.s={contexts:E,newContext:ha},j({}),y(["toUrl","undef","defined","specified"],function(b){j[b]=function(){var c=E._;return c.require[b].apply(c,arguments)}}),z&&(x=w.head=document.getElementsByTagName("head")[0],C=document.getElementsByTagName("base")[0])&&(x=w.head=C.parentNode),j.onError=aa,j.createNode=function(b){var c=b.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return c.type=b.scriptType||"text/javascript",c.charset="utf-8",c.async=!0,c},j.load=function(b,c,d){var h=b&&b.config||{};if(z)return h=j.createNode(h,c,d),h.setAttribute("data-requirecontext",b.contextName),h.setAttribute("data-requiremodule",c),!h.attachEvent||h.attachEvent.toString&&0>h.attachEvent.toString().indexOf("[native code")||W?(h.addEventListener("load",b.onScriptLoad,!1),h.addEventListener("error",b.onScriptError,!1)):(O=!0,h.attachEvent("onreadystatechange",b.onScriptLoad)),h.src=d,K=h,C?x.insertBefore(h,C):x.appendChild(h),K=null,h;if(da)try{importScripts(d),b.completeLoad(c)}catch(l){b.onError(A("importscripts","importScripts failed for "+c+" at "+d,l,[c]))}},z&&M(document.getElementsByTagName("script"),function(b){return x||(x=b.parentNode),(J=b.getAttribute("data-main"))?(q=J,t.baseUrl||(D=q.split("/"),q=D.pop(),fa=D.length?D.join("/")+"/":"./",t.baseUrl=fa),q=q.replace(ea,""),j.jsExtRegExp.test(q)&&(q=J),t.deps=t.deps?t.deps.concat(q):[q],!0):void 0}),define=function(b,c,d){var h,j;"string"!=typeof b&&(d=c,c=b,b=null),I(c)||(d=c,c=null),!c&&H(d)&&(c=[],d.length&&(d.toString().replace(la,"").replace(ma,function(b,d){c.push(d)}),c=(1===d.length?["require"]:["require","exports","module"]).concat(c))),O&&((h=K)||(P&&"interactive"===P.readyState||M(document.getElementsByTagName("script"),function(b){return"interactive"===b.readyState?P=b:void 0}),h=P),h&&(b||(b=h.getAttribute("data-requiremodule")),j=E[h.getAttribute("data-requirecontext")])),(j?j.defQueue:R).push([b,c,d])},define.amd={jQuery:!0},j.exec=function(b){return eval(b)},j(t)}}(this),window.RequireJS=window.RequireJS||{},RequireJS.requirejs=RequireJS.requirejs||window.requirejs,RequireJS.require=RequireJS.require||window.require,RequireJS.define=RequireJS.define||window.define,window.require=void 0,window.define=void 0,window.requirejs=void 0;var JSON;JSON||(JSON={}),function(){"use strict";function f(n){return 10>n?"0"+n:n}function quote(string){return escapable.lastIndex=0,escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return"string"==typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,partial,mind=gap,value=holder[key];switch(value&&"object"==typeof value&&"function"==typeof value.toJSON&&(value=value.toJSON(key)),"function"==typeof rep&&(value=rep.call(holder,key,value)),typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value)return"null";if(gap+=indent,partial=[],"[object Array]"===Object.prototype.toString.apply(value)){for(length=value.length,i=0;length>i;i+=1)partial[i]=str(i,value)||"null";return v=0===partial.length?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]",gap=mind,v}if(rep&&"object"==typeof rep)for(length=rep.length,i=0;length>i;i+=1)"string"==typeof rep[i]&&(k=rep[i],v=str(k,value),v&&partial.push(quote(k)+(gap?": ":":")+v));else for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(v=str(k,value),v&&partial.push(quote(k)+(gap?": ":":")+v));return v=0===partial.length?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}",gap=mind,v}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(value,replacer,space){var i;if(gap="",indent="","number"==typeof space)for(i=0;space>i;i+=1)indent+=" ";else"string"==typeof space&&(indent=space);if(rep=replacer,replacer&&"function"!=typeof replacer&&("object"!=typeof replacer||"number"!=typeof replacer.length))throw new Error("JSON.stringify");return str("",{"":value})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(v=walk(value,k),void 0!==v?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(e,t){function i(t,n){var r,i,o,u=t.nodeName.toLowerCase();return"area"===u?(r=t.parentNode,i=r.name,t.href&&i&&"map"===r.nodeName.toLowerCase()?(o=e("img[usemap=#"+i+"]")[0],!!o&&s(o)):!1):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||n:n)&&s(t)}function s(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var n=0,r=/^ui-id-\d+$/;e.ui=e.ui||{},e.ui.version||(e.extend(e.ui,{version:"1.10.0",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({_focus:e.fn.focus,focus:function(t,n){return"number"==typeof t?this.each(function(){var r=this;setTimeout(function(){e(r).focus(),n&&n.call(r)
},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var i,s,r=e(this[0]);r.length&&r[0]!==document;){if(i=r.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(r.css("zIndex"),10),!isNaN(s)&&0!==s))return s;r=r.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++n)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var n=e.attr(t,"tabindex"),r=isNaN(n);return(r||n>=0)&&i(t,!r)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,r){function u(t,n,r,s){return e.each(i,function(){n-=parseFloat(e.css(t,"padding"+this))||0,r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var i="Width"===r?["Left","Right"]:["Top","Bottom"],s=r.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?o["inner"+r].call(this):this.each(function(){e(this).css(s,u(this,n)+"px")})},e.fn["outer"+r]=function(t,n){return"number"!=typeof t?o["outer"+r].call(this,t):this.each(function(){e(this).css(s,u(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n){var r,i=e.plugins[t];if(i&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(r=0;r<i.length;r++)e.options[i[r][0]]&&i[r][1].apply(e.element,n)}},hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var r=n&&"left"===n?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)}}))}(jQuery),function(e,t){var n=0,r=Array.prototype.slice,i=e.cleanData;e.cleanData=function(t){for(var r,n=0;null!=(r=t[n]);n++)try{e(r).triggerHandler("remove")}catch(s){}i(t)},e.widget=function(t,n,r){var i,s,o,u,a={},f=t.split(".")[0];t=t.split(".")[1],i=f+"-"+t,r||(r=n,n=e.Widget),e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)},e[f]=e[f]||{},s=e[f][t],o=e[f][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new o(e,t)},e.extend(o,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),u=new n,u.options=e.widget.extend({},u.options),e.each(r,function(t,r){return e.isFunction(r)?void(a[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},i=function(e){return n.prototype[t].apply(this,e)};return function(){var s,t=this._super,n=this._superApply;return this._super=e,this._superApply=i,s=r.apply(this,arguments),this._super=t,this._superApply=n,s}}()):void(a[t]=r)}),o.prototype=e.widget.extend(u,{widgetEventPrefix:s?u.widgetEventPrefix:t},a,{constructor:o,namespace:f,widgetName:t,widgetFullName:i}),s?(e.each(s._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,o,n._proto)}),delete s._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o)},e.widget.extend=function(n){for(var u,a,i=r.call(arguments,1),s=0,o=i.length;o>s;s++)for(u in i[s])a=i[s][u],i[s].hasOwnProperty(u)&&a!==t&&(n[u]=e.isPlainObject(a)?e.isPlainObject(n[u])?e.widget.extend({},n[u],a):e.widget.extend({},a):a);return n},e.widget.bridge=function(n,i){var s=i.prototype.widgetFullName||n;e.fn[n]=function(o){var u="string"==typeof o,a=r.call(arguments,1),f=this;return o=!u&&a.length?e.widget.extend.apply(null,[o].concat(a)):o,this.each(u?function(){var r,i=e.data(this,s);return i?e.isFunction(i[o])&&"_"!==o.charAt(0)?(r=i[o].apply(i,a),r!==i&&r!==t?(f=r&&r.jquery?f.pushStack(r.get()):r,!1):void 0):e.error("no such method '"+o+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+o+"'")}:function(){var t=e.data(this,s);t?t.option(o||{})._init():e.data(this,s,new i(o,this))}),f}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var s,o,u,i=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(i={},s=n.split("."),n=s.shift(),s.length){for(o=i[n]=e.widget.extend({},this.options[n]),u=0;u<s.length-1;u++)o[s[u]]=o[s[u]]||{},o=o[s[u]];if(n=s.pop(),r===t)return o[n]===t?null:o[n];o[n]=r}else{if(r===t)return this.options[n]===t?null:this.options[n];i[n]=r}return this._setOptions(i),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,r){var i,s=this;"boolean"!=typeof t&&(r=n,n=t,t=!1),r?(n=i=e(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),e.each(r,function(r,o){function u(){return t||s.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?s[o]:o).apply(s,arguments):void 0}"string"!=typeof o&&(u.guid=o.guid=o.guid||u.guid||e.guid++);var a=r.match(/^(\w+)\s*(.*)$/),f=a[1]+s.eventNamespace,l=a[2];l?i.delegate(l,f,u):n.bind(f,u)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];if(r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent,s)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){"string"==typeof i&&(i={effect:i});var o,u=i?i===!0||"number"==typeof i?n:i.effect||n:t;i=i||{},"number"==typeof i&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&e.effects.effect[u]?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}})}(jQuery),function(e){var n=!1;e(document).mouseup(function(){n=!1}),e.widget("ui.mouse",{version:"1.10.0",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){return!0===e.data(n.target,t.widgetName+".preventClickEvent")?(e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!n){this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var r=this,i=1===t.which,s="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return i&&!s&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return r._mouseMove(e)},this._mouseUpDelegate=function(e){return r._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),n=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e,t){function h(e,t,n){return[parseInt(e[0],10)*(l.test(e[0])?t/100:1),parseInt(e[1],10)*(l.test(e[1])?n/100:1)]}function p(t,n){return parseInt(e.css(t,n),10)||0}function d(t){var n=t[0];return 9===n.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(n)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:n.preventDefault?{width:0,height:0,offset:{top:n.pageY,left:n.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var n,r=Math.max,i=Math.abs,s=Math.round,o=/left|center|right/,u=/top|center|bottom/,a=/[\+\-]\d+%?/,f=/^\w+/,l=/%$/,c=e.fn.position;e.position={scrollbarWidth:function(){if(n!==t)return n;var r,i,s=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=s.children()[0];return e("body").append(s),r=o.offsetWidth,s.css("overflow","scroll"),i=o.offsetWidth,r===i&&(i=s[0].clientWidth),s.remove(),n=r-i},getScrollInfo:function(t){var n=t.isWindow?"":t.element.css("overflow-x"),r=t.isWindow?"":t.element.css("overflow-y"),i="scroll"===n||"auto"===n&&t.width<t.element[0].scrollWidth,s="scroll"===r||"auto"===r&&t.height<t.element[0].scrollHeight;return{width:i?e.position.scrollbarWidth():0,height:s?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),r=e.isWindow(n[0]);return{element:n,isWindow:r,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:r?n.width():n.outerWidth(),height:r?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return c.apply(this,arguments);t=e.extend({},t);var n,l,v,m,g,y,b=e(t.of),w=e.position.getWithinInfo(t.within),E=e.position.getScrollInfo(w),S=(t.collision||"flip").split(" "),x={};return y=d(b),b[0].preventDefault&&(t.at="left top"),l=y.width,v=y.height,m=y.offset,g=e.extend({},m),e.each(["my","at"],function(){var n,r,e=(t[this]||"").split(" ");1===e.length&&(e=o.test(e[0])?e.concat(["center"]):u.test(e[0])?["center"].concat(e):["center","center"]),e[0]=o.test(e[0])?e[0]:"center",e[1]=u.test(e[1])?e[1]:"center",n=a.exec(e[0]),r=a.exec(e[1]),x[this]=[n?n[0]:0,r?r[0]:0],t[this]=[f.exec(e[0])[0],f.exec(e[1])[0]]}),1===S.length&&(S[1]=S[0]),"right"===t.at[0]?g.left+=l:"center"===t.at[0]&&(g.left+=l/2),"bottom"===t.at[1]?g.top+=v:"center"===t.at[1]&&(g.top+=v/2),n=h(x.at,l,v),g.left+=n[0],g.top+=n[1],this.each(function(){var o,u,a=e(this),f=a.outerWidth(),c=a.outerHeight(),d=p(this,"marginLeft"),y=p(this,"marginTop"),T=f+d+p(this,"marginRight")+E.width,N=c+y+p(this,"marginBottom")+E.height,C=e.extend({},g),k=h(x.my,a.outerWidth(),a.outerHeight());"right"===t.my[0]?C.left-=f:"center"===t.my[0]&&(C.left-=f/2),"bottom"===t.my[1]?C.top-=c:"center"===t.my[1]&&(C.top-=c/2),C.left+=k[0],C.top+=k[1],e.support.offsetFractions||(C.left=s(C.left),C.top=s(C.top)),o={marginLeft:d,marginTop:y},e.each(["left","top"],function(r,i){e.ui.position[S[r]]&&e.ui.position[S[r]][i](C,{targetWidth:l,targetHeight:v,elemWidth:f,elemHeight:c,collisionPosition:o,collisionWidth:T,collisionHeight:N,offset:[n[0]+k[0],n[1]+k[1]],my:t.my,at:t.at,within:w,elem:a})}),t.using&&(u=function(e){var n=m.left-C.left,s=n+l-f,o=m.top-C.top,u=o+v-c,h={target:{element:b,left:m.left,top:m.top,width:l,height:v},element:{element:a,left:C.left,top:C.top,width:f,height:c},horizontal:0>s?"left":n>0?"right":"center",vertical:0>u?"top":o>0?"bottom":"middle"};f>l&&i(n+s)<l&&(h.horizontal="center"),c>v&&i(o+u)<v&&(h.vertical="middle"),h.important=r(i(n),i(s))>r(i(o),i(u))?"horizontal":"vertical",t.using.call(this,e,h)}),a.offset(e.extend(C,{using:u}))})},e.ui.position={fit:{left:function(e,t){var f,n=t.within,i=n.isWindow?n.scrollLeft:n.offset.left,s=n.width,o=e.left-t.collisionPosition.marginLeft,u=i-o,a=o+t.collisionWidth-s-i;t.collisionWidth>s?u>0&&0>=a?(f=e.left+u+t.collisionWidth-s-i,e.left+=u-f):e.left=a>0&&0>=u?i:u>a?i+s-t.collisionWidth:i:u>0?e.left+=u:a>0?e.left-=a:e.left=r(e.left-o,e.left)},top:function(e,t){var f,n=t.within,i=n.isWindow?n.scrollTop:n.offset.top,s=t.within.height,o=e.top-t.collisionPosition.marginTop,u=i-o,a=o+t.collisionHeight-s-i;t.collisionHeight>s?u>0&&0>=a?(f=e.top+u+t.collisionHeight-s-i,e.top+=u-f):e.top=a>0&&0>=u?i:u>a?i+s-t.collisionHeight:i:u>0?e.top+=u:a>0?e.top-=a:e.top=r(e.top-o,e.top)}},flip:{left:function(e,t){var p,d,n=t.within,r=n.offset.left+n.scrollLeft,s=n.width,o=n.isWindow?n.scrollLeft:n.offset.left,u=e.left-t.collisionPosition.marginLeft,a=u-o,f=u+t.collisionWidth-s-o,l="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,c="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,h=-2*t.offset[0];0>a?(p=e.left+l+c+h+t.collisionWidth-s-r,(0>p||p<i(a))&&(e.left+=l+c+h)):f>0&&(d=e.left-t.collisionPosition.marginLeft+l+c+h-o,(d>0||i(d)<f)&&(e.left+=l+c+h))},top:function(e,t){var d,v,n=t.within,r=n.offset.top+n.scrollTop,s=n.height,o=n.isWindow?n.scrollTop:n.offset.top,u=e.top-t.collisionPosition.marginTop,a=u-o,f=u+t.collisionHeight-s-o,l="top"===t.my[1],c=l?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,h="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,p=-2*t.offset[1];0>a?(v=e.top+c+h+p+t.collisionHeight-s-r,e.top+c+h+p>a&&(0>v||v<i(a))&&(e.top+=c+h+p)):f>0&&(d=e.top-t.collisionPosition.marginTop+c+h+p-o,e.top+c+h+p>f&&(d>0||i(d)<f)&&(e.top+=c+h+p))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,r,i,s,o=document.getElementsByTagName("body")[0],u=document.createElement("div");t=document.createElement(o?"div":"body"),r={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(r,{position:"absolute",left:"-1000px",top:"-1000px"});for(s in r)t.style[s]=r[s];t.appendChild(u),n=o||document.documentElement,n.insertBefore(t,n.firstChild),u.style.cssText="position: absolute; left: 10.7432222px;",i=e(u).offset().left,e.support.offsetFractions=i>10&&11>i,t.innerHTML="",n.removeChild(t)}()}(jQuery),function(e){e.widget("ui.draggable",e.ui.mouse,{version:"1.10.0",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),n.containment&&this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){if(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!n){var r=this._uiHash();if(this._trigger("drag",t,r)===!1)return this._mouseUp({}),!1;this.position=r.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n,r=this,i=!1,s=!1;for(e.ui.ddmanager&&!this.options.dropBehaviour&&(s=e.ui.ddmanager.drop(this,t)),this.dropped&&(s=this.dropped,this.dropped=!1),n=this.element[0];n&&(n=n.parentNode);)n===document&&(i=!0);return i||"original"!==this.options.helper?("invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){r._trigger("stop",t)!==!1&&r._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1):!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){var n=this.options.handle&&e(this.options.handle,this.element).length?!1:!0;return e(this.options.handle,this.element).find("*").addBack().each(function(){this===t.target&&(n=!0)}),n},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),r[0]!==this.element[0]&&!/(fixed|absolute)/.test(r.css("position"))&&r.css("position","absolute"),r},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options;if("parent"===i.containment&&(i.containment=this.helper[0].parentNode),("document"===i.containment||"window"===i.containment)&&(this.containment=["document"===i.containment?0:e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"===i.containment?0:e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"===i.containment?0:e(window).scrollLeft())+e("document"===i.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"===i.containment?0:e(window).scrollTop())+(e("document"===i.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(i.containment)||i.containment.constructor===Array)i.containment.constructor===Array&&(this.containment=i.containment);else{if(n=e(i.containment),r=n[0],!r)return;t="hidden"!==e(r).css("overflow"),this.containment=[(parseInt(e(r).css("borderLeftWidth"),10)||0)+(parseInt(e(r).css("paddingLeft"),10)||0),(parseInt(e(r).css("borderTopWidth"),10)||0)+(parseInt(e(r).css("paddingTop"),10)||0),(t?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(e(r).css("borderLeftWidth"),10)||0)-(parseInt(e(r).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(e(r).css("borderTopWidth"),10)||0)-(parseInt(e(r).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n}},_convertPositionTo:function(t,n){n||(n=this.position);var r="absolute"===t?1:-1,i="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(i[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:i.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:i.scrollLeft())*r}},_generatePosition:function(t){var n,r,i,s,o=this.options,u="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(u[0].tagName),f=t.pageX,l=t.pageY;return this.originalPosition&&(this.containment&&(this.relative_container?(r=this.relative_container.offset(),n=[this.containment[0]+r.left,this.containment[1]+r.top,this.containment[2]+r.left,this.containment[3]+r.top]):n=this.containment,t.pageX-this.offset.click.left<n[0]&&(f=n[0]+this.offset.click.left),t.pageY-this.offset.click.top<n[1]&&(l=n[1]+this.offset.click.top),t.pageX-this.offset.click.left>n[2]&&(f=n[2]+this.offset.click.left),t.pageY-this.offset.click.top>n[3]&&(l=n[3]+this.offset.click.top)),o.grid&&(i=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=n?i-this.offset.click.top>=n[1]||i-this.offset.click.top>n[3]?i:i-this.offset.click.top>=n[1]?i-o.grid[1]:i+o.grid[1]:i,s=o.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,f=n?s-this.offset.click.left>=n[0]||s-this.offset.click.left>n[2]?s:s-this.offset.click.left>=n[0]?s-o.grid[0]:s+o.grid[0]:s)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:u.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:u.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,r){return r=r||this._uiHash(),e.ui.plugin.call(this,t,[n,r]),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,r)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var r=e(this).data("ui-draggable"),i=r.options,s=e.extend({},n,{item:r.element});r.sortables=[],e(i.connectToSortable).each(function(){var n=e.data(this,"ui-sortable");n&&!n.options.disabled&&(r.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,s))})},stop:function(t,n){var r=e(this).data("ui-draggable"),i=e.extend({},n,{item:r.element});e.each(r.sortables,function(){this.instance.isOver?(this.instance.isOver=0,r.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===r.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,i))})},drag:function(t,n){var r=e(this).data("ui-draggable"),i=this;e.each(r.sortables,function(){var s=!1,o=this;this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(s=!0,e.each(r.sortables,function(){return this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this!==o&&this.instance._intersectsWith(this.instance.containerCache)&&e.ui.contains(o.instance.element[0],this.instance.element[0])&&(s=!1),s})),s?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(i).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=r.offset.click.top,this.instance.offset.click.left=r.offset.click.left,this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top,r._trigger("toSortable",t),r.dropped=this.instance.element,r.currentItem=r.element,this.instance.fromOutside=r),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),r._trigger("fromSortable",t),r.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),n=e(this).data("ui-draggable").options;t.css("cursor")&&(n._cursor=t.css("cursor")),t.css("cursor",n.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var r=e(n.helper),i=e(this).data("ui-draggable").options;
r.css("opacity")&&(i._opacity=r.css("opacity")),r.css("opacity",i.opacity)},stop:function(t,n){var r=e(this).data("ui-draggable").options;r._opacity&&e(n.helper).css("opacity",r._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");t.scrollParent[0]!==document&&"HTML"!==t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var n=e(this).data("ui-draggable"),r=n.options,i=!1;n.scrollParent[0]!==document&&"HTML"!==n.scrollParent[0].tagName?(r.axis&&"x"===r.axis||(n.overflowOffset.top+n.scrollParent[0].offsetHeight-t.pageY<r.scrollSensitivity?n.scrollParent[0].scrollTop=i=n.scrollParent[0].scrollTop+r.scrollSpeed:t.pageY-n.overflowOffset.top<r.scrollSensitivity&&(n.scrollParent[0].scrollTop=i=n.scrollParent[0].scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(n.overflowOffset.left+n.scrollParent[0].offsetWidth-t.pageX<r.scrollSensitivity?n.scrollParent[0].scrollLeft=i=n.scrollParent[0].scrollLeft+r.scrollSpeed:t.pageX-n.overflowOffset.left<r.scrollSensitivity&&(n.scrollParent[0].scrollLeft=i=n.scrollParent[0].scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(t.pageY-e(document).scrollTop()<r.scrollSensitivity?i=e(document).scrollTop(e(document).scrollTop()-r.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<r.scrollSensitivity&&(i=e(document).scrollTop(e(document).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(t.pageX-e(document).scrollLeft()<r.scrollSensitivity?i=e(document).scrollLeft(e(document).scrollLeft()-r.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<r.scrollSensitivity&&(i=e(document).scrollLeft(e(document).scrollLeft()+r.scrollSpeed)))),i!==!1&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),n=t.options;t.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var n=e(this),r=n.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:n.outerWidth(),height:n.outerHeight(),top:r.top,left:r.left})})},drag:function(t,n){var r,i,s,o,u,a,f,l,c,h,p=e(this).data("ui-draggable"),d=p.options,v=d.snapTolerance,m=n.offset.left,g=m+p.helperProportions.width,y=n.offset.top,b=y+p.helperProportions.height;for(c=p.snapElements.length-1;c>=0;c--)u=p.snapElements[c].left,a=u+p.snapElements[c].width,f=p.snapElements[c].top,l=f+p.snapElements[c].height,m>u-v&&a+v>m&&y>f-v&&l+v>y||m>u-v&&a+v>m&&b>f-v&&l+v>b||g>u-v&&a+v>g&&y>f-v&&l+v>y||g>u-v&&a+v>g&&b>f-v&&l+v>b?("inner"!==d.snapMode&&(r=Math.abs(f-b)<=v,i=Math.abs(l-y)<=v,s=Math.abs(u-g)<=v,o=Math.abs(a-m)<=v,r&&(n.position.top=p._convertPositionTo("relative",{top:f-p.helperProportions.height,left:0}).top-p.margins.top),i&&(n.position.top=p._convertPositionTo("relative",{top:l,left:0}).top-p.margins.top),s&&(n.position.left=p._convertPositionTo("relative",{top:0,left:u-p.helperProportions.width}).left-p.margins.left),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a}).left-p.margins.left)),h=r||i||s||o,"outer"!==d.snapMode&&(r=Math.abs(f-y)<=v,i=Math.abs(l-b)<=v,s=Math.abs(u-m)<=v,o=Math.abs(a-g)<=v,r&&(n.position.top=p._convertPositionTo("relative",{top:f,left:0}).top-p.margins.top),i&&(n.position.top=p._convertPositionTo("relative",{top:l-p.helperProportions.height,left:0}).top-p.margins.top),s&&(n.position.left=p._convertPositionTo("relative",{top:0,left:u}).left-p.margins.left),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[c].snapping&&(r||i||s||o||h)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[c].item})),p.snapElements[c].snapping=r||i||s||o||h):(p.snapElements[c].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[c].item})),p.snapElements[c].snapping=!1)}}),e.ui.plugin.add("draggable","stack",{start:function(){var t,n=e(this).data("ui-draggable").options,r=e.makeArray(e(n.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});r.length&&(t=parseInt(r[0].style.zIndex,10)||0,e(r).each(function(e){this.style.zIndex=t+e}),this[0].style.zIndex=t+r.length)}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var r=e(n.helper),i=e(this).data("ui-draggable").options;r.css("zIndex")&&(i._zIndex=r.css("zIndex")),r.css("zIndex",i.zIndex)},stop:function(t,n){var r=e(this).data("ui-draggable").options;r._zIndex&&e(n.helper).css("zIndex",r._zIndex)}})}(jQuery),function(e){function n(e,t,n){return e>t&&t+n>e}e.widget("ui.droppable",{version:"1.10.0",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t=this.options,n=t.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(n)?n:function(e){return e.is(n)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},e.ui.ddmanager.droppables[t.scope]=e.ui.ddmanager.droppables[t.scope]||[],e.ui.ddmanager.droppables[t.scope].push(this),t.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var t=0,n=e.ui.ddmanager.droppables[this.options.scope];t<n.length;t++)n[t]===this&&n.splice(t,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,n){"accept"===t&&(this.accept=e.isFunction(n)?n:function(e){return e.is(n)}),e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),n&&this._trigger("activate",t,this.ui(n))},_deactivate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),n&&this._trigger("deactivate",t,this.ui(n))},_over:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(n)))},_out:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(n)))},_drop:function(t,n){var r=n||e.ui.ddmanager.current,i=!1;return r&&(r.currentItem||r.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=e.data(this,"ui-droppable");return t.options.greedy&&!t.options.disabled&&t.options.scope===r.options.scope&&t.accept.call(t.element[0],r.currentItem||r.element)&&e.ui.intersect(r,e.extend(t,{offset:t.element.offset()}),t.options.tolerance)?(i=!0,!1):void 0}),i?!1:this.accept.call(this.element[0],r.currentItem||r.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(r)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(e,t,r){if(!t.offset)return!1;var i,s,o=(e.positionAbs||e.position.absolute).left,u=o+e.helperProportions.width,a=(e.positionAbs||e.position.absolute).top,f=a+e.helperProportions.height,l=t.offset.left,c=l+t.proportions.width,h=t.offset.top,p=h+t.proportions.height;switch(r){case"fit":return o>=l&&c>=u&&a>=h&&p>=f;case"intersect":return l<o+e.helperProportions.width/2&&u-e.helperProportions.width/2<c&&h<a+e.helperProportions.height/2&&f-e.helperProportions.height/2<p;case"pointer":return i=(e.positionAbs||e.position.absolute).left+(e.clickOffset||e.offset.click).left,s=(e.positionAbs||e.position.absolute).top+(e.clickOffset||e.offset.click).top,n(s,h,t.proportions.height)&&n(i,l,t.proportions.width);case"touch":return(a>=h&&p>=a||f>=h&&p>=f||h>a&&f>p)&&(o>=l&&c>=o||u>=l&&c>=u||l>o&&u>c);default:return!1}},e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,n){var r,i,s=e.ui.ddmanager.droppables[t.options.scope]||[],o=n?n.type:null,u=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(r=0;r<s.length;r++)if(!(s[r].options.disabled||t&&!s[r].accept.call(s[r].element[0],t.currentItem||t.element))){for(i=0;i<u.length;i++)if(u[i]===s[r].element[0]){s[r].proportions.height=0;continue e}s[r].visible="none"!==s[r].element.css("display"),s[r].visible&&("mousedown"===o&&s[r]._activate.call(s[r],n),s[r].offset=s[r].element.offset(),s[r].proportions={width:s[r].element[0].offsetWidth,height:s[r].element[0].offsetHeight})}},drop:function(t,n){var r=!1;return e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(r=this._drop.call(this,n)||r),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,n)))}),r},dragStart:function(t,n){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)})},drag:function(t,n){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,n),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var r,i,s,o=e.ui.intersect(t,this,this.options.tolerance),u=!o&&this.isover?"isout":o&&!this.isover?"isover":null;u&&(this.options.greedy&&(i=this.options.scope,s=this.element.parents(":data(ui-droppable)").filter(function(){return e.data(this,"ui-droppable").options.scope===i}),s.length&&(r=e.data(s[0],"ui-droppable"),r.greedyChild="isover"===u)),r&&"isover"===u&&(r.isover=!1,r.isout=!0,r._out.call(r,n)),this[u]=!0,this["isout"===u?"isover":"isout"]=!1,this["isover"===u?"_over":"_out"].call(this,n),r&&"isout"===u&&(r.isout=!1,r.isover=!0,r._over.call(r,n)))}})},dragStop:function(t,n){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)}}}(jQuery),function(e){function n(e){return parseInt(e,10)||0}function r(e){return!isNaN(parseInt(e,10))}e.widget("ui.resizable",e.ui.mouse,{version:"1.10.0",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var t,n,r,i,s,o=this,u=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!u.aspectRatio,aspectRatio:u.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:u.helper||u.ghost||u.animate?u.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=u.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},n=0;n<t.length;n++)r=e.trim(t[n]),s="ui-resizable-"+r,i=e("<div class='ui-resizable-handle "+s+"'></div>"),i.css({zIndex:u.zIndex}),"se"===r&&i.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[r]=".ui-resizable-"+r,this.element.append(i);this._renderAxis=function(t){var n,r,i,s;t=t||this.element;for(n in this.handles)this.handles[n].constructor===String&&(this.handles[n]=e(this.handles[n],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(r=e(this.handles[n],this.element),s=/sw|ne|nw|se|n|s/.test(n)?r.outerHeight():r.outerWidth(),i=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join(""),t.css(i,s),this._proportionallyResize()),e(this.handles[n]).length},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(i=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=i&&i[1]?i[1]:"se")}),u.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){u.disabled||(e(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){u.disabled||o.resizing||(e(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,n=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(n(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),n(this.originalElement),this},_mouseCapture:function(t){var n,r,i=!1;for(n in this.handles)r=e(this.handles[n])[0],(r===t.target||e.contains(r,t.target))&&(i=!0);return!this.options.disabled&&i},_mouseStart:function(t){var r,i,s,o=this.options,u=this.element.position(),a=this.element;return this.resizing=!0,/absolute/.test(a.css("position"))?a.css({position:"absolute",top:a.css("top"),left:a.css("left")}):a.is(".ui-draggable")&&a.css({position:"absolute",top:u.top,left:u.left}),this._renderProxy(),r=n(this.helper.css("left")),i=n(this.helper.css("top")),o.containment&&(r+=e(o.containment).scrollLeft()||0,i+=e(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:r,top:i},this.size=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.originalSize=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.originalPosition={left:r,top:i},this.sizeDiff={width:a.outerWidth()-a.width(),height:a.outerHeight()-a.height()},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,s=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===s?this.axis+"-resize":s),a.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var n,r=this.helper,i={},s=this.originalMousePosition,o=this.axis,u=this.position.top,a=this.position.left,f=this.size.width,l=this.size.height,c=t.pageX-s.left||0,h=t.pageY-s.top||0,p=this._change[o];return p?(n=p.apply(this,[t,c,h]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(n=this._updateRatio(n,t)),n=this._respectSize(n,t),this._updateCache(n),this._propagate("resize",t),this.position.top!==u&&(i.top=this.position.top+"px"),this.position.left!==a&&(i.left=this.position.left+"px"),this.size.width!==f&&(i.width=this.size.width+"px"),this.size.height!==l&&(i.height=this.size.height+"px"),r.css(i),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(i)||this._trigger("resize",t,this.ui()),!1):!1},_mouseStop:function(t){this.resizing=!1;var n,r,i,s,o,u,a,f=this.options,l=this;return this._helper&&(n=this._proportionallyResizeElements,r=n.length&&/textarea/i.test(n[0].nodeName),i=r&&e.ui.hasScroll(n[0],"left")?0:l.sizeDiff.height,s=r?0:l.sizeDiff.width,o={width:l.helper.width()-s,height:l.helper.height()-i},u=parseInt(l.element.css("left"),10)+(l.position.left-l.originalPosition.left)||null,a=parseInt(l.element.css("top"),10)+(l.position.top-l.originalPosition.top)||null,f.animate||this.element.css(e.extend(o,{top:a,left:u})),l.helper.height(l.size.height),l.helper.width(l.size.width),this._helper&&!f.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,n,i,s,o,u=this.options;o={minWidth:r(u.minWidth)?u.minWidth:0,maxWidth:r(u.maxWidth)?u.maxWidth:1/0,minHeight:r(u.minHeight)?u.minHeight:0,maxHeight:r(u.maxHeight)?u.maxHeight:1/0},(this._aspectRatio||e)&&(t=o.minHeight*this.aspectRatio,i=o.minWidth/this.aspectRatio,n=o.maxHeight*this.aspectRatio,s=o.maxWidth/this.aspectRatio,t>o.minWidth&&(o.minWidth=t),i>o.minHeight&&(o.minHeight=i),n<o.maxWidth&&(o.maxWidth=n),s<o.maxHeight&&(o.maxHeight=s)),this._vBoundaries=o},_updateCache:function(e){this.offset=this.helper.offset(),r(e.left)&&(this.position.left=e.left),r(e.top)&&(this.position.top=e.top),r(e.height)&&(this.size.height=e.height),r(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,n=this.size,i=this.axis;return r(e.height)?e.width=e.height*this.aspectRatio:r(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===i&&(e.left=t.left+(n.width-e.width),e.top=null),"nw"===i&&(e.top=t.top+(n.height-e.height),e.left=t.left+(n.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,n=this.axis,i=r(e.width)&&t.maxWidth&&t.maxWidth<e.width,s=r(e.height)&&t.maxHeight&&t.maxHeight<e.height,o=r(e.width)&&t.minWidth&&t.minWidth>e.width,u=r(e.height)&&t.minHeight&&t.minHeight>e.height,a=this.originalPosition.left+this.originalSize.width,f=this.position.top+this.size.height,l=/sw|nw|w/.test(n),c=/nw|ne|n/.test(n);return o&&(e.width=t.minWidth),u&&(e.height=t.minHeight),i&&(e.width=t.maxWidth),s&&(e.height=t.maxHeight),o&&l&&(e.left=a-t.minWidth),i&&l&&(e.left=a-t.maxWidth),u&&c&&(e.top=f-t.minHeight),s&&c&&(e.top=f-t.maxHeight),e.width||e.height||e.left||!e.top?!e.width&&!e.height&&!e.top&&e.left&&(e.left=null):e.top=null,e},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var e,t,n,r,i,s=this.helper||this.element;for(e=0;e<this._proportionallyResizeElements.length;e++){if(i=this._proportionallyResizeElements[e],!this.borderDif)for(this.borderDif=[],n=[i.css("borderTopWidth"),i.css("borderRightWidth"),i.css("borderBottomWidth"),i.css("borderLeftWidth")],r=[i.css("paddingTop"),i.css("paddingRight"),i.css("paddingBottom"),i.css("paddingLeft")],t=0;t<n.length;t++)this.borderDif[t]=(parseInt(n[t],10)||0)+(parseInt(r[t],10)||0);i.css({height:s.height()-this.borderDif[0]-this.borderDif[2]||0,width:s.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var t=this.element,n=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var n=this.originalSize,r=this.originalPosition;return{left:r.left+t,width:n.width-t}},n:function(e,t,n){var r=this.originalSize,i=this.originalPosition;return{top:i.top+n,height:r.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},sw:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,r]))},ne:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},nw:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,r]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),"resize"!==t&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var n=e(this).data("ui-resizable"),r=n.options,i=n._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),o=s&&e.ui.hasScroll(i[0],"left")?0:n.sizeDiff.height,u=s?0:n.sizeDiff.width,a={width:n.size.width-u,height:n.size.height-o},f=parseInt(n.element.css("left"),10)+(n.position.left-n.originalPosition.left)||null,l=parseInt(n.element.css("top"),10)+(n.position.top-n.originalPosition.top)||null;n.element.animate(e.extend(a,l&&f?{top:l,left:f}:{}),{duration:r.animateDuration,easing:r.animateEasing,step:function(){var r={width:parseInt(n.element.css("width"),10),height:parseInt(n.element.css("height"),10),top:parseInt(n.element.css("top"),10),left:parseInt(n.element.css("left"),10)};i&&i.length&&e(i[0]).css({width:r.width,height:r.height}),n._updateCache(r),n._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,r,i,s,o,u,a,f=e(this).data("ui-resizable"),l=f.options,c=f.element,h=l.containment,p=h instanceof e?h.get(0):/parent/.test(h)?c.parent().get(0):h;p&&(f.containerElement=e(p),/document/.test(h)||h===document?(f.containerOffset={left:0,top:0},f.containerPosition={left:0,top:0},f.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(p),r=[],e(["Top","Right","Left","Bottom"]).each(function(e,i){r[e]=n(t.css("padding"+i))}),f.containerOffset=t.offset(),f.containerPosition=t.position(),f.containerSize={height:t.innerHeight()-r[3],width:t.innerWidth()-r[1]},i=f.containerOffset,s=f.containerSize.height,o=f.containerSize.width,u=e.ui.hasScroll(p,"left")?p.scrollWidth:o,a=e.ui.hasScroll(p)?p.scrollHeight:s,f.parentData={element:p,left:i.left,top:i.top,width:u,height:a}))},resize:function(t){var n,r,i,s,o=e(this).data("ui-resizable"),u=o.options,a=o.containerOffset,f=o.position,l=o._aspectRatio||t.shiftKey,c={top:0,left:0},h=o.containerElement;h[0]!==document&&/static/.test(h.css("position"))&&(c=a),f.left<(o._helper?a.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-a.left:o.position.left-c.left),l&&(o.size.height=o.size.width/o.aspectRatio),o.position.left=u.helper?a.left:0),f.top<(o._helper?a.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-a.top:o.position.top),l&&(o.size.width=o.size.height*o.aspectRatio),o.position.top=o._helper?a.top:0),o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top,n=Math.abs((o._helper?o.offset.left-c.left:o.offset.left-c.left)+o.sizeDiff.width),r=Math.abs((o._helper?o.offset.top-c.top:o.offset.top-a.top)+o.sizeDiff.height),i=o.containerElement.get(0)===o.element.parent().get(0),s=/relative|absolute/.test(o.containerElement.css("position")),i&&s&&(n-=o.parentData.left),n+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-n,l&&(o.size.height=o.size.width/o.aspectRatio)),r+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-r,l&&(o.size.width=o.size.height*o.aspectRatio))},stop:function(){var t=e(this).data("ui-resizable"),n=t.options,r=t.containerOffset,i=t.containerPosition,s=t.containerElement,o=e(t.helper),u=o.offset(),a=o.outerWidth()-t.sizeDiff.width,f=o.outerHeight()-t.sizeDiff.height;t._helper&&!n.animate&&/relative/.test(s.css("position"))&&e(this).css({left:u.left-i.left-r.left,width:a,height:f}),t._helper&&!n.animate&&/static/.test(s.css("position"))&&e(this).css({left:u.left-i.left-r.left,width:a,height:f})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).data("ui-resizable"),n=t.options,r=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof n.alsoResize||n.alsoResize.parentNode?r(n.alsoResize):n.alsoResize.length?(n.alsoResize=n.alsoResize[0],r(n.alsoResize)):e.each(n.alsoResize,function(e){r(e)})},resize:function(t,n){var r=e(this).data("ui-resizable"),i=r.options,s=r.originalSize,o=r.originalPosition,u={height:r.size.height-s.height||0,width:r.size.width-s.width||0,top:r.position.top-o.top||0,left:r.position.left-o.left||0},a=function(t,r){e(t).each(function(){var t=e(this),i=e(this).data("ui-resizable-alsoresize"),s={},o=r&&r.length?r:t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var n=(i[t]||0)+(u[t]||0);n&&n>=0&&(s[t]=n||null)}),t.css(s)})};"object"!=typeof i.alsoResize||i.alsoResize.nodeType?a(i.alsoResize):e.each(i.alsoResize,function(e,t){a(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).data("ui-resizable"),n=t.options,r=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:r.height,width:r.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof n.ghost?n.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).data("ui-resizable");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).data("ui-resizable");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t=e(this).data("ui-resizable"),n=t.options,r=t.size,i=t.originalSize,s=t.originalPosition,o=t.axis,u="number"==typeof n.grid?[n.grid,n.grid]:n.grid,a=u[0]||1,f=u[1]||1,l=Math.round((r.width-i.width)/a)*a,c=Math.round((r.height-i.height)/f)*f,h=i.width+l,p=i.height+c,d=n.maxWidth&&n.maxWidth<h,v=n.maxHeight&&n.maxHeight<p,m=n.minWidth&&n.minWidth>h,g=n.minHeight&&n.minHeight>p;n.grid=u,m&&(h+=a),g&&(p+=f),d&&(h-=a),v&&(p-=f),/^(se|s|e)$/.test(o)?(t.size.width=h,t.size.height=p):/^(ne)$/.test(o)?(t.size.width=h,t.size.height=p,t.position.top=s.top-c):/^(sw)$/.test(o)?(t.size.width=h,t.size.height=p,t.position.left=s.left-l):(t.size.width=h,t.size.height=p,t.position.top=s.top-c,t.position.left=s.left-l)}})}(jQuery),function(e){e.widget("ui.selectable",e.ui.mouse,{version:"1.10.0",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,n=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(n.options.filter,n.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),n=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:n.left,top:n.top,right:n.left+t.outerWidth(),bottom:n.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var n=this,r=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=e(r.filter,this.element[0]),this._trigger("start",t),e(r.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),r.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var r=e.data(this,"selectable-item");r.startselected=!0,!t.metaKey&&!t.ctrlKey&&(r.$element.removeClass("ui-selected"),r.selected=!1,r.$element.addClass("ui-unselecting"),r.unselecting=!0,n._trigger("unselecting",t,{unselecting:r.element}))}),e(t.target).parents().addBack().each(function(){var r,i=e.data(this,"selectable-item");return i?(r=!t.metaKey&&!t.ctrlKey||!i.$element.hasClass("ui-selected"),i.$element.removeClass(r?"ui-unselecting":"ui-selected").addClass(r?"ui-selecting":"ui-unselecting"),i.unselecting=!r,i.selecting=r,i.selected=r,r?n._trigger("selecting",t,{selecting:i.element}):n._trigger("unselecting",t,{unselecting:i.element}),!1):void 0}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var n,r=this,i=this.options,s=this.opos[0],o=this.opos[1],u=t.pageX,a=t.pageY;return s>u&&(n=u,u=s,s=n),o>a&&(n=a,a=o,o=n),this.helper.css({left:s,top:o,width:u-s,height:a-o}),this.selectees.each(function(){var n=e.data(this,"selectable-item"),f=!1;n&&n.element!==r.element[0]&&("touch"===i.tolerance?f=!(n.left>u||n.right<s||n.top>a||n.bottom<o):"fit"===i.tolerance&&(f=n.left>s&&n.right<u&&n.top>o&&n.bottom<a),f?(n.selected&&(n.$element.removeClass("ui-selected"),n.selected=!1),n.unselecting&&(n.$element.removeClass("ui-unselecting"),n.unselecting=!1),n.selecting||(n.$element.addClass("ui-selecting"),n.selecting=!0,r._trigger("selecting",t,{selecting:n.element}))):(n.selecting&&((t.metaKey||t.ctrlKey)&&n.startselected?(n.$element.removeClass("ui-selecting"),n.selecting=!1,n.$element.addClass("ui-selected"),n.selected=!0):(n.$element.removeClass("ui-selecting"),n.selecting=!1,n.startselected&&(n.$element.addClass("ui-unselecting"),n.unselecting=!0),r._trigger("unselecting",t,{unselecting:n.element}))),n.selected&&!t.metaKey&&!t.ctrlKey&&!n.startselected&&(n.$element.removeClass("ui-selected"),n.selected=!1,n.$element.addClass("ui-unselecting"),n.unselecting=!0,r._trigger("unselecting",t,{unselecting:n.element}))))}),!1}},_mouseStop:function(t){var n=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-unselecting"),r.unselecting=!1,r.startselected=!1,n._trigger("unselected",t,{unselected:r.element})}),e(".ui-selecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-selecting").addClass("ui-selected"),r.selecting=!1,r.selected=!0,r.startselected=!0,n._trigger("selected",t,{selected:r.element})}),this._trigger("stop",t),this.helper.remove(),!1}})}(jQuery),function(e){function n(e,t,n){return e>t&&t+n>e}e.widget("ui.sortable",e.ui.mouse,{version:"1.10.0",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var e=this.options;
this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,n){"disabled"===t?(this.options[t]=n,this.widget().toggleClass("ui-sortable-disabled",!!n)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,n){var r=null,i=!1,s=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,s.widgetName+"-item")===s?(r=e(this),!1):void 0}),e.data(t.target,s.widgetName+"-item")===s&&(r=e(t.target)),r&&(!this.options.handle||n||(e(this.options.handle,r).find("*").addBack().each(function(){this===t.target&&(i=!0)}),i))?(this.currentItem=r,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(t,n,r){var i,s=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,s.cursorAt&&this._adjustOffsetFromHelper(s.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),s.containment&&this._setContainment(),s.cursor&&(e("body").css("cursor")&&(this._storedCursor=e("body").css("cursor")),e("body").css("cursor",s.cursor)),s.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",s.opacity)),s.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",s.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!r)for(i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!s.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var n,r,i,s,o=this.options,u=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=u=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=u=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=u=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=u=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-e(document).scrollTop()<o.scrollSensitivity?u=e(document).scrollTop(e(document).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<o.scrollSensitivity&&(u=e(document).scrollTop(e(document).scrollTop()+o.scrollSpeed)),t.pageX-e(document).scrollLeft()<o.scrollSensitivity?u=e(document).scrollLeft(e(document).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<o.scrollSensitivity&&(u=e(document).scrollLeft(e(document).scrollLeft()+o.scrollSpeed))),u!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),n=this.items.length-1;n>=0;n--)if(r=this.items[n],i=r.item[0],s=this._intersectsWithPointer(r),s&&r.instance===this.currentContainer&&i!==this.currentItem[0]&&this.placeholder[1===s?"next":"prev"]()[0]!==i&&!e.contains(this.placeholder[0],i)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],i):!0)){if(this.direction=1===s?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(r))break;this._rearrange(t,r),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var r=this,i=this.placeholder.offset();this.reverting=!0,e(this.helper).animate({left:i.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft),top:i.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){r._clear(t)})}else this._clear(t,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);n&&r.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!r.length&&t.key&&r.push(t.key+"="),r.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},n.each(function(){r.push(e(t.item||this).attr(t.attribute||"id")||"")}),r},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,r=this.positionAbs.top,i=r+this.helperProportions.height,s=e.left,o=s+e.width,u=e.top,a=u+e.height,f=this.offset.click.top,l=this.offset.click.left,c=r+f>u&&a>r+f&&t+l>s&&o>t+l;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?c:s<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<o&&u<r+this.helperProportions.height/2&&i-this.helperProportions.height/2<a},_intersectsWithPointer:function(e){var t="x"===this.options.axis||n(this.positionAbs.top+this.offset.click.top,e.top,e.height),r="y"===this.options.axis||n(this.positionAbs.left+this.offset.click.left,e.left,e.width),i=t&&r,s=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return i?this.floating?o&&"right"===o||"down"===s?2:1:s&&("down"===s?2:1):!1},_intersectsWithSides:function(e){var t=n(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),r=n(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),i=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return this.floating&&s?"right"===s&&r||"left"===s&&!r:i&&("down"===i&&t||"up"===i&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var n,r,i,s,o=[],u=[],a=this._connectWith();if(a&&t)for(n=a.length-1;n>=0;n--)for(i=e(a[n]),r=i.length-1;r>=0;r--)s=e.data(i[r],this.widgetFullName),s&&s!==this&&!s.options.disabled&&u.push([e.isFunction(s.options.items)?s.options.items.call(s.element):e(s.options.items,s.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),s]);for(u.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=u.length-1;n>=0;n--)u[n][0].each(function(){o.push(this)});return e(o)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var n=0;n<t.length;n++)if(t[n]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var n,r,i,s,o,u,a,f,l=this.items,c=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],h=this._connectWith();if(h&&this.ready)for(n=h.length-1;n>=0;n--)for(i=e(h[n]),r=i.length-1;r>=0;r--)s=e.data(i[r],this.widgetFullName),s&&s!==this&&!s.options.disabled&&(c.push([e.isFunction(s.options.items)?s.options.items.call(s.element[0],t,{item:this.currentItem}):e(s.options.items,s.element),s]),this.containers.push(s));for(n=c.length-1;n>=0;n--)for(o=c[n][1],u=c[n][0],r=0,f=u.length;f>r;r++)a=e(u[r]),a.data(this.widgetName+"-item",o),l.push({item:a,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var n,r,i,s;for(n=this.items.length-1;n>=0;n--)r=this.items[n],r.instance!==this.currentContainer&&this.currentContainer&&r.item[0]!==this.currentItem[0]||(i=this.options.toleranceElement?e(this.options.toleranceElement,r.item):r.item,t||(r.width=i.outerWidth(),r.height=i.outerHeight()),s=i.offset(),r.left=s.left,r.top=s.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;n>=0;n--)s=this.containers[n].element.offset(),this.containers[n].containerCache.left=s.left,this.containers[n].containerCache.top=s.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var n,r=t.options;r.placeholder&&r.placeholder.constructor!==String||(n=r.placeholder,r.placeholder={element:function(){var r=e(document.createElement(t.currentItem[0].nodeName)).addClass(n||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return n||(r.style.visibility="hidden"),r},update:function(e,i){(!n||r.forcePlaceholderSize)&&(i.height()||i.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),i.width()||i.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(r.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),r.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var n,r,i,s,o,u,a,f,l,c=null,h=null;for(n=this.containers.length-1;n>=0;n--)if(!e.contains(this.currentItem[0],this.containers[n].element[0]))if(this._intersectsWith(this.containers[n].containerCache)){if(c&&e.contains(this.containers[n].element[0],c.element[0]))continue;c=this.containers[n],h=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",t,this._uiHash(this)),this.containers[n].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[h]._trigger("over",t,this._uiHash(this)),this.containers[h].containerCache.over=1;else{for(i=1e4,s=null,o=this.containers[h].floating?"left":"top",u=this.containers[h].floating?"width":"height",a=this.positionAbs[o]+this.offset.click[o],r=this.items.length-1;r>=0;r--)e.contains(this.containers[h].element[0],this.items[r].item[0])&&this.items[r].item[0]!==this.currentItem[0]&&(f=this.items[r].item.offset()[o],l=!1,Math.abs(f-a)>Math.abs(f+this.items[r][u]-a)&&(l=!0,f+=this.items[r][u]),Math.abs(f-a)<i&&(i=Math.abs(f-a),s=this.items[r],this.direction=l?"up":"down"));if(!s&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[h],s?this._rearrange(t,s,null,!0):this._rearrange(t,null,this.containers[h].element,!0),this._trigger("change",t,this._uiHash()),this.containers[h]._trigger("change",t,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[h]._trigger("over",t,this._uiHash(this)),this.containers[h].containerCache.over=1}},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):"clone"===n.helper?this.currentItem.clone():this.currentItem;return r.parents("body").length||e("parent"!==n.appendTo?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(r[0]),r[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!r[0].style.width||n.forceHelperSize)&&r.width(this.currentItem.width()),(!r[0].style.height||n.forceHelperSize)&&r.height(this.currentItem.height()),r},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options;"parent"===i.containment&&(i.containment=this.helper[0].parentNode),("document"===i.containment||"window"===i.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"===i.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"===i.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(i.containment)||(t=e(i.containment)[0],n=e(i.containment).offset(),r="hidden"!==e(t).css("overflow"),this.containment=[n.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,n.left+(r?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(r?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,n){n||(n=this.position);var r="absolute"===t?1:-1,i="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(i[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:i.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:i.scrollLeft())*r}},_generatePosition:function(t){var n,r,i=this.options,s=t.pageX,o=t.pageY,u="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(u[0].tagName);return"relative"===this.cssPosition&&(this.scrollParent[0]===document||this.scrollParent[0]===this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),i.grid&&(n=this.originalPageY+Math.round((o-this.originalPageY)/i.grid[1])*i.grid[1],o=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-i.grid[1]:n+i.grid[1]:n,r=this.originalPageX+Math.round((s-this.originalPageX)/i.grid[0])*i.grid[0],s=this.containment?r-this.offset.click.left>=this.containment[0]&&r-this.offset.click.left<=this.containment[2]?r:r-this.offset.click.left>=this.containment[0]?r-i.grid[0]:r+i.grid[0]:r)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:u.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:u.scrollLeft())}},_rearrange:function(e,t,n,r){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var i=this.counter;this._delay(function(){i===this.counter&&this.refreshPositions(!r)})},_clear:function(t,n){this.reverting=!1;var r,i=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(r in this._storedCSS)("auto"===this._storedCSS[r]||"static"===this._storedCSS[r])&&(this._storedCSS[r]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!n&&i.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!n&&i.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(n||(i.push(function(e){this._trigger("remove",e,this._uiHash())}),i.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),i.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),r=this.containers.length-1;r>=0;r--)n||i.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[r])),this.containers[r].containerCache.over&&(i.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[r])),this.containers[r].containerCache.over=0);if(this._storedCursor&&e("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!n){for(this._trigger("beforeStop",t,this._uiHash()),r=0;r<i.length;r++)i[r].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!1}if(n||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!n){for(r=0;r<i.length;r++)i[r].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})}(jQuery),function(e){var n=0,r={},i={};r.height=r.paddingTop=r.paddingBottom=r.borderTopWidth=r.borderBottomWidth="hide",i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="show",e.widget("ui.accordion",{version:"1.10.0",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),!t.collapsible&&(t.active===!1||null==t.active)&&(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,content:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?void this._activate(t):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"===e&&!t&&this.options.active===!1&&this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),"disabled"===e&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t),void 0)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var n=e.ui.keyCode,r=this.headers.length,i=this.headers.index(t.target),s=!1;switch(t.keyCode){case n.RIGHT:case n.DOWN:s=this.headers[(i+1)%r];break;case n.LEFT:case n.UP:s=this.headers[(i-1+r)%r];break;case n.SPACE:case n.ENTER:this._eventHandler(t);break;case n.HOME:s=this.headers[0];break;case n.END:s=this.headers[r-1]}s&&(e(t.target).attr("tabIndex",-1),e(s).attr("tabIndex",0),s.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),(t.active===!1&&t.collapsible===!0||!this.headers.length)&&(t.active=!1,this.active=e()),t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var t,r=this.options,i=r.heightStyle,s=this.element.parent(),o=this.accordionId="ui-accordion-"+(this.element.attr("id")||++n);this.active=this._findActive(r.active).addClass("ui-accordion-header-active ui-state-active").toggleClass("ui-corner-all ui-corner-top"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(t){var n=e(this),r=n.attr("id"),i=n.next(),s=i.attr("id");r||(r=o+"-header-"+t,n.attr("id",r)),s||(s=o+"-panel-"+t,i.attr("id",s)),n.attr("aria-controls",s),i.attr("aria-labelledby",r)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(r.event),"fill"===i?(t=s.height(),this.element.siblings(":visible").each(function(){var n=e(this),r=n.css("position");"absolute"!==r&&"fixed"!==r&&(t-=n.outerHeight(!0))}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===i&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var n=this._findActive(t)[0];n!==this.active[0]&&(n=n||this.active[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var n={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,n),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var n=this.options,r=this.active,i=e(t.currentTarget),s=i[0]===r[0],o=s&&n.collapsible,u=o?e():i.next(),a=r.next(),f={oldHeader:r,oldPanel:a,newHeader:o?e():i,newPanel:u};t.preventDefault(),s&&!n.collapsible||this._trigger("beforeActivate",t,f)===!1||(n.active=o?!1:this.headers.index(i),this.active=s?e():i,this._toggle(f),r.removeClass("ui-accordion-header-active ui-state-active"),n.icons&&r.children(".ui-accordion-header-icon").removeClass(n.icons.activeHeader).addClass(n.icons.header),s||(i.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),n.icons&&i.children(".ui-accordion-header-icon").removeClass(n.icons.header).addClass(n.icons.activeHeader),i.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var n=t.newPanel,r=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=n,this.prevHide=r,this.options.animate?this._animate(n,r,t):(r.hide(),n.show(),this._toggleComplete(t)),r.attr({"aria-expanded":"false","aria-hidden":"true"}),r.prev().attr("aria-selected","false"),n.length&&r.length?r.prev().attr("tabIndex",-1):n.length&&this.headers.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),n.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(e,t,n){var s,o,u,a=this,f=0,l=e.length&&(!t.length||e.index()<t.index()),c=this.options.animate||{},h=l&&c.down||c,p=function(){a._toggleComplete(n)};return"number"==typeof h&&(u=h),"string"==typeof h&&(o=h),o=o||h.easing||c.easing,u=u||h.duration||c.duration,t.length?e.length?(s=e.show().outerHeight(),t.animate(r,{duration:u,easing:o,step:function(e,t){t.now=Math.round(e)}}),e.hide().animate(i,{duration:u,easing:o,complete:p,step:function(e,n){n.now=Math.round(e),"height"!==n.prop?f+=n.now:"content"!==a.options.heightStyle&&(n.now=Math.round(s-t.outerHeight()-f),f=0)}}),void 0):t.animate(r,u,o,p):e.animate(i,u,o,p)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}})}(jQuery),function(e){var n=0;e.widget("ui.autocomplete",{version:"1.10.0",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var t,n,r;this.isMultiLine=this._isMultiLine(),this.valueMethod=this.element[this.element.is("input,textarea")?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(i){if(this.element.prop("readOnly"))return t=!0,r=!0,n=!0,void 0;t=!1,r=!1,n=!1;var s=e.ui.keyCode;switch(i.keyCode){case s.PAGE_UP:t=!0,this._move("previousPage",i);break;case s.PAGE_DOWN:t=!0,this._move("nextPage",i);break;case s.UP:t=!0,this._keyEvent("previous",i);break;case s.DOWN:t=!0,this._keyEvent("next",i);break;case s.ENTER:case s.NUMPAD_ENTER:this.menu.active&&(t=!0,i.preventDefault(),this.menu.select(i));break;case s.TAB:this.menu.active&&this.menu.select(i);break;case s.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(i),i.preventDefault());
break;default:n=!0,this._searchTimeout(i)}},keypress:function(r){if(t)return t=!1,void r.preventDefault();if(!n){var i=e.ui.keyCode;switch(r.keyCode){case i.PAGE_UP:this._move("previousPage",r);break;case i.PAGE_DOWN:this._move("nextPage",r);break;case i.UP:this._keyEvent("previous",r);break;case i.DOWN:this._keyEvent("next",r)}}},input:function(e){return r?(r=!1,void e.preventDefault()):void this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),this._change(e),void 0)}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete").appendTo(this._appendTo()).menu({input:e(),role:null}).zIndex(this.element.zIndex()+1).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var n=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(r){r.target!==t.element[0]&&r.target!==n&&!e.contains(n,r.target)&&t.close()})})},menufocus:function(t,n){if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)});var r=n.item.data("ui-autocomplete-item");!1!==this._trigger("focus",t,{item:r})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(r.value):this.liveRegion.text(r.value)},menuselect:function(e,t){var n=t.item.data("ui-autocomplete-item"),r=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=r,this._delay(function(){this.previous=r,this.selectedItem=n})),!1!==this._trigger("select",e,{item:n})&&this._value(n.value),this.term=this._value(),this.close(e),this.selectedItem=n}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_isMultiLine:function(){return this.element.is("textarea")?!0:this.element.is("input")?!1:this.element.prop("isContentEditable")},_initSource:function(){var t,n,r=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(n,r){r(e.ui.autocomplete.filter(t,n.term))}):"string"==typeof this.options.source?(n=this.options.source,this.source=function(t,i){r.xhr&&r.xhr.abort(),r.xhr=e.ajax({url:n,data:t,dataType:"json",success:function(e){i(e)},error:function(){i([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var e=this,t=++n;return function(r){t===n&&e.__response(r),e.pending--,e.pending||e.element.removeClass("ui-autocomplete-loading")}},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var n=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(n,t),this.menu.refresh(),n.show(),this._resizeMenu(),n.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,n){var r=this;e.each(n,function(e,n){r._renderItemData(t,n)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,n){return e("<li>").append(e("<a>").text(n.label)).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this._value(this.term),void this.menu.blur()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,n){var r=new RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(e){return r.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.text(t))}})}(jQuery),function(e){var n,r,i,s,o="ui-button ui-widget ui-state-default ui-corner-all",u="ui-state-hover ui-state-active ",a="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",f=function(){var t=e(this).find(":ui-button");setTimeout(function(){t.button("refresh")},1)},l=function(t){var n=t.name,r=t.form,i=e([]);return n&&(n=n.replace(/'/g,"\\'"),i=r?e(r).find("[name='"+n+"']"):e("[name='"+n+"']",t.ownerDocument).filter(function(){return!this.form})),i};e.widget("ui.button",{version:"1.10.0",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,f),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,u=this.options,a="checkbox"===this.type||"radio"===this.type,c=a?"":"ui-state-active",h="ui-state-focus";null===u.label&&(u.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(o).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){u.disabled||this===n&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){u.disabled||e(this).removeClass(c)}).bind("click"+this.eventNamespace,function(e){u.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){t.buttonElement.addClass(h)}).bind("blur"+this.eventNamespace,function(){t.buttonElement.removeClass(h)}),a&&(this.element.bind("change"+this.eventNamespace,function(){s||t.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(e){u.disabled||(s=!1,r=e.pageX,i=e.pageY)}).bind("mouseup"+this.eventNamespace,function(e){u.disabled||(r!==e.pageX||i!==e.pageY)&&(s=!0)})),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return u.disabled||s?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(u.disabled||s)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var n=t.element[0];l(n).not(n).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return u.disabled?!1:(e(this).addClass("ui-state-active"),n=this,t.document.one("mouseup",function(){n=null}),void 0)}).bind("mouseup"+this.eventNamespace,function(){return u.disabled?!1:void e(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(t){return u.disabled?!1:void((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",u.disabled),this._resetButton()},_determineButtonType:function(){var e,t,n;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),n=this.element.is(":checked"),n&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",n)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(o+" "+u+" "+a).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?void(t?this.element.prop("disabled",!0):this.element.prop("disabled",!1)):void this._resetButton()},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?l(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var t=this.buttonElement.removeClass(a),n=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),r=this.options.icons,i=r.primary&&r.secondary,s=[];r.primary||r.secondary?(this.options.text&&s.push("ui-button-text-icon"+(i?"s":r.primary?"-primary":"-secondary")),r.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+r.primary+"'></span>"),r.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+r.secondary+"'></span>"),this.options.text||(s.push(i?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(n)))):s.push("ui-button-text-only"),t.addClass(s.join(" "))}}),e.widget("ui.buttonset",{version:"1.10.0",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function(e,t){function s(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.dpDiv=o(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function o(t){var n="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(n,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(n,"mouseover",function(){e.datepicker._isDisabledDatepicker(i.inline?t.parent()[0]:i.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))})}function u(t,n){e.extend(t,n);for(var r in n)null==n[r]&&(t[r]=n[r]);return t}e.extend(e.ui,{datepicker:{version:"1.10.0"}});var i,n="datepicker",r=(new Date).getTime();e.extend(s.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return u(this._defaults,e||{}),this},_attachDatepicker:function(t,n){var r,i,s;r=t.nodeName.toLowerCase(),i="div"===r||"span"===r,t.id||(this.uuid+=1,t.id="dp"+this.uuid),s=this._newInst(e(t),i),s.settings=e.extend({},n||{}),"input"===r?this._connectDatepicker(t,s):i&&this._inlineDatepicker(t,s)},_newInst:function(t,n){var r=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:r,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:n,dpDiv:n?o(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,r){var i=e(t);r.append=e([]),r.trigger=e([]),i.hasClass(this.markerClassName)||(this._attachments(i,r),i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(r),e.data(t,n,r),r.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,n){var r,i,s,o=this._get(n,"appendText"),u=this._get(n,"isRTL");n.append&&n.append.remove(),o&&(n.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[u?"before":"after"](n.append)),t.unbind("focus",this._showDatepicker),n.trigger&&n.trigger.remove(),r=this._get(n,"showOn"),("focus"===r||"both"===r)&&t.focus(this._showDatepicker),("button"===r||"both"===r)&&(i=this._get(n,"buttonText"),s=this._get(n,"buttonImage"),n.trigger=e(this._get(n,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:s,alt:i,title:i}):e("<button type='button'></button>").addClass(this._triggerClass).html(s?e("<img/>").attr({src:s,alt:i,title:i}):i)),t[u?"before":"after"](n.trigger),n.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,n,r,i,s=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){for(n=0,r=0,i=0;i<e.length;i++)e[i].length>n&&(n=e[i].length,r=i);return r},s.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),s.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())),e.input.attr("size",this._formatDate(e,s).length)}},_inlineDatepicker:function(t,r){var i=e(t);i.hasClass(this.markerClassName)||(i.addClass(this.markerClassName).append(r.dpDiv),e.data(t,n,r),this._setDate(r,this._getDefaultDate(r),!0),this._updateDatepicker(r),this._updateAlternate(r),r.settings.disabled&&this._disableDatepicker(t),r.dpDiv.css("display","block"))},_dialogDatepicker:function(t,r,i,s,o){var a,f,l,c,h,p=this._dialogInst;return p||(this.uuid+=1,a="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+a+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),p=this._dialogInst=this._newInst(this._dialogInput,!1),p.settings={},e.data(this._dialogInput[0],n,p)),u(p.settings,s||{}),r=r&&r.constructor===Date?this._formatDate(p,r):r,this._dialogInput.val(r),this._pos=o?o.length?o:[o.pageX,o.pageY]:null,this._pos||(f=document.documentElement.clientWidth,l=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,h=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[f/2-100+c,l/2-150+h]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),p.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],n,p),this},_destroyDatepicker:function(t){var r,i=e(t),s=e.data(t,n);i.hasClass(this.markerClassName)&&(r=t.nodeName.toLowerCase(),e.removeData(t,n),"input"===r?(s.append.remove(),s.trigger.remove(),i.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===r||"span"===r)&&i.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var r,i,s=e(t),o=e.data(t,n);s.hasClass(this.markerClassName)&&(r=t.nodeName.toLowerCase(),"input"===r?(t.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===r||"span"===r)&&(i=s.children("."+this._inlineClass),i.children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var r,i,s=e(t),o=e.data(t,n);s.hasClass(this.markerClassName)&&(r=t.nodeName.toLowerCase(),"input"===r?(t.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===r||"span"===r)&&(i=s.children("."+this._inlineClass),i.children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,n)}catch(r){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(n,r,i){var s,o,a,f,l=this._getInst(n);return 2===arguments.length&&"string"==typeof r?"defaults"===r?e.extend({},e.datepicker._defaults):l?"all"===r?e.extend({},l.settings):this._get(l,r):null:(s=r||{},"string"==typeof r&&(s={},s[r]=i),l&&(this._curInst===l&&this._hideDatepicker(),o=this._getDateDatepicker(n,!0),a=this._getMinMaxDate(l,"min"),f=this._getMinMaxDate(l,"max"),u(l.settings,s),null!==a&&s.dateFormat!==t&&s.minDate===t&&(l.settings.minDate=this._formatDate(l,a)),null!==f&&s.dateFormat!==t&&s.maxDate===t&&(l.settings.maxDate=this._formatDate(l,f)),"disabled"in s&&(s.disabled?this._disableDatepicker(n):this._enableDatepicker(n)),this._attachments(e(n),l),this._autoSize(l),this._setDate(l,o),this._updateAlternate(l),this._updateDatepicker(l)),void 0)},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(t){var n,r,i,s=e.datepicker._getInst(t.target),o=!0,u=s.dpDiv.is(".ui-datepicker-rtl");if(s._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return i=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",s.dpDiv),i[0]&&e.datepicker._selectDay(t.target,s.selectedMonth,s.selectedYear,i[0]),n=e.datepicker._get(s,"onSelect"),n?(r=e.datepicker._formatDate(s),n.apply(s.input?s.input[0]:null,[r,s])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var n,r,i=e.datepicker._getInst(t.target);return e.datepicker._get(i,"constrainInput")?(n=e.datepicker._possibleChars(e.datepicker._get(i,"dateFormat")),r=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">r||!n||n.indexOf(r)>-1):void 0},_doKeyUp:function(t){var n,r=e.datepicker._getInst(t.target);if(r.input.val()!==r.lastVal)try{n=e.datepicker.parseDate(e.datepicker._get(r,"dateFormat"),r.input?r.input.val():null,e.datepicker._getFormatConfig(r)),n&&(e.datepicker._setDateFromField(r),e.datepicker._updateAlternate(r),e.datepicker._updateDatepicker(r))}catch(i){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var n,r,i,s,o,a,f;n=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==n&&(e.datepicker._curInst.dpDiv.stop(!0,!0),n&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),r=e.datepicker._get(n,"beforeShow"),i=r?r.apply(t,[t,n]):{},i!==!1&&(u(n.settings,i),n.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(n),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),s=!1,e(t).parents().each(function(){return s|="fixed"===e(this).css("position"),!s}),o={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,n.dpDiv.empty(),n.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(n),o=e.datepicker._checkOffset(n,o,s),n.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":s?"fixed":"absolute",display:"none",left:o.left+"px",top:o.top+"px"}),n.inline||(a=e.datepicker._get(n,"showAnim"),f=e.datepicker._get(n,"duration"),n.dpDiv.zIndex(e(t).zIndex()+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[a]?n.dpDiv.show(a,e.datepicker._get(n,"showOptions"),f):n.dpDiv[a||"show"](a?f:null),n.input.is(":visible")&&!n.input.is(":disabled")&&n.input.focus(),e.datepicker._curInst=n))}},_updateDatepicker:function(t){this.maxRows=4,i=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t),t.dpDiv.find("."+this._dayOverClass+" a").mouseover();var n,r=this._getNumberOfMonths(t),s=r[1],o=17;t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),s>1&&t.dpDiv.addClass("ui-datepicker-multi-"+s).css("width",o*s+"em"),t.dpDiv[(1!==r[0]||1!==r[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&t.input[0]!==document.activeElement&&t.input.focus(),t.yearshtml&&(n=t.yearshtml,setTimeout(function(){n===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),n=t.yearshtml=null},0))},_getBorders:function(e){var t=function(e){return{thin:1,medium:2,thick:3}[e]||e};return[parseFloat(t(e.css("border-left-width"))),parseFloat(t(e.css("border-top-width")))]},_checkOffset:function(t,n,r){var i=t.dpDiv.outerWidth(),s=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,u=t.input?t.input.outerHeight():0,a=document.documentElement.clientWidth+(r?0:e(document).scrollLeft()),f=document.documentElement.clientHeight+(r?0:e(document).scrollTop());return n.left-=this._get(t,"isRTL")?i-o:0,n.left-=r&&n.left===t.input.offset().left?e(document).scrollLeft():0,n.top-=r&&n.top===t.input.offset().top+u?e(document).scrollTop():0,n.left-=Math.min(n.left,n.left+i>a&&a>i?Math.abs(n.left+i-a):0),n.top-=Math.min(n.top,n.top+s>f&&f>s?Math.abs(s+u):0),n},_findPos:function(t){for(var n,r=this._getInst(t),i=this._get(r,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[i?"previousSibling":"nextSibling"];return n=e(t).offset(),[n.left,n.top]},_hideDatepicker:function(t){var r,i,s,o,u=this._curInst;!u||t&&u!==e.data(t,n)||this._datepickerShowing&&(r=this._get(u,"showAnim"),i=this._get(u,"duration"),s=function(){e.datepicker._tidyDialog(u)},e.effects&&(e.effects.effect[r]||e.effects[r])?u.dpDiv.hide(r,e.datepicker._get(u,"showOptions"),i,s):u.dpDiv["slideDown"===r?"slideUp":"fadeIn"===r?"fadeOut":"hide"](r?i:null,s),r||s(),this._datepickerShowing=!1,o=this._get(u,"onClose"),o&&o.apply(u.input?u.input[0]:null,[u.input?u.input.val():"",u]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var n=e(t.target),r=e.datepicker._getInst(n[0]);(n[0].id!==e.datepicker._mainDivId&&0===n.parents("#"+e.datepicker._mainDivId).length&&!n.hasClass(e.datepicker.markerClassName)&&!n.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||n.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==r)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,n,r){var i=e(t),s=this._getInst(i[0]);this._isDisabledDatepicker(i[0])||(this._adjustInstDate(s,n+("M"===r?this._get(s,"showCurrentAtPos"):0),r),this._updateDatepicker(s))},_gotoToday:function(t){var n,r=e(t),i=this._getInst(r[0]);this._get(i,"gotoCurrent")&&i.currentDay?(i.selectedDay=i.currentDay,i.drawMonth=i.selectedMonth=i.currentMonth,i.drawYear=i.selectedYear=i.currentYear):(n=new Date,i.selectedDay=n.getDate(),i.drawMonth=i.selectedMonth=n.getMonth(),i.drawYear=i.selectedYear=n.getFullYear()),this._notifyChange(i),this._adjustDate(r)},_selectMonthYear:function(t,n,r){var i=e(t),s=this._getInst(i[0]);s["selected"+("M"===r?"Month":"Year")]=s["draw"+("M"===r?"Month":"Year")]=parseInt(n.options[n.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(i)},_selectDay:function(t,n,r,i){var s,o=e(t);e(i).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(s=this._getInst(o[0]),s.selectedDay=s.currentDay=e("a",i).html(),s.selectedMonth=s.currentMonth=n,s.selectedYear=s.currentYear=r,this._selectDate(t,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear)))},_clearDate:function(t){var n=e(t);this._selectDate(n,"")},_selectDate:function(t,n){var r,i=e(t),s=this._getInst(i[0]);n=null!=n?n:this._formatDate(s),s.input&&s.input.val(n),this._updateAlternate(s),r=this._get(s,"onSelect"),r?r.apply(s.input?s.input[0]:null,[n,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],"object"!=typeof s.input[0]&&s.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var n,r,i,s=this._get(t,"altField");
s&&(n=this._get(t,"altFormat")||this._get(t,"dateFormat"),r=this._getDate(t),i=this.formatDate(n,r,this._getFormatConfig(t)),e(s).each(function(){e(this).val(i)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,n=new Date(e.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),t=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((t-n)/864e5)/7)+1},parseDate:function(t,n,r){if(null==t||null==n)throw"Invalid arguments";if(n="object"==typeof n?n.toString():n+"",""===n)return null;var i,s,o,b,u=0,a=(r?r.shortYearCutoff:null)||this._defaults.shortYearCutoff,f="string"!=typeof a?a:(new Date).getFullYear()%100+parseInt(a,10),l=(r?r.dayNamesShort:null)||this._defaults.dayNamesShort,c=(r?r.dayNames:null)||this._defaults.dayNames,h=(r?r.monthNamesShort:null)||this._defaults.monthNamesShort,p=(r?r.monthNames:null)||this._defaults.monthNames,d=-1,v=-1,m=-1,g=-1,y=!1,w=function(e){var n=i+1<t.length&&t.charAt(i+1)===e;return n&&i++,n},E=function(e){var t=w(e),r="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,i=new RegExp("^\\d{1,"+r+"}"),s=n.substring(u).match(i);if(!s)throw"Missing number at position "+u;return u+=s[0].length,parseInt(s[0],10)},S=function(t,r,i){var s=-1,o=e.map(w(t)?i:r,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(o,function(e,t){var r=t[1];return n.substr(u,r.length).toLowerCase()===r.toLowerCase()?(s=t[0],u+=r.length,!1):void 0}),-1!==s)return s+1;throw"Unknown name at position "+u},x=function(){if(n.charAt(u)!==t.charAt(i))throw"Unexpected literal at position "+u;u++};for(i=0;i<t.length;i++)if(y)"'"!==t.charAt(i)||w("'")?x():y=!1;else switch(t.charAt(i)){case"d":m=E("d");break;case"D":S("D",l,c);break;case"o":g=E("o");break;case"m":v=E("m");break;case"M":v=S("M",h,p);break;case"y":d=E("y");break;case"@":b=new Date(E("@")),d=b.getFullYear(),v=b.getMonth()+1,m=b.getDate();break;case"!":b=new Date((E("!")-this._ticksTo1970)/1e4),d=b.getFullYear(),v=b.getMonth()+1,m=b.getDate();break;case"'":w("'")?x():y=!0;break;default:x()}if(u<n.length&&(o=n.substr(u),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===d?d=(new Date).getFullYear():100>d&&(d+=(new Date).getFullYear()-(new Date).getFullYear()%100+(f>=d?0:-100)),g>-1)for(v=1,m=g;;){if(s=this._getDaysInMonth(d,v-1),s>=m)break;v++,m-=s}if(b=this._daylightSavingAdjust(new Date(d,v-1,m)),b.getFullYear()!==d||b.getMonth()+1!==v||b.getDate()!==m)throw"Invalid date";return b},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(e,t,n){if(!t)return"";var r,i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,s=(n?n.dayNames:null)||this._defaults.dayNames,o=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,u=(n?n.monthNames:null)||this._defaults.monthNames,a=function(t){var n=r+1<e.length&&e.charAt(r+1)===t;return n&&r++,n},f=function(e,t,n){var r=""+t;if(a(e))for(;r.length<n;)r="0"+r;return r},l=function(e,t,n,r){return a(e)?r[t]:n[t]},c="",h=!1;if(t)for(r=0;r<e.length;r++)if(h)"'"!==e.charAt(r)||a("'")?c+=e.charAt(r):h=!1;else switch(e.charAt(r)){case"d":c+=f("d",t.getDate(),2);break;case"D":c+=l("D",t.getDay(),i,s);break;case"o":c+=f("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":c+=f("m",t.getMonth()+1,2);break;case"M":c+=l("M",t.getMonth(),o,u);break;case"y":c+=a("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":c+=t.getTime();break;case"!":c+=1e4*t.getTime()+this._ticksTo1970;break;case"'":a("'")?c+="'":h=!0;break;default:c+=e.charAt(r)}return c},_possibleChars:function(e){var t,n="",r=!1,i=function(n){var r=t+1<e.length&&e.charAt(t+1)===n;return r&&t++,r};for(t=0;t<e.length;t++)if(r)"'"!==e.charAt(t)||i("'")?n+=e.charAt(t):r=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":n+="0123456789";break;case"D":case"M":return null;case"'":i("'")?n+="'":r=!0;break;default:n+=e.charAt(t)}return n},_get:function(e,n){return e.settings[n]!==t?e.settings[n]:this._defaults[n]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var n=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,i=this._getDefaultDate(e),s=i,o=this._getFormatConfig(e);try{s=this.parseDate(n,r,o)||i}catch(u){r=t?"":r}e.selectedDay=s.getDate(),e.drawMonth=e.selectedMonth=s.getMonth(),e.drawYear=e.selectedYear=s.getFullYear(),e.currentDay=r?s.getDate():0,e.currentMonth=r?s.getMonth():0,e.currentYear=r?s.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,n,r){var i=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},s=function(n){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),n,e.datepicker._getFormatConfig(t))}catch(r){}for(var i=(n.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,s=i.getFullYear(),o=i.getMonth(),u=i.getDate(),a=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,f=a.exec(n);f;){switch(f[2]||"d"){case"d":case"D":u+=parseInt(f[1],10);break;case"w":case"W":u+=7*parseInt(f[1],10);break;case"m":case"M":o+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o));break;case"y":case"Y":s+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o))}f=a.exec(n)}return new Date(s,o,u)},o=null==n||""===n?r:"string"==typeof n?s(n):"number"==typeof n?isNaN(n)?r:i(n):new Date(n.getTime());return o=o&&"Invalid Date"===o.toString()?r:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var r=!t,i=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),(i!==e.selectedMonth||s!==e.selectedYear)&&!n&&this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(r?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var n=this._get(t,"stepMonths"),i="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){window["DP_jQuery_"+r].datepicker._adjustDate(i,-n,"M")},next:function(){window["DP_jQuery_"+r].datepicker._adjustDate(i,+n,"M")},hide:function(){window["DP_jQuery_"+r].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+r].datepicker._gotoToday(i)},selectDay:function(){return window["DP_jQuery_"+r].datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return window["DP_jQuery_"+r].datepicker._selectMonthYear(i,this,"M"),!1},selectYear:function(){return window["DP_jQuery_"+r].datepicker._selectMonthYear(i,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q=new Date,R=this._daylightSavingAdjust(new Date(q.getFullYear(),q.getMonth(),q.getDate())),U=this._get(e,"isRTL"),z=this._get(e,"showButtonPanel"),W=this._get(e,"hideIfNoPrevNext"),X=this._get(e,"navigationAsDateFormat"),V=this._getNumberOfMonths(e),$=this._get(e,"showCurrentAtPos"),J=this._get(e,"stepMonths"),K=1!==V[0]||1!==V[1],Q=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),G=this._getMinMaxDate(e,"min"),Y=this._getMinMaxDate(e,"max"),Z=e.drawMonth-$,et=e.drawYear;if(0>Z&&(Z+=12,et--),Y)for(t=this._daylightSavingAdjust(new Date(Y.getFullYear(),Y.getMonth()-V[0]*V[1]+1,Y.getDate())),t=G&&G>t?G:t;this._daylightSavingAdjust(new Date(et,Z,1))>t;)Z--,0>Z&&(Z=11,et--);for(e.drawMonth=Z,e.drawYear=et,n=this._get(e,"prevText"),n=X?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z-J,1)),this._getFormatConfig(e)):n,r=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>":W?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>",i=this._get(e,"nextText"),i=X?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z+J,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>":W?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>",o=this._get(e,"currentText"),u=this._get(e,"gotoCurrent")&&e.currentDay?Q:R,o=X?this.formatDate(o,u,this._getFormatConfig(e)):o,a=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",f=z?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(U?a:"")+(this._isInRange(e,u)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(U?"":a)+"</div>":"",l=parseInt(this._get(e,"firstDay"),10),l=isNaN(l)?0:l,c=this._get(e,"showWeek"),h=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),d=this._get(e,"monthNames"),v=this._get(e,"monthNamesShort"),m=this._get(e,"beforeShowDay"),g=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),w="",E,S=0;S<V[0];S++){for(x="",this.maxRows=4,T=0;T<V[1];T++){if(N=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),C=" ui-corner-all",k="",K){if(k+="<div class='ui-datepicker-group",V[1]>1)switch(T){case 0:k+=" ui-datepicker-group-first",C=" ui-corner-"+(U?"right":"left");break;case V[1]-1:k+=" ui-datepicker-group-last",C=" ui-corner-"+(U?"left":"right");break;default:k+=" ui-datepicker-group-middle",C=""}k+="'>"}for(k+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+C+"'>"+(/all|left/.test(C)&&0===S?U?s:r:"")+(/all|right/.test(C)&&0===S?U?r:s:"")+this._generateMonthYearHeader(e,Z,et,G,Y,S>0||T>0,d,v)+"</div><table class='ui-datepicker-calendar'><thead><tr>",L=c?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",E=0;7>E;E++)A=(E+l)%7,L+="<th"+((E+l+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+h[A]+"'>"+p[A]+"</span></th>";for(k+=L+"</tr></thead><tbody>",O=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,O)),M=(this._getFirstDayOfMonth(et,Z)-l+7)%7,_=Math.ceil((M+O)/7),D=K&&this.maxRows>_?this.maxRows:_,this.maxRows=D,P=this._daylightSavingAdjust(new Date(et,Z,1-M)),H=0;D>H;H++){for(k+="<tr>",B=c?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(P)+"</td>":"",E=0;7>E;E++)j=m?m.apply(e.input?e.input[0]:null,[P]):[!0,""],F=P.getMonth()!==Z,I=F&&!y||!j[0]||G&&G>P||Y&&P>Y,B+="<td class='"+((E+l+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(P.getTime()===N.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===P.getTime()&&b.getTime()===N.getTime()?" "+this._dayOverClass:"")+(I?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!g?"":" "+j[1]+(P.getTime()===Q.getTime()?" "+this._currentClass:"")+(P.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+(F&&!g||!j[2]?"":" title='"+j[2]+"'")+(I?"":" data-handler='selectDay' data-event='click' data-month='"+P.getMonth()+"' data-year='"+P.getFullYear()+"'")+">"+(F&&!g?"&#xa0;":I?"<span class='ui-state-default'>"+P.getDate()+"</span>":"<a class='ui-state-default"+(P.getTime()===R.getTime()?" ui-state-highlight":"")+(P.getTime()===Q.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+"' href='#'>"+P.getDate()+"</a>")+"</td>",P.setDate(P.getDate()+1),P=this._daylightSavingAdjust(P);k+=B+"</tr>"}Z++,Z>11&&(Z=0,et++),k+="</tbody></table>"+(K?"</div>"+(V[0]>0&&T===V[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=k}w+=x}return w+=f,e._keyEvent=!1,w},_generateMonthYearHeader:function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p,d,v,m=this._get(e,"changeMonth"),g=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",w="";if(s||!m)w+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{for(a=r&&r.getFullYear()===n,f=i&&i.getFullYear()===n,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",l=0;12>l;l++)(!a||l>=r.getMonth())&&(!f||l<=i.getMonth())&&(w+="<option value='"+l+"'"+(l===t?" selected='selected'":"")+">"+u[l]+"</option>");w+="</select>"}if(y||(b+=w+(!s&&m&&g?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",s||!g)b+="<span class='ui-datepicker-year'>"+n+"</span>";else{for(c=this._get(e,"yearRange").split(":"),h=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?n+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t},d=p(c[0]),v=Math.max(d,p(c[1]||"")),d=r?Math.max(d,r.getFullYear()):d,v=i?Math.min(v,i.getFullYear()):v,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";v>=d;d++)e.yearshtml+="<option value='"+d+"'"+(d===n?" selected='selected'":"")+">"+d+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,"yearSuffix"),y&&(b+=(!s&&m&&g?"":"&#xa0;")+w),b+="</div>"},_adjustInstDate:function(e,t,n){var r=e.drawYear+("Y"===n?t:0),i=e.drawMonth+("M"===n?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(r,i))+("D"===n?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,i,s)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),("M"===n||"Y"===n)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),i=n&&n>t?n:t;return r&&i>r?r:i},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,n,r){var i=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(n,r+(0>t?t:i[0]*i[1]),1));return 0>t&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var n,r,i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),o=null,u=null,a=this._get(e,"yearRange");return a&&(n=a.split(":"),r=(new Date).getFullYear(),o=parseInt(n[0],10)+r,u=parseInt(n[1],10)+r),(!i||t.getTime()>=i.getTime())&&(!s||t.getTime()<=s.getTime())&&(!o||t.getFullYear()>=o)&&(!u||t.getFullYear()<=u)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,r){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var i=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(r,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),i,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var n=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(n)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n))},e.datepicker=new s,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.10.0",window["DP_jQuery_"+r]=e}(jQuery),function(e){var n={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},r={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};e.widget("ui.dialog",{version:"1.10.0",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var n=e(this).css(t).offset().top;0>n&&e(this).css("top",t.top-n)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var n=this;this._isOpen&&this._trigger("beforeClose",t)!==!1&&(this._isOpen=!1,this._destroyOverlay(),this.opener.filter(":focusable").focus().length||e(this.document[0].activeElement).blur(),this._hide(this.uiDialog,this.options.hide,function(){n._trigger("close",t)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,t){var n=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return n&&!t&&this._trigger("focus",e),n},open:function(){return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show),this._focusTabbable(),this._isOpen=!0,this._trigger("open"),this._trigger("focus"),void 0)},_focusTabbable:function(){var e=this.element.find("[autofocus]");e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function n(){var t=this.document[0].activeElement,n=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);n||this._focusTabbable()}t.preventDefault(),n.call(this),this._delay(n)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),void this.close(t);if(t.keyCode===e.ui.keyCode.TAB){var n=this.uiDialog.find(":tabbable"),r=n.filter(":first"),i=n.filter(":last");t.target!==i[0]&&t.target!==this.uiDialog[0]||t.shiftKey?(t.target===r[0]||t.target===this.uiDialog[0])&&t.shiftKey&&(i.focus(1),t.preventDefault()):(r.focus(1),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,n=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(n)?void this.uiDialog.removeClass("ui-dialog-buttons"):(e.each(n,function(n,r){var i,s;r=e.isFunction(r)?{click:r,text:n}:r,r=e.extend({type:"button"},r),i=r.click,r.click=function(){i.apply(t.element[0],arguments)},s={icons:r.icons,text:r.showText},delete r.icons,delete r.showText,e("<button></button>",r).button(s).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function r(e){return{position:e.position,offset:e.offset}}var t=this,n=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,i){e(this).addClass("ui-dialog-dragging"),t._trigger("dragStart",n,r(i))},drag:function(e,n){t._trigger("drag",e,r(n))},stop:function(i,s){n.position=[s.position.left-t.document.scrollLeft(),s.position.top-t.document.scrollTop()],e(this).removeClass("ui-dialog-dragging"),t._trigger("dragStop",i,r(s))}})},_makeResizable:function(){function o(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var t=this,n=this.options,r=n.resizable,i=this.uiDialog.css("position"),s="string"==typeof r?r:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:n.maxWidth,maxHeight:n.maxHeight,minWidth:n.minWidth,minHeight:this._minHeight(),handles:s,start:function(n,r){e(this).addClass("ui-dialog-resizing"),t._trigger("resizeStart",n,o(r))},resize:function(e,n){t._trigger("resize",e,o(n))},stop:function(r,i){n.height=e(this).height(),n.width=e(this).width(),e(this).removeClass("ui-dialog-resizing"),t._trigger("resizeStop",r,o(i))}}).css("position",i)},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var i=this,s=!1,o={};e.each(t,function(e,t){i._setOption(e,t),e in n&&(s=!0),e in r&&(o[e]=t)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",o)},_setOption:function(e,t){var n,r,i=this.uiDialog;"dialogClass"===e&&i.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&(n=i.is(":data(ui-draggable)"),n&&!t&&i.draggable("destroy"),!n&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(r=i.is(":data(ui-resizable)"),r&&!t&&i.resizable("destroy"),r&&"string"==typeof t&&i.resizable("option","handles",t),!r&&t!==!1&&this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,n,r=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),r.minWidth>r.width&&(r.width=r.minWidth),e=this.uiDialog.css({height:"auto",width:r.width}).outerHeight(),t=Math.max(0,r.minHeight-e),n="number"==typeof r.maxHeight?Math.max(0,r.maxHeight-e):"none","auto"===r.height?this.element.css({minHeight:t,maxHeight:n,height:"auto"}):this.element.height(Math.max(0,r.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_createOverlay:function(){this.options.modal&&(e.ui.dialog.overlayInstances||this._delay(function(){e.ui.dialog.overlayInstances&&this._on(this.document,{focusin:function(t){e(t.target).closest(".ui-dialog").length||(t.preventDefault(),e(".ui-dialog:visible:last .ui-dialog-content").data("ui-dialog")._focusTabbable())}})}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this.document[0].body),this._on(this.overlay,{mousedown:"_keepFocus"}),e.ui.dialog.overlayInstances++)},_destroyOverlay:function(){this.options.modal&&(e.ui.dialog.overlayInstances--,e.ui.dialog.overlayInstances||this._off(this.document,"focusin"),this.overlay.remove())}}),e.ui.dialog.overlayInstances=0,e.uiBackCompat!==!1&&e.widget("ui.dialog",e.ui.dialog,{_position:function(){var i,t=this.options.position,n=[],r=[0,0];t?(("string"==typeof t||"object"==typeof t&&"0"in t)&&(n=t.split?t.split(" "):[t[0],t[1]],1===n.length&&(n[1]=n[0]),e.each(["left","top"],function(e,t){+n[e]===n[e]&&(r[e]=n[e],n[e]=t)}),t={my:n[0]+(r[0]<0?r[0]:"+"+r[0])+" "+n[1]+(r[1]<0?r[1]:"+"+r[1]),at:n.join(" ")}),t=e.extend({},e.ui.dialog.prototype.options.position,t)):t=e.ui.dialog.prototype.options.position,i=this.uiDialog.is(":visible"),i||this.uiDialog.show(),this.uiDialog.position(t),i||this.uiDialog.hide()}})}(jQuery),function(e){e.widget("ui.menu",{version:"1.10.0",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(e){this.options.disabled&&e.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(t){var n=e(t.target).closest(".ui-menu-item");!this.mouseHandled&&n.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(t),n.has(".ui-menu").length?this.expand(t):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var n=e(t.currentTarget);n.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(t,n)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var n=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,n)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){e(t.target).closest(".ui-menu").length||this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function a(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var n,r,i,s,o,u=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:u=!1,r=this.previousFilter||"",i=String.fromCharCode(t.keyCode),s=!1,clearTimeout(this.filterTimer),i===r?s=!0:i=r+i,o=new RegExp("^"+a(i),"i"),n=this.activeMenu.children(".ui-menu-item").filter(function(){return o.test(e(this).children("a").text())}),n=s&&-1!==n.index(this.active.next())?this.active.nextAll(".ui-menu-item"):n,n.length||(i=String.fromCharCode(t.keyCode),o=new RegExp("^"+a(i),"i"),n=this.activeMenu.children(".ui-menu-item").filter(function(){return o.test(e(this).children("a").text())})),n.length?(this.focus(t,n),n.length>1?(this.previousFilter=i,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}u&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,n=this.options.icons.submenu,r=this.element.find(this.options.menus);r.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),r=t.prev("a"),i=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);
r.attr("aria-haspopup","true").prepend(i),t.attr("aria-labelledby",r.attr("id"))}),t=r.add(this.element),t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),t.children(":not(.ui-menu-item)").each(function(){var t=e(this);/[^\-—–\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")}),t.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),this._super(e,t)},focus:function(e,t){var n,r;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),r=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",r.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),n=t.children(".ui-menu"),n.length&&/^mouse/.test(e.type)&&this._startOpening(n),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var n,r,i,s,o,u;this._hasScroll()&&(n=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,r=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,i=t.offset().top-this.activeMenu.offset().top-n-r,s=this.activeMenu.scrollTop(),o=this.activeMenu.height(),u=t.height(),0>i?this.activeMenu.scrollTop(s+i):i+u>o&&this.activeMenu.scrollTop(s+i-o+u))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var n=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(n)},collapseAll:function(t,n){clearTimeout(this.timer),this.timer=this._delay(function(){var r=n?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));r.length||(r=this.element),this._close(r),this.blur(t),this.activeMenu=r},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,n){var r;this.active&&(r="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),r&&r.length&&this.active||(r=this.activeMenu.children(".ui-menu-item")[t]()),this.focus(n,r)},nextPage:function(t){var n,r,i;return this.active?void(this.isLastItem()||(this._hasScroll()?(r=this.active.offset().top,i=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-r-i<0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))):void this.next(t)},previousPage:function(t){var n,r,i;return this.active?void(this.isFirstItem()||(this._hasScroll()?(r=this.active.offset().top,i=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-r+i>0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item").first()))):void this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var n={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,n)}})}(jQuery),function(e,t){e.widget("ui.progressbar",{version:"1.10.0",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return e===t?this.options.value:(this.options.value=this._constrainedValue(e),void this._refreshValue())},_constrainedValue:function(e){return e===t&&(e=this.options.value),this.indeterminate=e===!1,"number"!=typeof e&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,n=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(n.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}})}(jQuery),function(e){var n=5;e.widget("ui.slider",e.ui.mouse,{version:"1.10.0",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){var t,n,r=this.options,i=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),s="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",o=[];for(this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this.range=e([]),r.range&&(r.range===!0&&(r.values?r.values.length&&2!==r.values.length?r.values=[r.values[0],r.values[0]]:e.isArray(r.values)&&(r.values=r.values.slice(0)):r.values=[this._valueMin(),this._valueMin()]),this.range=e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===r.range||"max"===r.range?" ui-slider-range-"+r.range:""))),n=r.values&&r.values.length||1,t=i.length;n>t;t++)o.push(s);this.handles=i.add(e(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(e){e.preventDefault()}).mouseenter(function(){r.disabled||e(this).addClass("ui-state-hover")}).mouseleave(function(){e(this).removeClass("ui-state-hover")}).focus(function(){r.disabled?e(this).blur():(e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),e(this).addClass("ui-state-focus"))}).blur(function(){e(this).removeClass("ui-state-focus")}),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)}),this._setOption("disabled",r.disabled),this._on(this.handles,this._handleEvents),this._refreshValue(),this._animateOff=!1},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var n,r,i,s,o,u,a,f,l=this,c=this.options;return c.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},r=this._normValueFromMouse(n),i=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var n=Math.abs(r-l.values(t));(i>n||i===n&&(t===l._lastChangedValue||l.values(t)===c.min))&&(i=n,s=e(this),o=t)}),u=this._start(t,o),u===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,s.addClass("ui-state-active").focus(),a=s.offset(),f=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=f?{left:0,top:0}:{left:t.pageX-a.left-s.width()/2,top:t.pageY-a.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,r),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,r,i,s;return"horizontal"===this.orientation?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),r=n/t,r>1&&(r=1),0>r&&(r=0),"vertical"===this.orientation&&(r=1-r),i=this._valueMax()-this._valueMin(),s=this._valueMin()+r*i,this._trimAlignValue(s)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var r,i,s;this.options.values&&this.options.values.length?(r=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&n>r||1===t&&r>n)&&(n=r),n!==this.values(t)&&(i=this.values(),i[t]=n,s=this._trigger("slide",e,{handle:this.handles[t],value:n,values:i}),r=this.values(t?0:1),s!==!1&&this.values(t,n,!0))):n!==this.value()&&(s=this._trigger("slide",e,{handle:this.handles[t],value:n}),s!==!1&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,n)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(t,n){var r,i,s;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),this._change(null,t),void 0;if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(r=this.options.values,i=arguments[0],s=0;s<r.length;s+=1)r[s]=this._trimAlignValue(i[s]),this._change(null,s);this._refreshValue()},_setOption:function(t,n){var r,i=0;switch(e.isArray(this.options.values)&&(i=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments),t){case"disabled":n?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0)):this.handles.prop("disabled",!1);break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),r=0;i>r;r+=1)this._change(null,r);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,n,r;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);for(n=this.options.values.slice(),r=0;r<n.length;r+=1)n[r]=this._trimAlignValue(n[r]);return n},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,r=e-n;return 2*Math.abs(n)>=t&&(r+=n>0?t:-t),parseFloat(r.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,r,i,s,o=this.options.range,u=this.options,a=this,f=this._animateOff?!1:u.animate,l={};this.options.values&&this.options.values.length?this.handles.each(function(r){n=(a.values(r)-a._valueMin())/(a._valueMax()-a._valueMin())*100,l["horizontal"===a.orientation?"left":"bottom"]=n+"%",e(this).stop(1,1)[f?"animate":"css"](l,u.animate),a.options.range===!0&&("horizontal"===a.orientation?(0===r&&a.range.stop(1,1)[f?"animate":"css"]({left:n+"%"},u.animate),1===r&&a.range[f?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:u.animate})):(0===r&&a.range.stop(1,1)[f?"animate":"css"]({bottom:n+"%"},u.animate),1===r&&a.range[f?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:u.animate}))),t=n}):(r=this.value(),i=this._valueMin(),s=this._valueMax(),n=s!==i?(r-i)/(s-i)*100:0,l["horizontal"===this.orientation?"left":"bottom"]=n+"%",this.handle.stop(1,1)[f?"animate":"css"](l,u.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[f?"animate":"css"]({width:n+"%"},u.animate),"max"===o&&"horizontal"===this.orientation&&this.range[f?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:u.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[f?"animate":"css"]({height:n+"%"},u.animate),"max"===o&&"vertical"===this.orientation&&this.range[f?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:u.animate}))},_handleEvents:{keydown:function(t){var r,i,s,o,u=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(t.target).addClass("ui-state-active"),r=this._start(t,u),r===!1))return}switch(o=this.options.step,i=s=this.options.values&&this.options.values.length?this.values(u):this.value(),t.keyCode){case e.ui.keyCode.HOME:s=this._valueMin();break;case e.ui.keyCode.END:s=this._valueMax();break;case e.ui.keyCode.PAGE_UP:s=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.PAGE_DOWN:s=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(i===this._valueMax())return;s=this._trimAlignValue(i+o);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(i===this._valueMin())return;s=this._trimAlignValue(i-o)}this._slide(t,u,s)},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),e(t.target).removeClass("ui-state-active"))}}})}(jQuery),function(e){function t(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.widget("ui.spinner",{version:"1.10.0",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},n=this.element;return e.each(["min","max","step"],function(e,r){var i=n.attr(r);void 0!==i&&i.length&&(t[r]=i)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",e)))},mousewheel:function(e,t){return t?this.spinning||this._start(e)?(this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault(),void 0):!1:void 0},"mousedown .ui-spinner-button":function(t){function r(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n}))}var n;n=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),r.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,r.call(this)}),this._start(t)!==!1&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return e(t.currentTarget).hasClass("ui-state-active")?this._start(t)===!1?!1:void this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var n=this.options,r=e.ui.keyCode;switch(t.keyCode){case r.UP:return this._repeat(null,1,t),!0;case r.DOWN:return this._repeat(null,-1,t),!0;case r.PAGE_UP:return this._repeat(null,n.page,t),!0;case r.PAGE_DOWN:return this._repeat(null,-n.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(e){return this.spinning||this._trigger("start",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,n){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,n)},e),this._spin(t*this.options.step,n)},_spin:function(e,t){var n=this.value()||0;this.counter||(this.counter=1),n=this._adjustValue(n+e*this._increment(this.counter)),this.spinning&&this._trigger("spin",t,{value:n})===!1||(this._value(n),this.counter++)},_increment:function(t){var n=this.options.incremental;return n?e.isFunction(n)?n(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),n=t.indexOf(".");return-1===n?0:t.length-n-1},_adjustValue:function(e){var t,n,r=this.options;return t=null!==r.min?r.min:0,n=e-t,n=Math.round(n/r.step)*r.step,e=t+n,e=parseFloat(e.toFixed(this._precision())),null!==r.max&&e>r.max?r.max:null!==r.min&&e<r.min?r.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var n=this._parse(this.element.val());return this.options[e]=t,void this.element.val(this._format(n))}("max"===e||"min"===e||"step"===e)&&"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(t?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:t(function(e){this._super(e),this._value(this.element.val())}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(e,t){var n;""!==e&&(n=this._parse(e),null!==n&&(t||(n=this._adjustValue(n)),e=this._format(n))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:t(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:t(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:t(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:t(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?void t(this._value).call(this,e):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})}(jQuery),function(e,t){function i(){return++n}function s(e){return e.hash.length>1&&decodeURIComponent(e.href.replace(r,""))===decodeURIComponent(location.href.replace(r,""))}var n=0,r=/#.*$/;e.widget("ui.tabs",{version:"1.10.0",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t=this,n=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",n.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),n.active=this._initialActive(),e.isArray(n.disabled)&&(n.disabled=e.unique(n.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(n.active):e(),this._refresh(),this.active.length&&this.load(n.active)},_initialActive:function(){var t=this.options.active,n=this.options.collapsible,r=location.hash.substring(1);return null===t&&(r&&this.tabs.each(function(n,i){return e(i).attr("aria-controls")===r?(t=n,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=n?!1:0)),!n&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var n=e(this.document[0].activeElement).closest("li"),r=this.tabs.index(n),i=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:r++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:i=!1,r--;break;case e.ui.keyCode.END:r=this.anchors.length-1;break;case e.ui.keyCode.HOME:r=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),this._activate(r),void 0;case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),this._activate(r===this.options.active?!1:r),void 0;default:return}t.preventDefault(),clearTimeout(this.activating),r=this._focusNextTab(r,i),t.ctrlKey||(n.attr("aria-selected","false"),this.tabs.eq(r).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",r)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,n){function i(){return t>r&&(t=0),0>t&&(t=r),t}for(var r=this.tabs.length-1;-1!==e.inArray(i(),this.options.disabled);)t=n?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?void this._activate(t):"disabled"===e?void this._setupDisabled(t):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),!t&&this.options.active===!1&&this._activate(0)),"event"===e&&this._setupEvents(t),"heightStyle"===e&&this._setupHeightStyle(t),void 0)},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+i()},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,n=this.tablist.children(":has(a[href])");t.disabled=e.map(n.filter(".ui-state-disabled"),function(e){return n.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(n,r){var i,o,u,a=e(r).uniqueId().attr("id"),f=e(r).closest("li"),l=f.attr("aria-controls");s(r)?(i=r.hash,o=t.element.find(t._sanitizeSelector(i))):(u=t._tabId(f),i="#"+u,o=t.element.find(i),o.length||(o=t._createPanel(u),o.insertAfter(t.panels[n-1]||t.tablist)),o.attr("aria-live","polite")),o.length&&(t.panels=t.panels.add(o)),l&&f.data("ui-tabs-aria-controls",l),f.attr({"aria-controls":i.substring(1),"aria-labelledby":a}),o.attr("aria-labelledby",a)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var r,n=0;r=this.tabs[n];n++)t===!0||-1!==e.inArray(n,t)?e(r).addClass("ui-state-disabled").attr("aria-disabled","true"):e(r).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var n={click:function(e){e.preventDefault()}};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,n),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var n,r=this.element.parent();"fill"===t?(n=r.height(),n-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),r=t.css("position");"absolute"!==r&&"fixed"!==r&&(n-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){n-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,n-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(n=0,this.panels.each(function(){n=Math.max(n,e(this).height("").height())}).height(n))},_eventHandler:function(t){var n=this.options,r=this.active,i=e(t.currentTarget),s=i.closest("li"),o=s[0]===r[0],u=o&&n.collapsible,a=u?e():this._getPanelForTab(s),f=r.length?this._getPanelForTab(r):e(),l={oldTab:r,oldPanel:f,newTab:u?e():s,newPanel:a};t.preventDefault(),s.hasClass("ui-state-disabled")||s.hasClass("ui-tabs-loading")||this.running||o&&!n.collapsible||this._trigger("beforeActivate",t,l)===!1||(n.active=u?!1:this.tabs.index(s),this.active=o?e():s,this.xhr&&this.xhr.abort(),!f.length&&!a.length&&e.error("jQuery UI Tabs: Mismatching fragment identifier."),a.length&&this.load(this.tabs.index(s),t),this._toggle(t,l))},_toggle:function(t,n){function o(){r.running=!1,r._trigger("activate",t,n)}function u(){n.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),i.length&&r.options.show?r._show(i,r.options.show,o):(i.show(),o())}var r=this,i=n.newPanel,s=n.oldPanel;this.running=!0,s.length&&this.options.hide?this._hide(s,this.options.hide,function(){n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),u()}):(n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),s.hide(),u()),s.attr({"aria-expanded":"false","aria-hidden":"true"}),n.oldTab.attr("aria-selected","false"),i.length&&s.length?n.oldTab.attr("tabIndex",-1):i.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),i.attr({"aria-expanded":"true","aria-hidden":"false"}),n.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(t){var n,r=this._findActive(t);
r[0]!==this.active[0]&&(r.length||(r=this.active),n=r.find(".ui-tabs-anchor")[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),n=t.data("ui-tabs-aria-controls");n?t.attr("aria-controls",n).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(n){var r=this.options.disabled;r!==!1&&(n===t?r=!1:(n=this._getIndex(n),r=e.isArray(r)?e.map(r,function(e){return e!==n?e:null}):e.map(this.tabs,function(e,t){return t!==n?t:null})),this._setupDisabled(r))},disable:function(n){var r=this.options.disabled;if(r!==!0){if(n===t)r=!0;else{if(n=this._getIndex(n),-1!==e.inArray(n,r))return;r=e.isArray(r)?e.merge([n],r).sort():[n]}this._setupDisabled(r)}},load:function(t,n){t=this._getIndex(t);var r=this,i=this.tabs.eq(t),o=i.find(".ui-tabs-anchor"),u=this._getPanelForTab(i),a={tab:i,panel:u};s(o[0])||(this.xhr=e.ajax(this._ajaxSettings(o,n,a)),this.xhr&&"canceled"!==this.xhr.statusText&&(i.addClass("ui-tabs-loading"),u.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){u.html(e),r._trigger("load",n,a)},1)}).complete(function(e,t){setTimeout(function(){"abort"===t&&r.panels.stop(!1,!0),i.removeClass("ui-tabs-loading"),u.removeAttr("aria-busy"),e===r.xhr&&delete r.xhr},1)})))},_ajaxSettings:function(t,n,r){var i=this;return{url:t.attr("href"),beforeSend:function(t,s){return i._trigger("beforeLoad",n,e.extend({jqXHR:t,ajaxSettings:s},r))}}},_getPanelForTab:function(t){var n=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+n))}})}(jQuery),function(e){function n(t,n){var r=(t.attr("aria-describedby")||"").split(/\s+/);r.push(n),t.data("ui-tooltip-id",n).attr("aria-describedby",e.trim(r.join(" ")))}function r(t){var n=t.data("ui-tooltip-id"),r=(t.attr("aria-describedby")||"").split(/\s+/),i=e.inArray(n,r);-1!==i&&r.splice(i,1),t.removeData("ui-tooltip-id"),r=e.trim(r.join(" ")),r?t.attr("aria-describedby",r):t.removeAttr("aria-describedby")}var t=0;e.widget("ui.tooltip",{version:"1.10.0",options:{content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(t,n){var r=this;return"disabled"===t?(this[n?"_disable":"_enable"](),void(this.options[t]=n)):(this._super(t,n),void("content"===t&&e.each(this.tooltips,function(e,t){r._updateContent(t)})))},_disable:function(){var t=this;e.each(this.tooltips,function(n,r){var i=e.Event("blur");i.target=i.currentTarget=r[0],t.close(i,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var n=this,r=e(t?t.target:this.element).closest(this.options.items);r.length&&!r.data("ui-tooltip-id")&&(r.attr("title")&&r.data("ui-tooltip-title",r.attr("title")),r.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&r.parents().each(function(){var r,t=e(this);t.data("ui-tooltip-open")&&(r=e.Event("blur"),r.target=r.currentTarget=this,n.close(r,!0)),t.attr("title")&&(t.uniqueId(),n.parents[this.id]={element:this,title:t.attr("title")},t.attr("title",""))}),this._updateContent(r,t))},_updateContent:function(e,t){var n,r=this.options.content,i=this,s=t?t.type:null;return"string"==typeof r?this._open(t,e,r):(n=r.call(e[0],function(n){e.data("ui-tooltip-open")&&i._delay(function(){t&&(t.type=s),this._open(t,e,n)})}),void(n&&this._open(t,e,n)))},_open:function(t,r,i){function f(e){a.of=e,s.is(":hidden")||s.position(a)}var s,o,u,a=e.extend({},this.options.position);if(i){if(s=this._find(r),s.length)return void s.find(".ui-tooltip-content").html(i);r.is("[title]")&&(t&&"mouseover"===t.type?r.attr("title",""):r.removeAttr("title")),s=this._tooltip(r),n(r,s.attr("id")),s.find(".ui-tooltip-content").html(i),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:f}),f(t)):s.position(e.extend({of:r},this.options.position)),s.hide(),this._show(s,this.options.show),this.options.show&&this.options.show.delay&&(u=this.delayedShow=setInterval(function(){s.is(":visible")&&(f(a.of),clearInterval(u))},e.fx.interval)),this._trigger("open",t,{tooltip:s}),o={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var n=e.Event(t);n.currentTarget=r[0],this.close(n,!0)}},remove:function(){this._removeTooltip(s)}},t&&"mouseover"!==t.type||(o.mouseleave="close"),t&&"focusin"!==t.type||(o.focusout="close"),this._on(!0,r,o)}},close:function(t){var n=this,i=e(t?t.currentTarget:this.element),s=this._find(i);this.closing||(clearInterval(this.delayedShow),i.data("ui-tooltip-title")&&i.attr("title",i.data("ui-tooltip-title")),r(i),s.stop(!0),this._hide(s,this.options.hide,function(){n._removeTooltip(e(this))}),i.removeData("ui-tooltip-open"),this._off(i,"mouseleave focusout keyup"),i[0]!==this.element[0]&&this._off(i,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,function(t,r){e(r.element).attr("title",r.title),delete n.parents[t]}),this.closing=!0,this._trigger("close",t,{tooltip:s}),this.closing=!1)},_tooltip:function(n){var r="ui-tooltip-"+t++,i=e("<div>").attr({id:r,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return e("<div>").addClass("ui-tooltip-content").appendTo(i),i.appendTo(this.document[0].body),this.tooltips[r]=n,i},_find:function(t){var n=t.data("ui-tooltip-id");return n?e("#"+n):e()},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(n,r){var i=e.Event("blur");i.target=i.currentTarget=r[0],t.close(i,!0),e("#"+n).remove(),r.data("ui-tooltip-title")&&(r.attr("title",r.data("ui-tooltip-title")),r.removeData("ui-tooltip-title"))})}})}(jQuery),jQuery.effects||function(e,t){var n="ui-effects-";e.effects={effect:{}},function(e,t){function h(e,t,n){var r=u[t.type]||{};return null==e?n||!t.def?null:t.def:(e=r.floor?~~e:parseFloat(e),isNaN(e)?t.def:r.mod?(e+r.mod)%r.mod:0>e?0:r.max<e?r.max:e)}function p(t){var n=s(),r=n._rgba=[];return t=t.toLowerCase(),c(i,function(e,i){var s,u=i.re.exec(t),a=u&&i.parse(u),f=i.space||"rgba";return a?(s=n[f](a),n[o[f].cache]=s[o[f].cache],r=n._rgba=s._rgba,!1):void 0}),r.length?("0,0,0,0"===r.join()&&e.extend(r,l.transparent),n):l[t]}function d(e,t,n){return n=(n+1)%1,1>6*n?e+(t-e)*n*6:1>2*n?t:2>3*n?e+(t-e)*(2/3-n)*6:e}var l,n="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,i=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],s=e.Color=function(t,n,r,i){return new e.Color.fn.parse(t,n,r,i)},o={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},u={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},a=s.support={},f=e("<p>")[0],c=e.each;f.style.cssText="background-color:rgba(1,1,1,.5)",a.rgba=f.style.backgroundColor.indexOf("rgba")>-1,c(o,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),s.fn=e.extend(s.prototype,{parse:function(n,r,i,u){if(n===t)return this._rgba=[null,null,null,null],this;(n.jquery||n.nodeType)&&(n=e(n).css(r),r=t);var a=this,f=e.type(n),d=this._rgba=[];return r!==t&&(n=[n,r,i,u],f="array"),"string"===f?this.parse(p(n)||l._default):"array"===f?(c(o.rgba.props,function(e,t){d[t.idx]=h(n[t.idx],t)}),this):"object"===f?(n instanceof s?c(o,function(e,t){n[t.cache]&&(a[t.cache]=n[t.cache].slice())}):c(o,function(t,r){var i=r.cache;c(r.props,function(e,t){if(!a[i]&&r.to){if("alpha"===e||null==n[e])return;a[i]=r.to(a._rgba)}a[i][t.idx]=h(n[e],t,!0)}),a[i]&&e.inArray(null,a[i].slice(0,3))<0&&(a[i][3]=1,r.from&&(a._rgba=r.from(a[i])))}),this):void 0},is:function(e){var t=s(e),n=!0,r=this;return c(o,function(e,i){var s,o=t[i.cache];return o&&(s=r[i.cache]||i.to&&i.to(r._rgba)||[],c(i.props,function(e,t){return null!=o[t.idx]?n=o[t.idx]===s[t.idx]:void 0})),n}),n},_space:function(){var e=[],t=this;return c(o,function(n,r){t[r.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var n=s(e),r=n._space(),i=o[r],a=0===this.alpha()?s("transparent"):this,f=a[i.cache]||i.to(a._rgba),l=f.slice();return n=n[i.cache],c(i.props,function(e,r){var i=r.idx,s=f[i],o=n[i],a=u[r.type]||{};null!==o&&(null===s?l[i]=o:(a.mod&&(o-s>a.mod/2?s+=a.mod:s-o>a.mod/2&&(s-=a.mod)),l[i]=h((o-s)*t+s,r)))}),this[r](l)},blend:function(t){if(1===this._rgba[3])return this;var n=this._rgba.slice(),r=n.pop(),i=s(t)._rgba;return s(e.map(n,function(e,t){return(1-r)*i[t]+r*e}))},toRgbaString:function(){var t="rgba(",n=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===n[3]&&(n.pop(),t="rgb("),t+n.join()+")"},toHslaString:function(){var t="hsla(",n=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===n[3]&&(n.pop(),t="hsl("),t+n.join()+")"},toHexString:function(t){var n=this._rgba.slice(),r=n.pop();return t&&n.push(~~(255*r)),"#"+e.map(n,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),s.fn.parse.prototype=s.fn,o.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var l,c,t=e[0]/255,n=e[1]/255,r=e[2]/255,i=e[3],s=Math.max(t,n,r),o=Math.min(t,n,r),u=s-o,a=s+o,f=.5*a;return l=o===s?0:t===s?60*(n-r)/u+360:n===s?60*(r-t)/u+120:60*(t-n)/u+240,c=0===u?0:.5>=f?u/a:u/(2-a),[Math.round(l)%360,c,f,null==i?1:i]},o.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,n=e[1],r=e[2],i=e[3],s=.5>=r?r*(1+n):r+n-r*n,o=2*r-s;return[Math.round(255*d(o,s,t+1/3)),Math.round(255*d(o,s,t)),Math.round(255*d(o,s,t-1/3)),i]},c(o,function(n,i){var o=i.props,u=i.cache,a=i.to,f=i.from;s.fn[n]=function(n){if(a&&!this[u]&&(this[u]=a(this._rgba)),n===t)return this[u].slice();var r,i=e.type(n),l="array"===i||"object"===i?n:arguments,p=this[u].slice();return c(o,function(e,t){var n=l["object"===i?e:t.idx];null==n&&(n=p[t.idx]),p[t.idx]=h(n,t)}),f?(r=s(f(p)),r[u]=p,r):s(p)},c(o,function(t,i){s.fn[t]||(s.fn[t]=function(s){var l,o=e.type(s),u="alpha"===t?this._hsla?"hsla":"rgba":n,a=this[u](),f=a[i.idx];return"undefined"===o?f:("function"===o&&(s=s.call(this,f),o=e.type(s)),null==s&&i.empty?this:("string"===o&&(l=r.exec(s),l&&(s=f+parseFloat(l[2])*("+"===l[1]?1:-1))),a[i.idx]=s,this[u](a)))})})}),s.hook=function(t){var n=t.split(" ");c(n,function(t,n){e.cssHooks[n]={set:function(t,r){var i,o,u="";if("transparent"!==r&&("string"!==e.type(r)||(i=p(r)))){if(r=s(i||r),!a.rgba&&1!==r._rgba[3]){for(o="backgroundColor"===n?t.parentNode:t;(""===u||"transparent"===u)&&o&&o.style;)try{u=e.css(o,"backgroundColor"),o=o.parentNode}catch(f){}r=r.blend(u&&"transparent"!==u?u:"_default")}r=r.toRgbaString()}try{t.style[n]=r}catch(f){}}},e.fx.step[n]=function(t){t.colorInit||(t.start=s(t.elem,n),t.end=s(t.end),t.colorInit=!0),e.cssHooks[n].set(t.elem,t.start.transition(t.end,t.pos))}})},s.hook(n),e.cssHooks.borderColor={expand:function(e){var t={};return c(["Top","Right","Bottom","Left"],function(n,r){t["border"+r+"Color"]=e}),t}},l=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function i(t){var n,r,i=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,s={};if(i&&i.length&&i[0]&&i[i[0]])for(r=i.length;r--;)n=i[r],"string"==typeof i[n]&&(s[e.camelCase(n)]=i[n]);else for(n in i)"string"==typeof i[n]&&(s[n]=i[n]);return s}function s(t,n){var s,o,i={};for(s in n)o=n[s],t[s]!==o&&!r[s]&&(e.fx.step[s]||!isNaN(parseFloat(o)))&&(i[s]=o);return i}var n=["add","remove","toggle"],r={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,n){e.fx.step[n]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(jQuery.style(e.elem,n,e.end),e.setAttr=!0)}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(t,r,o,u){var a=e.speed(r,o,u);return this.queue(function(){var u,r=e(this),o=r.attr("class")||"",f=a.children?r.find("*").addBack():r;f=f.map(function(){var t=e(this);return{el:t,start:i(this)}}),u=function(){e.each(n,function(e,n){t[n]&&r[n+"Class"](t[n])})},u(),f=f.map(function(){return this.end=i(this.el[0]),this.diff=s(this.start,this.end),this}),r.attr("class",o),f=f.map(function(){var t=this,n=e.Deferred(),r=e.extend({},a,{queue:!1,complete:function(){n.resolve(t)}});return this.el.animate(this.diff,r),n.promise()}),e.when.apply(e,f.get()).done(function(){u(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),a.complete.call(r[0])})})},e.fn.extend({_addClass:e.fn.addClass,addClass:function(t,n,r,i){return n?e.effects.animateClass.call(this,{add:t},n,r,i):this._addClass(t)},_removeClass:e.fn.removeClass,removeClass:function(t,n,r,i){return n?e.effects.animateClass.call(this,{remove:t},n,r,i):this._removeClass(t)},_toggleClass:e.fn.toggleClass,toggleClass:function(n,r,i,s,o){return"boolean"==typeof r||r===t?i?e.effects.animateClass.call(this,r?{add:n}:{remove:n},i,s,o):this._toggleClass(n,r):e.effects.animateClass.call(this,{toggle:n},r,i,s)},switchClass:function(t,n,r,i,s){return e.effects.animateClass.call(this,{add:n,remove:t},r,i,s)}})}(),function(){function r(t,n,r,i){return e.isPlainObject(t)&&(n=t,t=t.effect),t={effect:t},null==n&&(n={}),e.isFunction(n)&&(i=n,r=null,n={}),("number"==typeof n||e.fx.speeds[n])&&(i=r,r=n,n={}),e.isFunction(r)&&(i=r,r=null),n&&e.extend(t,n),r=r||n.duration,t.duration=e.fx.off?0:"number"==typeof r?r:r in e.fx.speeds?e.fx.speeds[r]:e.fx.speeds._default,t.complete=i||n.complete,t}function i(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"==typeof t&&!e.effects.effect[t]}e.extend(e.effects,{version:"1.10.0",save:function(e,t){for(var r=0;r<t.length;r++)null!==t[r]&&e.data(n+t[r],e[0].style[t[r]])},restore:function(e,r){var i,s;for(s=0;s<r.length;s++)null!==r[s]&&(i=e.data(n+r[s]),i===t&&(i=""),e.css(r[s],i))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var n,r;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":r=0;break;case"center":r=.5;break;case"right":r=1;break;default:r=e[1]/t.width}return{x:r,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},r=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),i={width:t.width(),height:t.height()},s=document.activeElement;try{s.id}catch(o){s=document.body}return t.wrap(r),(t[0]===s||e.contains(t[0],s))&&e(s).focus(),r=t.parent(),"static"===t.css("position")?(r.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,r){n[r]=t.css(r),isNaN(parseInt(n[r],10))&&(n[r]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(i),r.css(n).show()},removeWrapper:function(t){var n=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===n||e.contains(t[0],n))&&e(n).focus()),t},setTransition:function(t,n,r,i){return i=i||{},e.each(n,function(e,n){var s=t.cssUnit(n);s[0]>0&&(i[n]=s[0]*r+s[1])}),i}}),e.fn.extend({effect:function(){function o(n){function u(){e.isFunction(i)&&i.call(r[0]),e.isFunction(n)&&n()}var r=e(this),i=t.complete,o=t.mode;(r.is(":hidden")?"hide"===o:"show"===o)?u():s.call(r[0],t,u)}var t=r.apply(this,arguments),n=t.mode,i=t.queue,s=e.effects.effect[t.effect];return e.fx.off||!s?n?this[n](t.duration,t.complete):this.each(function(){t.complete&&t.complete.call(this)}):i===!1?this.each(o):this.queue(i||"fx",o)},_show:e.fn.show,show:function(e){if(i(e))return this._show.apply(this,arguments);var t=r.apply(this,arguments);return t.mode="show",this.effect.call(this,t)},_hide:e.fn.hide,hide:function(e){if(i(e))return this._hide.apply(this,arguments);var t=r.apply(this,arguments);return t.mode="hide",this.effect.call(this,t)},__toggle:e.fn.toggle,toggle:function(t){if(i(t)||"boolean"==typeof t||e.isFunction(t))return this.__toggle.apply(this,arguments);var n=r.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)},cssUnit:function(t){var n=this.css(t),r=[];return e.each(["em","px","%","pt"],function(e,t){n.indexOf(t)>0&&(r=[parseFloat(n),t])}),r}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,n){t[n]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,n){e.easing["easeIn"+t]=n,e.easing["easeOut"+t]=function(e){return 1-n(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?n(2*e)/2:1-n(-2*e+2)/2}})}()}(jQuery),function(e){var n=/up|down|vertical/,r=/up|left|vertical|horizontal/;e.effects.effect.blind=function(t,i){var v,m,g,s=e(this),o=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(s,t.mode||"hide"),a=t.direction||"up",f=n.test(a),l=f?"height":"width",c=f?"top":"left",h=r.test(a),p={},d="show"===u;s.parent().is(".ui-effects-wrapper")?e.effects.save(s.parent(),o):e.effects.save(s,o),s.show(),v=e.effects.createWrapper(s).css({overflow:"hidden"}),m=v[l](),g=parseFloat(v.css(c))||0,p[l]=d?m:0,h||(s.css(f?"bottom":"right",0).css(f?"top":"left","auto").css({position:"absolute"}),p[c]=d?g:m+g),d&&(v.css(l,0),h||v.css(c,g+m)),v.animate(p,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){"hide"===u&&s.hide(),e.effects.restore(s,o),e.effects.removeWrapper(s),i()}})}}(jQuery),function(e){e.effects.effect.bounce=function(t,n){var m,g,y,r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"effect"),o="hide"===s,u="show"===s,a=t.direction||"up",f=t.distance,l=t.times||5,c=2*l+(u||o?1:0),h=t.duration/c,p=t.easing,d="up"===a||"down"===a?"top":"left",v="up"===a||"left"===a,b=r.queue(),w=b.length;for((u||o)&&i.push("opacity"),e.effects.save(r,i),r.show(),e.effects.createWrapper(r),f||(f=r["top"===d?"outerHeight":"outerWidth"]()/3),u&&(y={opacity:1},y[d]=0,r.css("opacity",0).css(d,v?2*-f:2*f).animate(y,h,p)),o&&(f/=Math.pow(2,l-1)),y={},y[d]=0,m=0;l>m;m++)g={},g[d]=(v?"-=":"+=")+f,r.animate(g,h,p).animate(y,h,p),f=o?2*f:f/2;o&&(g={opacity:0},g[d]=(v?"-=":"+=")+f,r.animate(g,h,p)),r.queue(function(){o&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}),w>1&&b.splice.apply(b,[1,0].concat(b.splice(w,c+1))),r.dequeue()}}(jQuery),function(e){e.effects.effect.clip=function(t,n){var h,p,d,r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o="show"===s,u=t.direction||"vertical",a="vertical"===u,f=a?"height":"width",l=a?"top":"left",c={};e.effects.save(r,i),r.show(),h=e.effects.createWrapper(r).css({overflow:"hidden"}),p="IMG"===r[0].tagName?h:r,d=p[f](),o&&(p.css(f,0),p.css(l,d/2)),c[f]=o?d:0,c[l]=o?0:d/2,p.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){o||r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e){e.effects.effect.drop=function(t,n){var c,r=e(this),i=["position","top","bottom","left","right","opacity","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o="show"===s,u=t.direction||"left",a="up"===u||"down"===u?"top":"left",f="up"===u||"left"===u?"pos":"neg",l={opacity:o?1:0};e.effects.save(r,i),r.show(),e.effects.createWrapper(r),c=t.distance||r["top"===a?"outerHeight":"outerWidth"](!0)/2,o&&r.css("opacity",0).css(a,"pos"===f?-c:c),l[a]=(o?"pos"===f?"+=":"-=":"pos"===f?"-=":"+=")+c,r.animate(l,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===s&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e){e.effects.effect.explode=function(t,n){function y(){c.push(this),c.length===r*i&&b()}function b(){s.css({visibility:"visible"}),e(c).remove(),u||s.hide(),n()}var h,p,d,v,m,g,r=t.pieces?Math.round(Math.sqrt(t.pieces)):3,i=r,s=e(this),o=e.effects.setMode(s,t.mode||"hide"),u="show"===o,a=s.show().css("visibility","hidden").offset(),f=Math.ceil(s.outerWidth()/i),l=Math.ceil(s.outerHeight()/r),c=[];for(h=0;r>h;h++)for(v=a.top+h*l,g=h-(r-1)/2,p=0;i>p;p++)d=a.left+p*f,m=p-(i-1)/2,s.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-p*f,top:-h*l}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:f,height:l,left:d+(u?m*f:0),top:v+(u?g*l:0),opacity:u?0:1}).animate({left:d+(u?0:m*f),top:v+(u?0:g*l),opacity:u?1:0},t.duration||500,t.easing,y)}}(jQuery),function(e){e.effects.effect.fade=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"toggle");r.animate({opacity:i},{queue:!1,duration:t.duration,easing:t.easing,complete:n})}}(jQuery),function(e){e.effects.effect.fold=function(t,n){var d,v,r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o="show"===s,u="hide"===s,a=t.size||15,f=/([0-9]+)%/.exec(a),l=!!t.horizFirst,c=o!==l,h=c?["width","height"]:["height","width"],p=t.duration/2,m={},g={};e.effects.save(r,i),r.show(),d=e.effects.createWrapper(r).css({overflow:"hidden"}),v=c?[d.width(),d.height()]:[d.height(),d.width()],f&&(a=parseInt(f[1],10)/100*v[u?0:1]),o&&d.css(l?{height:0,width:a}:{height:a,width:0}),m[h[0]]=o?v[0]:a,g[h[1]]=o?v[1]:0,d.animate(m,p,t.easing).animate(g,p,t.easing,function(){u&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()})}}(jQuery),function(e){e.effects.effect.highlight=function(t,n){var r=e(this),i=["backgroundImage","backgroundColor","opacity"],s=e.effects.setMode(r,t.mode||"show"),o={backgroundColor:r.css("backgroundColor")};"hide"===s&&(o.opacity=0),e.effects.save(r,i),r.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===s&&r.hide(),e.effects.restore(r,i),n()}})}}(jQuery),function(e){e.effects.effect.pulsate=function(t,n){var p,r=e(this),i=e.effects.setMode(r,t.mode||"show"),s="show"===i,o="hide"===i,u=s||"hide"===i,a=2*(t.times||5)+(u?1:0),f=t.duration/a,l=0,c=r.queue(),h=c.length;for((s||!r.is(":visible"))&&(r.css("opacity",0).show(),l=1),p=1;a>p;p++)r.animate({opacity:l},f,t.easing),l=1-l;r.animate({opacity:l},f,t.easing),r.queue(function(){o&&r.hide(),n()}),h>1&&c.splice.apply(c,[1,0].concat(c.splice(h,a+1))),r.dequeue()}}(jQuery),function(e){e.effects.effect.puff=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"hide"),s="hide"===i,o=parseInt(t.percent,10)||150,u=o/100,a={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:i,complete:n,percent:s?o:100,from:s?a:{height:a.height*u,width:a.width*u,outerHeight:a.outerHeight*u,outerWidth:a.outerWidth*u}}),r.effect(t)},e.effects.effect.scale=function(t,n){var r=e(this),i=e.extend(!0,{},t),s=e.effects.setMode(r,t.mode||"effect"),o=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===s?0:100),u=t.direction||"both",a=t.origin,f={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()},l={y:"horizontal"!==u?o/100:1,x:"vertical"!==u?o/100:1};i.effect="size",i.queue=!1,i.complete=n,"effect"!==s&&(i.origin=a||["middle","center"],i.restore=!0),i.from=t.from||("show"===s?{height:0,width:0,outerHeight:0,outerWidth:0}:f),i.to={height:f.height*l.y,width:f.width*l.x,outerHeight:f.outerHeight*l.y,outerWidth:f.outerWidth*l.x},i.fade&&("show"===s&&(i.from.opacity=0,i.to.opacity=1),"hide"===s&&(i.from.opacity=1,i.to.opacity=0)),r.effect(i)},e.effects.effect.size=function(t,n){var r,i,s,o=e(this),u=["position","top","bottom","left","right","width","height","overflow","opacity"],a=["position","top","bottom","left","right","overflow","opacity"],f=["width","height","overflow"],l=["fontSize"],c=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],h=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(o,t.mode||"effect"),d=t.restore||"effect"!==p,v=t.scale||"both",m=t.origin||["middle","center"],g=o.css("position"),y=d?u:a,b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&o.show(),r={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===t.mode&&"show"===p?(o.from=t.to||b,o.to=t.from||r):(o.from=t.from||("show"===p?b:r),o.to=t.to||("hide"===p?b:r)),s={from:{y:o.from.height/r.height,x:o.from.width/r.width},to:{y:o.to.height/r.height,x:o.to.width/r.width}},("box"===v||"both"===v)&&(s.from.y!==s.to.y&&(y=y.concat(c),o.from=e.effects.setTransition(o,c,s.from.y,o.from),o.to=e.effects.setTransition(o,c,s.to.y,o.to)),s.from.x!==s.to.x&&(y=y.concat(h),o.from=e.effects.setTransition(o,h,s.from.x,o.from),o.to=e.effects.setTransition(o,h,s.to.x,o.to))),("content"===v||"both"===v)&&s.from.y!==s.to.y&&(y=y.concat(l).concat(f),o.from=e.effects.setTransition(o,l,s.from.y,o.from),o.to=e.effects.setTransition(o,l,s.to.y,o.to)),e.effects.save(o,y),o.show(),e.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),m&&(i=e.effects.getBaseline(m,r),o.from.top=(r.outerHeight-o.outerHeight())*i.y,o.from.left=(r.outerWidth-o.outerWidth())*i.x,o.to.top=(r.outerHeight-o.to.outerHeight)*i.y,o.to.left=(r.outerWidth-o.to.outerWidth)*i.x),o.css(o.from),("content"===v||"both"===v)&&(c=c.concat(["marginTop","marginBottom"]).concat(l),h=h.concat(["marginLeft","marginRight"]),f=u.concat(c).concat(h),o.find("*[width]").each(function(){var n=e(this),r={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()};d&&e.effects.save(n,f),n.from={height:r.height*s.from.y,width:r.width*s.from.x,outerHeight:r.outerHeight*s.from.y,outerWidth:r.outerWidth*s.from.x},n.to={height:r.height*s.to.y,width:r.width*s.to.x,outerHeight:r.height*s.to.y,outerWidth:r.width*s.to.x},s.from.y!==s.to.y&&(n.from=e.effects.setTransition(n,c,s.from.y,n.from),n.to=e.effects.setTransition(n,c,s.to.y,n.to)),s.from.x!==s.to.x&&(n.from=e.effects.setTransition(n,h,s.from.x,n.from),n.to=e.effects.setTransition(n,h,s.to.x,n.to)),n.css(n.from),n.animate(n.to,t.duration,t.easing,function(){d&&e.effects.restore(n,f)})})),o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===p&&o.hide(),e.effects.restore(o,y),d||("static"===g?o.css({position:"relative",top:o.to.top,left:o.to.left}):e.each(["top","left"],function(e,t){o.css(t,function(t,n){var r=parseInt(n,10),i=e?o.to.left:o.to.top;return"auto"===n?i+"px":r+i+"px"})})),e.effects.removeWrapper(o),n()}})}}(jQuery),function(e){e.effects.effect.shake=function(t,n){var m,r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"effect"),o=t.direction||"left",u=t.distance||20,a=t.times||3,f=2*a+1,l=Math.round(t.duration/f),c="up"===o||"down"===o?"top":"left",h="up"===o||"left"===o,p={},d={},v={},g=r.queue(),y=g.length;for(e.effects.save(r,i),r.show(),e.effects.createWrapper(r),p[c]=(h?"-=":"+=")+u,d[c]=(h?"+=":"-=")+2*u,v[c]=(h?"-=":"+=")+2*u,r.animate(p,l,t.easing),m=1;a>m;m++)r.animate(d,l,t.easing).animate(v,l,t.easing);r.animate(d,l,t.easing).animate(p,l/2,t.easing).queue(function(){"hide"===s&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}),y>1&&g.splice.apply(g,[1,0].concat(g.splice(y,f+1))),r.dequeue()}}(jQuery),function(e){e.effects.effect.slide=function(t,n){var l,r=e(this),i=["position","top","bottom","left","right","width","height"],s=e.effects.setMode(r,t.mode||"show"),o="show"===s,u=t.direction||"left",a="up"===u||"down"===u?"top":"left",f="up"===u||"left"===u,c={};e.effects.save(r,i),r.show(),l=t.distance||r["top"===a?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(r).css({overflow:"hidden"}),o&&r.css(a,f?isNaN(l)?"-"+l:-l:l),c[a]=(o?f?"+=":"-=":f?"-=":"+=")+l,r.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===s&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e){e.effects.effect.transfer=function(t,n){var r=e(this),i=e(t.to),s="fixed"===i.css("position"),o=e("body"),u=s?o.scrollTop():0,a=s?o.scrollLeft():0,f=i.offset(),l={top:f.top-u,left:f.left-a,height:i.innerHeight(),width:i.innerWidth()},c=r.offset(),h=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:c.top-u,left:c.left-a,height:r.innerHeight(),width:r.innerWidth(),position:s?"fixed":"absolute"}).animate(l,t.duration,t.easing,function(){h.remove(),n()})}}(jQuery),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function z(d){var l,e=this,f=d.elements.tooltip,g=d.options.content.ajax,h=".qtip-ajax",i=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,k=c;
d.checks.ajax={"^content.ajax":function(a,b,c){"ajax"===b&&(g=c),"once"===b?e.init():g&&g.url?e.load():f.unbind(h)}},a.extend(e,{init:function(){return g&&g.url&&f.unbind(h)[g.once?"one":"bind"]("tooltipshow"+h,e.load),e},load:function(b,f){function r(a,b,c){!k&&0!==a.status&&d.set("content.text",b+": "+c)}function q(b){k||(m&&(b=a("<div/>").append(b.replace(i,"")).find(m)),d.set("content.text",b))}function p(){k||(n&&(d.show(b.originalEvent),f=c),a.isFunction(g.complete)&&g.complete.apply(this,arguments))}var m,h=g.url.indexOf(" "),j=g.url,n=g.once&&!g.loading&&f;if(n)try{b.preventDefault()}catch(o){}else if(b&&b.isDefaultPrevented())return e;l&&l.abort&&l.abort(),h>-1&&(m=j.substr(h),j=j.substr(0,h)),l=a.ajax(a.extend({success:q,error:r,context:d},g,{url:j,complete:p}))},destroy:function(){l&&l.abort&&l.abort(),k=b}}),e.init()}function y(e,h){var i,j,k,l,m,n=a(this),o=a(document.body),p=this===document?o:n,q=n.metadata?n.metadata(h.metadata):d,r="html5"===h.metadata.type&&q?q[h.metadata.name]:d,s=n.data(h.metadata.name||"qtipopts");try{s="string"==typeof s?new Function("return "+s)():s}catch(u){v("Unable to parse HTML5 attribute data: "+s)}if(l=a.extend(b,{},f.defaults,h,"object"==typeof s?w(s):d,w(r||q)),j=l.position,l.id=e,"boolean"==typeof l.content.text){if(k=n.attr(l.content.attr),l.content.attr===c||!k)return v("Unable to locate content for tooltip! Aborting render of tooltip on element: ",n),c;l.content.text=k}if(j.container.length||(j.container=o),j.target===c&&(j.target=p),l.show.target===c&&(l.show.target=p),l.show.solo===b&&(l.show.solo=j.container.closest("body")),l.hide.target===c&&(l.hide.target=p),l.position.viewport===b&&(l.position.viewport=j.container),j.container=j.container.eq(0),j.at=new g.Corner(j.at),j.my=new g.Corner(j.my),a.data(this,"qtip"))if(l.overwrite)n.qtip("destroy");else if(l.overwrite===c)return c;return l.suppress&&(m=a.attr(this,"title"))&&a(this).removeAttr("title").attr(t,m),i=new x(n,l,e,!!k),a.data(this,"qtip",i),n.bind("remove.qtip-"+e+" removeqtip.qtip-"+e,function(){i.destroy()}),i}function x(r,s,v,x){function Q(){var b=[s.show.target[0],s.hide.target[0],y.rendered&&F.tooltip[0],s.position.container[0],s.position.viewport[0],window,document];y.rendered?a([]).pushStack(a.grep(b,function(a){return"object"==typeof a})).unbind(E):s.show.target.unbind(E+"-create")}function P(){function o(a){D.is(":visible")&&y.reposition(a)}function n(a){return D.hasClass(l)?c:(clearTimeout(y.timers.inactive),void(y.timers.inactive=setTimeout(function(){y.hide(a)},s.hide.inactive)))}function k(b){if(D.hasClass(l)||B||C)return c;var f=a(b.relatedTarget||b.target),g=f.closest(m)[0]===D[0],h=f[0]===e.show[0];if(clearTimeout(y.timers.show),clearTimeout(y.timers.hide),"mouse"===d.target&&g||s.hide.fixed&&/mouse(out|leave|move)/.test(b.type)&&(g||h))try{b.preventDefault(),b.stopImmediatePropagation()}catch(i){}else s.hide.delay>0?y.timers.hide=setTimeout(function(){y.hide(b)},s.hide.delay):y.hide(b)}function j(a){if(D.hasClass(l))return c;clearTimeout(y.timers.show),clearTimeout(y.timers.hide);var d=function(){y.toggle(b,a)};s.show.delay>0?y.timers.show=setTimeout(d,s.show.delay):d()}var d=s.position,e={show:s.show.target,hide:s.hide.target,viewport:a(d.viewport),document:a(document),body:a(document.body),window:a(window)},g={show:a.trim(""+s.show.event).split(" "),hide:a.trim(""+s.hide.event).split(" ")},i=a.browser.msie&&6===parseInt(a.browser.version,10);D.bind("mouseenter"+E+" mouseleave"+E,function(a){var b="mouseenter"===a.type;b&&y.focus(a),D.toggleClass(p,b)}),s.hide.fixed&&(e.hide=e.hide.add(D),D.bind("mouseover"+E,function(){D.hasClass(l)||clearTimeout(y.timers.hide)})),/mouse(out|leave)/i.test(s.hide.event)?"window"===s.hide.leave&&e.window.bind("mouseout"+E+" blur"+E,function(a){/select|option/.test(a.target)&&!a.relatedTarget&&y.hide(a)}):/mouse(over|enter)/i.test(s.show.event)&&e.hide.bind("mouseleave"+E,function(){clearTimeout(y.timers.show)}),(""+s.hide.event).indexOf("unfocus")>-1&&d.container.closest("html").bind("mousedown"+E,function(b){var c=a(b.target),e=(!D.hasClass(l)&&D.is(":visible"),c.parents(m).filter(D[0]).length>0);c[0]!==r[0]&&c[0]!==D[0]&&!e&&!r.has(c[0]).length&&!c.attr("disabled")&&y.hide(b)}),"number"==typeof s.hide.inactive&&(e.show.bind("qtip-"+v+"-inactive",n),a.each(f.inactiveEvents,function(a,b){e.hide.add(F.tooltip).bind(b+E+"-inactive",n)})),a.each(g.hide,function(b,c){var d=a.inArray(c,g.show),f=a(e.hide);d>-1&&f.add(e.show).length===f.length||"unfocus"===c?(e.show.bind(c+E,function(a){D.is(":visible")?k(a):j(a)}),delete g.show[d]):e.hide.bind(c+E,k)}),a.each(g.show,function(a,b){e.show.bind(b+E,j)}),"number"==typeof s.hide.distance&&e.show.add(D).bind("mousemove"+E,function(a){var b=G.origin||{},c=s.hide.distance,d=Math.abs;(d(a.pageX-b.pageX)>=c||d(a.pageY-b.pageY)>=c)&&y.hide(a)}),"mouse"===d.target&&(e.show.bind("mousemove"+E,function(a){h={pageX:a.pageX,pageY:a.pageY,type:"mousemove"}}),d.adjust.mouse&&(s.hide.event&&(D.bind("mouseleave"+E,function(a){(a.relatedTarget||a.target)!==e.show[0]&&y.hide(a)}),F.target.bind("mouseenter"+E+" mouseleave"+E,function(a){G.onTarget="mouseenter"===a.type})),e.document.bind("mousemove"+E,function(a){G.onTarget&&!D.hasClass(l)&&D.is(":visible")&&y.reposition(a||h)}))),(d.adjust.resize||e.viewport.length)&&(a.event.special.resize?e.viewport:e.window).bind("resize"+E,o),(e.viewport.length||i&&"fixed"===D.css("position"))&&e.viewport.bind("scroll"+E,o)}function O(b,d){function g(b){function i(e){e&&(delete h[e.src],clearTimeout(y.timers.img[e.src]),a(e).unbind(E)),a.isEmptyObject(h)&&(y.redraw(),d!==c&&y.reposition(G.event),b())}var g,h={};return 0===(g=f.find("img[src]:not([height]):not([width])")).length?i():void g.each(function(b,c){if(h[c.src]===e){var d=0,f=3;!function g(){return c.height||c.width||d>f?i(c):(d+=1,void(y.timers.img[c.src]=setTimeout(g,700)))}(),a(c).bind("error"+E+" load"+E,function(){i(this)}),h[c.src]=c}})}var f=F.content;return y.rendered&&b?(a.isFunction(b)&&(b=b.call(r,G.event,y)||""),b.jquery&&b.length>0?f.empty().append(b.css({display:"block"})):f.html(b),y.rendered<0?D.queue("fx",g):(C=0,g(a.noop)),y):c}function N(b,d){var e=F.title;return y.rendered&&b?(a.isFunction(b)&&(b=b.call(r,G.event,y)),b===c||!b&&""!==b?J(c):(b.jquery&&b.length>0?e.empty().append(b.css({display:"block"})):e.html(b),y.redraw(),d!==c&&y.rendered&&D.is(":visible")&&y.reposition(G.event),void 0)):c}function M(a){var b=F.button,d=F.title;return y.rendered?void(a?(d||L(),K()):b.remove()):c}function L(){var c=A+"-title";F.titlebar&&J(),F.titlebar=a("<div />",{"class":j+"-titlebar "+(s.style.widget?"ui-widget-header":"")}).append(F.title=a("<div />",{id:c,"class":j+"-title","aria-atomic":b})).insertBefore(F.content).delegate(".ui-tooltip-close","mousedown keydown mouseup keyup mouseout",function(b){a(this).toggleClass("ui-state-active ui-state-focus","down"===b.type.substr(-4))}).delegate(".ui-tooltip-close","mouseover mouseout",function(b){a(this).toggleClass("ui-state-hover","mouseover"===b.type)}),s.content.title.button?K():y.rendered&&y.redraw()}function K(){var b=s.content.title.button,d="string"==typeof b,e=d?b:"Close tooltip";F.button&&F.button.remove(),F.button=b.jquery?b:a("<a />",{"class":"ui-state-default ui-tooltip-close "+(s.style.widget?"":j+"-icon"),title:e,"aria-label":e}).prepend(a("<span />",{"class":"ui-icon ui-icon-close",html:"&times;"})),F.button.appendTo(F.titlebar).attr("role","button").click(function(a){return D.hasClass(l)||y.hide(a),c}),y.redraw()}function J(a){F.title&&(F.titlebar.remove(),F.titlebar=F.title=F.button=d,a!==c&&y.reposition())}function I(){var a=s.style.widget;D.toggleClass(k,a).toggleClass(n,s.style.def&&!a),F.content.toggleClass(k+"-content",a),F.titlebar&&F.titlebar.toggleClass(k+"-header",a),F.button&&F.button.toggleClass(j+"-icon",!a)}function H(a){for(var c,b=0,d=s,e=a.split(".");d=d[e[b++]];)b<e.length&&(c=d);return[c||s,e.pop()]}var F,G,y=this,z=document.body,A=j+"-"+v,B=0,C=0,D=a(),E=".qtip-"+v;y.id=v,y.rendered=c,y.elements=F={target:r},y.timers={img:{}},y.options=s,y.checks={},y.plugins={},y.cache=G={event:{},target:a(),disabled:c,attr:x,onTarget:c},y.checks.builtin={"^id$":function(d,e,g){var h=g===b?f.nextid:g,i=j+"-"+h;h!==c&&h.length>0&&!a("#"+i).length&&(D[0].id=i,F.content[0].id=i+"-content",F.title[0].id=i+"-title")},"^content.text$":function(a,b,c){O(c)},"^content.title.text$":function(a,b,c){return c?(!F.title&&c&&L(),void N(c)):J()},"^content.title.button$":function(a,b,c){M(c)},"^position.(my|at)$":function(a,b,c){"string"==typeof c&&(a[b]=new g.Corner(c))},"^position.container$":function(a,b,c){y.rendered&&D.appendTo(c)},"^show.ready$":function(){y.rendered?y.toggle(b):y.render(1)},"^style.classes$":function(a,b,c){D.attr("class",j+" qtip ui-helper-reset "+c)},"^style.widget|content.title":I,"^events.(render|show|move|hide|focus|blur)$":function(b,c,d){D[(a.isFunction(d)?"":"un")+"bind"]("tooltip"+c,d)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){var a=s.position;D.attr("tracking","mouse"===a.target&&a.adjust.mouse),Q(),P()}},a.extend(y,{render:function(d){if(y.rendered)return y;var e=s.content.text,f=s.content.title.text,h=s.position,i=a.Event("tooltiprender");return a.attr(r[0],"aria-describedby",A),D=F.tooltip=a("<div/>",{id:A,"class":j+" qtip ui-helper-reset "+n+" "+s.style.classes+" "+j+"-pos-"+s.position.my.abbrev(),width:s.style.width||"",height:s.style.height||"",tracking:"mouse"===h.target&&h.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":c,"aria-describedby":A+"-content","aria-hidden":b}).toggleClass(l,G.disabled).data("qtip",y).appendTo(s.position.container).append(F.content=a("<div />",{"class":j+"-content",id:A+"-content","aria-atomic":b})),y.rendered=-1,B=C=1,f&&(L(),a.isFunction(f)||N(f,c)),a.isFunction(e)||O(e,c),y.rendered=b,I(),a.each(s.events,function(b,c){a.isFunction(c)&&D.bind("toggle"===b?"tooltipshow tooltiphide":"tooltip"+b,c)}),a.each(g,function(){"render"===this.initialize&&this(y)}),P(),D.queue("fx",function(a){i.originalEvent=G.event,D.trigger(i,[y]),B=C=0,y.redraw(),(s.show.ready||d)&&y.toggle(b,G.event,c),a()}),y},get:function(a){var b,c;switch(a.toLowerCase()){case"dimensions":b={height:D.outerHeight(),width:D.outerWidth()};break;case"offset":b=g.offset(D,s.position.container);break;default:c=H(a.toLowerCase()),b=c[0][c[1]],b=b.precedance?b.string():b}return b},set:function(e,f){function m(a,b){var c,d,e;for(c in k)for(d in k[c])(e=new RegExp(d,"i").exec(a))&&(b.push(e),k[c][d].apply(y,b))}var l,g=/^position\.(my|at|adjust|target|container)|style|content|show\.ready/i,h=/^content\.(title|attr)|style/i,i=c,j=c,k=y.checks;return"string"==typeof e?(l=e,e={},e[l]=f):e=a.extend(b,{},e),a.each(e,function(b,c){var f,d=H(b.toLowerCase());f=d[0][d[1]],d[0][d[1]]="object"==typeof c&&c.nodeType?a(c):c,e[b]=[d[0],d[1],c,f],i=g.test(b)||i,j=h.test(b)||j}),w(s),B=C=1,a.each(e,m),B=C=0,D.is(":visible")&&y.rendered&&(i&&y.reposition("mouse"===s.position.target?d:G.event),j&&y.redraw()),y},toggle:function(e,f){function r(){e?(a.browser.msie&&D[0].style.removeAttribute("filter"),D.css("overflow",""),"string"==typeof i.autofocus&&a(i.autofocus,D).focus(),i.target.trigger("qtip-"+v+"-inactive")):D.css({display:"",visibility:"",opacity:"",left:"",top:""}),q=a.Event("tooltip"+(e?"visible":"hidden")),q.originalEvent=f?G.event:d,D.trigger(q,[y])}if(!y.rendered)return e?y.render(1):y;var q,g=e?"show":"hide",i=s[g],j=D.is(":visible"),k=!f||i.target.length<2||G.target[0]===f.target,l=f&&i.target.add(f.target).length!==i.target.length,n=s.position,o=s.content;if((typeof e).search("boolean|number")&&(e=!j),!D.is(":animated")&&j===e&&k)return y;if(f){if(/over|enter/.test(f.type)&&/out|leave/.test(G.event.type)&&s.show.target.add(f.target).length===s.show.target.length&&D.has(f.relatedTarget).length)return y;G.event=a.extend({},f)}return q=a.Event("tooltip"+g),q.originalEvent=f?G.event:d,D.trigger(q,[y,90]),q.isDefaultPrevented()?y:(a.attr(D[0],"aria-hidden",!e),e?(G.origin=a.extend({},h),y.focus(f),a.isFunction(o.text)&&O(o.text,c),a.isFunction(o.title.text)&&N(o.title.text,c),!u&&"mouse"===n.target&&n.adjust.mouse&&(a(document).bind("mousemove.qtip",function(a){h={pageX:a.pageX,pageY:a.pageY,type:"mousemove"}}),u=b),y.reposition(f,arguments[2]),(q.solo=!!i.solo)&&a(m,i.solo).not(D).qtip("hide",q)):(clearTimeout(y.timers.show),delete G.origin,u&&!a(m+'[tracking="true"]:visible',i.solo).not(D).length&&(a(document).unbind("mousemove.qtip"),u=c),y.blur(f)),D.stop(l,!l),i.effect===c?(D[g](),r.call(D)):a.isFunction(i.effect)?(i.effect.call(D,y),D.queue("fx",function(a){r(),a()})):D.fadeTo(90,e?1:0,r),e&&i.target.trigger("qtip-"+v+"-inactive"),y)},show:function(a){return y.toggle(b,a)},hide:function(a){return y.toggle(c,a)},focus:function(b){if(!y.rendered)return y;var i,c=a(m),d=parseInt(D[0].style.zIndex,10),e=f.zindex+c.length,g=a.extend({},b);return D.hasClass(o)||(i=a.Event("tooltipfocus"),i.originalEvent=g,D.trigger(i,[y,e]),i.isDefaultPrevented()||(d!==e&&(c.each(function(){this.style.zIndex>d&&(this.style.zIndex=this.style.zIndex-1)}),c.filter("."+o).qtip("blur",g)),D.addClass(o)[0].style.zIndex=e)),y},blur:function(b){var d,c=a.extend({},b);return D.removeClass(o),d=a.Event("tooltipblur"),d.originalEvent=c,D.trigger(d,[y]),y},reposition:function(b,d){if(!y.rendered||B)return y;B=1;var E,e=s.position.target,f=s.position,i=f.my,k=f.at,l=f.adjust,m=l.method.split(" "),n=D.outerWidth(),o=D.outerHeight(),p=0,q=0,r=a.Event("tooltipmove"),t="fixed"===D.css("position"),u=f.viewport,v={left:0,top:0},w=f.container,x=c,A=y.plugins.tip,C={horizontal:m[0],vertical:m[1]=m[1]||m[0],enabled:u.jquery&&e[0]!==window&&e[0]!==z&&"none"!==l.method,left:function(a){var b="shift"===C.horizontal,c=-w.offset.left+u.offset.left+u.scrollLeft,d="left"===i.x?n:"right"===i.x?-n:-n/2,e="left"===k.x?p:"right"===k.x?-p:-p/2,f=A&&A.size?A.size.width||0:0,g=A&&A.corner&&"x"===A.corner.precedance&&!b?f:0,h=c-a+g,j=a+n-u.width-c+g,m=d-("x"===i.precedance||i.x===i.y?e:0)-("center"===k.x?p/2:0),o="center"===i.x;return b?(g=A&&A.corner&&"y"===A.corner.precedance?f:0,m=("left"===i.x?1:-1)*d-g,v.left+=h>0?h:j>0?-j:0,v.left=Math.max(-w.offset.left+u.offset.left+(g&&"center"===A.corner.x?A.offset:0),a-m,Math.min(Math.max(-w.offset.left+u.offset.left+u.width,a+m),v.left))):(h>0&&("left"!==i.x||j>0)?v.left-=m:j>0&&("right"!==i.x||h>0)&&(v.left-=o?-m:m),v.left!==a&&o&&(v.left-=l.x),v.left<c&&-v.left>j&&(v.left=a)),v.left-a},top:function(a){var b="shift"===C.vertical,c=-w.offset.top+u.offset.top+u.scrollTop,d="top"===i.y?o:"bottom"===i.y?-o:-o/2,e="top"===k.y?q:"bottom"===k.y?-q:-q/2,f=A&&A.size?A.size.height||0:0,g=A&&A.corner&&"y"===A.corner.precedance&&!b?f:0,h=c-a+g,j=a+o-u.height-c+g,m=d-("y"===i.precedance||i.x===i.y?e:0)-("center"===k.y?q/2:0),n="center"===i.y;return b?(g=A&&A.corner&&"x"===A.corner.precedance?f:0,m=("top"===i.y?1:-1)*d-g,v.top+=h>0?h:j>0?-j:0,v.top=Math.max(-w.offset.top+u.offset.top+(g&&"center"===A.corner.x?A.offset:0),a-m,Math.min(Math.max(-w.offset.top+u.offset.top+u.height,a+m),v.top))):(h>0&&("top"!==i.y||j>0)?v.top-=m:j>0&&("bottom"!==i.y||h>0)&&(v.top-=n?-m:m),v.top!==a&&n&&(v.top-=l.y),v.top<0&&-v.top>j&&(v.top=a)),v.top-a}};if(a.isArray(e)&&2===e.length)k={x:"left",y:"top"},v={left:e[0],top:e[1]};else if("mouse"===e&&(b&&b.pageX||G.event.pageX))k={x:"left",y:"top"},b=(!b||"resize"!==b.type&&"scroll"!==b.type?b&&b.pageX&&"mousemove"===b.type?b:!h||!h.pageX||!l.mouse&&b&&b.pageX?!l.mouse&&G.origin&&G.origin.pageX&&s.show.distance?G.origin:b:{pageX:h.pageX,pageY:h.pageY}:G.event)||b||G.event||h||{},v={top:b.pageY,left:b.pageX};else{if(e="event"===e?b&&b.target&&"scroll"!==b.type&&"resize"!==b.type?G.target=a(b.target):G.target:G.target=a(e.jquery?e:F.target),e=a(e).eq(0),0===e.length)return y;e[0]===document||e[0]===window?(p=g.iOS?window.innerWidth:e.width(),q=g.iOS?window.innerHeight:e.height(),e[0]===window&&(v={top:(u||e).scrollTop(),left:(u||e).scrollLeft()})):e.is("area")&&g.imagemap?v=g.imagemap(e,k,C.enabled?m:c):"http://www.w3.org/2000/svg"===e[0].namespaceURI&&g.svg?v=g.svg(e,k):(p=e.outerWidth(),q=e.outerHeight(),v=g.offset(e,w)),v.offset&&(p=v.width,q=v.height,x=v.flipoffset,v=v.offset),(g.iOS<4.1&&g.iOS>3.1||4.3==g.iOS||!g.iOS&&t)&&(E=a(window),v.left-=E.scrollLeft(),v.top-=E.scrollTop()),v.left+="right"===k.x?p:"center"===k.x?p/2:0,v.top+="bottom"===k.y?q:"center"===k.y?q/2:0}return v.left+=l.x+("right"===i.x?-n:"center"===i.x?-n/2:0),v.top+=l.y+("bottom"===i.y?-o:"center"===i.y?-o/2:0),C.enabled?(u={elem:u,height:u[(u[0]===window?"h":"outerH")+"eight"](),width:u[(u[0]===window?"w":"outerW")+"idth"](),scrollLeft:t?0:u.scrollLeft(),scrollTop:t?0:u.scrollTop(),offset:u.offset()||{left:0,top:0}},w={elem:w,scrollLeft:w.scrollLeft(),scrollTop:w.scrollTop(),offset:w.offset()||{left:0,top:0}},v.adjusted={left:"none"!==C.horizontal?C.left(v.left):0,top:"none"!==C.vertical?C.top(v.top):0},v.adjusted.left+v.adjusted.top&&D.attr("class",D[0].className.replace(/ui-tooltip-pos-\w+/i,j+"-pos-"+i.abbrev())),x&&v.adjusted.left&&(v.left+=x.left),x&&v.adjusted.top&&(v.top+=x.top)):v.adjusted={left:0,top:0},r.originalEvent=a.extend({},b),D.trigger(r,[y,v,u.elem||u]),r.isDefaultPrevented()?y:(delete v.adjusted,d===c||isNaN(v.left)||isNaN(v.top)||"mouse"===e||!a.isFunction(f.effect)?D.css(v):a.isFunction(f.effect)&&(f.effect.call(D,y,a.extend({},v)),D.queue(function(b){a(this).css({opacity:"",height:""}),a.browser.msie&&this.style.removeAttribute("filter"),b()})),B=0,y)},redraw:function(){if(y.rendered<1||C)return y;var b,c,d,e,a=s.position.container;return C=1,s.style.height&&D.css("height",s.style.height),s.style.width?D.css("width",s.style.width):(D.css("width","").addClass(q),c=D.width()+1,d=D.css("max-width")||"",e=D.css("min-width")||"",b=(d+e).indexOf("%")>-1?a.width()/100:0,d=(d.indexOf("%")>-1?b:1)*parseInt(d,10)||c,e=(e.indexOf("%")>-1?b:1)*parseInt(e,10)||0,c=d+e?Math.min(Math.max(c,e),d):c,D.css("width",Math.round(c)).removeClass(q)),C=0,y},disable:function(b){return"boolean"!=typeof b&&(b=!D.hasClass(l)&&!G.disabled),y.rendered?(D.toggleClass(l,b),a.attr(D[0],"aria-disabled",b)):G.disabled=!!b,y},enable:function(){return y.disable(c)},destroy:function(){var b=r[0],c=a.attr(b,t),d=r.data("qtip");return y.rendered&&(D.stop(1,0).remove(),a.each(y.plugins,function(){this.destroy&&this.destroy()})),clearTimeout(y.timers.show),clearTimeout(y.timers.hide),Q(),d&&y!==d||(a.removeData(b,"qtip"),s.suppress&&c&&(a.attr(b,"title",c),r.removeAttr(t)),r.removeAttr("aria-describedby")),r.unbind(".qtip-"+v),delete i[y.id],r}})}function w(b){var e;return b&&"object"==typeof b?((b.metadata===d||"object"!=typeof b.metadata)&&(b.metadata={type:b.metadata}),"content"in b&&((b.content===d||"object"!=typeof b.content||b.content.jquery)&&(b.content={text:b.content}),e=b.content.text||c,!a.isFunction(e)&&(!e&&!e.attr||e.length<1||"object"==typeof e&&!e.jquery)&&(b.content.text=c),"title"in b.content&&((b.content.title===d||"object"!=typeof b.content.title)&&(b.content.title={text:b.content.title}),e=b.content.title.text||c,!a.isFunction(e)&&(!e&&!e.attr||e.length<1||"object"==typeof e&&!e.jquery)&&(b.content.title.text=c))),"position"in b&&(b.position===d||"object"!=typeof b.position)&&(b.position={my:b.position,at:b.position}),"show"in b&&(b.show===d||"object"!=typeof b.show)&&(b.show=b.show.jquery?{target:b.show}:{event:b.show}),"hide"in b&&(b.hide===d||"object"!=typeof b.hide)&&(b.hide=b.hide.jquery?{target:b.hide}:{event:b.hide}),"style"in b&&(b.style===d||"object"!=typeof b.style)&&(b.style={classes:b.style}),a.each(g,function(){this.sanitize&&this.sanitize(b)}),b):c}function v(){if(v.history=v.history||[],v.history.push(arguments),"object"==typeof console){var c,a=console[console.warn?"warn":"log"],b=Array.prototype.slice.call(arguments);"string"==typeof arguments[0]&&(b[0]="qTip2: "+b[0]),c=a.apply?a.apply(console,b):a(b)}}var e,f,g,h,u,b=!0,c=!1,d=null,i={},j="ui-tooltip",k="ui-widget",l="ui-state-disabled",m="div.qtip."+j,n=j+"-default",o=j+"-focus",p=j+"-hover",q=j+"-fluid",s="_replacedByqTip",t="oldtitle";f=a.fn.qtip=function(g,h,i){var j=(""+g).toLowerCase(),k=d,l=a.makeArray(arguments).slice(1),m=l[l.length-1],n=this[0]?a.data(this[0],"qtip"):d;return!arguments.length&&n||"api"===j?n:"string"==typeof g?(this.each(function(){var d=a.data(this,"qtip");if(!d)return b;if(m&&m.timeStamp&&(d.cache.event=m),"option"!==j&&"options"!==j||!h)d[j]&&d[j].apply(d[j],l);else{if(!a.isPlainObject(h)&&i===e)return k=d.get(h),c;d.set(h,i)}}),k!==d?k:this):"object"!=typeof g&&arguments.length?void 0:(n=w(a.extend(b,{},g)),f.bind.call(this,n,m))},f.bind=function(d,j){return this.each(function(k){function r(b){function d(){p.render("object"==typeof b||l.show.ready),m.show.add(m.hide).unbind(o)}return p.cache.disabled?c:(p.cache.event=a.extend({},b),p.cache.target=b?a(b.target):[e],l.show.delay>0?(clearTimeout(p.timers.show),p.timers.show=setTimeout(d,l.show.delay),n.show!==n.hide&&m.hide.bind(n.hide,function(){clearTimeout(p.timers.show)})):d(),void 0)}var l,m,n,o,p,q;return q=a.isArray(d.id)?d.id[k]:d.id,q=!q||q===c||q.length<1||i[q]?f.nextid++:i[q]=q,o=".qtip-"+q+"-create",p=y.call(this,q,d),p===c?b:(l=p.options,a.each(g,function(){"initialize"===this.initialize&&this(p)}),m={show:l.show.target,hide:l.hide.target},n={show:a.trim(""+l.show.event).replace(/ /g,o+" ")+o,hide:a.trim(""+l.hide.event).replace(/ /g,o+" ")+o},/mouse(over|enter)/i.test(n.show)&&!/mouse(out|leave)/i.test(n.hide)&&(n.hide+=" mouseleave"+o),m.show.bind("mousemove"+o,function(a){h={pageX:a.pageX,pageY:a.pageY,type:"mousemove"},p.cache.onTarget=b}),m.show.bind(n.show,r),(l.show.ready||l.prerender)&&r(j),void 0)})},g=f.plugins={Corner:function(a){a=(""+a).replace(/([A-Z])/," $1").replace(/middle/gi,"center").toLowerCase(),this.x=(a.match(/left|right/i)||a.match(/center/)||["inherit"])[0].toLowerCase(),this.y=(a.match(/top|bottom|center/i)||["inherit"])[0].toLowerCase();var b=a.charAt(0);this.precedance="t"===b||"b"===b?"y":"x",this.string=function(){return"y"===this.precedance?this.y+this.x:this.x+this.y},this.abbrev=function(){var a=this.x.substr(0,1),b=this.y.substr(0,1);return a===b?a:"c"===a||"c"!==a&&"c"!==b?b+a:a+b},this.clone=function(){return{x:this.x,y:this.y,precedance:this.precedance,string:this.string,abbrev:this.abbrev,clone:this.clone}}},offset:function(b,c){function j(a,b){d.left+=b*a.scrollLeft(),d.top+=b*a.scrollTop()}var g,h,i,d=b.offset(),e=b.closest("body")[0],f=c;if(f){do"static"!==f.css("position")&&(h=f.position(),d.left-=h.left+(parseInt(f.css("borderLeftWidth"),10)||0)+(parseInt(f.css("marginLeft"),10)||0),d.top-=h.top+(parseInt(f.css("borderTopWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0),!g&&"hidden"!==(i=f.css("overflow"))&&"visible"!==i&&(g=f));while((f=a(f[0].offsetParent)).length);g&&g[0]!==e&&j(g,1)}return d},iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,3})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_","."))||c,fn:{attr:function(b,c){if(this.length){var d=this[0],e="title",f=a.data(d,"qtip");if(b===e&&f&&"object"==typeof f&&f.options.suppress)return arguments.length<2?a.attr(d,t):(f&&f.options.content.attr===e&&f.cache.attr&&f.set("content.text",c),this.attr(t,c))}return a.fn["attr"+s].apply(this,arguments)},clone:function(b){var e=(a([]),a.fn["clone"+s].apply(this,arguments));return b||e.filter("["+t+"]").attr("title",function(){return a.attr(this,t)}).removeAttr(t),e}}},a.each(g.fn,function(c,d){if(!d||a.fn[c+s])return b;var e=a.fn[c+s]=a.fn[c];a.fn[c]=function(){return d.apply(this,arguments)||e.apply(this,arguments)}}),a.ui||(a["cleanData"+s]=a.cleanData,a.cleanData=function(b){for(var d,c=0;(d=b[c])!==e;c++)try{a(d).triggerHandler("removeqtip")}catch(f){}a["cleanData"+s](b)}),f.version="nightly",f.nextid=0,f.inactiveEvents="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" "),f.zindex=15e3,f.defaults={prerender:c,id:c,overwrite:b,suppress:b,content:{text:b,attr:"title",title:{text:c,button:c}},position:{my:"top left",at:"bottom right",target:c,container:c,viewport:c,adjust:{x:0,y:0,mouse:b,resize:b,method:"flip flip"},effect:function(b,d){a(this).animate(d,{duration:200,queue:c})}},show:{target:c,event:"mouseenter",effect:b,delay:90,solo:c,ready:c,autofocus:c},hide:{target:c,event:"mouseleave",effect:b,delay:0,fixed:c,inactive:c,leave:"window",distance:c},style:{classes:"",widget:c,width:c,height:c,def:b},events:{render:d,move:d,show:d,hide:d,toggle:d,visible:d,hidden:d,focus:d,blur:d}},g.ajax=function(a){var b=a.plugins.ajax;return"object"==typeof b?b:a.plugins.ajax=new z(a)},g.ajax.initialize="render",g.ajax.sanitize=function(a){var c,b=a.content;b&&"ajax"in b&&(c=b.ajax,"object"!=typeof c&&(c=a.content.ajax={url:c}),"boolean"!=typeof c.once&&c.once&&(c.once=!!c.once))},a.extend(b,f.defaults,{content:{ajax:{loading:b,once:b}}})});var swfobject=function(){function f(){if(!J){try{var Z=j.getElementsByTagName("body")[0].appendChild(C("span"));Z.parentNode.removeChild(Z)}catch(aa){return}J=!0;for(var X=U.length,Y=0;X>Y;Y++)U[Y]()}}function K(X){J?X():U[U.length]=X}function s(Y){if(typeof O.addEventListener!=D)O.addEventListener("load",Y,!1);else if(typeof j.addEventListener!=D)j.addEventListener("load",Y,!1);else if(typeof O.attachEvent!=D)i(O,"onload",Y);else if("function"==typeof O.onload){var X=O.onload;O.onload=function(){X(),Y()}}else O.onload=Y}function h(){T?V():H()}function V(){var X=j.getElementsByTagName("body")[0],aa=C(r);aa.setAttribute("type",q);var Z=X.appendChild(aa);if(Z){var Y=0;!function(){if(typeof Z.GetVariable!=D){var ab=Z.GetVariable("$version");ab&&(ab=ab.split(" ")[1].split(","),M.pv=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)])}else if(10>Y)return Y++,void setTimeout(arguments.callee,10);X.removeChild(aa),Z=null,H()}()}else H()}function H(){var ag=o.length;if(ag>0)for(var af=0;ag>af;af++){var Y=o[af].id,ab=o[af].callbackFn,aa={success:!1,id:Y};if(M.pv[0]>0){var ae=c(Y);if(ae)if(!F(o[af].swfVersion)||M.wk&&M.wk<312)if(o[af].expressInstall&&A()){var ai={};ai.data=o[af].expressInstall,ai.width=ae.getAttribute("width")||"0",ai.height=ae.getAttribute("height")||"0",ae.getAttribute("class")&&(ai.styleclass=ae.getAttribute("class")),ae.getAttribute("align")&&(ai.align=ae.getAttribute("align"));for(var ah={},X=ae.getElementsByTagName("param"),ac=X.length,ad=0;ac>ad;ad++)"movie"!=X[ad].getAttribute("name").toLowerCase()&&(ah[X[ad].getAttribute("name")]=X[ad].getAttribute("value"));P(ai,ah,Y,ab)}else p(ae),ab&&ab(aa);else w(Y,!0),ab&&(aa.success=!0,aa.ref=z(Y),ab(aa))}else if(w(Y,!0),ab){var Z=z(Y);Z&&typeof Z.SetVariable!=D&&(aa.success=!0,aa.ref=Z),ab(aa)}}}function z(aa){var X=null,Y=c(aa);if(Y&&"OBJECT"==Y.nodeName)if(typeof Y.SetVariable!=D)X=Y;else{var Z=Y.getElementsByTagName(r)[0];Z&&(X=Z)}return X}function A(){return!a&&F("6.0.65")&&(M.win||M.mac)&&!(M.wk&&M.wk<312)}function P(aa,ab,X,Z){a=!0,E=Z||null,B={success:!1,id:X};var ae=c(X);if(ae){"OBJECT"==ae.nodeName?(l=g(ae),Q=null):(l=ae,Q=X),aa.id=R,(typeof aa.width==D||!/%$/.test(aa.width)&&parseInt(aa.width,10)<310)&&(aa.width="310"),(typeof aa.height==D||!/%$/.test(aa.height)&&parseInt(aa.height,10)<137)&&(aa.height="137"),j.title=j.title.slice(0,47)+" - Flash Player Installation";var ad=M.ie&&M.win?"ActiveX":"PlugIn",ac="MMredirectURL="+O.location.toString().replace(/&/g,"%26")+"&MMplayerType="+ad+"&MMdoctitle="+j.title;if(typeof ab.flashvars!=D?ab.flashvars+="&"+ac:ab.flashvars=ac,M.ie&&M.win&&4!=ae.readyState){var Y=C("div");X+="SWFObjectNew",Y.setAttribute("id",X),ae.parentNode.insertBefore(Y,ae),ae.style.display="none",function(){4==ae.readyState?ae.parentNode.removeChild(ae):setTimeout(arguments.callee,10)}()}u(aa,ab,X)}}function p(Y){if(M.ie&&M.win&&4!=Y.readyState){var X=C("div");Y.parentNode.insertBefore(X,Y),X.parentNode.replaceChild(g(Y),X),Y.style.display="none",function(){4==Y.readyState?Y.parentNode.removeChild(Y):setTimeout(arguments.callee,10)}()}else Y.parentNode.replaceChild(g(Y),Y)}function g(ab){var aa=C("div");if(M.win&&M.ie)aa.innerHTML=ab.innerHTML;else{var Y=ab.getElementsByTagName(r)[0];if(Y){var ad=Y.childNodes;if(ad)for(var X=ad.length,Z=0;X>Z;Z++)1==ad[Z].nodeType&&"PARAM"==ad[Z].nodeName||8==ad[Z].nodeType||aa.appendChild(ad[Z].cloneNode(!0))}}return aa}function u(ai,ag,Y){var X,aa=c(Y);if(M.wk&&M.wk<312)return X;if(aa)if(typeof ai.id==D&&(ai.id=Y),M.ie&&M.win){var ah="";for(var ae in ai)ai[ae]!=Object.prototype[ae]&&("data"==ae.toLowerCase()?ag.movie=ai[ae]:"styleclass"==ae.toLowerCase()?ah+=' class="'+ai[ae]+'"':"classid"!=ae.toLowerCase()&&(ah+=" "+ae+'="'+ai[ae]+'"'));var af="";for(var ad in ag)ag[ad]!=Object.prototype[ad]&&(af+='<param name="'+ad+'" value="'+ag[ad]+'" />');aa.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+ah+">"+af+"</object>",N[N.length]=ai.id,X=c(ai.id)}else{var Z=C(r);Z.setAttribute("type",q);for(var ac in ai)ai[ac]!=Object.prototype[ac]&&("styleclass"==ac.toLowerCase()?Z.setAttribute("class",ai[ac]):"classid"!=ac.toLowerCase()&&Z.setAttribute(ac,ai[ac]));for(var ab in ag)ag[ab]!=Object.prototype[ab]&&"movie"!=ab.toLowerCase()&&e(Z,ab,ag[ab]);aa.parentNode.replaceChild(Z,aa),X=Z}return X}function e(Z,X,Y){var aa=C("param");aa.setAttribute("name",X),aa.setAttribute("value",Y),Z.appendChild(aa)}function y(Y){var X=c(Y);X&&"OBJECT"==X.nodeName&&(M.ie&&M.win?(X.style.display="none",function(){4==X.readyState?b(Y):setTimeout(arguments.callee,10)}()):X.parentNode.removeChild(X))}function b(Z){var Y=c(Z);if(Y){for(var X in Y)"function"==typeof Y[X]&&(Y[X]=null);Y.parentNode.removeChild(Y)}}function c(Z){var X=null;try{X=j.getElementById(Z)}catch(Y){}return X}function C(X){return j.createElement(X)}function i(Z,X,Y){Z.attachEvent(X,Y),I[I.length]=[Z,X,Y]}function F(Z){var Y=M.pv,X=Z.split(".");return X[0]=parseInt(X[0],10),X[1]=parseInt(X[1],10)||0,X[2]=parseInt(X[2],10)||0,Y[0]>X[0]||Y[0]==X[0]&&Y[1]>X[1]||Y[0]==X[0]&&Y[1]==X[1]&&Y[2]>=X[2]?!0:!1}function v(ac,Y,ad,ab){if(!M.ie||!M.mac){var aa=j.getElementsByTagName("head")[0];if(aa){var X=ad&&"string"==typeof ad?ad:"screen";if(ab&&(n=null,G=null),!n||G!=X){var Z=C("style");Z.setAttribute("type","text/css"),Z.setAttribute("media",X),n=aa.appendChild(Z),M.ie&&M.win&&typeof j.styleSheets!=D&&j.styleSheets.length>0&&(n=j.styleSheets[j.styleSheets.length-1]),G=X}M.ie&&M.win?n&&typeof n.addRule==r&&n.addRule(ac,Y):n&&typeof j.createTextNode!=D&&n.appendChild(j.createTextNode(ac+" {"+Y+"}"))}}}function w(Z,X){if(m){var Y=X?"visible":"hidden";J&&c(Z)?c(Z).style.visibility=Y:v("#"+Z,"visibility:"+Y)}}function L(Y){var Z=/[\\\"<>\.;]/,X=null!=Z.exec(Y);return X&&typeof encodeURIComponent!=D?encodeURIComponent(Y):Y}{var l,Q,E,B,n,G,D="undefined",r="object",S="Shockwave Flash",W="ShockwaveFlash.ShockwaveFlash",q="application/x-shockwave-flash",R="SWFObjectExprInst",x="onreadystatechange",O=window,j=document,t=navigator,T=!1,U=[h],o=[],N=[],I=[],J=!1,a=!1,m=!0,M=function(){var aa=typeof j.getElementById!=D&&typeof j.getElementsByTagName!=D&&typeof j.createElement!=D,ah=t.userAgent.toLowerCase(),Y=t.platform.toLowerCase(),ae=/win/.test(Y?Y:ah),ac=/mac/.test(Y?Y:ah),af=/webkit/.test(ah)?parseFloat(ah.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,X=!1,ag=[0,0,0],ab=null;if(typeof t.plugins!=D&&typeof t.plugins[S]==r)ab=t.plugins[S].description,!ab||typeof t.mimeTypes!=D&&t.mimeTypes[q]&&!t.mimeTypes[q].enabledPlugin||(T=!0,X=!1,ab=ab.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),ag[0]=parseInt(ab.replace(/^(.*)\..*$/,"$1"),10),ag[1]=parseInt(ab.replace(/^.*\.(.*)\s.*$/,"$1"),10),ag[2]=/[a-zA-Z]/.test(ab)?parseInt(ab.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof O.ActiveXObject!=D)try{var ad=new ActiveXObject(W);ad&&(ab=ad.GetVariable("$version"),ab&&(X=!0,ab=ab.split(" ")[1].split(","),ag=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)]))}catch(Z){}return{w3:aa,pv:ag,wk:af,ie:X,win:ae,mac:ac}}();!function(){M.w3&&((typeof j.readyState!=D&&"complete"==j.readyState||typeof j.readyState==D&&(j.getElementsByTagName("body")[0]||j.body))&&f(),J||(typeof j.addEventListener!=D&&j.addEventListener("DOMContentLoaded",f,!1),M.ie&&M.win&&(j.attachEvent(x,function(){"complete"==j.readyState&&(j.detachEvent(x,arguments.callee),f())
}),O==top&&!function(){if(!J){try{j.documentElement.doScroll("left")}catch(X){return void setTimeout(arguments.callee,0)}f()}}()),M.wk&&!function(){return J?void 0:/loaded|complete/.test(j.readyState)?void f():void setTimeout(arguments.callee,0)}(),s(f)))}(),function(){M.ie&&M.win&&window.attachEvent("onunload",function(){for(var ac=I.length,ab=0;ac>ab;ab++)I[ab][0].detachEvent(I[ab][1],I[ab][2]);for(var Z=N.length,aa=0;Z>aa;aa++)y(N[aa]);for(var Y in M)M[Y]=null;M=null;for(var X in swfobject)swfobject[X]=null;swfobject=null})}()}return{registerObject:function(ab,X,aa,Z){if(M.w3&&ab&&X){var Y={};Y.id=ab,Y.swfVersion=X,Y.expressInstall=aa,Y.callbackFn=Z,o[o.length]=Y,w(ab,!1)}else Z&&Z({success:!1,id:ab})},getObjectById:function(X){return M.w3?z(X):void 0},embedSWF:function(ab,ah,ae,ag,Y,aa,Z,ad,af,ac){var X={success:!1,id:ah};M.w3&&!(M.wk&&M.wk<312)&&ab&&ah&&ae&&ag&&Y?(w(ah,!1),K(function(){ae+="",ag+="";var aj={};if(af&&typeof af===r)for(var al in af)aj[al]=af[al];aj.data=ab,aj.width=ae,aj.height=ag;var am={};if(ad&&typeof ad===r)for(var ak in ad)am[ak]=ad[ak];if(Z&&typeof Z===r)for(var ai in Z)typeof am.flashvars!=D?am.flashvars+="&"+ai+"="+Z[ai]:am.flashvars=ai+"="+Z[ai];if(F(Y)){var an=u(aj,am,ah);aj.id==ah&&w(ah,!0),X.success=!0,X.ref=an}else{if(aa&&A())return aj.data=aa,void P(aj,am,ah,ac);w(ah,!0)}ac&&ac(X)})):ac&&ac(X)},switchOffAutoHideShow:function(){m=!1},ua:M,getFlashPlayerVersion:function(){return{major:M.pv[0],minor:M.pv[1],release:M.pv[2]}},hasFlashPlayerVersion:F,createSWF:function(Z,Y,X){return M.w3?u(Z,Y,X):void 0},showExpressInstall:function(Z,aa,X,Y){M.w3&&A()&&P(Z,aa,X,Y)},removeSWF:function(X){M.w3&&y(X)},createCSS:function(aa,Z,Y,X){M.w3&&v(aa,Z,Y,X)},addDomLoadEvent:K,addLoadEvent:s,getQueryParamValue:function(aa){var Z=j.location.search||j.location.hash;if(Z){if(/\?/.test(Z)&&(Z=Z.split("?")[1]),null==aa)return L(Z);for(var Y=Z.split("&"),X=0;X<Y.length;X++)if(Y[X].substring(0,Y[X].indexOf("="))==aa)return L(Y[X].substring(Y[X].indexOf("=")+1))}return""},expressInstallCallback:function(){if(a){var X=c(R);X&&l&&(X.parentNode.replaceChild(l,X),Q&&(w(Q,!0),M.ie&&M.win&&(l.style.display="block")),E&&E(B)),a=!1}}}}();!function($,p){function E(F){return"string"==typeof F}function B(G){var F=m.call(arguments,1);return function(){return G.apply(this,F.concat(m.call(arguments)))}}function n(F){return F.replace(/^[^#]*#?(.*)$/,"$1")}function o(F){return F.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function f(H,M,F,I,G){var O,L,K,N,J;return I!==i?(K=F.match(H?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/),J=K[3]||"",2===G&&E(I)?L=I.replace(H?w:x,""):(N=l(K[2]),I=E(I)?l[H?D:A](I):I,L=2===G?I:1===G?$.extend({},I,N):$.extend({},N,I),L=a(L),H&&(L=L.replace(h,r))),O=K[1]+(H?"#":L||!K[1]?"?":"")+L+J):O=M(F!==i?F:p[g][k]),O}function z(H,F,G){return F===i||"boolean"==typeof F?(G=F,F=a[H?D:A]()):F=E(F)?F.replace(H?w:x,""):F,l(F,G)}function s(I,G,H,F){return E(H)||"object"==typeof H||(F=H,H=G,G=i),this.each(function(){var L=$(this),J=G||j()[(this.nodeName||"").toLowerCase()]||"",K=J&&L.attr(J)||"";L.attr(J,a[I](K,H,F))})}var i,c,l,v,q,u,j,h,m=Array.prototype.slice,r=decodeURIComponent,a=$.param,b=$.bbq=$.bbq||{},e=$.event.special,d="hashchange",A="querystring",D="fragment",y="elemUrlAttr",g="location",k="href",t="src",x=/^.*\?|#.*$/g,w=/^.*\#/,C={};a[A]=B(f,0,o),a[D]=c=B(f,1,n),c.noEscape=function(G){G=G||"";var F=$.map(G.split(""),encodeURIComponent);h=new RegExp(F.join("|"),"g")},c.noEscape(",/"),$.deparam=l=function(I,F){var H={},G={"true":!0,"false":!1,"null":null};return $.each(I.replace(/\+/g," ").split("&"),function(L,Q){var J,K=Q.split("="),P=r(K[0]),O=H,M=0,R=P.split("]["),N=R.length-1;if(/\[/.test(R[0])&&/\]$/.test(R[N])?(R[N]=R[N].replace(/\]$/,""),R=R.shift().split("[").concat(R),N=R.length-1):N=0,2===K.length)if(J=r(K[1]),F&&(J=J&&!isNaN(J)?+J:"undefined"===J?i:G[J]!==i?G[J]:J),N)for(;N>=M;M++)P=""===R[M]?O.length:R[M],O=O[P]=N>M?O[P]||(R[M+1]&&isNaN(R[M+1])?{}:[]):J;else $.isArray(H[P])?H[P].push(J):H[P]=H[P]!==i?[H[P],J]:J;else P&&(H[P]=F?i:"")}),H},l[A]=B(z,0),l[D]=v=B(z,1),$[y]||($[y]=function(F){return $.extend(C,F)})({a:k,base:k,iframe:t,img:t,input:t,form:"action",link:k,script:t}),j=$[y],$.fn[A]=B(s,A),$.fn[D]=B(s,D),b.pushState=q=function(I,F){E(I)&&/^#/.test(I)&&F===i&&(F=2);var H=I!==i,G=c(p[g][k],H?I:{},H?F:2);p[g][k]=G+(/#/.test(G)?"":"#")},b.getState=u=function(F,G){return F===i||"boolean"==typeof F?v(F):v(G)[F]},b.removeState=function(F){var G={};F!==i&&(G=u(),$.each($.isArray(F)?F:arguments,function(I,H){delete G[H]})),q(G,2)},e[d]=$.extend(e[d],{add:function(F){function G(J){var I=J[D]=c();J.getState=function(K,L){return K===i||"boolean"==typeof K?l(I,K):l(I,L)[K]},H.apply(this,arguments)}var H;return $.isFunction(F)?(H=F,G):(H=F.handler,void(F.handler=G))}})}(jQuery,this),function($,i,b){function a(m){return m=m||i[c][l],m.replace(/^[^#]*#?(.*)$/,"$1")}var j,k=$.event.special,c="location",d="hashchange",l="href",f=$.browser,g=document.documentMode,h=f.msie&&(g===b||8>g),e="on"+d in i&&!h;$[d+"Delay"]=100,k[d]=$.extend(k[d],{setup:function(){return e?!1:void $(j.start)},teardown:function(){return e?!1:void $(j.stop)}}),j=function(){function p(){o=q=function(s){return s},h&&(n=$('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow,q=function(){return a(n.document[c][l])},(o=function(u,s){if(u!==s){var t=n.document;t.open().close(),t[c].hash="#"+u}})(a()))}var r,n,o,q,m={};return m.start=function(){if(!r){var t=a();o||p(),function s(){var v=a(),u=q(t);v!==t?(o(t=v,u),$(i).trigger(d)):u!==t&&(i[c][l]=i[c][l].replace(/#.*/,"")+"#"+u),r=setTimeout(s,$[d+"Delay"])}()}},m.stop=function(){n||(r&&clearTimeout(r),r=0)},m}()}(jQuery,this);var findChild,getNodeName,getNodePosition,simpleXPathJQuery,simpleXPathPure;simpleXPathJQuery=function(relativeRoot){var jq;return jq=this.map(function(){var elem,idx,path,tagName;for(path="",elem=this;(null!=elem?elem.nodeType:void 0)===Node.ELEMENT_NODE&&elem!==relativeRoot;)tagName=elem.tagName.replace(":","\\:"),idx=$(elem.parentNode).children(tagName).index(elem)+1,idx="["+idx+"]",path="/"+elem.tagName.toLowerCase()+idx+path,elem=elem.parentNode;return path}),jq.get()},simpleXPathPure=function(relativeRoot){var getPathSegment,getPathTo,jq,rootNode;return getPathSegment=function(node){var name,pos;return name=getNodeName(node),pos=getNodePosition(node),""+name+"["+pos+"]"},rootNode=relativeRoot,getPathTo=function(node){var xpath;for(xpath="";node!==rootNode;){if(null==node)throw new Error("Called getPathTo on a node which was not a descendant of @rootNode. "+rootNode);xpath=getPathSegment(node)+"/"+xpath,node=node.parentNode}return xpath="/"+xpath,xpath=xpath.replace(/\/$/,"")},jq=this.map(function(){var path;return path=getPathTo(this)}),jq.get()},findChild=function(node,type,index){var child,children,found,name,_i,_len;if(!node.hasChildNodes())throw new Error("XPath error: node has no children!");for(children=node.childNodes,found=0,_i=0,_len=children.length;_len>_i;_i++)if(child=children[_i],name=getNodeName(child),name===type&&(found+=1,found===index))return child;throw new Error("XPath error: wanted child not found.")},getNodeName=function(node){var nodeName;switch(nodeName=node.nodeName.toLowerCase()){case"#text":return"text()";case"#comment":return"comment()";case"#cdata-section":return"cdata-section()";default:return nodeName}},getNodePosition=function(node){var pos,tmp;for(pos=0,tmp=node;tmp;)tmp.nodeName===node.nodeName&&pos++,tmp=tmp.previousSibling;return pos};var $,Util,gettext_annotator,_ref,_t;gettext_annotator=function(msgid){return msgid},_t=function(msgid){return gettext_annotator(msgid)},("undefined"!=typeof jQuery&&null!==jQuery&&null!=(_ref=jQuery.fn)?_ref.jquery:void 0)||console.error(_t("Annotator requires jQuery: have you included lib/vendor/jquery.js?")),JSON&&JSON.parse&&JSON.stringify||console.error(_t("Annotator requires a JSON implementation: have you included lib/vendor/json2.js?")),$=jQuery,Util={},Util.flatten=function(array){var flatten;return(flatten=function(ary){var el,flat,_i,_len;for(flat=[],_i=0,_len=ary.length;_len>_i;_i++)el=ary[_i],flat=flat.concat(el&&$.isArray(el)?flatten(el):el);return flat})(array)},Util.contains=function(parent,child){var node;for(node=child;null!=node;){if(node===parent)return!0;node=node.parentNode}return!1},Util.getTextNodes=function(jq){var getTextNodes;return getTextNodes=function(node){var nodes;if(node&&node.nodeType!==Node.TEXT_NODE){if(nodes=[],node.nodeType!==Node.COMMENT_NODE)for(node=node.lastChild;node;)nodes.push(getTextNodes(node)),node=node.previousSibling;return nodes.reverse()}return node},jq.map(function(){return Util.flatten(getTextNodes(this))})},Util.getLastTextNodeUpTo=function(n){var result;switch(n.nodeType){case Node.TEXT_NODE:return n;case Node.ELEMENT_NODE:if(null!=n.lastChild&&(result=Util.getLastTextNodeUpTo(n.lastChild),null!=result))return result}return n=n.previousSibling,null!=n?Util.getLastTextNodeUpTo(n):null},Util.getFirstTextNodeNotBefore=function(n){var result;switch(n.nodeType){case Node.TEXT_NODE:return n;case Node.ELEMENT_NODE:if(null!=n.firstChild&&(result=Util.getFirstTextNodeNotBefore(n.firstChild),null!=result))return result}return n=n.nextSibling,null!=n?Util.getFirstTextNodeNotBefore(n):null},Util.readRangeViaSelection=function(range){var sel;return sel=Util.getGlobal().getSelection(),sel.removeAllRanges(),sel.addRange(range.toRange()),sel.toString()},Util.xpathFromNode=function(el,relativeRoot){var exception,result;try{result=simpleXPathJQuery.call(el,relativeRoot)}catch(_error){exception=_error,console.log("jQuery-based XPath construction failed! Falling back to manual."),result=simpleXPathPure.call(el,relativeRoot)}return result},Util.nodeFromXPath=function(xp,root){var idx,name,node,step,steps,_i,_len,_ref1;for(steps=xp.substring(1).split("/"),node=root,_i=0,_len=steps.length;_len>_i;_i++)step=steps[_i],_ref1=step.split("["),name=_ref1[0],idx=_ref1[1],idx=null!=idx?parseInt((null!=idx?idx.split("]"):void 0)[0]):1,node=findChild(node,name.toLowerCase(),idx);return node},Util.escape=function(html){return html.replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},Util.uuid=function(){var counter;return counter=0,function(){return counter++}}(),Util.getGlobal=function(){return function(){return this}()},Util.maxZIndex=function($elements){var all,el;return all=function(){var _i,_len,_results;for(_results=[],_i=0,_len=$elements.length;_len>_i;_i++)el=$elements[_i],_results.push("static"===$(el).css("position")?-1:parseInt($(el).css("z-index"),10)||-1);return _results}(),Math.max.apply(Math,all)},Util.mousePosition=function(e,offsetEl){var offset,_ref1;return"absolute"!==(_ref1=$(offsetEl).css("position"))&&"fixed"!==_ref1&&"relative"!==_ref1&&(offsetEl=$(offsetEl).offsetParent()[0]),offset=$(offsetEl).offset(),{top:e.pageY-offset.top,left:e.pageX-offset.left}},Util.preventEventDefault=function(event){return null!=event&&"function"==typeof event.preventDefault?event.preventDefault():void 0};var fn,functions,_i,_j,_len,_len1,__slice=[].slice;if(functions=["log","debug","info","warn","exception","assert","dir","dirxml","trace","group","groupEnd","groupCollapsed","time","timeEnd","profile","profileEnd","count","clear","table","error","notifyFirebug","firebug","userObjects"],"undefined"!=typeof console&&null!==console)for(null==console.group&&(console.group=function(name){return console.log("GROUP: ",name)}),null==console.groupCollapsed&&(console.groupCollapsed=console.group),_i=0,_len=functions.length;_len>_i;_i++)fn=functions[_i],null==console[fn]&&(console[fn]=function(){return console.log(_t("Not implemented:")+(" console."+name))});else{for(this.console={},_j=0,_len1=functions.length;_len1>_j;_j++)fn=functions[_j],this.console[fn]=function(){};this.console.error=function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],alert("ERROR: "+args.join(", "))},this.console.warn=function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],alert("WARNING: "+args.join(", "))}}var Delegator,__slice=[].slice,__hasProp={}.hasOwnProperty;Delegator=function(){function Delegator(element,options){this.options=$.extend(!0,{},this.options,options),this.element=$(element),this._closures={},this.on=this.subscribe,this.addEvents()}return Delegator.prototype.events={},Delegator.prototype.options={},Delegator.prototype.element=null,Delegator.prototype.addEvents=function(){var event,_i,_len,_ref,_results;for(_ref=Delegator._parseEvents(this.events),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)event=_ref[_i],_results.push(this._addEvent(event.selector,event.event,event.functionName));return _results},Delegator.prototype.removeEvents=function(){var event,_i,_len,_ref,_results;for(_ref=Delegator._parseEvents(this.events),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)event=_ref[_i],_results.push(this._removeEvent(event.selector,event.event,event.functionName));return _results},Delegator.prototype._addEvent=function(selector,event,functionName){var closure,_this=this;return closure=function(){return _this[functionName].apply(_this,arguments)},""===selector&&Delegator._isCustomEvent(event)?this.subscribe(event,closure):this.element.delegate(selector,event,closure),this._closures[""+selector+"/"+event+"/"+functionName]=closure,this},Delegator.prototype._removeEvent=function(selector,event,functionName){var closure;return closure=this._closures[""+selector+"/"+event+"/"+functionName],""===selector&&Delegator._isCustomEvent(event)?this.unsubscribe(event,closure):this.element.undelegate(selector,event,closure),delete this._closures[""+selector+"/"+event+"/"+functionName],this},Delegator.prototype.publish=function(){return this.element.triggerHandler.apply(this.element,arguments),this},Delegator.prototype.subscribe=function(event,callback){var closure;return closure=function(){return callback.apply(this,[].slice.call(arguments,1))},closure.guid=callback.guid=$.guid+=1,this.element.bind(event,closure),this},Delegator.prototype.unsubscribe=function(){return this.element.unbind.apply(this.element,arguments),this},Delegator}(),Delegator._parseEvents=function(eventsObj){var event,events,functionName,sel,selector,_i,_ref;events=[];for(sel in eventsObj)functionName=eventsObj[sel],_ref=sel.split(" "),selector=2<=_ref.length?__slice.call(_ref,0,_i=_ref.length-1):(_i=0,[]),event=_ref[_i++],events.push({selector:selector.join(" "),event:event,functionName:functionName});return events},Delegator.natives=function(){var key,specials,val;return specials=function(){var _ref,_results;_ref=jQuery.event.special,_results=[];for(key in _ref)__hasProp.call(_ref,key)&&(val=_ref[key],_results.push(key));return _results}(),"blur focus focusin focusout load resize scroll unload click dblclick\nmousedown mouseup mousemove mouseover mouseout mouseenter mouseleave\nchange select submit keydown keypress keyup error".split(/[^a-z]+/).concat(specials)}(),Delegator._isCustomEvent=function(event){return event=event.split(".")[0],-1===$.inArray(event,Delegator.natives)};var Range,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Range={},Range.sniff=function(r){return null!=r.commonAncestorContainer?new Range.BrowserRange(r):"string"==typeof r.start?new Range.SerializedRange(r):r.start&&"object"==typeof r.start?new Range.NormalizedRange(r):(console.error(_t("Could not sniff range type")),!1)},Range.nodeFromXPath=function(xpath,root){var customResolver,evaluateXPath,namespace,node,segment;return null==root&&(root=document),evaluateXPath=function(xp,nsResolver){var exception;null==nsResolver&&(nsResolver=null);try{return document.evaluate("."+xp,root,nsResolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}catch(_error){return exception=_error,console.log("XPath evaluation failed."),console.log("Trying fallback..."),Util.nodeFromXPath(xp,root)}},$.isXMLDoc(document.documentElement)?(customResolver=document.createNSResolver(null===document.ownerDocument?document.documentElement:document.ownerDocument.documentElement),node=evaluateXPath(xpath,customResolver),node||(xpath=function(){var _i,_len,_ref,_results;for(_ref=xpath.split("/"),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)segment=_ref[_i],_results.push(segment&&-1===segment.indexOf(":")?segment.replace(/^([a-z]+)/,"xhtml:$1"):segment);return _results}().join("/"),namespace=document.lookupNamespaceURI(null),customResolver=function(ns){return"xhtml"===ns?namespace:document.documentElement.getAttribute("xmlns:"+ns)},node=evaluateXPath(xpath,customResolver)),node):evaluateXPath(xpath)},Range.RangeError=function(_super){function RangeError(type,message,parent){this.type=type,this.message=message,this.parent=null!=parent?parent:null,RangeError.__super__.constructor.call(this,this.message)}return __extends(RangeError,_super),RangeError}(Error),Range.BrowserRange=function(){function BrowserRange(obj){this.commonAncestorContainer=obj.commonAncestorContainer,this.startContainer=obj.startContainer,this.startOffset=obj.startOffset,this.endContainer=obj.endContainer,this.endOffset=obj.endOffset}return BrowserRange.prototype.normalize=function(){var n,node,nr,r;if(this.tainted)return console.error(_t("You may only call normalize() once on a BrowserRange!")),!1;if(this.tainted=!0,r={},this.startContainer.nodeType===Node.ELEMENT_NODE?(r.start=Util.getFirstTextNodeNotBefore(this.startContainer.childNodes[this.startOffset]),r.startOffset=0):(r.start=this.startContainer,r.startOffset=this.startOffset),this.endContainer.nodeType===Node.ELEMENT_NODE){if(node=this.endContainer.childNodes[this.endOffset],null!=node){for(n=node;null!=n&&n.nodeType!==Node.TEXT_NODE;)n=n.firstChild;null!=n&&(r.end=n,r.endOffset=0)}null==r.end&&(node=this.endContainer.childNodes[this.endOffset-1],r.end=Util.getLastTextNodeUpTo(node),r.endOffset=r.end.nodeValue.length)}else r.end=this.endContainer,r.endOffset=this.endOffset;for(nr={},nr.start=r.startOffset>0?r.start.nodeValue.length>r.startOffset?r.start.splitText(r.startOffset):r.start.nextSibling:r.start,r.start===r.end?(nr.start.nodeValue.length>r.endOffset-r.startOffset&&nr.start.splitText(r.endOffset-r.startOffset),nr.end=nr.start):(r.end.nodeValue.length>r.endOffset&&r.end.splitText(r.endOffset),nr.end=r.end),nr.commonAncestor=this.commonAncestorContainer;nr.commonAncestor.nodeType!==Node.ELEMENT_NODE;)nr.commonAncestor=nr.commonAncestor.parentNode;return new Range.NormalizedRange(nr)},BrowserRange.prototype.serialize=function(root,ignoreSelector){return this.normalize(root).serialize(root,ignoreSelector)},BrowserRange}(),Range.NormalizedRange=function(){function NormalizedRange(obj){this.commonAncestor=obj.commonAncestor,this.start=obj.start,this.end=obj.end}return NormalizedRange.prototype.normalize=function(){return this},NormalizedRange.prototype.limit=function(bounds){var nodes,parent,startParents,_i,_len,_ref;if(nodes=$.grep(this.textNodes(),function(node){return node.parentNode===bounds||$.contains(bounds,node.parentNode)}),!nodes.length)return null;for(this.start=nodes[0],this.end=nodes[nodes.length-1],startParents=$(this.start).parents(),_ref=$(this.end).parents(),_i=0,_len=_ref.length;_len>_i;_i++)if(parent=_ref[_i],-1!==startParents.index(parent)){this.commonAncestor=parent;break}return this},NormalizedRange.prototype.serialize=function(root,ignoreSelector){var end,serialization,start;return serialization=function(node,isEnd){var n,nodes,offset,origParent,textNodes,xpath,_i,_len;for(origParent=ignoreSelector?$(node).parents(":not("+ignoreSelector+")").eq(0):$(node).parent(),xpath=Util.xpathFromNode(origParent,root)[0],textNodes=Util.getTextNodes(origParent),nodes=textNodes.slice(0,textNodes.index(node)),offset=0,_i=0,_len=nodes.length;_len>_i;_i++)n=nodes[_i],offset+=n.nodeValue.length;return isEnd?[xpath,offset+node.nodeValue.length]:[xpath,offset]},start=serialization(this.start),end=serialization(this.end,!0),new Range.SerializedRange({start:start[0],end:end[0],startOffset:start[1],endOffset:end[1]})},NormalizedRange.prototype.text=function(){var node;return function(){var _i,_len,_ref,_results;for(_ref=this.textNodes(),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)node=_ref[_i],_results.push(node.nodeValue);return _results}.call(this).join("")},NormalizedRange.prototype.textNodes=function(){var end,start,textNodes,_ref;return textNodes=Util.getTextNodes($(this.commonAncestor)),_ref=[textNodes.index(this.start),textNodes.index(this.end)],start=_ref[0],end=_ref[1],$.makeArray(textNodes.slice(start,+end+1||9e9))},NormalizedRange.prototype.toRange=function(){var range;return range=document.createRange(),range.setStartBefore(this.start),range.setEndAfter(this.end),range},NormalizedRange}(),Range.SerializedRange=function(){function SerializedRange(obj){this.start=obj.start,this.startOffset=obj.startOffset,this.end=obj.end,this.endOffset=obj.endOffset}return SerializedRange.prototype.normalize=function(root){var contains,e,length,node,p,range,targetOffset,tn,_i,_j,_len,_len1,_ref,_ref1;for(range={},_ref=["start","end"],_i=0,_len=_ref.length;_len>_i;_i++){p=_ref[_i];try{node=Range.nodeFromXPath(this[p],root)}catch(_error){throw e=_error,new Range.RangeError(p,"Error while finding "+p+" node: "+this[p]+": "+e,e)}if(!node)throw new Range.RangeError(p,"Couldn't find "+p+" node: "+this[p]);for(length=0,targetOffset=this[p+"Offset"],"end"===p&&targetOffset--,_ref1=Util.getTextNodes($(node)),_j=0,_len1=_ref1.length;_len1>_j;_j++){if(tn=_ref1[_j],length+tn.nodeValue.length>targetOffset){range[p+"Container"]=tn,range[p+"Offset"]=this[p+"Offset"]-length;break}length+=tn.nodeValue.length}if(null==range[p+"Offset"])throw new Range.RangeError(""+p+"offset","Couldn't find offset "+this[p+"Offset"]+" in element "+this[p])}return contains=null==document.compareDocumentPosition?function(a,b){return a.contains(b)}:function(a,b){return 16&a.compareDocumentPosition(b)},$(range.startContainer).parents().each(function(){return contains(this,range.endContainer)?(range.commonAncestorContainer=this,!1):void 0}),new Range.BrowserRange(range).normalize(root)},SerializedRange.prototype.serialize=function(root,ignoreSelector){return this.normalize(root).serialize(root,ignoreSelector)},SerializedRange.prototype.toObject=function(){return{start:this.start,startOffset:this.startOffset,end:this.end,endOffset:this.endOffset}},SerializedRange}();var Annotator,g,_Annotator,_ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};_Annotator=this.Annotator,Annotator=function(_super){function Annotator(){return this.onDeleteAnnotation=__bind(this.onDeleteAnnotation,this),this.onEditAnnotation=__bind(this.onEditAnnotation,this),this.onAdderClick=__bind(this.onAdderClick,this),this.onAdderMousedown=__bind(this.onAdderMousedown,this),this.onHighlightMouseover=__bind(this.onHighlightMouseover,this),this.checkForEndSelection=__bind(this.checkForEndSelection,this),this.checkForStartSelection=__bind(this.checkForStartSelection,this),this.clearViewerHideTimer=__bind(this.clearViewerHideTimer,this),this.startViewerHideTimer=__bind(this.startViewerHideTimer,this),this.showViewer=__bind(this.showViewer,this),this.onEditorSubmit=__bind(this.onEditorSubmit,this),this.onEditorHide=__bind(this.onEditorHide,this),this.showEditor=__bind(this.showEditor,this),Annotator.__super__.constructor.apply(this,arguments),this.plugins={},Annotator.supported()?(this.options.readOnly||this._setupDocumentEvents(),this._setupWrapper()._setupViewer()._setupEditor(),this._setupDynamicStyle(),this.adder=$(this.html.adder).appendTo(this.wrapper).hide(),void Annotator._instances.push(this)):this}return __extends(Annotator,_super),Annotator.prototype.events={".annotator-adder button click":"onAdderClick",".annotator-adder button mousedown":"onAdderMousedown",".annotator-hl mouseover":"onHighlightMouseover",".annotator-hl mouseout":"startViewerHideTimer"},Annotator.prototype.html={adder:'<div class="annotator-adder"><button>'+_t("Annotate")+"</button></div>",wrapper:'<div class="annotator-wrapper"></div>'},Annotator.prototype.options={readOnly:!1},Annotator.prototype.plugins={},Annotator.prototype.editor=null,Annotator.prototype.viewer=null,Annotator.prototype.selectedRanges=null,Annotator.prototype.mouseIsDown=!1,Annotator.prototype.ignoreMouseup=!1,Annotator.prototype.viewerHideTimer=null,Annotator.prototype._setupWrapper=function(){return this.wrapper=$(this.html.wrapper),this.element.find("script").remove(),this.element.wrapInner(this.wrapper),this.wrapper=this.element.find(".annotator-wrapper"),this},Annotator.prototype._setupViewer=function(){var _this=this;return this.viewer=new Annotator.Viewer({readOnly:this.options.readOnly}),this.viewer.hide().on("edit",this.onEditAnnotation).on("delete",this.onDeleteAnnotation).addField({load:function(field,annotation){return $(field).html(annotation.text?Util.escape(annotation.text):"<i>"+_t("No Comment")+"</i>"),_this.publish("annotationViewerTextField",[field,annotation])}}).element.appendTo(this.wrapper).bind({mouseover:this.clearViewerHideTimer,mouseout:this.startViewerHideTimer}),this},Annotator.prototype._setupEditor=function(){return this.editor=new Annotator.Editor,this.editor.hide().on("hide",this.onEditorHide).on("save",this.onEditorSubmit).addField({type:"textarea",label:_t("Comments")+"…",load:function(field,annotation){return $(field).find("textarea").val(annotation.text||"")},submit:function(field,annotation){return annotation.text=$(field).find("textarea").val()}}),this.editor.element.appendTo(this.wrapper),this},Annotator.prototype._setupDocumentEvents=function(){return $(document).bind({mouseup:this.checkForEndSelection,mousedown:this.checkForStartSelection}),this},Annotator.prototype._setupDynamicStyle=function(){var max,sel,style,x;return style=$("#annotator-dynamic-style"),style.length||(style=$('<style id="annotator-dynamic-style"></style>').appendTo(document.head)),sel="*"+function(){var _i,_len,_ref,_results;for(_ref=["adder","outer","notice","filter"],_results=[],_i=0,_len=_ref.length;_len>_i;_i++)x=_ref[_i],_results.push(":not(.annotator-"+x+")");return _results}().join(""),max=Util.maxZIndex($(document.body).find(sel)),max=Math.max(max,1e3),style.text([".annotator-adder, .annotator-outer, .annotator-notice {","  z-index: "+(max+20)+";","}",".annotator-filter {","  z-index: "+(max+10)+";","}"].join("\n")),this},Annotator.prototype.destroy=function(){var idx,name,plugin,_ref;$(document).unbind({mouseup:this.checkForEndSelection,mousedown:this.checkForStartSelection}),$("#annotator-dynamic-style").remove(),this.adder.remove(),this.viewer.destroy(),this.editor.destroy(),this.wrapper.find(".annotator-hl").each(function(){return $(this).contents().insertBefore(this),$(this).remove()}),this.wrapper.contents().insertBefore(this.wrapper),this.wrapper.remove(),this.element.data("annotator",null),_ref=this.plugins;for(name in _ref)plugin=_ref[name],this.plugins[name].destroy();return this.removeEvents(),idx=Annotator._instances.indexOf(this),-1!==idx?Annotator._instances.splice(idx,1):void 0},Annotator.prototype.getSelectedRanges=function(){var browserRange,i,normedRange,r,ranges,rangesToIgnore,selection,_i,_len;for(selection=Util.getGlobal().getSelection(),ranges=[],rangesToIgnore=[],selection.isCollapsed||(ranges=function(){var _i,_ref,_results;for(_results=[],i=_i=0,_ref=selection.rangeCount;_ref>=0?_ref>_i:_i>_ref;i=_ref>=0?++_i:--_i)r=selection.getRangeAt(i),browserRange=new Range.BrowserRange(r),normedRange=browserRange.normalize().limit(this.wrapper[0]),null===normedRange&&rangesToIgnore.push(r),_results.push(normedRange);return _results}.call(this),selection.removeAllRanges()),_i=0,_len=rangesToIgnore.length;_len>_i;_i++)r=rangesToIgnore[_i],selection.addRange(r);return $.grep(ranges,function(range){return range&&selection.addRange(range.toRange()),range})},Annotator.prototype.createAnnotation=function(){var annotation;return annotation={},this.publish("beforeAnnotationCreated",[annotation]),annotation},Annotator.prototype.setupAnnotation=function(annotation){var e,normed,normedRanges,r,root,_i,_j,_len,_len1,_ref;for(root=this.wrapper[0],annotation.ranges||(annotation.ranges=this.selectedRanges),normedRanges=[],_ref=annotation.ranges,_i=0,_len=_ref.length;_len>_i;_i++){r=_ref[_i];try{normedRanges.push(Range.sniff(r).normalize(root))}catch(_error){if(e=_error,!(e instanceof Range.RangeError))throw e;this.publish("rangeNormalizeFail",[annotation,r,e])}}if(0!=normedRanges.length){for(annotation.quote=[],annotation.ranges=[],annotation.highlights=[],_j=0,_len1=normedRanges.length;_len1>_j;_j++)normed=normedRanges[_j],annotation.quote.push($.trim(normed.text())),annotation.ranges.push(normed.serialize(this.wrapper[0],".annotator-hl")),$.merge(annotation.highlights,this.highlightRange(normed));annotation.quote=annotation.quote.join(" / "),$(annotation.highlights).data("annotation",annotation)}return annotation},Annotator.prototype.updateAnnotation=function(annotation){return this.publish("beforeAnnotationUpdated",[annotation]),this.publish("annotationUpdated",[annotation]),annotation},Annotator.prototype.deleteAnnotation=function(annotation){var child,h,_i,_len,_ref;if(null!=annotation.highlights)for(_ref=annotation.highlights,_i=0,_len=_ref.length;_len>_i;_i++)h=_ref[_i],null!=h.parentNode&&(child=h.childNodes[0],$(h).replaceWith(h.childNodes));return this.publish("annotationDeleted",[annotation]),annotation},Annotator.prototype.loadAnnotations=function(annotations){var clone,loader,_this=this;return null==annotations&&(annotations=[]),loader=function(annList){var n,now,_i,_len;for(null==annList&&(annList=[]),now=annList.splice(0,10),_i=0,_len=now.length;_len>_i;_i++)n=now[_i],_this.setupAnnotation(n);return annList.length>0?setTimeout(function(){return loader(annList)},10):_this.publish("annotationsLoaded",[clone])},clone=annotations.slice(),loader(annotations),this},Annotator.prototype.dumpAnnotations=function(){return this.plugins.Store?this.plugins.Store.dumpAnnotations():(console.warn(_t("Can't dump annotations without Store plugin.")),!1)},Annotator.prototype.highlightRange=function(normedRange,cssClass){var hl,node,white,_i,_len,_ref,_results;for(null==cssClass&&(cssClass="annotator-hl"),white=/^\s*$/,hl=$("<span class='"+cssClass+"'></span>"),_ref=normedRange.textNodes(),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)node=_ref[_i],white.test(node.nodeValue)||_results.push($(node).wrapAll(hl).parent().show()[0]);return _results},Annotator.prototype.highlightRanges=function(normedRanges,cssClass){var highlights,r,_i,_len;for(null==cssClass&&(cssClass="annotator-hl"),highlights=[],_i=0,_len=normedRanges.length;_len>_i;_i++)r=normedRanges[_i],$.merge(highlights,this.highlightRange(r,cssClass));return highlights},Annotator.prototype.addPlugin=function(name,options){var klass,_base;return this.plugins[name]?console.error(_t("You cannot have more than one instance of any plugin.")):(klass=Annotator.Plugin[name],"function"==typeof klass?(this.plugins[name]=new klass(this.element[0],options),this.plugins[name].annotator=this,"function"==typeof(_base=this.plugins[name]).pluginInit&&_base.pluginInit()):console.error(_t("Could not load ")+name+_t(" plugin. Have you included the appropriate <script> tag?"))),this},Annotator.prototype.showEditor=function(annotation,location){return this.editor.element.css(location),this.editor.load(annotation),this.publish("annotationEditorShown",[this.editor,annotation]),this},Annotator.prototype.onEditorHide=function(){return this.publish("annotationEditorHidden",[this.editor]),this.ignoreMouseup=!1
},Annotator.prototype.onEditorSubmit=function(annotation){return this.publish("annotationEditorSubmit",[this.editor,annotation])},Annotator.prototype.showViewer=function(annotations,location){return this.viewer.element.css(location),this.viewer.load(annotations),this.publish("annotationViewerShown",[this.viewer,annotations])},Annotator.prototype.startViewerHideTimer=function(){return this.viewerHideTimer?void 0:this.viewerHideTimer=setTimeout(this.viewer.hide,250)},Annotator.prototype.clearViewerHideTimer=function(){return clearTimeout(this.viewerHideTimer),this.viewerHideTimer=!1},Annotator.prototype.checkForStartSelection=function(event){return event&&this.isAnnotator(event.target)||this.startViewerHideTimer(),this.mouseIsDown=!0},Annotator.prototype.checkForEndSelection=function(event){var container,range,_i,_len,_ref;if(this.mouseIsDown=!1,!this.ignoreMouseup){for(this.selectedRanges=this.getSelectedRanges(),_ref=this.selectedRanges,_i=0,_len=_ref.length;_len>_i;_i++)if(range=_ref[_i],container=range.commonAncestor,$(container).hasClass("annotator-hl")&&(container=$(container).parents("[class!=annotator-hl]")[0]),this.isAnnotator(container))return;return event&&this.selectedRanges.length?this.adder.css(Util.mousePosition(event,this.wrapper[0])).show():this.adder.hide()}},Annotator.prototype.isAnnotator=function(element){return!!$(element).parents().addBack().filter("[class^=annotator-]").not(this.wrapper).length},Annotator.prototype.onHighlightMouseover=function(event){var annotations;return this.clearViewerHideTimer(),this.mouseIsDown||this.viewer.isShown()?!1:(annotations=$(event.target).parents(".annotator-hl").addBack().map(function(){return $(this).data("annotation")}),this.showViewer($.makeArray(annotations),Util.mousePosition(event,this.wrapper[0])))},Annotator.prototype.onAdderMousedown=function(event){return null!=event&&event.preventDefault(),this.ignoreMouseup=!0},Annotator.prototype.onAdderClick=function(event){var annotation,cancel,cleanup,position,save,_this=this;return null!=event&&event.preventDefault(),position=this.adder.position(),this.adder.hide(),annotation=this.setupAnnotation(this.createAnnotation()),$(annotation.highlights).addClass("annotator-hl-temporary"),save=function(){return cleanup(),$(annotation.highlights).removeClass("annotator-hl-temporary"),_this.publish("annotationCreated",[annotation])},cancel=function(){return cleanup(),_this.deleteAnnotation(annotation)},cleanup=function(){return _this.unsubscribe("annotationEditorHidden",cancel),_this.unsubscribe("annotationEditorSubmit",save)},this.subscribe("annotationEditorHidden",cancel),this.subscribe("annotationEditorSubmit",save),this.showEditor(annotation,position)},Annotator.prototype.onEditAnnotation=function(annotation){var cleanup,offset,update,_this=this;return offset=this.viewer.element.position(),update=function(){return cleanup(),_this.updateAnnotation(annotation)},cleanup=function(){return _this.unsubscribe("annotationEditorHidden",cleanup),_this.unsubscribe("annotationEditorSubmit",update)},this.subscribe("annotationEditorHidden",cleanup),this.subscribe("annotationEditorSubmit",update),this.viewer.hide(),this.showEditor(annotation,offset)},Annotator.prototype.onDeleteAnnotation=function(annotation){return this.viewer.hide(),this.deleteAnnotation(annotation)},Annotator}(Delegator),Annotator.Plugin=function(_super){function Plugin(){Plugin.__super__.constructor.apply(this,arguments)}return __extends(Plugin,_super),Plugin.prototype.pluginInit=function(){},Plugin.prototype.destroy=function(){return this.removeEvents()},Plugin}(Delegator),g=Util.getGlobal(),null==(null!=(_ref=g.document)?_ref.evaluate:void 0)&&$.getScript("//assets.annotateit.org/vendor/xpath.min.js"),null==g.getSelection&&$.getScript("//assets.annotateit.org/vendor/ierange.min.js"),null==g.JSON&&$.getScript("//assets.annotateit.org/vendor/json2.min.js"),null==g.Node&&(g.Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}),Annotator.$=$,Annotator.Delegator=Delegator,Annotator.Range=Range,Annotator.Util=Util,Annotator._instances=[],Annotator._t=_t,Annotator.supported=function(){return function(){return!!this.getSelection}()},Annotator.noConflict=function(){return Util.getGlobal().Annotator=_Annotator,this},$.fn.annotator=function(options){var args;args=Array.prototype.slice.call(arguments,1);var temp=this.each(function(){var instance;return instance=$.data(this,"annotator"),instance?options&&instance[options].apply(instance,args):(instance=new Annotator(this,options),$.data(this,"annotator",instance))});return temp},this.Annotator=Annotator;var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Annotator.Widget=function(_super){function Widget(){Widget.__super__.constructor.apply(this,arguments),this.classes=$.extend({},Annotator.Widget.prototype.classes,this.classes)}return __extends(Widget,_super),Widget.prototype.classes={hide:"annotator-hide",invert:{x:"annotator-invert-x",y:"annotator-invert-y"}},Widget.prototype.destroy=function(){return this.removeEvents(),this.element.remove()},Widget.prototype.checkOrientation=function(){var current,offset,viewport,widget,window;return this.resetOrientation(),window=$(Annotator.Util.getGlobal()),widget=this.element.children(":first"),offset=widget.offset(),viewport={top:window.scrollTop(),right:window.width()+window.scrollLeft()},current={top:offset.top,right:offset.left+widget.width()},current.top-viewport.top<0&&this.invertY(),current.right-viewport.right>0&&this.invertX(),this},Widget.prototype.resetOrientation=function(){return this.element.removeClass(this.classes.invert.x).removeClass(this.classes.invert.y),this},Widget.prototype.invertX=function(){return this.element.addClass(this.classes.invert.x),this},Widget.prototype.invertY=function(){return this.element.addClass(this.classes.invert.y),this},Widget.prototype.isInvertedY=function(){return this.element.hasClass(this.classes.invert.y)},Widget.prototype.isInvertedX=function(){return this.element.hasClass(this.classes.invert.x)},Widget}(Delegator);var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Annotator.Editor=function(_super){function Editor(options){this.onCancelButtonMouseover=__bind(this.onCancelButtonMouseover,this),this.processKeypress=__bind(this.processKeypress,this),this.submit=__bind(this.submit,this),this.load=__bind(this.load,this),this.hide=__bind(this.hide,this),this.show=__bind(this.show,this),Editor.__super__.constructor.call(this,$(this.html)[0],options),this.fields=[],this.annotation={}}return __extends(Editor,_super),Editor.prototype.events={"form submit":"submit",".annotator-save click":"submit",".annotator-cancel click":"hide",".annotator-cancel mouseover":"onCancelButtonMouseover","textarea keydown":"processKeypress"},Editor.prototype.classes={hide:"annotator-hide",focus:"annotator-focus"},Editor.prototype.html='<div class="annotator-outer annotator-editor">\n  <form class="annotator-widget">\n    <ul class="annotator-listing"></ul>\n    <div class="annotator-controls">\n      <a href="#cancel" class="annotator-cancel">'+_t("Cancel")+'</a>\n<a href="#save" class="annotator-save annotator-focus">'+_t("Save")+"</a>\n    </div>\n  </form>\n</div>",Editor.prototype.options={},Editor.prototype.show=function(event){return Annotator.Util.preventEventDefault(event),this.element.removeClass(this.classes.hide),this.element.find(".annotator-save").addClass(this.classes.focus),this.checkOrientation(),this.element.find(":input:first").focus(),this.setupDraggables(),this.publish("show")},Editor.prototype.hide=function(event){return Annotator.Util.preventEventDefault(event),this.element.addClass(this.classes.hide),this.publish("hide")},Editor.prototype.load=function(annotation){var field,_i,_len,_ref;for(this.annotation=annotation,this.publish("load",[this.annotation]),_ref=this.fields,_i=0,_len=_ref.length;_len>_i;_i++)field=_ref[_i],field.load(field.element,this.annotation);return this.show()},Editor.prototype.submit=function(event){var field,_i,_len,_ref;for(Annotator.Util.preventEventDefault(event),_ref=this.fields,_i=0,_len=_ref.length;_len>_i;_i++)field=_ref[_i],field.submit(field.element,this.annotation);return this.publish("save",[this.annotation]),this.hide()},Editor.prototype.addField=function(options){var element,field,input;switch(field=$.extend({id:"annotator-field-"+Annotator.Util.uuid(),type:"input",label:"",load:function(){},submit:function(){}},options),input=null,element=$('<li class="annotator-item" />'),field.element=element[0],field.type){case"textarea":input=$("<textarea />");break;case"input":case"checkbox":input=$("<input />");break;case"select":input=$("<select />")}return element.append(input),input.attr({id:field.id,placeholder:field.label}),"checkbox"===field.type&&(input[0].type="checkbox",element.addClass("annotator-checkbox"),element.append($("<label />",{"for":field.id,html:field.label}))),this.element.find("ul:first").append(element),this.fields.push(field),field.element},Editor.prototype.checkOrientation=function(){var controls,list;return Editor.__super__.checkOrientation.apply(this,arguments),list=this.element.find(".annotator-listing"),controls=this.element.find(".annotator-controls"),this.element.hasClass(this.classes.invert.y)?controls.insertBefore(list):controls.is(":first-child")&&controls.insertAfter(list),this},Editor.prototype.processKeypress=function(event){return 27===event.keyCode?this.hide():13!==event.keyCode||event.shiftKey?void 0:this.submit()},Editor.prototype.onCancelButtonMouseover=function(){return this.element.find("."+this.classes.focus).removeClass(this.classes.focus)},Editor.prototype.setupDraggables=function(){var classes,controls,cornerItem,editor,mousedown,onMousedown,onMousemove,onMouseup,resize,textarea,throttle;return this.element.find(".annotator-resize").remove(),cornerItem=this.element.find(this.element.hasClass(this.classes.invert.y)?".annotator-item:last":".annotator-item:first"),cornerItem&&$('<span class="annotator-resize"></span>').appendTo(cornerItem),mousedown=null,classes=this.classes,editor=this.element,textarea=null,resize=editor.find(".annotator-resize"),controls=editor.find(".annotator-controls"),throttle=!1,onMousedown=function(event){return event.target===this?(mousedown={element:this,top:event.pageY,left:event.pageX},textarea=editor.find("textarea:first"),$(window).bind({"mouseup.annotator-editor-resize":onMouseup,"mousemove.annotator-editor-resize":onMousemove}),event.preventDefault()):void 0},onMouseup=function(){return mousedown=null,$(window).unbind(".annotator-editor-resize")},onMousemove=function(event){var diff,directionX,directionY,height,width;return mousedown&&throttle===!1?(diff={top:event.pageY-mousedown.top,left:event.pageX-mousedown.left},mousedown.element===resize[0]?(height=textarea.outerHeight(),width=textarea.outerWidth(),directionX=editor.hasClass(classes.invert.x)?-1:1,directionY=editor.hasClass(classes.invert.y)?1:-1,textarea.height(height+diff.top*directionY),textarea.width(width+diff.left*directionX),textarea.outerHeight()!==height&&(mousedown.top=event.pageY),textarea.outerWidth()!==width&&(mousedown.left=event.pageX)):mousedown.element===controls[0]&&(editor.css({top:parseInt(editor.css("top"),10)+diff.top,left:parseInt(editor.css("left"),10)+diff.left}),mousedown.top=event.pageY,mousedown.left=event.pageX),throttle=!0,setTimeout(function(){return throttle=!1},1e3/60)):void 0},resize.bind("mousedown",onMousedown),controls.bind("mousedown",onMousedown)},Editor}(Annotator.Widget);var LinkParser,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Annotator.Viewer=function(_super){function Viewer(options){this.onDeleteClick=__bind(this.onDeleteClick,this),this.onEditClick=__bind(this.onEditClick,this),this.load=__bind(this.load,this),this.hide=__bind(this.hide,this),this.show=__bind(this.show,this),Viewer.__super__.constructor.call(this,$(this.html.element)[0],options),this.item=$(this.html.item)[0],this.fields=[],this.annotations=[]}return __extends(Viewer,_super),Viewer.prototype.events={".annotator-edit click":"onEditClick",".annotator-delete click":"onDeleteClick"},Viewer.prototype.classes={hide:"annotator-hide",showControls:"annotator-visible"},Viewer.prototype.html={element:'<div class="annotator-outer annotator-viewer">\n  <ul class="annotator-widget annotator-listing"></ul>\n</div>',item:'<li class="annotator-annotation annotator-item">\n  <span class="annotator-controls">\n    <a href="#" title="View as webpage" class="annotator-link">View as webpage</a>\n    <button title="Edit" class="annotator-edit">Edit</button>\n    <button title="Delete" class="annotator-delete">Delete</button>\n  </span>\n</li>'},Viewer.prototype.options={readOnly:!1},Viewer.prototype.show=function(event){var controls,_this=this;return Annotator.Util.preventEventDefault(event),controls=this.element.find(".annotator-controls").addClass(this.classes.showControls),setTimeout(function(){return controls.removeClass(_this.classes.showControls)},500),this.element.removeClass(this.classes.hide),this.checkOrientation().publish("show")},Viewer.prototype.isShown=function(){return!this.element.hasClass(this.classes.hide)},Viewer.prototype.hide=function(event){return Annotator.Util.preventEventDefault(event),this.element.addClass(this.classes.hide),this.publish("hide")},Viewer.prototype.load=function(annotations){var annotation,controller,controls,del,edit,element,field,item,link,links,list,_i,_j,_len,_len1,_ref,_ref1;for(this.annotations=annotations||[],list=this.element.find("ul:first").empty(),_ref=this.annotations,_i=0,_len=_ref.length;_len>_i;_i++)for(annotation=_ref[_i],item=$(this.item).clone().appendTo(list).data("annotation",annotation),controls=item.find(".annotator-controls"),link=controls.find(".annotator-link"),edit=controls.find(".annotator-edit"),del=controls.find(".annotator-delete"),links=new LinkParser(annotation.links||[]).get("alternate",{type:"text/html"}),0===links.length||null==links[0].href?link.remove():link.attr("href",links[0].href),this.options.readOnly?(edit.remove(),del.remove()):controller={showEdit:function(){return edit.removeAttr("disabled")},hideEdit:function(){return edit.attr("disabled","disabled")},showDelete:function(){return del.removeAttr("disabled")},hideDelete:function(){return del.attr("disabled","disabled")}},_ref1=this.fields,_j=0,_len1=_ref1.length;_len1>_j;_j++)field=_ref1[_j],element=$(field.element).clone().appendTo(item)[0],field.load(element,annotation,controller);return this.publish("load",[this.annotations]),this.show()},Viewer.prototype.addField=function(options){var field;return field=$.extend({load:function(){}},options),field.element=$("<div />")[0],this.fields.push(field),field.element,this},Viewer.prototype.onEditClick=function(event){return this.onButtonClick(event,"edit")},Viewer.prototype.onDeleteClick=function(event){return this.onButtonClick(event,"delete")},Viewer.prototype.onButtonClick=function(event,type){var item;return item=$(event.target).parents(".annotator-annotation"),this.publish(type,[item.data("annotation")])},Viewer}(Annotator.Widget),LinkParser=function(){function LinkParser(data){this.data=data}return LinkParser.prototype.get=function(rel,cond){var d,k,keys,match,v,_i,_len,_ref,_results;for(null==cond&&(cond={}),cond=$.extend({},cond,{rel:rel}),keys=function(){var _results;_results=[];for(k in cond)__hasProp.call(cond,k)&&(v=cond[k],_results.push(k));return _results}(),_ref=this.data,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)d=_ref[_i],match=keys.reduce(function(m,k){return m&&d[k]===cond[k]},!0),match&&_results.push(d);return _results},LinkParser}();var Annotator,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Annotator=Annotator||{},Annotator.Notification=function(_super){function Notification(options){this.hide=__bind(this.hide,this),this.show=__bind(this.show,this),Notification.__super__.constructor.call(this,$(this.options.html).appendTo(document.body)[0],options)}return __extends(Notification,_super),Notification.prototype.events={click:"hide"},Notification.prototype.options={html:"<div class='annotator-notice'></div>",classes:{show:"annotator-notice-show",info:"annotator-notice-info",success:"annotator-notice-success",error:"annotator-notice-error"}},Notification.prototype.show=function(message,status){return null==status&&(status=Annotator.Notification.INFO),this.currentStatus=status,$(this.element).addClass(this.options.classes.show).addClass(this.options.classes[this.currentStatus]).html(Util.escape(message||"")),setTimeout(this.hide,5e3),this},Notification.prototype.hide=function(){return null==this.currentStatus&&(this.currentStatus=Annotator.Notification.INFO),$(this.element).removeClass(this.options.classes.show).removeClass(this.options.classes[this.currentStatus]),this},Notification}(Delegator),Annotator.Notification.INFO="info",Annotator.Notification.SUCCESS="success",Annotator.Notification.ERROR="error",$(function(){var notification;return notification=new Annotator.Notification,Annotator.showNotification=notification.show,Annotator.hideNotification=notification.hide});var _ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Annotator.Plugin.Unsupported=function(_super){function Unsupported(){return _ref=Unsupported.__super__.constructor.apply(this,arguments)}return __extends(Unsupported,_super),Unsupported.prototype.options={message:Annotator._t("Sorry your current browser does not support the Annotator")},Unsupported.prototype.pluginInit=function(){var _this=this;return Annotator.supported()?void 0:$(function(){return Annotator.showNotification(_this.options.message),void 0===window.XMLHttpRequest&&void 0!==ActiveXObject?$("html").addClass("ie6"):void 0})},Unsupported}(Annotator.Plugin);var base64Decode,base64UrlDecode,createDateFromISO8601,parseToken,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};createDateFromISO8601=function(string){var d,date,offset,regexp,time,_ref;return regexp="([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(\\.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?",d=string.match(new RegExp(regexp)),offset=0,date=new Date(d[1],0,1),d[3]&&date.setMonth(d[3]-1),d[5]&&date.setDate(d[5]),d[7]&&date.setHours(d[7]),d[8]&&date.setMinutes(d[8]),d[10]&&date.setSeconds(d[10]),d[12]&&date.setMilliseconds(1e3*Number("0."+d[12])),d[14]&&(offset=60*Number(d[16])+Number(d[17]),offset*=null!=(_ref="-"===d[15])?_ref:{1:-1}),offset-=date.getTimezoneOffset(),time=Number(date)+60*offset*1e3,date.setTime(Number(time)),date},base64Decode=function(data){var ac,b64,bits,dec,h1,h2,h3,h4,i,o1,o2,o3,tmp_arr;if("undefined"!=typeof atob&&null!==atob)return atob(data);if(b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=0,ac=0,dec="",tmp_arr=[],!data)return data;for(data+="";i<data.length;)h1=b64.indexOf(data.charAt(i++)),h2=b64.indexOf(data.charAt(i++)),h3=b64.indexOf(data.charAt(i++)),h4=b64.indexOf(data.charAt(i++)),bits=h1<<18|h2<<12|h3<<6|h4,o1=bits>>16&255,o2=bits>>8&255,o3=255&bits,tmp_arr[ac++]=64===h3?String.fromCharCode(o1):64===h4?String.fromCharCode(o1,o2):String.fromCharCode(o1,o2,o3);return tmp_arr.join("")},base64UrlDecode=function(data){var i,m,_i,_ref;if(m=data.length%4,0!==m)for(i=_i=0,_ref=4-m;_ref>=0?_ref>_i:_i>_ref;i=_ref>=0?++_i:--_i)data+="=";return data=data.replace(/-/g,"+"),data=data.replace(/_/g,"/"),base64Decode(data)},parseToken=function(token){var head,payload,sig,_ref;return _ref=token.split("."),head=_ref[0],payload=_ref[1],sig=_ref[2],JSON.parse(base64UrlDecode(payload))},Annotator.Plugin.Auth=function(_super){function Auth(){Auth.__super__.constructor.apply(this,arguments),this.waitingForToken=[],this.options.token?this.setToken(this.options.token):this.requestToken()}return __extends(Auth,_super),Auth.prototype.options={token:null,tokenUrl:"/auth/token",autoFetch:!0},Auth.prototype.requestToken=function(){var _this=this;return this.requestInProgress=!0,$.ajax({url:this.options.tokenUrl,dataType:"text",xhrFields:{withCredentials:!0}}).done(function(data){return _this.setToken(data)}).fail(function(xhr,status,err){var msg;return msg=Annotator._t("Couldn't get auth token:"),console.error(""+msg+" "+err,xhr),Annotator.showNotification(""+msg+" "+xhr.responseText,Annotator.Notification.ERROR)}).always(function(){return _this.requestInProgress=!1})},Auth.prototype.setToken=function(token){var _results,_this=this;if(this.token=token,this._unsafeToken=parseToken(token),this.haveValidToken()){for(this.options.autoFetch&&(this.refreshTimeout=setTimeout(function(){return _this.requestToken()},1e3*(this.timeToExpiry()-2))),this.updateHeaders(),_results=[];this.waitingForToken.length>0;)_results.push(this.waitingForToken.pop()(this._unsafeToken));return _results}return console.warn(Annotator._t("Didn't get a valid token.")),this.options.autoFetch?(console.warn(Annotator._t("Getting a new token in 10s.")),setTimeout(function(){return _this.requestToken()},1e4)):void 0},Auth.prototype.haveValidToken=function(){var allFields;return allFields=this._unsafeToken&&this._unsafeToken.issuedAt&&this._unsafeToken.ttl&&this._unsafeToken.consumerKey,allFields&&this.timeToExpiry()>0?!0:!1},Auth.prototype.timeToExpiry=function(){var expiry,issue,now,timeToExpiry;return now=(new Date).getTime()/1e3,issue=createDateFromISO8601(this._unsafeToken.issuedAt).getTime()/1e3,expiry=issue+this._unsafeToken.ttl,timeToExpiry=expiry-now,timeToExpiry>0?timeToExpiry:0},Auth.prototype.updateHeaders=function(){var current;return current=this.element.data("annotator:headers"),this.element.data("annotator:headers",$.extend(current,{"x-annotator-auth-token":this.token}))},Auth.prototype.withToken=function(callback){return null!=callback?this.haveValidToken()?callback(this._unsafeToken):(this.waitingForToken.push(callback),this.requestInProgress?void 0:this.requestToken()):void 0},Auth}(Annotator.Plugin);var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};Annotator.Plugin.Store=function(_super){function Store(){this._onError=__bind(this._onError,this),this._onLoadAnnotationsFromSearch=__bind(this._onLoadAnnotationsFromSearch,this),this._onLoadAnnotations=__bind(this._onLoadAnnotations,this),this._getAnnotations=__bind(this._getAnnotations,this),Store.__super__.constructor.apply(this,arguments),this.annotations=[]}return __extends(Store,_super),Store.prototype.events={annotationCreated:"annotationCreated",annotationDeleted:"annotationDeleted",annotationUpdated:"annotationUpdated"},Store.prototype.options={annotationData:{},emulateHTTP:!1,loadFromSearch:!1,prefix:"/store",urls:{create:"/annotations",read:"/annotations/:id",update:"/annotations/:id",destroy:"/annotations/:id",search:"/search"}},Store.prototype.pluginInit=function(){return Annotator.supported()?this.annotator.plugins.Auth?this.annotator.plugins.Auth.withToken(this._getAnnotations):this._getAnnotations():void 0},Store.prototype._getAnnotations=function(){return this.options.loadFromSearch?this.loadAnnotationsFromSearch(this.options.loadFromSearch):this.loadAnnotations()},Store.prototype.annotationCreated=function(annotation){var _this=this;return __indexOf.call(this.annotations,annotation)<0?(this.registerAnnotation(annotation),this._apiRequest("create",annotation,function(data){return null==data.id&&console.warn(Annotator._t("Warning: No ID returned from server for annotation "),annotation),_this.updateAnnotation(annotation,data)})):this.updateAnnotation(annotation,{})},Store.prototype.annotationUpdated=function(annotation){var _this=this;return __indexOf.call(this.annotations,annotation)>=0?this._apiRequest("update",annotation,function(data){return _this.updateAnnotation(annotation,data)}):void 0},Store.prototype.annotationDeleted=function(annotation){var _this=this;return __indexOf.call(this.annotations,annotation)>=0?this._apiRequest("destroy",annotation,function(){return _this.unregisterAnnotation(annotation)}):void 0},Store.prototype.registerAnnotation=function(annotation){return this.annotations.push(annotation)},Store.prototype.unregisterAnnotation=function(annotation){return this.annotations.splice(this.annotations.indexOf(annotation),1)},Store.prototype.updateAnnotation=function(annotation,data){return __indexOf.call(this.annotations,annotation)<0?console.error(Annotator._t("Trying to update unregistered annotation!")):$.extend(annotation,data),$(annotation.highlights).data("annotation",annotation)},Store.prototype.loadAnnotations=function(){return this._apiRequest("read",null,this._onLoadAnnotations)},Store.prototype._onLoadAnnotations=function(data){var a,annotation,annotationMap,newData,_i,_j,_len,_len1,_ref;for(null==data&&(data=[]),annotationMap={},_ref=this.annotations,_i=0,_len=_ref.length;_len>_i;_i++)a=_ref[_i],annotationMap[a.id]=a;for(newData=[],_j=0,_len1=data.length;_len1>_j;_j++)a=data[_j],annotationMap[a.id]?(annotation=annotationMap[a.id],this.updateAnnotation(annotation,a)):newData.push(a);return this.annotations=this.annotations.concat(newData),this.annotator.loadAnnotations(newData.slice())},Store.prototype.loadAnnotationsFromSearch=function(searchOptions){return this._apiRequest("search",searchOptions,this._onLoadAnnotationsFromSearch)},Store.prototype._onLoadAnnotationsFromSearch=function(data){return null==data&&(data={}),this._onLoadAnnotations(data.rows||[])},Store.prototype.dumpAnnotations=function(){var ann,_i,_len,_ref,_results;for(_ref=this.annotations,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)ann=_ref[_i],_results.push(JSON.parse(this._dataFor(ann)));return _results},Store.prototype._apiRequest=function(action,obj,onSuccess){var id,options,request,url;return id=obj&&obj.id,url=this._urlFor(action,id),options=this._apiRequestOptions(action,obj,onSuccess),request=$.ajax(url,options),request._id=id,request._action=action,request},Store.prototype._apiRequestOptions=function(action,obj,onSuccess){var data,method,opts;return method=this._methodFor(action),opts={type:method,headers:this.element.data("annotator:headers"),dataType:"json",success:onSuccess||function(){},error:this._onError},!this.options.emulateHTTP||"PUT"!==method&&"DELETE"!==method||(opts.headers=$.extend(opts.headers,{"X-HTTP-Method-Override":method}),opts.type="POST"),"search"===action?opts=$.extend(opts,{data:obj}):(data=obj&&this._dataFor(obj),this.options.emulateJSON?(opts.data={json:data},this.options.emulateHTTP&&(opts.data._method=method),opts):opts=$.extend(opts,{data:data,contentType:"application/json; charset=utf-8"}))},Store.prototype._urlFor=function(action,id){var url;return url=null!=this.options.prefix?this.options.prefix:"",url+=this.options.urls[action],url=url.replace(/\/:id/,null!=id?"/"+id:""),url=url.replace(/:id/,null!=id?id:"")},Store.prototype._methodFor=function(action){var table;return table={create:"POST",read:"GET",update:"PUT",destroy:"DELETE",search:"GET"},table[action]},Store.prototype._dataFor=function(annotation){var data,highlights;return highlights=annotation.highlights,delete annotation.highlights,$.extend(annotation,this.options.annotationData),data=JSON.stringify(annotation),highlights&&(annotation.highlights=highlights),data},Store.prototype._onError=function(xhr){var action,message;switch(action=xhr._action,message=Annotator._t("Sorry, our server seems to be down. We could not ")+action+Annotator._t(" this annotation"),"search"===xhr._action?message=Annotator._t("Sorry, the Annotations service is down. Contact your instructor and try again later."):"read"!==xhr._action||xhr._id||(message=Annotator._t("Sorry, our server seems to be down. We could not ")+action+Annotator._t(" the annotation(s).")),xhr.status){case 401:message=Annotator._t("Sorry, you are not allowed to ")+action+Annotator._t(" this annotation");break;case 404:message=Annotator._t("Sorry, we could not connect to the annotations database.");break;case 500:message=Annotator._t("Sorry, our server is down. Contact your instructor and try again later.")}return Annotator.showNotification(message,Annotator.Notification.ERROR),console.error(Annotator._t("API request failed:")+(" '"+xhr.status+"'"))},Store}(Annotator.Plugin);var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Annotator.Plugin.Permissions=function(_super){function Permissions(){this._setAuthFromToken=__bind(this._setAuthFromToken,this),this.updateViewer=__bind(this.updateViewer,this),this.updateAnnotationPermissions=__bind(this.updateAnnotationPermissions,this),this.updatePermissionsField=__bind(this.updatePermissionsField,this),this.addFieldsToAnnotation=__bind(this.addFieldsToAnnotation,this),Permissions.__super__.constructor.apply(this,arguments),this.options.user&&(this.setUser(this.options.user),delete this.options.user)}return __extends(Permissions,_super),Permissions.prototype.events={beforeAnnotationCreated:"addFieldsToAnnotation"},Permissions.prototype.options={showViewPermissionsCheckbox:!0,showEditPermissionsCheckbox:!0,userId:function(user){return user},userString:function(user){return user},userAuthorize:function(action,annotation,user){var token,tokens,_i,_len;if(annotation.permissions){if(tokens=annotation.permissions[action]||[],0===tokens.length)return!0;for(_i=0,_len=tokens.length;_len>_i;_i++)if(token=tokens[_i],this.userId(user)===token)return!0;return!1}return annotation.user?user?this.userId(user)===this.userId(annotation.user):!1:!0},user:"",permissions:{read:[],update:[],"delete":[],admin:[]}},Permissions.prototype.pluginInit=function(){var createCallback,self,_this=this;if(Annotator.supported())return self=this,createCallback=function(method,type){return function(field,annotation){return self[method].call(self,type,field,annotation)
}},!this.user&&this.annotator.plugins.Auth&&this.annotator.plugins.Auth.withToken(this._setAuthFromToken),this.options.showViewPermissionsCheckbox===!0&&this.annotator.editor.addField({type:"checkbox",label:Annotator._t("Allow anyone to <strong>view</strong> this annotation"),load:createCallback("updatePermissionsField","read"),submit:createCallback("updateAnnotationPermissions","read")}),this.options.showEditPermissionsCheckbox===!0&&this.annotator.editor.addField({type:"checkbox",label:Annotator._t("Allow anyone to <strong>edit</strong> this annotation"),load:createCallback("updatePermissionsField","update"),submit:createCallback("updateAnnotationPermissions","update")}),this.annotator.viewer.addField({load:this.updateViewer}),this.annotator.plugins.Filter?this.annotator.plugins.Filter.addFilter({label:Annotator._t("User"),property:"user",isFiltered:function(input,user){var keyword,_i,_len,_ref;if(user=_this.options.userString(user),!input||!user)return!1;for(_ref=input.split(/\s*/),_i=0,_len=_ref.length;_len>_i;_i++)if(keyword=_ref[_i],-1===user.indexOf(keyword))return!1;return!0}}):void 0},Permissions.prototype.setUser=function(user){return this.user=user},Permissions.prototype.addFieldsToAnnotation=function(annotation){return annotation&&(annotation.permissions=this.options.permissions,this.user)?annotation.user=this.user:void 0},Permissions.prototype.authorize=function(action,annotation,user){return void 0===user&&(user=this.user),this.options.userAuthorize?this.options.userAuthorize.call(this.options,action,annotation,user):!0},Permissions.prototype.updatePermissionsField=function(action,field,annotation){var input;return field=$(field).show(),input=field.find("input").removeAttr("disabled"),this.authorize("admin",annotation)||field.hide(),this.authorize(action,annotation||{},null)?input.attr("checked","checked"):input.removeAttr("checked")},Permissions.prototype.updateAnnotationPermissions=function(type,field,annotation){var dataKey;return annotation.permissions||(annotation.permissions=this.options.permissions),dataKey=type+"-permissions",annotation.permissions[type]=$(field).find("input").is(":checked")?[]:[this.options.userId(this.user)]},Permissions.prototype.updateViewer=function(field,annotation,controls){var user,username;return field=$(field),username=this.options.userString(annotation.user),annotation.user&&username&&"string"==typeof username?(user=Annotator.Util.escape(this.options.userString(annotation.user)),field.html(user).addClass("annotator-user")):field.remove(),controls&&(this.authorize("update",annotation)||controls.hideEdit(),!this.authorize("delete",annotation))?controls.hideDelete():void 0},Permissions.prototype._setAuthFromToken=function(token){return this.setUser(token.userId)},Permissions}(Annotator.Plugin);var _ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};Annotator.Plugin.AnnotateItPermissions=function(_super){function AnnotateItPermissions(){return this._setAuthFromToken=__bind(this._setAuthFromToken,this),this.updateAnnotationPermissions=__bind(this.updateAnnotationPermissions,this),this.updatePermissionsField=__bind(this.updatePermissionsField,this),this.addFieldsToAnnotation=__bind(this.addFieldsToAnnotation,this),_ref=AnnotateItPermissions.__super__.constructor.apply(this,arguments)}return __extends(AnnotateItPermissions,_super),AnnotateItPermissions.prototype.options={showViewPermissionsCheckbox:!0,showEditPermissionsCheckbox:!0,groups:{world:"group:__world__",authenticated:"group:__authenticated__",consumer:"group:__consumer__"},userId:function(user){return user.userId},userString:function(user){return user.userId},userAuthorize:function(action,annotation,user){var action_field,permissions,_ref1,_ref2,_ref3,_ref4;return permissions=annotation.permissions||{},action_field=permissions[action]||[],_ref1=this.groups.world,__indexOf.call(action_field,_ref1)>=0?!0:null!=user&&null!=user.userId&&null!=user.consumerKey?user.userId===annotation.user&&user.consumerKey===annotation.consumer?!0:(_ref2=this.groups.authenticated,__indexOf.call(action_field,_ref2)>=0?!0:user.consumerKey===annotation.consumer&&(_ref3=this.groups.consumer,__indexOf.call(action_field,_ref3)>=0)?!0:user.consumerKey===annotation.consumer&&(_ref4=user.userId,__indexOf.call(action_field,_ref4)>=0)?!0:user.consumerKey===annotation.consumer&&user.admin?!0:!1):!1},permissions:{read:["group:__world__"],update:[],"delete":[],admin:[]}},AnnotateItPermissions.prototype.addFieldsToAnnotation=function(annotation){return annotation&&(annotation.permissions=this.options.permissions,this.user)?(annotation.user=this.user.userId,annotation.consumer=this.user.consumerKey):void 0},AnnotateItPermissions.prototype.updatePermissionsField=function(action,field,annotation){var input;return field=$(field).show(),input=field.find("input").removeAttr("disabled"),this.authorize("admin",annotation)||field.hide(),this.user&&this.authorize(action,annotation||{},{userId:"__nonexistentuser__",consumerKey:this.user.consumerKey})?input.attr("checked","checked"):input.removeAttr("checked")},AnnotateItPermissions.prototype.updateAnnotationPermissions=function(type,field,annotation){var dataKey;return annotation.permissions||(annotation.permissions=this.options.permissions),dataKey=type+"-permissions",annotation.permissions[type]=$(field).find("input").is(":checked")?["read"===type?this.options.groups.world:this.options.groups.consumer]:[]},AnnotateItPermissions.prototype._setAuthFromToken=function(token){return this.setUser(token)},AnnotateItPermissions}(Annotator.Plugin.Permissions);var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Annotator.Plugin.Filter=function(_super){function Filter(element,options){this._onPreviousClick=__bind(this._onPreviousClick,this),this._onNextClick=__bind(this._onNextClick,this),this._onFilterKeyup=__bind(this._onFilterKeyup,this),this._onFilterBlur=__bind(this._onFilterBlur,this),this._onFilterFocus=__bind(this._onFilterFocus,this),this.updateHighlights=__bind(this.updateHighlights,this);var _base;element=$(this.html.element).appendTo((null!=options?options.appendTo:void 0)||this.options.appendTo),Filter.__super__.constructor.call(this,element,options),(_base=this.options).filters||(_base.filters=[]),this.filter=$(this.html.filter),this.filters=[],this.current=0}return __extends(Filter,_super),Filter.prototype.events={".annotator-filter-property input focus":"_onFilterFocus",".annotator-filter-property input blur":"_onFilterBlur",".annotator-filter-property input keyup":"_onFilterKeyup",".annotator-filter-previous click":"_onPreviousClick",".annotator-filter-next click":"_onNextClick",".annotator-filter-clear click":"_onClearClick"},Filter.prototype.classes={active:"annotator-filter-active",hl:{hide:"annotator-hl-filtered",active:"annotator-hl-active"}},Filter.prototype.html={element:'<div class="annotator-filter">\n  <strong>'+Annotator._t("Navigate:")+'</strong>\n<span class="annotator-filter-navigation">\n  <button class="annotator-filter-previous">'+Annotator._t("Previous")+'</button>\n<button class="annotator-filter-next">'+Annotator._t("Next")+"</button>\n</span>\n<strong>"+Annotator._t("Filter by:")+"</strong>\n</div>",filter:'<span class="annotator-filter-property">\n  <label></label>\n  <input/>\n  <button class="annotator-filter-clear">'+Annotator._t("Clear")+"</button>\n</span>"},Filter.prototype.options={appendTo:"body",filters:[],addAnnotationFilter:!0,isFiltered:function(input,property){var keyword,_i,_len,_ref;if(!input||!property)return!1;for(_ref=input.split(/\s+/),_i=0,_len=_ref.length;_len>_i;_i++)if(keyword=_ref[_i],-1===property.indexOf(keyword))return!1;return!0}},Filter.prototype.pluginInit=function(){var filter,_i,_len,_ref;for(_ref=this.options.filters,_i=0,_len=_ref.length;_len>_i;_i++)filter=_ref[_i],this.addFilter(filter);return this.updateHighlights(),this._setupListeners()._insertSpacer(),this.options.addAnnotationFilter===!0?this.addFilter({label:Annotator._t("Annotation"),property:"text"}):void 0},Filter.prototype.destroy=function(){var currentMargin,html;return Filter.__super__.destroy.apply(this,arguments),html=$("html"),currentMargin=parseInt(html.css("padding-top"),10)||0,html.css("padding-top",currentMargin-this.element.outerHeight()),this.element.remove()},Filter.prototype._insertSpacer=function(){var currentMargin,html;return html=$("html"),currentMargin=parseInt(html.css("padding-top"),10)||0,html.css("padding-top",currentMargin+this.element.outerHeight()),this},Filter.prototype._setupListeners=function(){var event,events,_i,_len;for(events=["annotationsLoaded","annotationCreated","annotationUpdated","annotationDeleted"],_i=0,_len=events.length;_len>_i;_i++)event=events[_i],this.annotator.subscribe(event,this.updateHighlights);return this},Filter.prototype.addFilter=function(options){var f,filter;return filter=$.extend({label:"",property:"",isFiltered:this.options.isFiltered},options),function(){var _i,_len,_ref,_results;for(_ref=this.filters,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)f=_ref[_i],f.property===filter.property&&_results.push(f);return _results}.call(this).length||(filter.id="annotator-filter-"+filter.property,filter.annotations=[],filter.element=this.filter.clone().appendTo(this.element),filter.element.find("label").html(filter.label).attr("for",filter.id),filter.element.find("input").attr({id:filter.id,placeholder:Annotator._t("Filter by ")+filter.label+"…"}),filter.element.find("button").hide(),filter.element.data("filter",filter),this.filters.push(filter)),this},Filter.prototype.updateFilter=function(filter){var annotation,annotations,input,property,_i,_len,_ref;if(filter.annotations=[],this.updateHighlights(),this.resetHighlights(),input=$.trim(filter.element.find("input").val())){for(annotations=this.highlights.map(function(){return $(this).data("annotation")}),_ref=$.makeArray(annotations),_i=0,_len=_ref.length;_len>_i;_i++)annotation=_ref[_i],property=annotation[filter.property],filter.isFiltered(input,property)&&filter.annotations.push(annotation);return this.filterHighlights()}},Filter.prototype.updateHighlights=function(){return this.highlights=this.annotator.element.find(".annotator-hl:visible"),this.filtered=this.highlights.not(this.classes.hl.hide)},Filter.prototype.filterHighlights=function(){var activeFilters,annotation,annotations,filtered,highlights,index,uniques,_i,_len,_ref;for(activeFilters=$.grep(this.filters,function(filter){return!!filter.annotations.length}),filtered=(null!=(_ref=activeFilters[0])?_ref.annotations:void 0)||[],activeFilters.length>1&&(annotations=[],$.each(activeFilters,function(){return $.merge(annotations,this.annotations)}),uniques=[],filtered=[],$.each(annotations,function(){return-1===$.inArray(this,uniques)?uniques.push(this):filtered.push(this)})),highlights=this.highlights,index=_i=0,_len=filtered.length;_len>_i;index=++_i)annotation=filtered[index],highlights=highlights.not(annotation.highlights);return highlights.addClass(this.classes.hl.hide),this.filtered=this.highlights.not(this.classes.hl.hide),this},Filter.prototype.resetHighlights=function(){return this.highlights.removeClass(this.classes.hl.hide),this.filtered=this.highlights,this},Filter.prototype._onFilterFocus=function(event){var input;return input=$(event.target),input.parent().addClass(this.classes.active),input.next("button").show()},Filter.prototype._onFilterBlur=function(event){var input;return event.target.value?void 0:(input=$(event.target),input.parent().removeClass(this.classes.active),input.next("button").hide())},Filter.prototype._onFilterKeyup=function(event){var filter;return filter=$(event.target).parent().data("filter"),filter?this.updateFilter(filter):void 0},Filter.prototype._findNextHighlight=function(previous){var active,annotation,current,index,next,offset,operator,resetOffset;return this.highlights.length?(offset=previous?0:-1,resetOffset=previous?-1:0,operator=previous?"lt":"gt",active=this.highlights.not("."+this.classes.hl.hide),current=active.filter("."+this.classes.hl.active),current.length||(current=active.eq(offset)),annotation=current.data("annotation"),index=active.index(current[0]),next=active.filter(":"+operator+"("+index+")").not(annotation.highlights).eq(resetOffset),next.length||(next=active.eq(resetOffset)),this._scrollToHighlight(next.data("annotation").highlights)):this},Filter.prototype._onNextClick=function(){return this._findNextHighlight()},Filter.prototype._onPreviousClick=function(){return this._findNextHighlight(!0)},Filter.prototype._scrollToHighlight=function(highlight){return highlight=$(highlight),this.highlights.removeClass(this.classes.hl.active),highlight.addClass(this.classes.hl.active),$("html, body").animate({scrollTop:highlight.offset().top-(this.element.height()+20)},150)},Filter.prototype._onClearClick=function(event){return $(event.target).prev("input").val("").keyup().blur()},Filter}(Annotator.Plugin);var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Annotator.Plugin.Markdown=function(_super){function Markdown(){this.updateTextField=__bind(this.updateTextField,this),null!=("undefined"!=typeof Showdown&&null!==Showdown?Showdown.converter:void 0)?(Markdown.__super__.constructor.apply(this,arguments),this.converter=new Showdown.converter):console.error(Annotator._t("To use the Markdown plugin, you must include Showdown into the page first."))}return __extends(Markdown,_super),Markdown.prototype.events={annotationViewerTextField:"updateTextField"},Markdown.prototype.updateTextField=function(field,annotation){var text;return text=Annotator.Util.escape(annotation.text||""),$(field).html(this.convert(text))},Markdown.prototype.convert=function(text){return this.converter.makeHtml(text)},Markdown}(Annotator.Plugin);var _ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Annotator.Plugin.Tags=function(_super){function Tags(){return this.setAnnotationTags=__bind(this.setAnnotationTags,this),this.updateField=__bind(this.updateField,this),_ref=Tags.__super__.constructor.apply(this,arguments)}return __extends(Tags,_super),Tags.prototype.options={parseTags:function(string){var tags;return string=$.trim(string),tags=[],string&&(tags=string.split(/\s+/)),tags},stringifyTags:function(array){return array.join(" ")}},Tags.prototype.field=null,Tags.prototype.input=null,Tags.prototype.pluginInit=function(){return Annotator.supported()?(this.field=this.annotator.editor.addField({label:Annotator._t("Add some tags here")+"…",load:this.updateField,submit:this.setAnnotationTags}),this.annotator.viewer.addField({load:this.updateViewer}),this.annotator.plugins.Filter&&this.annotator.plugins.Filter.addFilter({label:Annotator._t("Tag"),property:"tags",isFiltered:Annotator.Plugin.Tags.filterCallback}),this.input=$(this.field).find(":input")):void 0},Tags.prototype.parseTags=function(string){return this.options.parseTags(string)},Tags.prototype.stringifyTags=function(array){return this.options.stringifyTags(array)},Tags.prototype.updateField=function(field,annotation){var value;return value="",annotation.tags&&(value=this.stringifyTags(annotation.tags)),this.input.val(value)},Tags.prototype.setAnnotationTags=function(field,annotation){return annotation.tags=this.parseTags(this.input.val())},Tags.prototype.updateViewer=function(field,annotation){return field=$(field),annotation.tags&&$.isArray(annotation.tags)&&annotation.tags.length?field.addClass("annotator-tags").html(function(){var string;return string=$.map(annotation.tags,function(tag){return'<span class="annotator-tag">'+Annotator.Util.escape(tag)+"</span>"}).join(" ")}):field.remove()},Tags}(Annotator.Plugin),Annotator.Plugin.Tags.filterCallback=function(input,tags){var keyword,keywords,matches,tag,_i,_j,_len,_len1;if(null==tags&&(tags=[]),matches=0,keywords=[],input)for(keywords=input.split(/\s+/g),_i=0,_len=keywords.length;_len>_i;_i++)if(keyword=keywords[_i],tags.length)for(_j=0,_len1=tags.length;_len1>_j;_j++)tag=tags[_j],-1!==tag.indexOf(keyword)&&(matches+=1);return matches===keywords.length};var __hasProp={}.hasOwnProperty,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};Annotator.prototype.setupPlugins=function(config,options){var name,opts,pluginConfig,plugins,uri,win,_i,_len,_results;null==config&&(config={}),null==options&&(options={}),win=Annotator.Util.getGlobal(),plugins=["Unsupported","Auth","Tags","Filter","Store","AnnotateItPermissions"],win.Showdown&&plugins.push("Markdown"),uri=win.location.href.split(/#|\?/).shift()||"",pluginConfig={Tags:{},Filter:{filters:[{label:Annotator._t("User"),property:"user"},{label:Annotator._t("Tags"),property:"tags"}]},Auth:{tokenUrl:config.tokenUrl||"http://annotateit.org/api/token"},Store:{prefix:config.storeUrl||"http://annotateit.org/api",annotationData:{uri:uri},loadFromSearch:{uri:uri}}};for(name in options)__hasProp.call(options,name)&&(opts=options[name],__indexOf.call(plugins,name)<0&&plugins.push(name));for($.extend(!0,pluginConfig,options),_results=[],_i=0,_len=plugins.length;_len>_i;_i++)name=plugins[_i],_results.push(name in pluginConfig&&!pluginConfig[name]?void 0:this.addPlugin(name,pluginConfig[name]));return _results},Annotator.Plugin.Auth.prototype.haveValidToken=function(){return this._unsafeToken&&this._unsafeToken.d.issuedAt&&this._unsafeToken.d.ttl&&this._unsafeToken.d.consumerKey&&this.timeToExpiry()>0},Annotator.Plugin.Auth.prototype.timeToExpiry=function(){var expiry,issue,now,timeToExpiry;return now=(new Date).getTime()/1e3,issue=createDateFromISO8601(this._unsafeToken.d.issuedAt).getTime()/1e3,expiry=issue+this._unsafeToken.d.ttl,timeToExpiry=expiry-now,timeToExpiry>0?timeToExpiry:0},document.createElement("video"),document.createElement("audio"),document.createElement("track");var vjs=function(id,options,ready){var tag;if("string"==typeof id){if(0===id.indexOf("#")&&(id=id.slice(1)),vjs.players[id])return vjs.players[id];tag=vjs.el(id)}else tag=id;if(!tag||!tag.nodeName)throw new TypeError("The element or ID supplied is not valid. (videojs)");return tag.player||new vjs.Player(tag,options,ready)},videojs=vjs;window.videojs=window.vjs=vjs,vjs.CDN_VERSION="4.2",vjs.ACCESS_PROTOCOL="https:"==document.location.protocol?"https://":"http://",vjs.options={techOrder:["html5","flash","youtube"],html5:{},flash:{},width:300,height:150,defaultVolume:0,children:{mediaLoader:{},posterImage:{},textTrackDisplay:{},loadingSpinner:{},bigPlayButton:{},controlBar:{}},notSupportedMessage:'Sorry, no compatible source and playback technology were found for this video. Try using another browser like <a href="http://bit.ly/ccMUEC">Chrome</a> or download the latest <a href="http://adobe.ly/mwfN1">Adobe Flash Player</a>.'},"GENERATED_CDN_VSN"!==vjs.CDN_VERSION&&(videojs.options.flash.swf=vjs.ACCESS_PROTOCOL+"vjs.zencdn.net/"+vjs.CDN_VERSION+"/video-js.swf"),vjs.players={},vjs.CoreObject=vjs.CoreObject=function(){},vjs.CoreObject.extend=function(props){var init,subObj;props=props||{},init=props.init||props.init||this.prototype.init||this.prototype.init||function(){},subObj=function(){init.apply(this,arguments)},subObj.prototype=vjs.obj.create(this.prototype),subObj.prototype.constructor=subObj,subObj.extend=vjs.CoreObject.extend,subObj.create=vjs.CoreObject.create;for(var name in props)props.hasOwnProperty(name)&&(subObj.prototype[name]=props[name]);return subObj},vjs.CoreObject.create=function(){var inst=vjs.obj.create(this.prototype);return this.apply(inst,arguments),inst},vjs.on=function(elem,type,fn){var data=vjs.getData(elem);data.handlers||(data.handlers={}),data.handlers[type]||(data.handlers[type]=[]),fn.guid||(fn.guid=vjs.guid++),data.handlers[type].push(fn),data.dispatcher||(data.disabled=!1,data.dispatcher=function(event){if(!data.disabled){event=vjs.fixEvent(event);var handlers=data.handlers[event.type];if(handlers)for(var handlersCopy=handlers.slice(0),m=0,n=handlersCopy.length;n>m&&!event.isImmediatePropagationStopped();m++)handlersCopy[m].call(elem,event)}}),1==data.handlers[type].length&&(document.addEventListener?elem.addEventListener(type,data.dispatcher,!1):document.attachEvent&&elem.attachEvent("on"+type,data.dispatcher))},vjs.off=function(elem,type,fn){if(vjs.hasData(elem)){var data=vjs.getData(elem);if(data.handlers){var removeType=function(t){data.handlers[t]=[],vjs.cleanUpEvents(elem,t)};if(type){var handlers=data.handlers[type];if(handlers){if(!fn)return void removeType(type);if(fn.guid)for(var n=0;n<handlers.length;n++)handlers[n].guid===fn.guid&&handlers.splice(n--,1);vjs.cleanUpEvents(elem,type)}}else for(var t in data.handlers)removeType(t)}}},vjs.cleanUpEvents=function(elem,type){var data=vjs.getData(elem);0===data.handlers[type].length&&(delete data.handlers[type],document.removeEventListener?elem.removeEventListener(type,data.dispatcher,!1):document.detachEvent&&elem.detachEvent("on"+type,data.dispatcher)),vjs.isEmpty(data.handlers)&&(delete data.handlers,delete data.dispatcher,delete data.disabled),vjs.isEmpty(data)&&vjs.removeData(elem)},vjs.fixEvent=function(event){function returnTrue(){return!0}function returnFalse(){return!1}if(!event||!event.isPropagationStopped){var old=event||window.event;event={};for(var key in old)"layerX"!==key&&"layerY"!==key&&(event[key]=old[key]);if(event.target||(event.target=event.srcElement||document),event.relatedTarget=event.fromElement===event.target?event.toElement:event.fromElement,event.preventDefault=function(){old.preventDefault&&old.preventDefault(),event.returnValue=!1,event.isDefaultPrevented=returnTrue},event.isDefaultPrevented=returnFalse,event.stopPropagation=function(){old.stopPropagation&&old.stopPropagation(),event.cancelBubble=!0,event.isPropagationStopped=returnTrue},event.isPropagationStopped=returnFalse,event.stopImmediatePropagation=function(){old.stopImmediatePropagation&&old.stopImmediatePropagation(),event.isImmediatePropagationStopped=returnTrue,event.stopPropagation()},event.isImmediatePropagationStopped=returnFalse,null!=event.clientX){var doc=document.documentElement,body=document.body;event.pageX=event.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=event.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}event.which=event.charCode||event.keyCode,null!=event.button&&(event.button=1&event.button?0:4&event.button?1:2&event.button?2:0)}return event},vjs.trigger=function(elem,event){var elemData=vjs.hasData(elem)?vjs.getData(elem):{},parent=elem.parentNode||elem.ownerDocument;if("string"==typeof event&&(event={type:event,target:elem}),event=vjs.fixEvent(event),elemData.dispatcher&&elemData.dispatcher.call(elem,event),parent&&!event.isPropagationStopped()&&event.bubbles!==!1)vjs.trigger(parent,event);else if(!parent&&!event.isDefaultPrevented()){var targetData=vjs.getData(event.target);event.target[event.type]&&(targetData.disabled=!0,"function"==typeof event.target[event.type]&&event.target[event.type](),targetData.disabled=!1)}return!event.isDefaultPrevented()},vjs.one=function(elem,type,fn){var func=function(){vjs.off(elem,type,func),fn.apply(this,arguments)};func.guid=fn.guid=fn.guid||vjs.guid++,vjs.on(elem,type,func)};var hasOwnProp=Object.prototype.hasOwnProperty;vjs.createEl=function(tagName,properties){var el,propName;el=document.createElement(tagName||"div");for(propName in properties)hasOwnProp.call(properties,propName)&&(-1!==propName.indexOf("aria-")||"role"==propName?el.setAttribute(propName,properties[propName]):el[propName]=properties[propName]);return el},vjs.capitalize=function(string){return string.charAt(0).toUpperCase()+string.slice(1)},vjs.obj={},vjs.obj.create=Object.create||function(obj){function F(){}return F.prototype=obj,new F},vjs.obj.each=function(obj,fn,context){for(var key in obj)hasOwnProp.call(obj,key)&&fn.call(context||this,key,obj[key])},vjs.obj.merge=function(obj1,obj2){if(!obj2)return obj1;for(var key in obj2)hasOwnProp.call(obj2,key)&&(obj1[key]=obj2[key]);return obj1},vjs.obj.deepMerge=function(obj1,obj2){var key,val1,val2;obj1=vjs.obj.copy(obj1);for(key in obj2)hasOwnProp.call(obj2,key)&&(val1=obj1[key],val2=obj2[key],obj1[key]=vjs.obj.isPlain(val1)&&vjs.obj.isPlain(val2)?vjs.obj.deepMerge(val1,val2):obj2[key]);return obj1},vjs.obj.copy=function(obj){return vjs.obj.merge({},obj)},vjs.obj.isPlain=function(obj){return!!obj&&"object"==typeof obj&&"[object Object]"===obj.toString()&&obj.constructor===Object},vjs.bind=function(context,fn,uid){fn.guid||(fn.guid=vjs.guid++);var ret=function(){return fn.apply(context,arguments)};return ret.guid=uid?uid+"_"+fn.guid:fn.guid,ret},vjs.cache={},vjs.guid=1,vjs.expando="vdata"+(new Date).getTime(),vjs.getData=function(el){var id=el[vjs.expando];return id||(id=el[vjs.expando]=vjs.guid++,vjs.cache[id]={}),vjs.cache[id]},vjs.hasData=function(el){var id=el[vjs.expando];return!(!id||vjs.isEmpty(vjs.cache[id]))},vjs.removeData=function(el){var id=el[vjs.expando];if(id){delete vjs.cache[id];try{delete el[vjs.expando]}catch(e){el.removeAttribute?el.removeAttribute(vjs.expando):el[vjs.expando]=null}}},vjs.isEmpty=function(obj){for(var prop in obj)if(null!==obj[prop])return!1;return!0},vjs.addClass=function(element,classToAdd){-1==(" "+element.className+" ").indexOf(" "+classToAdd+" ")&&(element.className=""===element.className?classToAdd:element.className+" "+classToAdd)},vjs.removeClass=function(element,classToRemove){var classNames,i;if(-1!=element.className.indexOf(classToRemove)){for(classNames=element.className.split(" "),i=classNames.length-1;i>=0;i--)classNames[i]===classToRemove&&classNames.splice(i,1);element.className=classNames.join(" ")}},vjs.TEST_VID=vjs.createEl("video"),vjs.USER_AGENT=navigator.userAgent,vjs.IS_IPHONE=/iPhone/i.test(vjs.USER_AGENT),vjs.IS_IPAD=/iPad/i.test(vjs.USER_AGENT),vjs.IS_IPOD=/iPod/i.test(vjs.USER_AGENT),vjs.IS_IOS=vjs.IS_IPHONE||vjs.IS_IPAD||vjs.IS_IPOD,vjs.IOS_VERSION=function(){var match=vjs.USER_AGENT.match(/OS (\d+)_/i);return match&&match[1]?match[1]:void 0}(),vjs.IS_ANDROID=/Android/i.test(vjs.USER_AGENT),vjs.ANDROID_VERSION=function(){var major,minor,match=vjs.USER_AGENT.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);return match?(major=match[1]&&parseFloat(match[1]),minor=match[2]&&parseFloat(match[2]),major&&minor?parseFloat(match[1]+"."+match[2]):major?major:null):null}(),vjs.IS_OLD_ANDROID=vjs.IS_ANDROID&&/webkit/i.test(vjs.USER_AGENT)&&vjs.ANDROID_VERSION<2.3,vjs.IS_FIREFOX=/Firefox/i.test(vjs.USER_AGENT),vjs.IS_CHROME=/Chrome/i.test(vjs.USER_AGENT),vjs.TOUCH_ENABLED="ontouchstart"in window,vjs.getAttributeValues=function(tag){var obj,knownBooleans,attrs,attrName,attrVal;if(obj={},knownBooleans=",autoplay,controls,loop,muted,default,",tag&&tag.attributes&&tag.attributes.length>0){attrs=tag.attributes;for(var i=attrs.length-1;i>=0;i--)attrName=attrs[i].name,attrVal=attrs[i].value,("boolean"==typeof tag[attrName]||-1!==knownBooleans.indexOf(","+attrName+","))&&(attrVal=null!==attrVal?!0:!1),obj[attrName]=attrVal}return obj},vjs.getComputedDimension=function(el,strCssRule){var strValue="";return document.defaultView&&document.defaultView.getComputedStyle?strValue=document.defaultView.getComputedStyle(el,"").getPropertyValue(strCssRule):el.currentStyle&&(strValue=el["client"+strCssRule.substr(0,1).toUpperCase()+strCssRule.substr(1)]+"px"),strValue},vjs.insertFirst=function(child,parent){parent.firstChild?parent.insertBefore(child,parent.firstChild):parent.appendChild(child)},vjs.support={},vjs.el=function(id){return 0===id.indexOf("#")&&(id=id.slice(1)),document.getElementById(id)},vjs.formatTime=function(seconds,guide){guide=guide||seconds;var s=Math.floor(seconds%60),m=Math.floor(seconds/60%60),h=Math.floor(seconds/3600),gm=Math.floor(guide/60%60),gh=Math.floor(guide/3600);return(isNaN(seconds)||1/0===seconds)&&(h=m=s="-"),h=h>0||gh>0?h+":":"",m=((h||gm>=10)&&10>m?"0"+m:m)+":",s=10>s?"0"+s:s,h+m+s},vjs.blockTextSelection=function(){document.body.focus(),document.onselectstart=function(){return!1}},vjs.unblockTextSelection=function(){document.onselectstart=function(){return!0}},vjs.trim=function(str){return(str+"").replace(/^\s+|\s+$/g,"")},vjs.round=function(num,dec){return dec||(dec=0),Math.round(num*Math.pow(10,dec))/Math.pow(10,dec)},vjs.createTimeRange=function(start,end){return{length:1,start:function(){return start},end:function(){return end}}},vjs.get=function(url,onSuccess,onError){var local,request;"undefined"==typeof XMLHttpRequest&&(window.XMLHttpRequest=function(){try{return new window.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new window.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(f){}try{return new window.ActiveXObject("Msxml2.XMLHTTP")}catch(g){}throw new Error("This browser does not support XMLHttpRequest.")}),request=new XMLHttpRequest;try{request.open("GET",url)}catch(e){onError(e)}local=0===url.indexOf("file:")||0===window.location.href.indexOf("file:")&&-1===url.indexOf("http"),request.onreadystatechange=function(){4===request.readyState&&(200===request.status||local&&0===request.status?onSuccess(request.responseText):onError&&onError())};try{request.send()}catch(e){onError&&onError(e)}},vjs.setLocalStorage=function(key,value){try{var localStorage=window.localStorage||!1;if(!localStorage)return;localStorage[key]=value}catch(e){22==e.code||1014==e.code?vjs.log("LocalStorage Full (VideoJS)",e):18==e.code?vjs.log("LocalStorage not allowed (VideoJS)",e):vjs.log("LocalStorage Error (VideoJS)",e)}},vjs.getAbsoluteURL=function(url){return url.match(/^https?:\/\//)||(url=vjs.createEl("div",{innerHTML:'<a href="'+url+'">x</a>'}).firstChild.href),url},vjs.log=function(){vjs.log.history=vjs.log.history||[],vjs.log.history.push(arguments),window.console&&window.console.log(Array.prototype.slice.call(arguments))},vjs.findPosition=function(el){var box,docEl,body,clientLeft,scrollLeft,left,clientTop,scrollTop,top;return el.getBoundingClientRect&&el.parentNode&&(box=el.getBoundingClientRect()),box?(docEl=document.documentElement,body=document.body,clientLeft=docEl.clientLeft||body.clientLeft||0,scrollLeft=window.pageXOffset||body.scrollLeft,left=box.left+scrollLeft-clientLeft,clientTop=docEl.clientTop||body.clientTop||0,scrollTop=window.pageYOffset||body.scrollTop,top=box.top+scrollTop-clientTop,{left:left,top:top}):{left:0,top:0}},vjs.Component=vjs.CoreObject.extend({init:function(player,options,ready){this.player_=player,this.options_=vjs.obj.copy(this.options_),options=this.options(options),this.id_=options.id||(options.el&&options.el.id?options.el.id:player.id()+"_component_"+vjs.guid++),this.name_=options.name||null,this.el_=options.el||this.createEl(),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.initChildren(),this.ready(ready)}}),vjs.Component.prototype.dispose=function(){if(this.trigger("dispose"),this.children_)for(var i=this.children_.length-1;i>=0;i--)this.children_[i].dispose&&this.children_[i].dispose();
this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.off(),this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),vjs.removeData(this.el_),this.el_=null},vjs.Component.prototype.player_,vjs.Component.prototype.player=function(){return this.player_},vjs.Component.prototype.options_,vjs.Component.prototype.options=function(obj){return void 0===obj?this.options_:this.options_=vjs.obj.deepMerge(this.options_,obj)},vjs.Component.prototype.el_,vjs.Component.prototype.createEl=function(tagName,attributes){return vjs.createEl(tagName,attributes)},vjs.Component.prototype.el=function(){return this.el_},vjs.Component.prototype.contentEl_,vjs.Component.prototype.contentEl=function(){return this.contentEl_||this.el_},vjs.Component.prototype.id_,vjs.Component.prototype.id=function(){return this.id_},vjs.Component.prototype.name_,vjs.Component.prototype.name=function(){return this.name_},vjs.Component.prototype.children_,vjs.Component.prototype.children=function(){return this.children_},vjs.Component.prototype.childIndex_,vjs.Component.prototype.getChildById=function(id){return this.childIndex_[id]},vjs.Component.prototype.childNameIndex_,vjs.Component.prototype.getChild=function(name){return this.childNameIndex_[name]},vjs.Component.prototype.addChild=function(child,options){var component,componentClass,componentName;return"string"==typeof child?(componentName=child,options=options||{},componentClass=options.componentClass||vjs.capitalize(componentName),options.name=componentName,component=new window.videojs[componentClass](this.player_||this,options)):component=child,this.children_.push(component),"function"==typeof component.id&&(this.childIndex_[component.id()]=component),componentName=componentName||component.name&&component.name(),componentName&&(this.childNameIndex_[componentName]=component),"function"==typeof component.el&&component.el()&&this.contentEl().appendChild(component.el()),component},vjs.Component.prototype.removeChild=function(component){if("string"==typeof component&&(component=this.getChild(component)),component&&this.children_){for(var childFound=!1,i=this.children_.length-1;i>=0;i--)if(this.children_[i]===component){childFound=!0,this.children_.splice(i,1);break}if(childFound){this.childIndex_[component.id]=null,this.childNameIndex_[component.name]=null;var compEl=component.el();compEl&&compEl.parentNode===this.contentEl()&&this.contentEl().removeChild(component.el())}}},vjs.Component.prototype.initChildren=function(){var options=this.options_;if(options&&options.children){var self=this;vjs.obj.each(options.children,function(name,opts){if(opts!==!1){var tempAdd=function(){self[name]=self.addChild(name,opts)};opts.loadEvent||tempAdd()}})}},vjs.Component.prototype.buildCSSClass=function(){return""},vjs.Component.prototype.on=function(type,fn){return vjs.on(this.el_,type,vjs.bind(this,fn)),this},vjs.Component.prototype.off=function(type,fn){return vjs.off(this.el_,type,fn),this},vjs.Component.prototype.one=function(type,fn){return vjs.one(this.el_,type,vjs.bind(this,fn)),this},vjs.Component.prototype.trigger=function(type,event){return vjs.trigger(this.el_,type,event),this},vjs.Component.prototype.isReady_,vjs.Component.prototype.isReadyOnInitFinish_=!0,vjs.Component.prototype.readyQueue_,vjs.Component.prototype.ready=function(fn){return fn&&(this.isReady_?fn.call(this):(void 0===this.readyQueue_&&(this.readyQueue_=[]),this.readyQueue_.push(fn))),this},vjs.Component.prototype.triggerReady=function(){this.isReady_=!0;var readyQueue=this.readyQueue_;if(readyQueue&&readyQueue.length>0){for(var i=0,j=readyQueue.length;j>i;i++)readyQueue[i].call(this);this.readyQueue_=[],this.trigger("ready")}},vjs.Component.prototype.addClass=function(classToAdd){return vjs.addClass(this.el_,classToAdd),this},vjs.Component.prototype.removeClass=function(classToRemove){return vjs.removeClass(this.el_,classToRemove),this},vjs.Component.prototype.show=function(){return this.el_.style.display="block",this},vjs.Component.prototype.hide=function(){return this.el_.style.display="none",this},vjs.Component.prototype.lockShowing=function(){return this.addClass("vjs-lock-showing"),this},vjs.Component.prototype.unlockShowing=function(){return this.removeClass("vjs-lock-showing"),this},vjs.Component.prototype.disable=function(){this.hide(),this.show=function(){}},vjs.Component.prototype.width=function(num,skipListeners){return this.dimension("width",num,skipListeners)},vjs.Component.prototype.height=function(num,skipListeners){return this.dimension("height",num,skipListeners)},vjs.Component.prototype.dimensions=function(width,height){return this.width(width,!0).height(height)},vjs.Component.prototype.dimension=function(widthOrHeight,num,skipListeners){if(void 0!==num)return this.el_.style[widthOrHeight]=-1!==(""+num).indexOf("%")||-1!==(""+num).indexOf("px")?num:"auto"===num?"":num+"px",skipListeners||this.trigger("resize"),this;if(!this.el_)return 0;var val=this.el_.style[widthOrHeight],pxIndex=val.indexOf("px");return-1!==pxIndex?parseInt(val.slice(0,pxIndex),10):parseInt(this.el_["offset"+vjs.capitalize(widthOrHeight)],10)},vjs.Component.prototype.emitTapEvents=function(){var touchStart,touchTime,couldBeTap,noTap;touchStart=0,this.on("touchstart",function(){touchStart=(new Date).getTime(),couldBeTap=!0}),noTap=function(){couldBeTap=!1},this.on("touchmove",noTap),this.on("touchleave",noTap),this.on("touchcancel",noTap),this.on("touchend",function(){couldBeTap===!0&&(touchTime=(new Date).getTime()-touchStart,250>touchTime&&this.trigger("tap"))})},vjs.Button=vjs.Component.extend({init:function(player,options){vjs.Component.call(this,player,options);var touchstart=!1;this.on("touchstart",function(event){event.preventDefault(),touchstart=!0}),this.on("touchmove",function(){touchstart=!1});var self=this;this.on("touchend",function(event){touchstart&&self.onClick(event),event.preventDefault()}),this.on("click",this.onClick),this.on("focus",this.onFocus),this.on("blur",this.onBlur)}}),vjs.Button.prototype.createEl=function(type,props){return props=vjs.obj.merge({className:this.buildCSSClass(),innerHTML:'<div class="vjs-control-content"><span class="vjs-control-text">'+(this.buttonText||"Need Text")+"</span></div>",role:"button","aria-live":"polite",tabIndex:0},props),vjs.Component.prototype.createEl.call(this,type,props)},vjs.Button.prototype.buildCSSClass=function(){return"vjs-control "+vjs.Component.prototype.buildCSSClass.call(this)},vjs.Button.prototype.onClick=function(){},vjs.Button.prototype.onFocus=function(){vjs.on(document,"keyup",vjs.bind(this,this.onKeyPress))},vjs.Button.prototype.onKeyPress=function(event){(32==event.which||13==event.which)&&(event.preventDefault(),this.onClick())},vjs.Button.prototype.onBlur=function(){vjs.off(document,"keyup",vjs.bind(this,this.onKeyPress))},vjs.Slider=vjs.Component.extend({init:function(player,options){vjs.Component.call(this,player,options),this.bar=this.getChild(this.options_.barName),this.handle=this.getChild(this.options_.handleName),player.on(this.playerEvent,vjs.bind(this,this.update)),this.on("mousedown",this.onMouseDown),this.on("touchstart",this.onMouseDown),this.on("focus",this.onFocus),this.on("blur",this.onBlur),this.on("click",this.onClick),this.player_.on("controlsvisible",vjs.bind(this,this.update)),player.ready(vjs.bind(this,this.update)),this.boundEvents={}}}),vjs.Slider.prototype.createEl=function(type,props){return props=props||{},props.className=props.className+" vjs-slider",props=vjs.obj.merge({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},props),vjs.Component.prototype.createEl.call(this,type,props)},vjs.Slider.prototype.onMouseDown=function(event){event.preventDefault(),vjs.blockTextSelection(),this.boundEvents.move=vjs.bind(this,this.onMouseMove),this.boundEvents.end=vjs.bind(this,this.onMouseUp),vjs.on(document,"mousemove",this.boundEvents.move),vjs.on(document,"mouseup",this.boundEvents.end),vjs.on(document,"touchmove",this.boundEvents.move),vjs.on(document,"touchend",this.boundEvents.end),this.onMouseMove(event)},vjs.Slider.prototype.onMouseUp=function(){vjs.unblockTextSelection(),vjs.off(document,"mousemove",this.boundEvents.move,!1),vjs.off(document,"mouseup",this.boundEvents.end,!1),vjs.off(document,"touchmove",this.boundEvents.move,!1),vjs.off(document,"touchend",this.boundEvents.end,!1),this.update()},vjs.Slider.prototype.update=function(){if(this.el_){var barProgress,progress=this.getPercent(),handle=this.handle,bar=this.bar;if(isNaN(progress)&&(progress=0),barProgress=progress,handle){var box=this.el_,boxWidth=box.offsetWidth,handleWidth=handle.el().offsetWidth,handlePercent=handleWidth?handleWidth/boxWidth:0,boxAdjustedPercent=1-handlePercent,adjustedProgress=progress*boxAdjustedPercent;barProgress=adjustedProgress+handlePercent/2,handle.el().style.left=vjs.round(100*adjustedProgress,2)+"%"}bar.el().style.width=vjs.round(100*barProgress,2)+"%"}},vjs.Slider.prototype.calculateDistance=function(event){var el,box,boxX,boxY,boxW,boxH,handle,pageX,pageY;if(el=this.el_,box=vjs.findPosition(el),boxW=boxH=el.offsetWidth,handle=this.handle,this.options_.vertical){if(boxY=box.top,pageY=event.changedTouches?event.changedTouches[0].pageY:event.pageY,handle){var handleH=handle.el().offsetHeight;boxY+=handleH/2,boxH-=handleH}return Math.max(0,Math.min(1,(boxY-pageY+boxH)/boxH))}if(boxX=box.left,pageX=event.changedTouches?event.changedTouches[0].pageX:event.pageX,handle){var handleW=handle.el().offsetWidth;boxX+=handleW/2,boxW-=handleW}return Math.max(0,Math.min(1,(pageX-boxX)/boxW))},vjs.Slider.prototype.onFocus=function(){vjs.on(document,"keyup",vjs.bind(this,this.onKeyPress))},vjs.Slider.prototype.onKeyPress=function(event){37==event.which?(event.preventDefault(),this.stepBack()):39==event.which&&(event.preventDefault(),this.stepForward())},vjs.Slider.prototype.onBlur=function(){vjs.off(document,"keyup",vjs.bind(this,this.onKeyPress))},vjs.Slider.prototype.onClick=function(event){event.stopImmediatePropagation(),event.preventDefault()},vjs.SliderHandle=vjs.Component.extend(),vjs.SliderHandle.prototype.defaultValue=0,vjs.SliderHandle.prototype.createEl=function(type,props){return props=props||{},props.className=props.className+" vjs-slider-handle",props=vjs.obj.merge({innerHTML:'<span class="vjs-control-text">'+this.defaultValue+"</span>"},props),vjs.Component.prototype.createEl.call(this,"div",props)},vjs.Menu=vjs.Component.extend(),vjs.Menu.prototype.addItem=function(component){this.addChild(component),component.on("click",vjs.bind(this,function(){this.unlockShowing()}))},vjs.Menu.prototype.createEl=function(){var contentElType=this.options().contentElType||"ul";this.contentEl_=vjs.createEl(contentElType,{className:"vjs-menu-content"});var el=vjs.Component.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return el.appendChild(this.contentEl_),vjs.on(el,"click",function(event){event.preventDefault(),event.stopImmediatePropagation()}),el},vjs.MenuItem=vjs.Button.extend({init:function(player,options){vjs.Button.call(this,player,options),this.selected(options.selected)}}),vjs.MenuItem.prototype.createEl=function(type,props){return vjs.Button.prototype.createEl.call(this,"li",vjs.obj.merge({className:"vjs-menu-item",innerHTML:this.options_.label},props))},vjs.MenuItem.prototype.onClick=function(){this.selected(!0)},vjs.MenuItem.prototype.selected=function(selected){selected?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-selected",!0)):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-selected",!1))},vjs.MenuButton=vjs.Button.extend({init:function(player,options){vjs.Button.call(this,player,options),this.menu=this.createMenu(),this.addChild(this.menu),this.items&&0===this.items.length&&this.hide(),this.on("keyup",this.onKeyPress),this.el_.setAttribute("aria-haspopup",!0),this.el_.setAttribute("role","button")}}),vjs.MenuButton.prototype.buttonPressed_=!1,vjs.MenuButton.prototype.createMenu=function(){var menu=new vjs.Menu(this.player_);if(this.options().title&&menu.el().appendChild(vjs.createEl("li",{className:"vjs-menu-title",innerHTML:vjs.capitalize(this.kind_),tabindex:-1})),this.items=this.createItems(),this.items)for(var i=0;i<this.items.length;i++)menu.addItem(this.items[i]);return menu},vjs.MenuButton.prototype.createItems=function(){},vjs.MenuButton.prototype.buildCSSClass=function(){return this.className+" vjs-menu-button "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.MenuButton.prototype.onFocus=function(){},vjs.MenuButton.prototype.onBlur=function(){},vjs.MenuButton.prototype.onClick=function(){this.one("mouseout",vjs.bind(this,function(){this.menu.unlockShowing(),this.el_.blur()})),this.buttonPressed_?this.unpressButton():this.pressButton()},vjs.MenuButton.prototype.onKeyPress=function(event){event.preventDefault(),32==event.which||13==event.which?this.buttonPressed_?this.unpressButton():this.pressButton():27==event.which&&this.buttonPressed_&&this.unpressButton()},vjs.MenuButton.prototype.pressButton=function(){this.buttonPressed_=!0,this.menu.lockShowing(),this.el_.setAttribute("aria-pressed",!0),this.items&&this.items.length>0&&this.items[0].el().focus()},vjs.MenuButton.prototype.unpressButton=function(){this.buttonPressed_=!1,this.menu.unlockShowing(),this.el_.setAttribute("aria-pressed",!1)},vjs.Player=vjs.Component.extend({init:function(tag,options,ready){this.tag=tag,options=vjs.obj.merge(this.getTagSettings(tag),options),this.cache_={},this.poster_=options.poster,this.controls_=options.controls,tag.controls=!1,vjs.Component.call(this,this,options,ready),this.addClass(this.controls()?"vjs-controls-enabled":"vjs-controls-disabled"),this.one("play",function(e){var fpEvent={type:"firstplay",target:this.el_},keepGoing=vjs.trigger(this.el_,fpEvent);keepGoing||(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation())}),this.on("ended",this.onEnded),this.on("play",this.onPlay),this.on("firstplay",this.onFirstPlay),this.on("pause",this.onPause),this.on("progress",this.onProgress),this.on("durationchange",this.onDurationChange),this.on("error",this.onError),this.on("fullscreenchange",this.onFullscreenChange),vjs.players[this.id_]=this,options.plugins&&vjs.obj.each(options.plugins,function(key,val){this[key](val)},this),this.listenForUserActivity()}}),vjs.Player.prototype.options_=vjs.options,vjs.Player.prototype.dispose=function(){this.trigger("dispose"),this.off("dispose"),vjs.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.stopTrackingProgress(),this.stopTrackingCurrentTime(),this.tech&&this.tech.dispose(),vjs.Component.prototype.dispose.call(this)},vjs.Player.prototype.getTagSettings=function(tag){var options={sources:[],tracks:[]};if(vjs.obj.merge(options,vjs.getAttributeValues(tag)),tag.hasChildNodes()){var children,child,childName,i,j;for(children=tag.childNodes,i=0,j=children.length;j>i;i++)child=children[i],childName=child.nodeName.toLowerCase(),"source"===childName?options.sources.push(vjs.getAttributeValues(child)):"track"===childName&&options.tracks.push(vjs.getAttributeValues(child))}return options},vjs.Player.prototype.createEl=function(){var el=this.el_=vjs.Component.prototype.createEl.call(this,"div"),tag=this.tag;if(tag.removeAttribute("width"),tag.removeAttribute("height"),tag.hasChildNodes()){var nodes,nodesLength,i,node,nodeName,removeNodes;for(nodes=tag.childNodes,nodesLength=nodes.length,removeNodes=[];nodesLength--;)node=nodes[nodesLength],nodeName=node.nodeName.toLowerCase(),("source"===nodeName||"track"===nodeName)&&removeNodes.push(node);for(i=0;i<removeNodes.length;i++)tag.removeChild(removeNodes[i])}return tag.id=tag.id||"vjs_video_"+vjs.guid++,el.id=tag.id,el.className=tag.className,tag.id+="_html5_api",tag.className="vjs-tech",tag.player=el.player=this,this.addClass("vjs-paused"),this.width(this.options_.width,!0),this.height(this.options_.height,!0),tag.parentNode&&tag.parentNode.insertBefore(el,tag),vjs.insertFirst(tag,el),el},vjs.Player.prototype.loadTech=function(techName,source){this.tech?this.unloadTech():"Html5"!==techName&&this.tag&&(this.el_.removeChild(this.tag),this.tag.player=null,this.tag=null),this.techName=techName,this.isReady_=!1;var techReady=function(){this.player_.triggerReady(),this.features.progressEvents||this.player_.manualProgressOn(),this.features.timeupdateEvents||this.player_.manualTimeUpdatesOn()},techOptions=vjs.obj.merge({source:source,parentEl:this.el_},this.options_[techName.toLowerCase()]);source&&(source.src==this.cache_.src&&this.cache_.currentTime>0&&(techOptions.startTime=this.cache_.currentTime),this.cache_.src=source.src),this.tech=new window.videojs[techName](this,techOptions),this.tech.ready(techReady)},vjs.Player.prototype.unloadTech=function(){this.isReady_=!1,this.tech.dispose(),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),this.tech=!1},vjs.Player.prototype.manualProgressOn=function(){this.manualProgress=!0,this.trackProgress(),this.tech.one("progress",function(){this.features.progressEvents=!0,this.player_.manualProgressOff()})},vjs.Player.prototype.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress()},vjs.Player.prototype.trackProgress=function(){this.progressInterval=setInterval(vjs.bind(this,function(){this.cache_.bufferEnd<this.buffered().end(0)?this.trigger("progress"):1==this.bufferedPercent()&&(this.stopTrackingProgress(),this.trigger("progress"))}),500)},vjs.Player.prototype.stopTrackingProgress=function(){clearInterval(this.progressInterval)},vjs.Player.prototype.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime),this.tech.one("timeupdate",function(){this.features.timeupdateEvents=!0,this.player_.manualTimeUpdatesOff()})},vjs.Player.prototype.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},vjs.Player.prototype.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=setInterval(vjs.bind(this,function(){this.trigger("timeupdate")}),250)},vjs.Player.prototype.stopTrackingCurrentTime=function(){clearInterval(this.currentTimeInterval)},vjs.Player.prototype.onEnded=function(){this.options_.loop&&(this.currentTime(0),this.play())},vjs.Player.prototype.onPlay=function(){vjs.removeClass(this.el_,"vjs-paused"),vjs.addClass(this.el_,"vjs-playing")},vjs.Player.prototype.onFirstPlay=function(){this.options_.starttime&&this.currentTime(this.options_.starttime),this.addClass("vjs-has-started")},vjs.Player.prototype.onPause=function(){vjs.removeClass(this.el_,"vjs-playing"),vjs.addClass(this.el_,"vjs-paused")},vjs.Player.prototype.onProgress=function(){1==this.bufferedPercent()&&this.trigger("loadedalldata")},vjs.Player.prototype.onDurationChange=function(){this.duration(this.techGet("duration"))},vjs.Player.prototype.onError=function(e){vjs.log("Video Error",e)},vjs.Player.prototype.onFullscreenChange=function(){this.isFullScreen?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},vjs.Player.prototype.cache_,vjs.Player.prototype.getCache=function(){return this.cache_},vjs.Player.prototype.techCall=function(method,arg){if(this.tech&&!this.tech.isReady_)this.tech.ready(function(){this[method](arg)});else try{this.tech[method](arg)}catch(e){throw vjs.log(e),e}},vjs.Player.prototype.techGet=function(method){if(this.tech&&this.tech.isReady_)try{return this.tech[method]()}catch(e){throw void 0===this.tech[method]?vjs.log("Video.js: "+method+" method not defined for "+this.techName+" playback technology.",e):"TypeError"==e.name?(vjs.log("Video.js: "+method+" unavailable on "+this.techName+" playback technology element.",e),this.tech.isReady_=!1):vjs.log(e),e}},vjs.Player.prototype.play=function(){return this.techCall("play"),this},vjs.Player.prototype.pause=function(){return this.techCall("pause"),this},vjs.Player.prototype.paused=function(){return this.techGet("paused")===!1?!1:!0},vjs.Player.prototype.currentTime=function(seconds){return void 0!==seconds?(this.cache_.lastSetCurrentTime=seconds,this.techCall("setCurrentTime",seconds),this.manualTimeUpdates&&this.trigger("timeupdate"),this):this.cache_.currentTime=this.techGet("currentTime")||0},vjs.Player.prototype.duration=function(seconds){return void 0!==seconds?(this.cache_.duration=parseFloat(seconds),this):this.cache_.duration},vjs.Player.prototype.remainingTime=function(){return this.duration()-this.currentTime()},vjs.Player.prototype.buffered=function(){var buffered=this.techGet("buffered"),start=0,buflast=buffered.length-1,end=this.cache_.bufferEnd=this.cache_.bufferEnd||0;return buffered&&buflast>=0&&buffered.end(buflast)!==end&&(end=buffered.end(buflast),this.cache_.bufferEnd=end),vjs.createTimeRange(start,end)},vjs.Player.prototype.bufferedPercent=function(){return this.duration()?this.buffered().end(0)/this.duration():0},vjs.Player.prototype.volume=function(percentAsDecimal){var vol;return void 0!==percentAsDecimal?(vol=Math.max(0,Math.min(1,parseFloat(percentAsDecimal))),this.cache_.volume=vol,this.techCall("setVolume",vol),vjs.setLocalStorage("volume",vol),this):(vol=parseFloat(this.techGet("volume")),isNaN(vol)?1:vol)},vjs.Player.prototype.muted=function(muted){return void 0!==muted?(this.techCall("setMuted",muted),this):this.techGet("muted")||!1},vjs.Player.prototype.supportsFullScreen=function(){return this.techGet("supportsFullScreen")||!1},vjs.Player.prototype.requestFullScreen=function(){var requestFullScreen=vjs.support.requestFullScreen;return this.isFullScreen=!0,requestFullScreen?(vjs.on(document,requestFullScreen.eventName,vjs.bind(this,function(){this.isFullScreen=document[requestFullScreen.isFullScreen],this.isFullScreen===!1&&vjs.off(document,requestFullScreen.eventName,arguments.callee),this.trigger("fullscreenchange")})),this.el_[requestFullScreen.requestFn]()):this.tech.supportsFullScreen()?this.techCall("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange")),this},vjs.Player.prototype.cancelFullScreen=function(){var requestFullScreen=vjs.support.requestFullScreen;return this.isFullScreen=!1,requestFullScreen?document[requestFullScreen.cancelFn]():this.tech.supportsFullScreen()?this.techCall("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange")),this},vjs.Player.prototype.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=document.documentElement.style.overflow,vjs.on(document,"keydown",vjs.bind(this,this.fullWindowOnEscKey)),document.documentElement.style.overflow="hidden",vjs.addClass(document.body,"vjs-full-window"),this.trigger("enterFullWindow")},vjs.Player.prototype.fullWindowOnEscKey=function(event){27===event.keyCode&&(this.isFullScreen===!0?this.cancelFullScreen():this.exitFullWindow())},vjs.Player.prototype.exitFullWindow=function(){this.isFullWindow=!1,vjs.off(document,"keydown",this.fullWindowOnEscKey),document.documentElement.style.overflow=this.docOrigOverflow,vjs.removeClass(document.body,"vjs-full-window"),this.trigger("exitFullWindow")},vjs.Player.prototype.selectSource=function(sources){for(var i=0,j=this.options_.techOrder;i<j.length;i++){var techName=vjs.capitalize(j[i]),tech=window.videojs[techName];if(tech.isSupported())for(var a=0,b=sources;a<b.length;a++){var source=b[a];if(tech.canPlaySource(source))return{source:source,tech:techName}}}return!1},vjs.Player.prototype.src=function(source){if(source instanceof Array){var techName,sourceTech=this.selectSource(source);sourceTech?(source=sourceTech.source,techName=sourceTech.tech,techName==this.techName?this.src(source):this.loadTech(techName,source)):this.el_.appendChild(vjs.createEl("p",{innerHTML:this.options().notSupportedMessage}))}else source instanceof Object?this.src(window.videojs[this.techName].canPlaySource(source)?source.src:[source]):(this.cache_.src=source,this.isReady_?(this.techCall("src",source),"auto"==this.options_.preload&&this.load(),this.options_.autoplay&&this.play()):this.ready(function(){this.src(source)}));return this},vjs.Player.prototype.load=function(){return this.techCall("load"),this},vjs.Player.prototype.currentSrc=function(){return this.techGet("currentSrc")||this.cache_.src||""},vjs.Player.prototype.preload=function(value){return void 0!==value?(this.techCall("setPreload",value),this.options_.preload=value,this):this.techGet("preload")},vjs.Player.prototype.autoplay=function(value){return void 0!==value?(this.techCall("setAutoplay",value),this.options_.autoplay=value,this):this.techGet("autoplay",value)},vjs.Player.prototype.loop=function(value){return void 0!==value?(this.techCall("setLoop",value),this.options_.loop=value,this):this.techGet("loop")},vjs.Player.prototype.poster_,vjs.Player.prototype.poster=function(src){return void 0!==src&&(this.poster_=src),this.poster_},vjs.Player.prototype.controls_,vjs.Player.prototype.controls=function(bool){return void 0!==bool?(bool=!!bool,this.controls_!==bool&&(this.controls_=bool,bool?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled")):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"))),this):this.controls_},vjs.Player.prototype.usingNativeControls_,vjs.Player.prototype.usingNativeControls=function(bool){return void 0!==bool?(bool=!!bool,this.usingNativeControls_!==bool&&(this.usingNativeControls_=bool,bool?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols"))),this):this.usingNativeControls_},vjs.Player.prototype.error=function(){return this.techGet("error")},vjs.Player.prototype.ended=function(){return this.techGet("ended")},vjs.Player.prototype.seeking=function(){return this.techGet("seeking")},vjs.Player.prototype.userActivity_=!0,vjs.Player.prototype.reportUserActivity=function(){this.userActivity_=!0},vjs.Player.prototype.userActive_=!0,vjs.Player.prototype.userActive=function(bool){return void 0!==bool?(bool=!!bool,bool!==this.userActive_&&(this.userActive_=bool,bool?(this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive")):(this.userActivity_=!1,this.tech.one("mousemove",function(e){e.stopPropagation(),e.preventDefault()}),this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive"))),this):this.userActive_},vjs.Player.prototype.listenForUserActivity=function(){var onMouseActivity,onMouseDown,mouseInProgress,onMouseUp,activityCheck,inactivityTimeout;onMouseActivity=this.reportUserActivity,onMouseDown=function(){onMouseActivity(),clearInterval(mouseInProgress),mouseInProgress=setInterval(vjs.bind(this,onMouseActivity),250)},onMouseUp=function(){onMouseActivity(),clearInterval(mouseInProgress)},this.on("mousedown",onMouseDown),this.on("mousemove",onMouseActivity),this.on("mouseup",onMouseUp),this.on("keydown",onMouseActivity),this.on("keyup",onMouseActivity),this.on("touchstart",onMouseDown),this.on("touchmove",onMouseActivity),this.on("touchend",onMouseUp),this.on("touchcancel",onMouseUp),activityCheck=setInterval(vjs.bind(this,function(){this.userActivity_&&(this.userActivity_=!1,this.userActive(!0),clearTimeout(inactivityTimeout),inactivityTimeout=setTimeout(vjs.bind(this,function(){this.userActivity_||this.userActive(!1)}),2e3))}),250),this.on("dispose",function(){clearInterval(activityCheck),clearTimeout(inactivityTimeout)})},function(){var prefix,requestFS,div;div=document.createElement("div"),requestFS={},void 0!==div.cancelFullscreen?(requestFS.requestFn="requestFullscreen",requestFS.cancelFn="exitFullscreen",requestFS.eventName="fullscreenchange",requestFS.isFullScreen="fullScreen"):(document.mozCancelFullScreen?(prefix="moz",requestFS.isFullScreen=prefix+"FullScreen"):(prefix="webkit",requestFS.isFullScreen=prefix+"IsFullScreen"),div[prefix+"RequestFullScreen"]&&(requestFS.requestFn=prefix+"RequestFullScreen",requestFS.cancelFn=prefix+"CancelFullScreen"),requestFS.eventName=prefix+"fullscreenchange"),document[requestFS.cancelFn]&&(vjs.support.requestFullScreen=requestFS)}(),vjs.ControlBar=vjs.Component.extend(),vjs.ControlBar.prototype.options_={loadEvent:"play",children:{playToggle:{},currentTimeDisplay:{},timeDivider:{},durationDisplay:{},remainingTimeDisplay:{},progressControl:{},fullscreenToggle:{},volumeControl:{},muteToggle:{}}},vjs.ControlBar.prototype.createEl=function(){return vjs.createEl("div",{className:"vjs-control-bar"})},vjs.PlayToggle=vjs.Button.extend({init:function(player,options){vjs.Button.call(this,player,options),player.on("play",vjs.bind(this,this.onPlay)),player.on("pause",vjs.bind(this,this.onPause))}}),vjs.PlayToggle.prototype.buttonText="Play",vjs.PlayToggle.prototype.buildCSSClass=function(){return"vjs-play-control "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.PlayToggle.prototype.onClick=function(){this.player_.paused()?this.player_.play():this.player_.pause()},vjs.PlayToggle.prototype.onPlay=function(){vjs.removeClass(this.el_,"vjs-paused"),vjs.addClass(this.el_,"vjs-playing"),this.el_.children[0].children[0].innerHTML="Pause"},vjs.PlayToggle.prototype.onPause=function(){vjs.removeClass(this.el_,"vjs-playing"),vjs.addClass(this.el_,"vjs-paused"),this.el_.children[0].children[0].innerHTML="Play"},vjs.CurrentTimeDisplay=vjs.Component.extend({init:function(player,options){vjs.Component.call(this,player,options),player.on("timeupdate",vjs.bind(this,this.updateContent))}}),vjs.CurrentTimeDisplay.prototype.createEl=function(){var el=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-current-time vjs-time-controls vjs-control"});return this.content=vjs.createEl("div",{className:"vjs-current-time-display",innerHTML:'<span class="vjs-control-text">Current Time </span>0:00',"aria-live":"off"}),el.appendChild(vjs.createEl("div").appendChild(this.content)),el},vjs.CurrentTimeDisplay.prototype.updateContent=function(){var time=this.player_.scrubbing?this.player_.getCache().currentTime:this.player_.currentTime();this.content.innerHTML='<span class="vjs-control-text">Current Time </span>'+vjs.formatTime(time,this.player_.duration())},vjs.DurationDisplay=vjs.Component.extend({init:function(player,options){vjs.Component.call(this,player,options),player.on("timeupdate",vjs.bind(this,this.updateContent))}}),vjs.DurationDisplay.prototype.createEl=function(){var el=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-duration vjs-time-controls vjs-control"});return this.content=vjs.createEl("div",{className:"vjs-duration-display",innerHTML:'<span class="vjs-control-text">Duration Time </span>0:00',"aria-live":"off"}),el.appendChild(vjs.createEl("div").appendChild(this.content)),el},vjs.DurationDisplay.prototype.updateContent=function(){var duration=this.player_.duration();duration&&(this.content.innerHTML='<span class="vjs-control-text">Duration Time </span>'+vjs.formatTime(duration))},vjs.TimeDivider=vjs.Component.extend({init:function(player,options){vjs.Component.call(this,player,options)}}),vjs.TimeDivider.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-time-divider",innerHTML:"<div><span>/</span></div>"})},vjs.RemainingTimeDisplay=vjs.Component.extend({init:function(player,options){vjs.Component.call(this,player,options),player.on("timeupdate",vjs.bind(this,this.updateContent))}}),vjs.RemainingTimeDisplay.prototype.createEl=function(){var el=vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-remaining-time vjs-time-controls vjs-control"});return this.content=vjs.createEl("div",{className:"vjs-remaining-time-display",innerHTML:'<span class="vjs-control-text">Remaining Time </span>-0:00',"aria-live":"off"}),el.appendChild(vjs.createEl("div").appendChild(this.content)),el
},vjs.RemainingTimeDisplay.prototype.updateContent=function(){this.player_.duration()&&(this.content.innerHTML='<span class="vjs-control-text">Remaining Time </span>-'+vjs.formatTime(this.player_.remainingTime()))},vjs.FullscreenToggle=vjs.Button.extend({init:function(player,options){vjs.Button.call(this,player,options)}}),vjs.FullscreenToggle.prototype.buttonText="Fullscreen",vjs.FullscreenToggle.prototype.buildCSSClass=function(){return"vjs-fullscreen-control "+vjs.Button.prototype.buildCSSClass.call(this)},vjs.FullscreenToggle.prototype.onClick=function(){this.player_.isFullScreen?(this.player_.cancelFullScreen(),this.el_.children[0].children[0].innerHTML="Fullscreen"):(this.player_.requestFullScreen(),this.el_.children[0].children[0].innerHTML="Non-Fullscreen")},vjs.ProgressControl=vjs.Component.extend({init:function(player,options){vjs.Component.call(this,player,options)}}),vjs.ProgressControl.prototype.options_={children:{seekBar:{}}},vjs.ProgressControl.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},vjs.SeekBar=vjs.Slider.extend({init:function(player,options){vjs.Slider.call(this,player,options),player.on("timeupdate",vjs.bind(this,this.updateARIAAttributes)),player.ready(vjs.bind(this,this.updateARIAAttributes))}}),vjs.SeekBar.prototype.options_={children:{loadProgressBar:{},playProgressBar:{},seekHandle:{}},barName:"playProgressBar",handleName:"seekHandle"},vjs.SeekBar.prototype.playerEvent="timeupdate",vjs.SeekBar.prototype.createEl=function(){return vjs.Slider.prototype.createEl.call(this,"div",{className:"vjs-progress-holder","aria-label":"video progress bar"})},vjs.SeekBar.prototype.updateARIAAttributes=function(){var time=this.player_.scrubbing?this.player_.getCache().currentTime:this.player_.currentTime();this.el_.setAttribute("aria-valuenow",vjs.round(100*this.getPercent(),2)),this.el_.setAttribute("aria-valuetext",vjs.formatTime(time,this.player_.duration()))},vjs.SeekBar.prototype.getPercent=function(){var currentTime;if("Flash"===this.player_.techName&&this.player_.seeking()){var cache=this.player_.getCache();currentTime=cache.lastSetCurrentTime?cache.lastSetCurrentTime:this.player_.currentTime()}else currentTime=this.player_.currentTime();return currentTime/this.player_.duration()},vjs.SeekBar.prototype.onMouseDown=function(event){vjs.Slider.prototype.onMouseDown.call(this,event),this.player_.scrubbing=!0,this.videoWasPlaying=!this.player_.paused(),this.player_.pause()},vjs.SeekBar.prototype.onMouseMove=function(event){var newTime=this.calculateDistance(event)*this.player_.duration();newTime==this.player_.duration()&&(newTime-=.1),this.player_.currentTime(newTime)},vjs.SeekBar.prototype.onMouseUp=function(event){vjs.Slider.prototype.onMouseUp.call(this,event),this.player_.scrubbing=!1,this.videoWasPlaying&&this.player_.play()},vjs.SeekBar.prototype.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},vjs.SeekBar.prototype.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},vjs.LoadProgressBar=vjs.Component.extend({init:function(player,options){vjs.Component.call(this,player,options),player.on("progress",vjs.bind(this,this.update))}}),vjs.LoadProgressBar.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text">Loaded: 0%</span>'})},vjs.LoadProgressBar.prototype.update=function(){this.el_.style&&(this.el_.style.width=vjs.round(100*this.player_.bufferedPercent(),2)+"%")},vjs.PlayProgressBar=vjs.Component.extend({init:function(player,options){vjs.Component.call(this,player,options)}}),vjs.PlayProgressBar.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-play-progress",innerHTML:'<span class="vjs-control-text">Progress: 0%</span>'})},vjs.SeekHandle=vjs.SliderHandle.extend(),vjs.SeekHandle.prototype.defaultValue="00:00",vjs.SeekHandle.prototype.createEl=function(){return vjs.SliderHandle.prototype.createEl.call(this,"div",{className:"vjs-seek-handle"})},vjs.VolumeControl=vjs.Component.extend({init:function(player,options){vjs.Component.call(this,player,options),player.tech&&player.tech.features&&player.tech.features.volumeControl===!1&&this.addClass("vjs-hidden"),player.on("loadstart",vjs.bind(this,function(){player.tech.features&&player.tech.features.volumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")}))}}),vjs.VolumeControl.prototype.options_={children:{volumeBar:{}}},vjs.VolumeControl.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control"})},vjs.VolumeBar=vjs.Slider.extend({init:function(player,options){vjs.Slider.call(this,player,options),player.on("volumechange",vjs.bind(this,this.updateARIAAttributes)),player.ready(vjs.bind(this,this.updateARIAAttributes)),setTimeout(vjs.bind(this,this.update),0)}}),vjs.VolumeBar.prototype.updateARIAAttributes=function(){this.el_.setAttribute("aria-valuenow",vjs.round(100*this.player_.volume(),2)),this.el_.setAttribute("aria-valuetext",vjs.round(100*this.player_.volume(),2)+"%")},vjs.VolumeBar.prototype.options_={children:{volumeLevel:{},volumeHandle:{}},barName:"volumeLevel",handleName:"volumeHandle"},vjs.VolumeBar.prototype.playerEvent="volumechange",vjs.VolumeBar.prototype.createEl=function(){return vjs.Slider.prototype.createEl.call(this,"div",{className:"vjs-volume-bar","aria-label":"volume level"})},vjs.VolumeBar.prototype.onMouseMove=function(event){this.player_.muted()&&this.player_.muted(!1),this.player_.volume(this.calculateDistance(event))},vjs.VolumeBar.prototype.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},vjs.VolumeBar.prototype.stepForward=function(){this.player_.volume(this.player_.volume()+.1)},vjs.VolumeBar.prototype.stepBack=function(){this.player_.volume(this.player_.volume()-.1)},vjs.VolumeLevel=vjs.Component.extend({init:function(player,options){vjs.Component.call(this,player,options)}}),vjs.VolumeLevel.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},vjs.VolumeHandle=vjs.SliderHandle.extend(),vjs.VolumeHandle.prototype.defaultValue="00:00",vjs.VolumeHandle.prototype.createEl=function(){return vjs.SliderHandle.prototype.createEl.call(this,"div",{className:"vjs-volume-handle"})},vjs.MuteToggle=vjs.Button.extend({init:function(player,options){vjs.Button.call(this,player,options),player.on("volumechange",vjs.bind(this,this.update)),player.tech&&player.tech.features&&player.tech.features.volumeControl===!1&&this.addClass("vjs-hidden"),player.on("loadstart",vjs.bind(this,function(){player.tech.features&&player.tech.features.volumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")}))}}),vjs.MuteToggle.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-mute-control vjs-control",innerHTML:'<div><span class="vjs-control-text">Mute</span></div>'})},vjs.MuteToggle.prototype.onClick=function(){this.player_.muted(this.player_.muted()?!1:!0)},vjs.MuteToggle.prototype.update=function(){var vol=this.player_.volume(),level=3;0===vol||this.player_.muted()?level=0:.33>vol?level=1:.67>vol&&(level=2),this.player_.muted()?"Unmute"!=this.el_.children[0].children[0].innerHTML&&(this.el_.children[0].children[0].innerHTML="Unmute"):"Mute"!=this.el_.children[0].children[0].innerHTML&&(this.el_.children[0].children[0].innerHTML="Mute");for(var i=0;4>i;i++)vjs.removeClass(this.el_,"vjs-vol-"+i);vjs.addClass(this.el_,"vjs-vol-"+level)},vjs.VolumeMenuButton=vjs.MenuButton.extend({init:function(player,options){vjs.MenuButton.call(this,player,options),player.on("volumechange",vjs.bind(this,this.update)),player.tech&&player.tech.features&&player.tech.features.volumeControl===!1&&this.addClass("vjs-hidden"),player.on("loadstart",vjs.bind(this,function(){player.tech.features&&player.tech.features.volumeControl===!1?this.addClass("vjs-hidden"):this.removeClass("vjs-hidden")})),this.addClass("vjs-menu-button")}}),vjs.VolumeMenuButton.prototype.createMenu=function(){var menu=new vjs.Menu(this.player_,{contentElType:"div"}),vc=new vjs.VolumeBar(this.player_,vjs.obj.merge({vertical:!0},this.options_.volumeBar));return menu.addChild(vc),menu},vjs.VolumeMenuButton.prototype.onClick=function(){vjs.MuteToggle.prototype.onClick.call(this),vjs.MenuButton.prototype.onClick.call(this)},vjs.VolumeMenuButton.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-volume-menu-button vjs-menu-button vjs-control",innerHTML:'<div><span class="vjs-control-text">Mute</span></div>'})},vjs.VolumeMenuButton.prototype.update=vjs.MuteToggle.prototype.update,vjs.PosterImage=vjs.Button.extend({init:function(player,options){vjs.Button.call(this,player,options),player.poster()&&player.controls()||this.hide(),player.on("play",vjs.bind(this,this.hide))}}),vjs.PosterImage.prototype.createEl=function(){var el=vjs.createEl("div",{className:"vjs-poster",tabIndex:-1}),poster=this.player_.poster();return poster&&("backgroundSize"in el.style?el.style.backgroundImage='url("'+poster+'")':el.appendChild(vjs.createEl("img",{src:poster}))),el},vjs.PosterImage.prototype.onClick=function(){this.player().controls()&&this.player_.play()},vjs.LoadingSpinner=vjs.Component.extend({init:function(player,options){vjs.Component.call(this,player,options),player.on("canplay",vjs.bind(this,this.hide)),player.on("canplaythrough",vjs.bind(this,this.hide)),player.on("playing",vjs.bind(this,this.hide)),player.on("seeked",vjs.bind(this,this.hide)),player.on("seeking",vjs.bind(this,this.show)),player.on("seeked",vjs.bind(this,this.hide)),player.on("error",vjs.bind(this,this.show)),player.on("waiting",vjs.bind(this,this.show))}}),vjs.LoadingSpinner.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner"})},vjs.BigPlayButton=vjs.Button.extend(),vjs.BigPlayButton.prototype.createEl=function(){return vjs.Button.prototype.createEl.call(this,"div",{className:"vjs-big-play-button",innerHTML:"<span></span>","aria-label":"play video"})},vjs.BigPlayButton.prototype.onClick=function(){this.player_.play()},vjs.MediaTechController=vjs.Component.extend({init:function(player,options,ready){vjs.Component.call(this,player,options,ready),this.initControlsListeners()}}),vjs.MediaTechController.prototype.initControlsListeners=function(){var player,tech,activateControls,deactivateControls;tech=this,player=this.player();var activateControls=function(){player.controls()&&!player.usingNativeControls()&&tech.addControlsListeners()};deactivateControls=vjs.bind(tech,tech.removeControlsListeners),this.ready(activateControls),player.on("controlsenabled",activateControls),player.on("controlsdisabled",deactivateControls)},vjs.MediaTechController.prototype.addControlsListeners=function(){var preventBubble,userWasActive;this.on("mousedown",this.onClick),this.on("touchstart",function(event){event.preventDefault(),event.stopPropagation(),userWasActive=this.player_.userActive()}),preventBubble=function(event){event.stopPropagation(),userWasActive&&this.player_.reportUserActivity()},this.on("touchmove",preventBubble),this.on("touchleave",preventBubble),this.on("touchcancel",preventBubble),this.on("touchend",preventBubble),this.emitTapEvents(),this.on("tap",this.onTap)},vjs.MediaTechController.prototype.removeControlsListeners=function(){this.off("tap"),this.off("touchstart"),this.off("touchmove"),this.off("touchleave"),this.off("touchcancel"),this.off("touchend"),this.off("click"),this.off("mousedown")},vjs.MediaTechController.prototype.onClick=function(event){0===event.button&&this.player().controls()&&(this.player().paused()?this.player().play():this.player().pause())},vjs.MediaTechController.prototype.onTap=function(){this.player().userActive(!this.player().userActive())},vjs.MediaTechController.prototype.features={volumeControl:!0,fullscreenResize:!1,progressEvents:!1,timeupdateEvents:!1},vjs.media={},vjs.media.ApiMethods="play,pause,paused,currentTime,setCurrentTime,duration,buffered,volume,setVolume,muted,setMuted,width,height,supportsFullScreen,enterFullScreen,src,load,currentSrc,preload,setPreload,autoplay,setAutoplay,loop,setLoop,error,networkState,readyState,seeking,initialTime,startOffsetTime,played,seekable,ended,videoTracks,audioTracks,videoWidth,videoHeight,textTracks,defaultPlaybackRate,playbackRate,mediaGroup,controller,controls,defaultMuted".split(",");for(var i=vjs.media.ApiMethods.length-1;i>=0;i--){var methodName=vjs.media.ApiMethods[i];vjs.MediaTechController.prototype[vjs.media.ApiMethods[i]]=createMethod(methodName)}vjs.Html5=vjs.MediaTechController.extend({init:function(player,options,ready){this.features.volumeControl=vjs.Html5.canControlVolume(),this.features.movingMediaElementInDOM=!vjs.IS_IOS,this.features.fullscreenResize=!0,vjs.MediaTechController.call(this,player,options,ready);var source=options.source;source&&this.el_.currentSrc==source.src?player.trigger("loadstart"):source&&(this.el_.src=source.src),vjs.TOUCH_ENABLED&&player.options().nativeControlsForTouch!==!1&&this.useNativeControls(),player.ready(function(){this.tag&&this.options_.autoplay&&this.paused()&&(delete this.tag.poster,this.play())}),this.setupTriggers(),this.triggerReady()}}),vjs.Html5.prototype.dispose=function(){vjs.MediaTechController.prototype.dispose.call(this)},vjs.Html5.prototype.createEl=function(){var player=this.player_,el=player.tag;el&&this.features.movingMediaElementInDOM!==!1||(el?(el.player=null,player.tag=null,player.el().removeChild(el),el=el.cloneNode(!1)):el=vjs.createEl("video",{id:player.id()+"_html5_api",className:"vjs-tech"}),el.player=player,vjs.insertFirst(el,player.el()));for(var attrs=["autoplay","preload","loop","muted"],i=attrs.length-1;i>=0;i--){var attr=attrs[i];null!==player.options_[attr]&&(el[attr]=player.options_[attr])}return el},vjs.Html5.prototype.setupTriggers=function(){for(var i=vjs.Html5.Events.length-1;i>=0;i--)vjs.on(this.el_,vjs.Html5.Events[i],vjs.bind(this.player_,this.eventHandler))},vjs.Html5.prototype.eventHandler=function(e){this.trigger(e),e.stopPropagation()},vjs.Html5.prototype.useNativeControls=function(){var tech,player,controlsOn,controlsOff,cleanUp;tech=this,player=this.player(),tech.setControls(player.controls()),controlsOn=function(){tech.setControls(!0)},controlsOff=function(){tech.setControls(!1)},player.on("controlsenabled",controlsOn),player.on("controlsdisabled",controlsOff),cleanUp=function(){player.off("controlsenabled",controlsOn),player.off("controlsdisabled",controlsOff)},tech.on("dispose",cleanUp),player.on("usingcustomcontrols",cleanUp),player.usingNativeControls(!0)},vjs.Html5.prototype.play=function(){this.el_.play()},vjs.Html5.prototype.pause=function(){this.el_.pause()},vjs.Html5.prototype.paused=function(){return this.el_.paused},vjs.Html5.prototype.currentTime=function(){return this.el_.currentTime},vjs.Html5.prototype.setCurrentTime=function(seconds){try{this.el_.currentTime=seconds}catch(e){vjs.log(e,"Video is not ready. (Video.js)")}},vjs.Html5.prototype.duration=function(){return this.el_.duration||0},vjs.Html5.prototype.buffered=function(){return this.el_.buffered},vjs.Html5.prototype.volume=function(){return this.el_.volume},vjs.Html5.prototype.setVolume=function(percentAsDecimal){this.el_.volume=percentAsDecimal},vjs.Html5.prototype.muted=function(){return this.el_.muted},vjs.Html5.prototype.setMuted=function(muted){this.el_.muted=muted},vjs.Html5.prototype.width=function(){return this.el_.offsetWidth},vjs.Html5.prototype.height=function(){return this.el_.offsetHeight},vjs.Html5.prototype.supportsFullScreen=function(){return"function"!=typeof this.el_.webkitEnterFullScreen||!/Android/.test(vjs.USER_AGENT)&&/Chrome|Mac OS X 10.5/.test(vjs.USER_AGENT)?!1:!0},vjs.Html5.prototype.enterFullScreen=function(){var video=this.el_;video.paused&&video.networkState<=video.HAVE_METADATA?(this.el_.play(),setTimeout(function(){video.pause(),video.webkitEnterFullScreen()},0)):video.webkitEnterFullScreen()},vjs.Html5.prototype.exitFullScreen=function(){this.el_.webkitExitFullScreen()},vjs.Html5.prototype.src=function(src){this.el_.src=src},vjs.Html5.prototype.load=function(){this.el_.load()},vjs.Html5.prototype.currentSrc=function(){return this.el_.currentSrc},vjs.Html5.prototype.preload=function(){return this.el_.preload},vjs.Html5.prototype.setPreload=function(val){this.el_.preload=val},vjs.Html5.prototype.autoplay=function(){return this.el_.autoplay},vjs.Html5.prototype.setAutoplay=function(val){this.el_.autoplay=val},vjs.Html5.prototype.controls=function(){return this.el_.controls},vjs.Html5.prototype.setControls=function(val){this.el_.controls=!!val},vjs.Html5.prototype.loop=function(){return this.el_.loop},vjs.Html5.prototype.setLoop=function(val){this.el_.loop=val},vjs.Html5.prototype.error=function(){return this.el_.error},vjs.Html5.prototype.seeking=function(){return this.el_.seeking},vjs.Html5.prototype.ended=function(){return this.el_.ended},vjs.Html5.prototype.defaultMuted=function(){return this.el_.defaultMuted},vjs.Html5.isSupported=function(){return!!vjs.TEST_VID.canPlayType},vjs.Html5.canPlaySource=function(srcObj){try{return!!vjs.TEST_VID.canPlayType(srcObj.type)}catch(e){return""}},vjs.Html5.canControlVolume=function(){var volume=vjs.TEST_VID.volume;return vjs.TEST_VID.volume=volume/2+.1,volume!==vjs.TEST_VID.volume},vjs.Html5.Events="loadstart,suspend,abort,error,emptied,stalled,loadedmetadata,loadeddata,canplay,canplaythrough,playing,waiting,seeking,seeked,ended,durationchange,timeupdate,progress,play,pause,ratechange,volumechange".split(","),vjs.IS_OLD_ANDROID&&(document.createElement("video").constructor.prototype.canPlayType=function(type){return type&&-1!=type.toLowerCase().indexOf("video/mp4")?"maybe":""}),vjs.Flash=vjs.MediaTechController.extend({init:function(player,options,ready){vjs.MediaTechController.call(this,player,options,ready);var source=options.source,parentEl=options.parentEl,placeHolder=this.el_=vjs.createEl("div",{id:player.id()+"_temp_flash"}),objId=player.id()+"_flash_api",playerOptions=player.options_,flashVars=vjs.obj.merge({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",autoplay:playerOptions.autoplay,preload:playerOptions.preload,loop:playerOptions.loop,muted:playerOptions.muted},options.flashVars),params=vjs.obj.merge({wmode:"opaque",bgcolor:"#000000"},options.params),attributes=vjs.obj.merge({id:objId,name:objId,"class":"vjs-tech"},options.attributes);if(source)if(source.type&&vjs.Flash.isStreamingType(source.type)){var parts=vjs.Flash.streamToParts(source.src);flashVars.rtmpConnection=encodeURIComponent(parts.connection),flashVars.rtmpStream=encodeURIComponent(parts.stream)}else flashVars.src=encodeURIComponent(vjs.getAbsoluteURL(source.src));if(vjs.insertFirst(placeHolder,parentEl),options.startTime&&this.ready(function(){this.load(),this.play(),this.currentTime(options.startTime)}),options.iFrameMode!==!0||vjs.IS_FIREFOX)vjs.Flash.embed(options.swf,placeHolder,flashVars,params,attributes);else{var iFrm=vjs.createEl("iframe",{id:objId+"_iframe",name:objId+"_iframe",className:"vjs-tech",scrolling:"no",marginWidth:0,marginHeight:0,frameBorder:0});flashVars.readyFunction="ready",flashVars.eventProxyFunction="events",flashVars.errorEventProxyFunction="errors",vjs.on(iFrm,"load",vjs.bind(this,function(){var iDoc,iWin=iFrm.contentWindow;iDoc=iFrm.contentDocument?iFrm.contentDocument:iFrm.contentWindow.document,iDoc.write(vjs.Flash.getEmbedCode(options.swf,flashVars,params,attributes)),iWin.player=this.player_,iWin.ready=vjs.bind(this.player_,function(currSwf){var el=iDoc.getElementById(currSwf),player=this,tech=player.tech;tech.el_=el,vjs.Flash.checkReady(tech)}),iWin.events=vjs.bind(this.player_,function(swfID,eventName){var player=this;player&&"flash"===player.techName&&player.trigger(eventName)}),iWin.errors=vjs.bind(this.player_,function(swfID,eventName){vjs.log("Flash Error",eventName)})})),placeHolder.parentNode.replaceChild(iFrm,placeHolder)}}}),vjs.Flash.prototype.dispose=function(){vjs.MediaTechController.prototype.dispose.call(this)},vjs.Flash.prototype.play=function(){this.el_.vjs_play()},vjs.Flash.prototype.pause=function(){this.el_.vjs_pause()},vjs.Flash.prototype.src=function(src){if(vjs.Flash.isStreamingSrc(src)?(src=vjs.Flash.streamToParts(src),this.setRtmpConnection(src.connection),this.setRtmpStream(src.stream)):(src=vjs.getAbsoluteURL(src),this.el_.vjs_src(src)),this.player_.autoplay()){var tech=this;setTimeout(function(){tech.play()},0)}},vjs.Flash.prototype.currentSrc=function(){var src=this.el_.vjs_getProperty("currentSrc");if(null==src){var connection=this.rtmpConnection(),stream=this.rtmpStream();connection&&stream&&(src=vjs.Flash.streamFromParts(connection,stream))}return src},vjs.Flash.prototype.load=function(){this.el_.vjs_load()},vjs.Flash.prototype.poster=function(){this.el_.vjs_getProperty("poster")},vjs.Flash.prototype.buffered=function(){return vjs.createTimeRange(0,this.el_.vjs_getProperty("buffered"))},vjs.Flash.prototype.supportsFullScreen=function(){return!1},vjs.Flash.prototype.enterFullScreen=function(){return!1};var api=vjs.Flash.prototype,readWrite="rtmpConnection,rtmpStream,preload,currentTime,defaultPlaybackRate,playbackRate,autoplay,loop,mediaGroup,controller,controls,volume,muted,defaultMuted".split(","),readOnly="error,currentSrc,networkState,readyState,seeking,initialTime,duration,startOffsetTime,paused,played,seekable,ended,videoTracks,audioTracks,videoWidth,videoHeight,textTracks".split(","),createSetter=function(attr){var attrUpper=attr.charAt(0).toUpperCase()+attr.slice(1);api["set"+attrUpper]=function(val){return this.el_.vjs_setProperty(attr,val)}},createGetter=function(attr){api[attr]=function(){return this.el_.vjs_getProperty(attr)}};if(function(){var i;for(i=0;i<readWrite.length;i++)createGetter(readWrite[i]),createSetter(readWrite[i]);for(i=0;i<readOnly.length;i++)createGetter(readOnly[i])}(),vjs.Flash.isSupported=function(){return vjs.Flash.version()[0]>=10},vjs.Flash.canPlaySource=function(srcObj){return srcObj.type in vjs.Flash.formats||srcObj.type in vjs.Flash.streamingFormats?"maybe":void 0},vjs.Flash.formats={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"},vjs.Flash.streamingFormats={"rtmp/mp4":"MP4","rtmp/flv":"FLV"},vjs.Flash.onReady=function(currSwf){var el=vjs.el(currSwf),player=el.player||el.parentNode.player,tech=player.tech;el.player=player,tech.el_=el,vjs.Flash.checkReady(tech)},vjs.Flash.checkReady=function(tech){tech.el().vjs_getProperty?tech.triggerReady():setTimeout(function(){vjs.Flash.checkReady(tech)},50)},vjs.Flash.onEvent=function(swfID,eventName){var player=vjs.el(swfID).player;player.trigger(eventName)},vjs.Flash.onError=function(swfID,err){var player=vjs.el(swfID).player;player.trigger("error"),vjs.log("Flash Error",err,swfID)},vjs.Flash.version=function(){var version="0,0,0";try{version=new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(e){try{navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(version=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1])}catch(err){}}return version.split(",")},vjs.Flash.embed=function(swf,placeHolder,flashVars,params,attributes){var code=vjs.Flash.getEmbedCode(swf,flashVars,params,attributes),obj=vjs.createEl("div",{innerHTML:code}).childNodes[0],par=placeHolder.parentNode;placeHolder.parentNode.replaceChild(obj,placeHolder);var newObj=par.childNodes[0];return setTimeout(function(){newObj.style.display="block"},1e3),obj},vjs.Flash.getEmbedCode=function(swf,flashVars,params,attributes){var objTag='<object type="application/x-shockwave-flash"',flashVarsString="",paramsString="",attrsString="";return flashVars&&vjs.obj.each(flashVars,function(key,val){flashVarsString+=key+"="+val+"&amp;"}),params=vjs.obj.merge({movie:swf,flashvars:flashVarsString,allowScriptAccess:"always",allowNetworking:"all"},params),vjs.obj.each(params,function(key,val){paramsString+='<param name="'+key+'" value="'+val+'" />'}),attributes=vjs.obj.merge({data:swf,width:"100%",height:"100%"},attributes),vjs.obj.each(attributes,function(key,val){attrsString+=key+'="'+val+'" '}),objTag+attrsString+">"+paramsString+"</object>"},vjs.Flash.streamFromParts=function(connection,stream){return connection+"&"+stream},vjs.Flash.streamToParts=function(src){var parts={connection:"",stream:""};if(!src)return parts;var streamBegin,connEnd=src.indexOf("&");return-1!==connEnd?streamBegin=connEnd+1:(connEnd=streamBegin=src.lastIndexOf("/")+1,0===connEnd&&(connEnd=streamBegin=src.length)),parts.connection=src.substring(0,connEnd),parts.stream=src.substring(streamBegin,src.length),parts},vjs.Flash.isStreamingType=function(srcType){return srcType in vjs.Flash.streamingFormats},vjs.Flash.RTMP_RE=/^rtmp[set]?:\/\//i,vjs.Flash.isStreamingSrc=function(src){return vjs.Flash.RTMP_RE.test(src)},vjs.MediaLoader=vjs.Component.extend({init:function(player,options,ready){if(vjs.Component.call(this,player,options,ready),player.options_.sources&&0!==player.options_.sources.length)player.src(player.options_.sources);else for(var i=0,j=player.options_.techOrder;i<j.length;i++){var techName=vjs.capitalize(j[i]),tech=window.videojs[techName];if(tech&&tech.isSupported()){player.loadTech(techName);break}}}}),vjs.Player.prototype.textTracks_,vjs.Player.prototype.textTracks=function(){return this.textTracks_=this.textTracks_||[],this.textTracks_},vjs.Player.prototype.addTextTrack=function(kind,label,language,options){var tracks=this.textTracks_=this.textTracks_||[];options=options||{},options.kind=kind,options.label=label,options.language=language;var Kind=vjs.capitalize(kind||"subtitles"),track=new window.videojs[Kind+"Track"](this,options);return tracks.push(track),track},vjs.Player.prototype.addTextTracks=function(trackList){for(var trackObj,i=0;i<trackList.length;i++)trackObj=trackList[i],this.addTextTrack(trackObj.kind,trackObj.label,trackObj.language,trackObj);return this},vjs.Player.prototype.showTextTrack=function(id,disableSameKind){for(var track,showTrack,kind,tracks=this.textTracks_,i=0,j=tracks.length;j>i;i++)track=tracks[i],track.id()===id?(track.show(),showTrack=track):disableSameKind&&track.kind()==disableSameKind&&track.mode()>0&&track.disable();return kind=showTrack?showTrack.kind():disableSameKind?disableSameKind:!1,kind&&this.trigger(kind+"trackchange"),this},vjs.TextTrack=vjs.Component.extend({init:function(player,options){vjs.Component.call(this,player,options),this.id_=options.id||"vjs_"+options.kind+"_"+options.language+"_"+vjs.guid++,this.src_=options.src,this.dflt_=options["default"]||options.dflt,this.title_=options.title,this.language_=options.srclang,this.label_=options.label,this.cues_=[],this.activeCues_=[],this.readyState_=0,this.mode_=0,this.player_.on("fullscreenchange",vjs.bind(this,this.adjustFontSize))}}),vjs.TextTrack.prototype.kind_,vjs.TextTrack.prototype.kind=function(){return this.kind_},vjs.TextTrack.prototype.src_,vjs.TextTrack.prototype.src=function(){return this.src_},vjs.TextTrack.prototype.dflt_,vjs.TextTrack.prototype.dflt=function(){return this.dflt_},vjs.TextTrack.prototype.title_,vjs.TextTrack.prototype.title=function(){return this.title_},vjs.TextTrack.prototype.language_,vjs.TextTrack.prototype.language=function(){return this.language_},vjs.TextTrack.prototype.label_,vjs.TextTrack.prototype.label=function(){return this.label_},vjs.TextTrack.prototype.cues_,vjs.TextTrack.prototype.cues=function(){return this.cues_},vjs.TextTrack.prototype.activeCues_,vjs.TextTrack.prototype.activeCues=function(){return this.activeCues_},vjs.TextTrack.prototype.readyState_,vjs.TextTrack.prototype.readyState=function(){return this.readyState_},vjs.TextTrack.prototype.mode_,vjs.TextTrack.prototype.mode=function(){return this.mode_},vjs.TextTrack.prototype.adjustFontSize=function(){this.el_.style.fontSize=this.player_.isFullScreen?screen.width/this.player_.width()*1.4*100+"%":""},vjs.TextTrack.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-"+this.kind_+" vjs-text-track"})},vjs.TextTrack.prototype.show=function(){this.activate(),this.mode_=2,vjs.Component.prototype.show.call(this)},vjs.TextTrack.prototype.hide=function(){this.activate(),this.mode_=1,vjs.Component.prototype.hide.call(this)},vjs.TextTrack.prototype.disable=function(){2==this.mode_&&this.hide(),this.deactivate(),this.mode_=0},vjs.TextTrack.prototype.activate=function(){0===this.readyState_&&this.load(),0===this.mode_&&(this.player_.on("timeupdate",vjs.bind(this,this.update,this.id_)),this.player_.on("ended",vjs.bind(this,this.reset,this.id_)),("captions"===this.kind_||"subtitles"===this.kind_)&&this.player_.getChild("textTrackDisplay").addChild(this))},vjs.TextTrack.prototype.deactivate=function(){this.player_.off("timeupdate",vjs.bind(this,this.update,this.id_)),this.player_.off("ended",vjs.bind(this,this.reset,this.id_)),this.reset(),this.player_.getChild("textTrackDisplay").removeChild(this)},vjs.TextTrack.prototype.load=function(){0===this.readyState_&&(this.readyState_=1,vjs.get(this.src_,vjs.bind(this,this.parseCues),vjs.bind(this,this.onError)))},vjs.TextTrack.prototype.onError=function(err){this.error=err,this.readyState_=3,this.trigger("error")},vjs.TextTrack.prototype.parseCues=function(srcContent){for(var cue,time,text,id,lines=srcContent.split("\n"),line="",i=1,j=lines.length;j>i;i++)if(line=vjs.trim(lines[i])){for(-1==line.indexOf("-->")?(id=line,line=vjs.trim(lines[++i])):id=this.cues_.length,cue={id:id,index:this.cues_.length},time=line.split(" --> "),cue.startTime=this.parseCueTime(time[0]),cue.endTime=this.parseCueTime(time[1]),text=[];lines[++i]&&(line=vjs.trim(lines[i]));)text.push(line);cue.text=text.join("<br/>"),this.cues_.push(cue)}this.readyState_=2,this.trigger("loaded")},vjs.TextTrack.prototype.parseCueTime=function(timeText){var hours,minutes,other,seconds,ms,parts=timeText.split(":"),time=0;return 3==parts.length?(hours=parts[0],minutes=parts[1],other=parts[2]):(hours=0,minutes=parts[0],other=parts[1]),other=other.split(/\s+/),seconds=other.splice(0,1)[0],seconds=seconds.split(/\.|,/),ms=parseFloat(seconds[1]),seconds=seconds[0],time+=3600*parseFloat(hours),time+=60*parseFloat(minutes),time+=parseFloat(seconds),ms&&(time+=ms/1e3),time},vjs.TextTrack.prototype.update=function(){if(this.cues_.length>0){var time=this.player_.currentTime();if(void 0===this.prevChange||time<this.prevChange||this.nextChange<=time){var firstActiveIndex,lastActiveIndex,cue,i,cues=this.cues_,newNextChange=this.player_.duration(),newPrevChange=0,reverse=!1,newCues=[];for(time>=this.nextChange||void 0===this.nextChange?i=void 0!==this.firstActiveIndex?this.firstActiveIndex:0:(reverse=!0,i=void 0!==this.lastActiveIndex?this.lastActiveIndex:cues.length-1);;){if(cue=cues[i],cue.endTime<=time)newPrevChange=Math.max(newPrevChange,cue.endTime),cue.active&&(cue.active=!1);else if(time<cue.startTime){if(newNextChange=Math.min(newNextChange,cue.startTime),cue.active&&(cue.active=!1),!reverse)break}else reverse?(newCues.splice(0,0,cue),void 0===lastActiveIndex&&(lastActiveIndex=i),firstActiveIndex=i):(newCues.push(cue),void 0===firstActiveIndex&&(firstActiveIndex=i),lastActiveIndex=i),newNextChange=Math.min(newNextChange,cue.endTime),newPrevChange=Math.max(newPrevChange,cue.startTime),cue.active=!0;if(reverse){if(0===i)break;i--}else{if(i===cues.length-1)break;i++}}this.activeCues_=newCues,this.nextChange=newNextChange,this.prevChange=newPrevChange,this.firstActiveIndex=firstActiveIndex,this.lastActiveIndex=lastActiveIndex,this.updateDisplay(),this.trigger("cuechange")
}}},vjs.TextTrack.prototype.updateDisplay=function(){for(var cues=this.activeCues_,html="",i=0,j=cues.length;j>i;i++)html+='<span class="vjs-tt-cue">'+cues[i].text+"</span>";this.el_.innerHTML=html},vjs.TextTrack.prototype.reset=function(){this.nextChange=0,this.prevChange=this.player_.duration(),this.firstActiveIndex=0,this.lastActiveIndex=0},vjs.CaptionsTrack=vjs.TextTrack.extend(),vjs.CaptionsTrack.prototype.kind_="captions",vjs.SubtitlesTrack=vjs.TextTrack.extend(),vjs.SubtitlesTrack.prototype.kind_="subtitles",vjs.ChaptersTrack=vjs.TextTrack.extend(),vjs.ChaptersTrack.prototype.kind_="chapters",vjs.TextTrackDisplay=vjs.Component.extend({init:function(player,options,ready){vjs.Component.call(this,player,options,ready),player.options_.tracks&&player.options_.tracks.length>0&&this.player_.addTextTracks(player.options_.tracks)}}),vjs.TextTrackDisplay.prototype.createEl=function(){return vjs.Component.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"})},vjs.TextTrackMenuItem=vjs.MenuItem.extend({init:function(player,options){var track=this.track=options.track;options.label=track.label(),options.selected=track.dflt(),vjs.MenuItem.call(this,player,options),this.player_.on(track.kind()+"trackchange",vjs.bind(this,this.update))}}),vjs.TextTrackMenuItem.prototype.onClick=function(){vjs.MenuItem.prototype.onClick.call(this),this.player_.showTextTrack(this.track.id_,this.track.kind())},vjs.TextTrackMenuItem.prototype.update=function(){this.selected(2==this.track.mode())},vjs.OffTextTrackMenuItem=vjs.TextTrackMenuItem.extend({init:function(player,options){options.track={kind:function(){return options.kind},player:player,label:function(){return options.kind+" off"},dflt:function(){return!1},mode:function(){return!1}},vjs.TextTrackMenuItem.call(this,player,options),this.selected(!0)}}),vjs.OffTextTrackMenuItem.prototype.onClick=function(){vjs.TextTrackMenuItem.prototype.onClick.call(this),this.player_.showTextTrack(this.track.id_,this.track.kind())},vjs.OffTextTrackMenuItem.prototype.update=function(){for(var track,tracks=this.player_.textTracks(),i=0,j=tracks.length,off=!0;j>i;i++)track=tracks[i],track.kind()==this.track.kind()&&2==track.mode()&&(off=!1);this.selected(off)},vjs.TextTrackButton=vjs.MenuButton.extend({init:function(player,options){vjs.MenuButton.call(this,player,options),this.items.length<=1&&this.hide()}}),vjs.TextTrackButton.prototype.createItems=function(){var track,items=[];items.push(new vjs.OffTextTrackMenuItem(this.player_,{kind:this.kind_}));for(var i=0;i<this.player_.textTracks().length;i++)track=this.player_.textTracks()[i],track.kind()===this.kind_&&items.push(new vjs.TextTrackMenuItem(this.player_,{track:track}));return items},vjs.CaptionsButton=vjs.TextTrackButton.extend({init:function(player,options,ready){vjs.TextTrackButton.call(this,player,options,ready),this.el_.setAttribute("aria-label","Captions Menu")}}),vjs.CaptionsButton.prototype.kind_="captions",vjs.CaptionsButton.prototype.buttonText="Captions",vjs.CaptionsButton.prototype.className="vjs-captions-button",vjs.SubtitlesButton=vjs.TextTrackButton.extend({init:function(player,options,ready){vjs.TextTrackButton.call(this,player,options,ready),this.el_.setAttribute("aria-label","Subtitles Menu")}}),vjs.SubtitlesButton.prototype.kind_="subtitles",vjs.SubtitlesButton.prototype.buttonText="Subtitles",vjs.SubtitlesButton.prototype.className="vjs-subtitles-button",vjs.ChaptersButton=vjs.TextTrackButton.extend({init:function(player,options,ready){vjs.TextTrackButton.call(this,player,options,ready),this.el_.setAttribute("aria-label","Chapters Menu")}}),vjs.ChaptersButton.prototype.kind_="chapters",vjs.ChaptersButton.prototype.buttonText="Chapters",vjs.ChaptersButton.prototype.className="vjs-chapters-button",vjs.ChaptersButton.prototype.createItems=function(){for(var track,items=[],i=0;i<this.player_.textTracks().length;i++)track=this.player_.textTracks()[i],track.kind()===this.kind_&&items.push(new vjs.TextTrackMenuItem(this.player_,{track:track}));return items},vjs.ChaptersButton.prototype.createMenu=function(){for(var track,chaptersTrack,tracks=this.player_.textTracks(),i=0,j=tracks.length,items=this.items=[];j>i;i++)if(track=tracks[i],track.kind()==this.kind_&&track.dflt()){if(track.readyState()<2)return this.chaptersTrack=track,void track.on("loaded",vjs.bind(this,this.createMenu));chaptersTrack=track;break}var menu=this.menu=new vjs.Menu(this.player_);if(menu.el_.appendChild(vjs.createEl("li",{className:"vjs-menu-title",innerHTML:vjs.capitalize(this.kind_),tabindex:-1})),chaptersTrack){var cue,mi,cues=chaptersTrack.cues_;for(i=0,j=cues.length;j>i;i++)cue=cues[i],mi=new vjs.ChaptersTrackMenuItem(this.player_,{track:chaptersTrack,cue:cue}),items.push(mi),menu.addChild(mi)}return this.items.length>0&&this.show(),menu},vjs.ChaptersTrackMenuItem=vjs.MenuItem.extend({init:function(player,options){var track=this.track=options.track,cue=this.cue=options.cue,currentTime=player.currentTime();options.label=cue.text,options.selected=cue.startTime<=currentTime&&currentTime<cue.endTime,vjs.MenuItem.call(this,player,options),track.on("cuechange",vjs.bind(this,this.update))}}),vjs.ChaptersTrackMenuItem.prototype.onClick=function(){vjs.MenuItem.prototype.onClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},vjs.ChaptersTrackMenuItem.prototype.update=function(){var cue=this.cue,currentTime=this.player_.currentTime();this.selected(cue.startTime<=currentTime&&currentTime<cue.endTime)},vjs.obj.merge(vjs.ControlBar.prototype.options_.children,{subtitlesButton:{},captionsButton:{},chaptersButton:{}}),vjs.JSON,"undefined"!=typeof window.JSON&&"function"===window.JSON.parse)vjs.JSON=window.JSON;else{vjs.JSON={};var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;vjs.JSON.parse=function(text,reviver){function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(v=walk(value,k),void 0!==v?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse(): invalid or malformed JSON data")}}vjs.autoSetup=function(){var options,vid,player,vids=document.getElementsByTagName("video");if(vids&&vids.length>0)for(var i=0,j=vids.length;j>i;i++){if(vid=vids[i],!vid||!vid.getAttribute){vjs.autoSetupTimeout(1);break}void 0===vid.player&&(options=vid.getAttribute("data-setup"),null!==options&&(options=vjs.JSON.parse(options||"{}"),player=videojs(vid,options)))}else vjs.windowLoaded||vjs.autoSetupTimeout(1)},vjs.autoSetupTimeout=function(wait){setTimeout(vjs.autoSetup,wait)},"complete"===document.readyState?vjs.windowLoaded=!0:vjs.one(window,"load",function(){vjs.windowLoaded=!0}),vjs.autoSetupTimeout(1),vjs.plugin=function(name,init){vjs.Player.prototype[name]=init},videojs.Youtube=videojs.MediaTechController.extend({init:function(player,options,ready){if(videojs.MediaTechController.call(this,player,options,ready),this.features.progressEvents=!1,this.features.timeupdateEvents=!1,"undefined"!=typeof options.source)for(var key in options.source)player.options()[key]=options.source[key];this.userQuality=videojs.Youtube.convertQualityName(player.options().quality),this.player_=player,this.player_el_=document.getElementById(player.id()),this.player_el_.className+=" vjs-youtube",(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/Android.*AppleWebKit/i))&&(player.options().ytcontrols=!0),this.qualityButton=document.createElement("div"),this.qualityButton.setAttribute("class","vjs-quality-button vjs-menu-button vjs-control"),this.qualityButton.setAttribute("tabindex",0);var qualityContent=document.createElement("div");this.qualityButton.appendChild(qualityContent),this.qualityTitle=document.createElement("span"),qualityContent.appendChild(this.qualityTitle);var qualityMenu=document.createElement("div");qualityMenu.setAttribute("class","vjs-menu"),this.qualityButton.appendChild(qualityMenu),this.qualityMenuContent=document.createElement("ul"),this.qualityMenuContent.setAttribute("class","vjs-menu-content"),qualityMenu.appendChild(this.qualityMenuContent),this.id_=this.player_.id()+"_youtube_api",this.el_=videojs.Component.prototype.createEl("iframe",{id:this.id_,className:"vjs-tech",scrolling:"no",marginWidth:0,marginHeight:0,frameBorder:0,webkitAllowFullScreen:"true",mozallowfullscreen:"true",allowFullScreen:"true"}),this.iframeblocker=videojs.Component.prototype.createEl("div",{className:"iframeblocker"});var self=this,toggleThis=function(){self.paused()?self.play():self.pause()};this.iframeblocker.addEventListener("click",toggleThis),this.iframeblocker.addEventListener("mousemove",function(e){self.player_.userActive()||self.player_.userActive(!0),e.stopPropagation(),e.preventDefault()}),this.player_.options().ytcontrols||(this.iframeblocker.style.display="block"),this.player_el_.insertBefore(this.iframeblocker,this.player_el_.firstChild),this.player_el_.insertBefore(this.el_,this.iframeblocker),this.parseSrc(player.options().src),this.playOnReady=this.player_.options().autoplay||!1;var params={enablejsapi:1,iv_load_policy:3,playerapiid:this.id(),disablekb:1,wmode:"transparent",controls:this.player_.options().ytcontrols?1:0,showinfo:0,modestbranding:1,rel:0,autoplay:this.playOnReady?1:0,loop:this.player_.options().loop?1:0,list:this.playlistId,vq:this.userQuality};"undefined"==typeof params.list&&delete params.list,"file:"!=window.location.protocol?(params.origin=window.location.protocol+"//"+window.location.host,this.el_.src=window.location.protocol+"//www.youtube.com/embed/"+this.videoId+"?"+videojs.Youtube.makeQueryString(params)):this.el_.src="https://www.youtube.com/embed/"+this.videoId+"?"+videojs.Youtube.makeQueryString(params);var self=this;if(player.ready(function(){var controlBar=self.player_el_.getElementsByClassName("vjs-control-bar")[0];controlBar.appendChild(self.qualityButton),self.playOnReady&&!self.player_.options().ytcontrols&&(self.player_.loadingSpinner.show(),self.player_.bigPlayButton.hide())}),this.player_.options().ytcontrols?this.player_.controls(!1):this.player_.poster()||(null==this.videoId?this.iframeblocker.style.backgroundColor="black":this.player_.poster("https://img.youtube.com/vi/"+this.videoId+"/0.jpg")),videojs.Youtube.apiReady)this.loadYoutube();else if(videojs.Youtube.loadingQueue.push(this),!videojs.Youtube.apiLoading){var tag=document.createElement("script");tag.src="//www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag),videojs.Youtube.apiLoading=!0}this.on("dispose",function(){this.el_.parentNode.removeChild(this.el_),this.iframeblocker.parentNode.removeChild(this.iframeblocker),this.qualityButton.parentNode.removeChild(this.qualityButton),this.player_.loadingSpinner.hide(),this.player_.bigPlayButton.hide()})}}),videojs.Youtube.prototype.parseSrc=function(src){if(this.srcVal=src,src){var regId=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,match=src.match(regId);this.videoId=match&&11==match[2].length?match[2]:null;var regPlaylist=/[?&]list=([^#\&\?]+)/;match=src.match(regPlaylist),null!=match&&match.length>1?this.playlistId=match[1]:this.playlistId&&delete this.playlistId;var regVideoQuality=/[?&]vq=([^#\&\?]+)/;match=src.match(regVideoQuality),null!=match&&match.length>1&&(this.userQuality=match[1])}},videojs.Youtube.prototype.src=function(src){return src&&(this.parseSrc(src),null==this.videoId?(this.iframeblocker.style.backgroundColor="black",this.iframeblocker.style.display="block"):(this.ytplayer.loadVideoById({videoId:this.videoId,suggestedQuality:this.userQuality}),this.player_el_.getElementsByClassName("vjs-poster")[0].style.backgroundImage="url(https://img.youtube.com/vi/"+this.videoId+"/0.jpg)",this.iframeblocker.style.backgroundColor="",this.iframeblocker.style.display="",this.player_.poster("https://img.youtube.com/vi/"+this.videoId+"/0.jpg"))),this.srcVal},videojs.Youtube.prototype.load=function(){},videojs.Youtube.prototype.play=function(){null!=this.videoId&&(this.player_.options().ytcontrols||this.player_.trigger("waiting"),this.isReady_?this.ytplayer.playVideo():this.playOnReady=!0)},videojs.Youtube.prototype.pause=function(){this.ytplayer.pauseVideo()},videojs.Youtube.prototype.paused=function(){return this.ytplayer?this.lastState!==YT.PlayerState.PLAYING&&this.lastState!==YT.PlayerState.BUFFERING:!0},videojs.Youtube.prototype.currentTime=function(){return this.ytplayer&&this.ytplayer.getCurrentTime?this.ytplayer.getCurrentTime():0},videojs.Youtube.prototype.setCurrentTime=function(seconds){this.ytplayer.seekTo(seconds,!0),this.player_.trigger("timeupdate")},videojs.Youtube.prototype.duration=function(){return this.ytplayer&&this.ytplayer.getDuration?this.ytplayer.getDuration():0},videojs.Youtube.prototype.volume=function(){return this.ytplayer&&isNaN(this.volumeVal)&&(this.volumeVal=this.ytplayer.getVolume()/100),this.volumeVal},videojs.Youtube.prototype.setVolume=function(percentAsDecimal){percentAsDecimal&&percentAsDecimal!=this.volumeVal&&(this.ytplayer.setVolume(100*percentAsDecimal),this.volumeVal=percentAsDecimal,this.player_.trigger("volumechange"))},videojs.Youtube.prototype.muted=function(){return this.mutedVal},videojs.Youtube.prototype.setMuted=function(muted){muted?this.ytplayer.mute():this.ytplayer.unMute(),this.mutedVal=muted,this.player_.trigger("volumechange")},videojs.Youtube.prototype.buffered=function(){if(this.ytplayer&&this.ytplayer.getVideoBytesLoaded){var loadedBytes=this.ytplayer.getVideoBytesLoaded(),totalBytes=this.ytplayer.getVideoBytesTotal();if(!loadedBytes||!totalBytes)return 0;var duration=this.ytplayer.getDuration(),secondsBuffered=loadedBytes/totalBytes*duration,secondsOffset=this.ytplayer.getVideoStartBytes()/totalBytes*duration;return videojs.createTimeRange(secondsOffset,secondsOffset+secondsBuffered)}return videojs.createTimeRange(0,0)},videojs.Youtube.prototype.supportsFullScreen=function(){return!0},videojs.Youtube.isSupported=function(){return!0},videojs.Youtube.canPlaySource=function(srcObj){return"video/youtube"==srcObj.type},videojs.Youtube.canControlVolume=function(){return!0},videojs.Youtube.loadingQueue=[],videojs.Youtube.prototype.loadYoutube=function(){this.ytplayer=new YT.Player(this.id_,{events:{onReady:function(e){e.target.vjsTech.onReady()},onStateChange:function(e){e.target.vjsTech.onStateChange(e.data)},onPlaybackQualityChange:function(e){e.target.vjsTech.onPlaybackQualityChange(e.data)},onError:function(e){e.target.vjsTech.onError(e.data)}}}),this.ytplayer.vjsTech=this},videojs.Youtube.makeQueryString=function(args){var array=[];for(var key in args)args.hasOwnProperty(key)&&array.push(encodeURIComponent(key)+"="+encodeURIComponent(args[key]));return array.join("&")},window.onYouTubeIframeAPIReady=function(){for(var yt;yt=videojs.Youtube.loadingQueue.shift();)yt.loadYoutube();videojs.Youtube.loadingQueue=[],videojs.Youtube.apiReady=!0},videojs.Youtube.prototype.onReady=function(){this.isReady_=!0,this.triggerReady(),this.iframeblocker.style.display="",this.player_.loadingSpinner.hide(),this.player_.options().muted&&this.setMuted(!0),this.playOnReady&&(this.playOnReady=!1,this.play())},videojs.Youtube.prototype.updateQualities=function(){var qualities=this.ytplayer.getAvailableQualityLevels();if(0==qualities.length)this.qualityButton.style.display="none";else{for(this.qualityButton.style.display="";this.qualityMenuContent.hasChildNodes();)this.qualityMenuContent.removeChild(this.qualityMenuContent.lastChild);for(var i=0;i<qualities.length;++i){var el=document.createElement("li");el.setAttribute("class","vjs-menu-item"),setInnerText(el,videojs.Youtube.parseQualityName(qualities[i])),el.setAttribute("data-val",qualities[i]),qualities[i]==this.quality&&el.classList.add("vjs-selected");var self=this;el.addEventListener("click",function(){var quality=this.getAttribute("data-val");self.ytplayer.setPlaybackQuality(quality),setInnerText(self.qualityTitle,videojs.Youtube.parseQualityName(quality));var selected=self.qualityMenuContent.querySelector(".vjs-selected");selected&&selected.classList.remove("vjs-selected"),this.classList.add("vjs-selected")}),this.qualityMenuContent.appendChild(el)}}},videojs.Youtube.prototype.onStateChange=function(state){if(state!=this.lastState){switch(state){case-1:this.player_.trigger("durationchange");break;case YT.PlayerState.ENDED:this.player_.options().ytcontrols||(this.player_el_.getElementsByClassName("vjs-poster")[0].style.display="block",this.player_.bigPlayButton.show()),this.player_.trigger("ended");break;case YT.PlayerState.PLAYING:this.player_.bigPlayButton.hide(),this.updateQualities(),this.player_.trigger("timeupdate"),this.player_.trigger("durationchange"),this.player_.trigger("playing"),this.player_.trigger("play");break;case YT.PlayerState.PAUSED:this.player_.trigger("pause");break;case YT.PlayerState.BUFFERING:this.player_.trigger("timeupdate"),this.player_.options().ytcontrols||this.player_.trigger("waiting");break;case YT.PlayerState.CUED:}this.lastState=state}},videojs.Youtube.convertQualityName=function(name){switch(name){case"144p":return"tiny";case"240p":return"small";case"360p":return"medium";case"480p":return"large";case"720p":return"hd720";case"1080p":return"hd1080"}return name},videojs.Youtube.parseQualityName=function(name){switch(name){case"tiny":return"144p";case"small":return"240p";case"medium":return"360p";case"large":return"480p";case"hd720":return"720p";case"hd1080":return"1080p"}return name},videojs.Youtube.prototype.onPlaybackQualityChange=function(quality){switch(this.quality=quality,setInnerText(this.qualityTitle,videojs.Youtube.parseQualityName(quality)),quality){case"medium":this.player_.videoWidth=480,this.player_.videoHeight=360;break;case"large":this.player_.videoWidth=640,this.player_.videoHeight=480;break;case"hd720":this.player_.videoWidth=960,this.player_.videoHeight=720;break;case"hd1080":this.player_.videoWidth=1440,this.player_.videoHeight=1080;break;case"highres":this.player_.videoWidth=1920,this.player_.videoHeight=1080;break;case"small":this.player_.videoWidth=320,this.player_.videoHeight=240;break;case"tiny":this.player_.videoWidth=144,this.player_.videoHeight=108;break;default:this.player_.videoWidth=0,this.player_.videoHeight=0}this.player_.trigger("ratechange")},videojs.Youtube.prototype.onError=function(error){this.player_.error=error,this.player_.trigger("error")},function(){var style=document.createElement("style");style.type="text/css";var css=" .vjs-youtube .vjs-poster { background-size: cover; }.iframeblocker { display:none;position:absolute;top:0;left:0;width:100%;height:100%;cursor:pointer;z-index:2; }.vjs-youtube.vjs-user-inactive .iframeblocker { display:block; } .vjs-quality-button > div:first-child > span:first-child { position:relative;top:7px }";setInnerText(style,css),document.getElementsByTagName("head")[0].appendChild(style)}(),function(){function RangeSlider_(options){function initialVideoFinished(){var plugin=player.rangeslider;for(var index in plugin.components)plugin.components[index].init_();plugin.options.hidden&&plugin.hide(),plugin.options.locked&&plugin.lock(),0==plugin.options.panel&&plugin.hidePanel(),0==plugin.options.controlTime&&plugin.hidecontrolTime(),plugin._reset(),player.trigger("loadedRangeSlider")}var player=this;player.rangeslider=new RangeSlider(player,options),"Youtube"==player.techName?(player.one("error",function(){switch(player.error){case 2:alert("The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.");case 5:alert("The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.");case 100:alert("The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.");break;case 101:alert("The owner of the requested video does not allow it to be played in embedded players.");break;case 150:alert("The owner of the requested video does not allow it to be played in embedded players.");break;default:alert("Unknown Error")}}),player.on("firstplay",initialVideoFinished)):player.one("playing",initialVideoFinished),console.log("Loaded Plugin RangeSlider")}function RangeSlider(player,options){var player=player||this;this.player=player,this.components={},options=options||{},options.hasOwnProperty("locked")||(options.locked=!1),options.hasOwnProperty("hidden")||(options.hidden=!0),options.hasOwnProperty("panel")||(options.panel=!0),options.hasOwnProperty("controlTime")||(options.controlTime=!0),this.options=options,this.init()}videojs.plugin("rangeslider",RangeSlider_),RangeSlider.prototype={init:function(){var player=this.player||{};this.updatePrecision=3,this.start=0,this.end=0;var controlBar=player.controlBar,seekBar=controlBar.progressControl.seekBar;this.components.RSTimeBar=seekBar.RSTimeBar,this.components.ControlTimePanel=controlBar.ControlTimePanel,this.rstb=this.components.RSTimeBar,this.box=this.components.SeekRSBar=this.rstb.SeekRSBar,this.bar=this.components.SelectionBar=this.box.SelectionBar,this.left=this.components.SelectionBarLeft=this.box.SelectionBarLeft,this.right=this.components.SelectionBarRight=this.box.SelectionBarRight,this.tp=this.components.TimePanel=this.box.TimePanel,this.tpl=this.components.TimePanelLeft=this.tp.TimePanelLeft,this.tpr=this.components.TimePanelRight=this.tp.TimePanelRight,this.ctp=this.components.ControlTimePanel,this.ctpl=this.components.ControlTimePanelLeft=this.ctp.ControlTimePanelLeft,this.ctpr=this.components.ControlTimePanelRight=this.ctp.ControlTimePanelRight},lock:function(){this.options.locked=!0,this.ctp.enable(!1),"undefined"!=typeof this.box&&videojs.addClass(this.box.el_,"locked")},unlock:function(){this.options.locked=!1,this.ctp.enable(),"undefined"!=typeof this.box&&videojs.removeClass(this.box.el_,"locked")},show:function(){this.options.hidden=!1,"undefined"!=typeof this.rstb&&(this.rstb.show(),this.options.controlTime&&this.showcontrolTime())},hide:function(){this.options.hidden=!0,"undefined"!=typeof this.rstb&&(this.rstb.hide(),this.ctp.hide())},showPanel:function(){this.options.panel=!0,"undefined"!=typeof this.tp&&videojs.removeClass(this.tp.el_,"disable")},hidePanel:function(){this.options.panel=!1,"undefined"!=typeof this.tp&&videojs.addClass(this.tp.el_,"disable")},showcontrolTime:function(){this.options.controlTime=!0,"undefined"!=typeof this.ctp&&this.ctp.show()},hidecontrolTime:function(){this.options.controlTime=!1,"undefined"!=typeof this.ctp&&this.ctp.hide()},setValue:function(index,seconds,writeControlTime){var writeControlTime="undefined"!=typeof writeControlTime?writeControlTime:!0,percent=this._percent(seconds),isValidIndex=0===index||1===index,isChangeable=!this.locked;isChangeable&&isValidIndex&&this.box.setPosition(index,percent,writeControlTime)},setValues:function(start,end,writeControlTime){var writeControlTime="undefined"!=typeof writeControlTime?writeControlTime:!0;this._reset(),this._setValuesLocked(start,end,writeControlTime)},getValues:function(){var start,end;return start=this.start||this._getArrowValue(0),end=this.end||this._getArrowValue(1),{start:start,end:end}},playBetween:function(start,end,showRS){showRS="undefined"==typeof showRS?!0:showRS,this.player.currentTime(start),this.player.play(),showRS?(this.show(),this._reset()):this.hide(),this._setValuesLocked(start,end),this.bar.activatePlay(start,end)},loop:function(start,end,show){var player=this.player;player&&(player.on("pause",videojs.bind(this,function(){this.looping=!1})),show="undefined"==typeof show?!0:show,show?(this.show(),this._reset()):this.hide(),this._setValuesLocked(start,end),this.timeStart=start,this.timeEnd=end,this.looping=!0,this.player.currentTime(start),this.player.play(),this.player.on("timeupdate",videojs.bind(this,this.bar.process_loop)))},_getArrowValue:function(index){var index=index||0,duration=this.player.duration();duration="undefined"==typeof duration?0:duration;var percentage=this[0===index?"left":"right"].el_.style.left.replace("%","");return""==percentage&&(percentage=0===index?0:100),videojs.round(this._seconds(percentage/100),this.updatePrecision-1)},_percent:function(seconds){var duration=this.player.duration();return isNaN(duration)?0:Math.min(1,Math.max(0,seconds/duration))},_seconds:function(percent){var duration=this.player.duration();return isNaN(duration)?0:Math.min(duration,Math.max(0,percent*duration))},_reset:function(){var duration=this.player.duration();this.tpl.el_.style.left="0%",this.tpr.el_.style.left="100%",this._setValuesLocked(0,duration)},_setValuesLocked:function(start,end,writeControlTime){var triggerSliderChange="undefined"!=typeof writeControlTime,writeControlTime="undefined"!=typeof writeControlTime?writeControlTime:!0;this.options.locked?(this.unlock(),this.setValue(0,start,writeControlTime),this.setValue(1,end,writeControlTime),this.lock()):(this.setValue(0,start,writeControlTime),this.setValue(1,end,writeControlTime)),triggerSliderChange&&this._triggerSliderChange()},_checkControlTime:function(index,TextInput,timeOld){var obj,objNew,objOld,h=TextInput[0],m=TextInput[1],s=TextInput[2],newHour=h.value,newMin=m.value,newSec=s.value;if(index=index||0,newHour!=timeOld[0])obj=h,objNew=newHour,objOld=timeOld[0];else if(newMin!=timeOld[1])obj=m,objNew=newMin,objOld=timeOld[1];else{if(newSec==timeOld[2])return!1;obj=s,objNew=newSec,objOld=timeOld[2]}var durationSel,duration=this.player.duration()||0,intRegex=/^\d+$/;if((!intRegex.test(objNew)||objNew>60)&&(objNew=""==objNew?"":objOld),newHour=""==newHour?0:newHour,newMin=""==newMin?0:newMin,newSec=""==newSec?0:newSec,durationSel=videojs.TextTrack.prototype.parseCueTime(newHour+":"+newMin+":"+newSec),durationSel>duration?(obj.value=objOld,obj.style.border="1px solid red"):(obj.value=objNew,h.style.border=m.style.border=s.style.border="1px solid transparent",this.setValue(index,durationSel,!1),this._triggerSliderChange()),1===index){var oldTimeLeft=this.ctpl.el_.children,durationSelLeft=videojs.TextTrack.prototype.parseCueTime(oldTimeLeft[0].value+":"+oldTimeLeft[1].value+":"+oldTimeLeft[2].value);durationSelLeft>durationSel&&(obj.style.border="1px solid red")}else{var oldTimeRight=this.ctpr.el_.children,durationSelRight=videojs.TextTrack.prototype.parseCueTime(oldTimeRight[0].value+":"+oldTimeRight[1].value+":"+oldTimeRight[2].value);durationSel>durationSelRight&&(obj.style.border="1px solid red")}},_triggerSliderChange:function(){this.player.trigger("sliderchange")}},videojs.Player.prototype.lockSlider=function(){return this.rangeslider.lock()},videojs.Player.prototype.unlockSlider=function(){return this.rangeslider.unlock()},videojs.Player.prototype.showSlider=function(){return this.rangeslider.show()},videojs.Player.prototype.hideSlider=function(){return this.rangeslider.hide()},videojs.Player.prototype.showSliderPanel=function(){return this.rangeslider.showPanel()},videojs.Player.prototype.hideSliderPanel=function(){return this.rangeslider.hidePanel()},videojs.Player.prototype.showControlTime=function(){return this.rangeslider.showcontrolTime()},videojs.Player.prototype.hideControlTime=function(){return this.rangeslider.hidecontrolTime()},videojs.Player.prototype.setValueSlider=function(start,end){return this.rangeslider.setValues(start,end)},videojs.Player.prototype.playBetween=function(start,end){return this.rangeslider.playBetween(start,end)},videojs.Player.prototype.loopBetween=function(start,end){return this.rangeslider.loop(start,end)},videojs.Player.prototype.getValueSlider=function(){return this.rangeslider.getValues()},videojs.SeekBar.prototype.options_.children.RSTimeBar={},videojs.ControlBar.prototype.options_.children.ControlTimePanel={},videojs.RSTimeBar=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options)}}),videojs.RSTimeBar.prototype.init_=function(){this.rs=this.player_.rangeslider},videojs.RSTimeBar.prototype.options_={children:{SeekRSBar:{}}},videojs.RSTimeBar.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-timebar-RS",innerHTML:""})},videojs.SeekRSBar=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options),this.on("mousedown",this.onMouseDown)}}),videojs.SeekRSBar.prototype.init_=function(){this.rs=this.player_.rangeslider},videojs.SeekRSBar.prototype.options_={children:{SelectionBar:{},SelectionBarLeft:{},SelectionBarRight:{},TimePanel:{}}},videojs.SeekRSBar.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-rangeslider-holder"})},videojs.SeekRSBar.prototype.onMouseDown=function(event){event.preventDefault(),videojs.blockTextSelection(),this.rs.options.locked||(videojs.on(document,"mousemove",videojs.bind(this,this.onMouseMove)),videojs.on(document,"mouseup",videojs.bind(this,this.onMouseUp)))},videojs.SeekRSBar.prototype.onMouseUp=function(){videojs.off(document,"mousemove",this.onMouseMove,!1),videojs.off(document,"mouseup",this.onMouseUp,!1)},videojs.SeekRSBar.prototype.onMouseMove=function(event){var left=this.calculateDistance(event);this.rs.left.pressed?this.setPosition(0,left):this.rs.right.pressed&&this.setPosition(1,left);var currentTimeDisplay=this.player_.controlBar.currentTimeDisplay.content;currentTimeDisplay.innerHTML='<span class="vjs-control-text">Current Time </span>'+vjs.formatTime(this.rs._seconds(left),this.player_.duration()),(this.rs.left.pressed||this.rs.right.pressed)&&this.rs._triggerSliderChange()},videojs.SeekRSBar.prototype.setPosition=function(index,left,writeControlTime){var writeControlTime="undefined"!=typeof writeControlTime?writeControlTime:!0,index=index||0;if(this.rs.options.locked)return!1;if(isNaN(left))return!1;if(0!==index&&1!==index)return!1;var ObjLeft=this.rs.left.el_,Obj=(this.rs.right.el_,this.rs[0===index?"left":"right"].el_),tpr=this.rs.tpr.el_,tpl=this.rs.tpl.el_,bar=this.rs.bar,ctp=this.rs[0===index?"ctpl":"ctpr"].el_;if(0===index?bar.updateLeft(left):bar.updateRight(left)){Obj.style.left=100*left+"%",0===index?bar.updateLeft(left):bar.updateRight(left),this.rs[0===index?"start":"end"]=this.rs._seconds(left),0===index&&(ObjLeft.style.zIndex=left>=.9?25:10);var MaxP,MinP,MaxDisP,TimeText=videojs.formatTime(this.rs._seconds(left)),tplTextLegth=tpl.children[0].innerHTML.length;if(MaxDisP=4>=tplTextLegth?this.player_.isFullScreen?3.25:6.5:5>=tplTextLegth?this.player_.isFullScreen?4:8:this.player_.isFullScreen?5:10,TimeText.length<=4?(MaxP=this.player_.isFullScreen?97:93,MinP=this.player_.isFullScreen?.1:.5):TimeText.length<=5?(MaxP=this.player_.isFullScreen?96:92,MinP=this.player_.isFullScreen?.1:.5):(MaxP=this.player_.isFullScreen?95:91,MinP=this.player_.isFullScreen?.1:.5),0===index?(tpl.style.left=Math.max(MinP,Math.min(MaxP,100*left-MaxDisP/2))+"%",tpr.style.left.replace("%","")-tpl.style.left.replace("%","")<=MaxDisP&&(tpl.style.left=Math.max(MinP,Math.min(MaxP,tpr.style.left.replace("%","")-MaxDisP))+"%"),tpl.children[0].innerHTML=TimeText):(tpr.style.left=Math.max(MinP,Math.min(MaxP,100*left-MaxDisP/2))+"%",(tpr.style.left.replace("%","")||100)-tpl.style.left.replace("%","")<=MaxDisP&&(tpr.style.left=Math.max(MinP,Math.min(MaxP,tpl.style.left.replace("%","")-0+MaxDisP))+"%"),tpr.children[0].innerHTML=TimeText),writeControlTime){var h,m,s,time=TimeText.split(":");
2==time.length?(h=0,m=time[0],s=time[1]):(h=time[0],m=time[1],s=time[2]),ctp.children[0].value=h,ctp.children[1].value=m,ctp.children[2].value=s}}return!0},videojs.SeekRSBar.prototype.calculateDistance=function(event){var rstbX=this.getRSTBX(),rstbW=this.getRSTBWidth(),handleW=this.getWidth();return rstbX+=handleW/2,rstbW-=handleW,Math.max(0,Math.min(1,(event.pageX-rstbX)/rstbW))},videojs.SeekRSBar.prototype.getRSTBWidth=function(){return this.el_.offsetWidth},videojs.SeekRSBar.prototype.getRSTBX=function(){return videojs.findPosition(this.el_).left},videojs.SeekRSBar.prototype.getWidth=function(){return this.rs.left.el_.offsetWidth},videojs.SelectionBar=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options),this.on("mouseup",this.onMouseUp),this.fired=!1}}),videojs.SelectionBar.prototype.init_=function(){this.rs=this.player_.rangeslider},videojs.SelectionBar.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-selectionbar-RS"})},videojs.SelectionBar.prototype.onMouseUp=function(){var start=this.rs.left.el_.style.left.replace("%",""),end=this.rs.right.el_.style.left.replace("%",""),duration=this.player_.duration(),precision=this.rs.updatePrecision,segStart=videojs.round(start*duration/100,precision),segEnd=videojs.round(end*duration/100,precision);this.player_.currentTime(segStart),this.player_.play(),this.rs.bar.activatePlay(segStart,segEnd)},videojs.SelectionBar.prototype.updateLeft=function(left){var rightVal=""!=this.rs.right.el_.style.left?this.rs.right.el_.style.left:100,right=parseFloat(rightVal)/100,width=videojs.round(right-left,this.rs.updatePrecision);return right+1e-5>=left?(this.rs.bar.el_.style.left=100*left+"%",this.rs.bar.el_.style.width=100*width+"%",!0):!1},videojs.SelectionBar.prototype.updateRight=function(right){var leftVal=""!=this.rs.left.el_.style.left?this.rs.left.el_.style.left:0,left=parseFloat(leftVal)/100,width=videojs.round(right-left,this.rs.updatePrecision);return right+1e-5>=left?(this.rs.bar.el_.style.width=100*width+"%",this.rs.bar.el_.style.left=100*(right-width)+"%",!0):!1},videojs.SelectionBar.prototype.activatePlay=function(start,end){this.timeStart=start,this.timeEnd=end,this.suspendPlay(),this.player_.on("timeupdate",videojs.bind(this,this._processPlay))},videojs.SelectionBar.prototype.suspendPlay=function(){this.fired=!1,this.player_.off("timeupdate",videojs.bind(this,this._processPlay))},videojs.SelectionBar.prototype._processPlay=function(){if(this.player_.currentTime()>=this.timeStart&&(this.timeEnd<0||this.player_.currentTime()<this.timeEnd)){if(this.fired)return;this.fired=!0}else{if(!this.fired)return;this.fired=!1,this.player_.pause(),this.player_.currentTime(this.timeEnd),this.suspendPlay()}},videojs.SelectionBar.prototype.process_loop=function(){var player=this.player;if(player&&this.looping){var current_time=player.currentTime();(current_time<this.timeStart||this.timeEnd>0&&this.timeEnd<current_time)&&player.currentTime(this.timeStart)}},videojs.SelectionBarLeft=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options),this.on("mousedown",this.onMouseDown),this.pressed=!1}}),videojs.SelectionBarLeft.prototype.init_=function(){this.rs=this.player_.rangeslider},videojs.SelectionBarLeft.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-rangeslider-handle vjs-selectionbar-left-RS",innerHTML:'<div class="vjs-selectionbar-arrow-RS"></div><div class="vjs-selectionbar-line-RS"></div>'})},videojs.SelectionBarLeft.prototype.onMouseDown=function(event){event.preventDefault(),videojs.blockTextSelection(),this.rs.options.locked||(this.pressed=!0,videojs.on(document,"mouseup",videojs.bind(this,this.onMouseUp)),videojs.addClass(this.el_,"active"))},videojs.SelectionBarLeft.prototype.onMouseUp=function(){videojs.off(document,"mouseup",this.onMouseUp,!1),videojs.removeClass(this.el_,"active"),this.rs.options.locked||(this.pressed=!1)},videojs.SelectionBarRight=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options),this.on("mousedown",this.onMouseDown),this.pressed=!1}}),videojs.SelectionBarRight.prototype.init_=function(){this.rs=this.player_.rangeslider},videojs.SelectionBarRight.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-rangeslider-handle vjs-selectionbar-right-RS",innerHTML:'<div class="vjs-selectionbar-arrow-RS"></div><div class="vjs-selectionbar-line-RS"></div>'})},videojs.SelectionBarRight.prototype.onMouseDown=function(event){event.preventDefault(),videojs.blockTextSelection(),this.rs.options.locked||(this.pressed=!0,videojs.on(document,"mouseup",videojs.bind(this,this.onMouseUp)),videojs.addClass(this.el_,"active"))},videojs.SelectionBarRight.prototype.onMouseUp=function(){videojs.off(document,"mouseup",this.onMouseUp,!1),videojs.removeClass(this.el_,"active"),this.rs.options.locked||(this.pressed=!1)},videojs.TimePanel=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options)}}),videojs.TimePanel.prototype.init_=function(){this.rs=this.player_.rangeslider},videojs.TimePanel.prototype.options_={children:{TimePanelLeft:{},TimePanelRight:{}}},videojs.TimePanel.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-timepanel-RS"})},videojs.TimePanelLeft=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options)}}),videojs.TimePanelLeft.prototype.init_=function(){this.rs=this.player_.rangeslider},videojs.TimePanelLeft.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-timepanel-left-RS",innerHTML:'<span class="vjs-time-text">00:00</span>'})},videojs.TimePanelRight=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options)}}),videojs.TimePanelRight.prototype.init_=function(){this.rs=this.player_.rangeslider},videojs.TimePanelRight.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-timepanel-right-RS",innerHTML:'<span class="vjs-time-text">00:00</span>'})},videojs.ControlTimePanel=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options)}}),videojs.ControlTimePanel.prototype.init_=function(){this.rs=this.player_.rangeslider},videojs.ControlTimePanel.prototype.options_={children:{ControlTimePanelLeft:{},ControlTimePanelRight:{}}},videojs.ControlTimePanel.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-controltimepanel-RS vjs-control"})},videojs.ControlTimePanel.prototype.enable=function(enable){var enable="undefined"!=typeof enable?enable:!0;this.rs.ctpl.el_.children[0].disabled=enable?"":"disabled",this.rs.ctpl.el_.children[1].disabled=enable?"":"disabled",this.rs.ctpl.el_.children[2].disabled=enable?"":"disabled",this.rs.ctpr.el_.children[0].disabled=enable?"":"disabled",this.rs.ctpr.el_.children[1].disabled=enable?"":"disabled",this.rs.ctpr.el_.children[2].disabled=enable?"":"disabled"},videojs.ControlTimePanelLeft=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options),this.on("keyup",this.onKeyUp),this.on("keydown",this.onKeyDown)}}),videojs.ControlTimePanelLeft.prototype.init_=function(){this.rs=this.player_.rangeslider,this.timeOld={}},videojs.ControlTimePanelLeft.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-controltimepanel-left-RS",innerHTML:'Start: <input type="text" id="controltimepanel" maxlength="2" value="00"/>:<input type="text" id="controltimepanel" maxlength="2" value="00"/>:<input type="text" id="controltimepanel" maxlength="2" value="00"/>'})},videojs.ControlTimePanelLeft.prototype.onKeyDown=function(){this.timeOld[0]=this.el_.children[0].value,this.timeOld[1]=this.el_.children[1].value,this.timeOld[2]=this.el_.children[2].value},videojs.ControlTimePanelLeft.prototype.onKeyUp=function(){this.rs._checkControlTime(0,this.el_.children,this.timeOld)},videojs.ControlTimePanelRight=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options),this.on("keyup",this.onKeyUp),this.on("keydown",this.onKeyDown)}}),videojs.ControlTimePanelRight.prototype.init_=function(){this.rs=this.player_.rangeslider,this.timeOld={}},videojs.ControlTimePanelRight.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-controltimepanel-right-RS",innerHTML:'End: <input type="text" id="controltimepanel" maxlength="2" value="00"/>:<input type="text" id="controltimepanel" maxlength="2" value="00"/>:<input type="text" id="controltimepanel" maxlength="2" value="00"/>'})},videojs.ControlTimePanelRight.prototype.onKeyDown=function(){this.timeOld[0]=this.el_.children[0].value,this.timeOld[1]=this.el_.children[1].value,this.timeOld[2]=this.el_.children[2].value},videojs.ControlTimePanelRight.prototype.onKeyUp=function(){this.rs._checkControlTime(1,this.el_.children,this.timeOld)}}();var _ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Annotator.Plugin.Share=function(_super){function Share(element,options){return"undefined"!=typeof options&&(this.options.shareIn="undefined"!=typeof options.shareIn?options.shareIn:this.options.shareIn),this.buildHTMLShareButton=__bind(this.buildHTMLShareButton,this),this.runningAPI=__bind(this.runningAPI,this),this.updateViewer=__bind(this.updateViewer,this),_ref=Share.__super__.constructor.apply(this,arguments)}return __extends(Share,_super),Share.prototype.options={shareIn:["facebook","twitter","email","google"],getUrl:{facebook:function(title,link,noteText){return"https://www.facebook.com/sharer/sharer.php?s=100&p[url]="+link+"&p[title]="+encodeURIComponent("Open Video Annotation")+"&p[summary]="+noteText},twitter:function(title,link){return"https://twitter.com/intent/tweet?original_referer="+link+"&source=tweetbutton&url="+link+"&via=OpenVideoAnnotation&text="+encodeURIComponent("I want to share the following Open Video Annotation: ")},google:function(title,link){return"https://plus.google.com/share?url="+link},email:function(title,link){return"mailto:?subject="+title+"&body="+link}},baseUrl:""},Share.prototype.field=null,Share.prototype.input=null,Share.prototype.pluginInit=function(){if(Annotator.supported()){this.field=this.annotator.editor.addField({type:"input"});var newfield=Annotator.$('<li class="annotator-item">'+this.buildHTMLShareButton("Share without saving:")+"</li>");Annotator.$(this.field).replaceWith(newfield),this.field=newfield[0],this.buttonsActions(this.field,2,this.options.baseUrl);var APIoptions=this.initAPI();this.runAPI(APIoptions);{this.annotator.viewer.addField({load:this.updateViewer})}return this.input=$(this.field).find(":input")}},Share.prototype.buildHTMLShareButton=function(title,id){var title=title||"",id="undefined"!=typeof id?'annotationId="'+id+'"':"",titleText=""!==title?'<div class="share-text-annotator">'+title+"</div>":"",shareButton='<div class="share-button-annotator share-button" '+id+"></div>",popup='<div class="share-popup-overlay-bg" style="z-index:30000000000"><div class="share-popup"><div class="share-popup-items"></div><div class="close-btn">Close</div></div></div>';return 0===$(".share-popup-overlay-bg").length&&$(".annotator-wrapper").append(popup),'<div class="share-container-annotator">'+titleText+shareButton+"</div>"},Share.prototype.buildHTMLPopup=function(title){var buttons="";"undefined"!=typeof this.options.shareIn&&this.options.shareIn.forEach(function(item){buttons+='<div class="share-'+item+'-annotator share-button">'+item.charAt(0).toUpperCase()+item.slice(1)+"</div>"}),this.uri="undefined"!=typeof this.uri?this.uri:"";var title='<div class="share-popup-title">'+title.replace(":","")+"</div>",copy='<div class="share-popup-copy">Copy and Share:</div>',uri='<input type="text" class="share-popup-uri" onclick="javascript:this.select();" readonly="true" value="'+this.uri+'">',popup=title+buttons+copy+uri;return popup},Share.prototype.buttonsActions=function(field,method,url){var share=this;$(".close-btn").click(function(){$(".share-popup-overlay-bg").hide()}),$(".share-popup-overlay-bg").click(function(){$(".share-popup-overlay-bg").hide()}),$(".share-popup").click(function(){return!1}),$(field).find(".share-button-annotator.share-button").click(function(event){event.preventDefault();var ovaId=$(this).attr("annotationId"),title=1===method?"Share":"Share without saving";share.uri=share.createAPIURL(method,ovaId,url),$(".share-popup-overlay-bg").show(),$(".share-popup-items").html(share.buildHTMLPopup(title)),"undefined"!=typeof share.options.shareIn&&share.options.shareIn.forEach(function(item){$(".share-"+item+"-annotator.share-button").click(function(){var url=share.createAPIURL(method,ovaId,url),title="Sharing a annotation with Open Video Annotation",link=encodeURIComponent(url),noteText=share.getSource("ovaText"),finalUrl="";if(1===method){var viewer=share.annotator.viewer,textarea=$(viewer.element).find("div:first").html();noteText=encodeURIComponent(textarea)}finalUrl="undefined"!=typeof share.options.getUrl[item]?share.options.getUrl[item](title,link,noteText):"","undefined"!=typeof share.options.getUrl[item]&&window.open(finalUrl)})})})},Share.prototype.createAPIURL=function(method,ovaId,url){var annotator=this.annotator,editor=annotator.editor,method=method||1,url=url||window.location.href;if(url+=url.indexOf("?")>=0?"&":"?",1===method){var ovaId="undefined"!=typeof ovaId?ovaId:"";url+="ovaId="+ovaId}else if(2===method){var ovaText=this.getSource("ovaText")||" ";if(url+="ovaText="+ovaText,"undefined"!=typeof editor.VideoJS&&-1!==editor.VideoJS){var ovaStart=this.getSource("ovaStart")||" ",ovaEnd=this.getSource("ovaEnd")||" ",ovaContainer=this.getSource("ovaContainer")||" ",ovaSrc=this.getSource("ovaSrc")||" ";url+="&ovaStart="+ovaStart+"&ovaEnd="+ovaEnd+"&ovaContainer="+ovaContainer+"&ovaSrc="+ovaSrc}else if("undefined"!=typeof editor.OpenSeaDragon&&-1!==editor.OpenSeaDragon){var ovaLeft=this.getSource("ovaLeft")||" ",ovaTop=this.getSource("ovaTop")||" ",ovaWidth=this.getSource("ovaWidth")||" ",ovaHeight=this.getSource("ovaHeight")||" ",ovaLeftZoom=this.getSource("ovaLeftZoom")||" ",ovaTopZoom=this.getSource("ovaTopZoom")||" ",ovaWidthZoom=this.getSource("ovaWidthZoom")||" ",ovaHeightZoom=this.getSource("ovaHeightZoom")||" ",ovaContainer=this.getSource("ovaContainer")||" ",ovaSrc=this.getSource("ovaSrc")||" ";url+="&ovaLeft="+ovaLeft+"&ovaTop="+ovaTop+"&ovaWidth="+ovaWidth+"&ovaHeight="+ovaHeight+"&ovaLeftZoom="+ovaLeftZoom+"&ovaTopZoom="+ovaTopZoom+"&ovaWidthZoom="+ovaWidthZoom+"&ovaHeightZoom="+ovaHeightZoom+"&ovaContainer="+ovaContainer+"&ovaSrc="+ovaSrc}else{var ovaStart=this.getSource("ovaStart")||" ",ovaEnd=this.getSource("ovaEnd")||" ",ovastartOffset=this.getSource("ovastartOffset")||" ",ovaendOffset=this.getSource("ovaendOffset")||" ";url+="&ovaStart="+ovaStart+"&ovaEnd="+ovaEnd+"&ovastartOffset="+ovastartOffset+"&ovaendOffset="+ovaendOffset}}return url},Share.prototype.getSource=function(source){var source=source||"";if("ovaId"===source)source=this.annotation.id;else{var annotator=this.annotator,editor=annotator.editor,textarea=$(editor.element).find("textarea")[0];if("ovaText"===source&&(source=textarea.value),"undefined"!=typeof editor.VideoJS&&-1!==editor.VideoJS)"ovaContainer"===source?source=editor.VideoJS:"ovaSrc"===source?source=annotator.mplayer[editor.VideoJS].tech.options_.source.src:"ovaStart"===source?source=annotator.mplayer[editor.VideoJS].rangeslider.getValues().start:"ovaEnd"===source&&(source=annotator.mplayer[editor.VideoJS].rangeslider.getValues().end);else if("undefined"!=typeof editor.OpenSeaDragon&&-1!==editor.OpenSeaDragon){var annotation=editor.annotation;if("ovaLeft"===source)source=annotator.osda.rectPosition?annotator.osda.rectPosition.left:annotation.rangePosition.left;else if("ovaTop"===source)source=annotator.osda.rectPosition?annotator.osda.rectPosition.top:annotation.rangePosition.top;else if("ovaWidth"===source)source=annotator.osda.rectPosition?annotator.osda.rectPosition.width:annotation.rangePosition.width;else if("ovaHeight"===source)source=annotator.osda.rectPosition?annotator.osda.rectPosition.height:annotation.rangePosition.height;else if("ovaLeftZoom"===source)source=annotator.osda.viewer.drawer.viewport.getBounds().x;else if("ovaTopZoom"===source)source=annotator.osda.viewer.drawer.viewport.getBounds().y;else if("ovaWidthZoom"===source)source=annotator.osda.viewer.drawer.viewport.getBounds().width;else if("ovaHeightZoom"===source)source=annotator.osda.viewer.drawer.viewport.getBounds().height;else if("ovaContainer"===source)source=annotator.osda.viewer.id;else if("ovaSrc"===source){var source=annotator.osda.viewer.source,tilesUrl="undefined"!=typeof source.tilesUrl?source.tilesUrl:"",functionUrl="undefined"!=typeof source.getTileUrl?source.getTileUrl:"";source=""!==tilesUrl?tilesUrl:(""+functionUrl).replace(/\s+/g," ")}}else{var annotation=editor.annotation;annotation.ranges.length>0&&("ovastartOffset"===source?source=annotation.ranges[0].startOffset:"ovaendOffset"===source?source=annotation.ranges[0].endOffset:"ovaStart"===source?source=annotation.ranges[0].start:"ovaEnd"===source&&(source=annotation.ranges[0].end))}}return encodeURIComponent(source)},Share.prototype.initAPI=function(){var API={},ovaId=this.getParameterByName("ovaId"),start=this.getParameterByName("ovaStart"),end=this.getParameterByName("ovaEnd"),container=this.getParameterByName("ovaContainer"),src=this.getParameterByName("ovaSrc"),text=this.getParameterByName("ovaText"),user=this.getParameterByName("ovaUser"),Left=this.getParameterByName("ovaLeft"),Top=this.getParameterByName("ovaTop"),Width=this.getParameterByName("ovaWidth"),Height=this.getParameterByName("ovaHeight"),leftZoom=this.getParameterByName("ovaLeftZoom"),topZoom=this.getParameterByName("ovaTopZoom"),widthZoom=this.getParameterByName("ovaWidthZoom"),heightZoom=this.getParameterByName("ovaHeightZoom"),startOffset=this.getParameterByName("ovastartOffset"),endOffset=this.getParameterByName("ovaendOffset"),stripped_url=top.location.href;return""!==ovaId&&(stripped_url=this.removeVariableFromURL(stripped_url,"ovaId")),""!==start&&(stripped_url=this.removeVariableFromURL(stripped_url,"ovaStart")),""!==end&&(stripped_url=this.removeVariableFromURL(stripped_url,"ovaEnd")),""!==container&&(stripped_url=this.removeVariableFromURL(stripped_url,"ovaContainer")),""!==src&&(stripped_url=this.removeVariableFromURL(stripped_url,"ovaSrc")),""!==text&&(stripped_url=this.removeVariableFromURL(stripped_url,"ovaText")),""!==user&&(stripped_url=this.removeVariableFromURL(stripped_url,"ovaUser")),""!==Left&&(stripped_url=this.removeVariableFromURL(stripped_url,"ovaLeft")),""!==Top&&(stripped_url=this.removeVariableFromURL(stripped_url,"ovaTop")),""!==Width&&(stripped_url=this.removeVariableFromURL(stripped_url,"ovaWidth")),""!==Height&&(stripped_url=this.removeVariableFromURL(stripped_url,"ovaHeight")),""!==leftZoom&&(stripped_url=this.removeVariableFromURL(stripped_url,"ovaLeftZoom")),""!==topZoom&&(stripped_url=this.removeVariableFromURL(stripped_url,"ovaTopZoom")),""!==widthZoom&&(stripped_url=this.removeVariableFromURL(stripped_url,"ovaWidthZoom")),""!==heightZoom&&(stripped_url=this.removeVariableFromURL(stripped_url,"ovaHeightZoom")),""!==startOffset&&(stripped_url=this.removeVariableFromURL(stripped_url,"ovastartOffset")),""!==endOffset&&(stripped_url=this.removeVariableFromURL(stripped_url,"ovaendOffset")),window.history.pushState("object or string","Title",stripped_url),""!==ovaId&&$.extend(API,{method:1,ovaId:ovaId}),""!==start&&""!==end&&""!==container&&""!==src?$.extend(API,{method:2,start:start,end:end,container:container,src:src,text:text,user:user}):""!==Left&&""!==Top&&""!==Width&&""!==Height&&""!==leftZoom&&""!==topZoom&&""!==widthZoom&&""!==heightZoom?$.extend(API,{method:2,Left:Left,Top:Top,Width:Width,Height:Height,leftZoom:leftZoom,topZoom:topZoom,widthZoom:widthZoom,heightZoom:heightZoom,container:container,src:src,text:text,user:user}):""!==start&&""!==end&&""!==startOffset&&""!==endOffset&&$.extend(API,{method:2,start:start,end:end,startOffset:startOffset,endOffset:endOffset,text:text,user:user}),API},Share.prototype.runningAPI=function(annotations,API){function waitingOsda(){if(isOpenViewer="undefined"!=typeof annotator.osda&&"undefined"!=typeof annotator.osda.viewer,"undefined"==typeof olditem&&(olditem=item),isOpenViewer){if(an=allannotations[olditem],$(an.highlights).parent().find(".annotator-hl").removeClass("api"),$(an.highlights).addClass("api"),"undefined"!=typeof annotator&&"undefined"!=typeof annotator.osda){var currentBounds=annotator.osda.viewer.drawer.viewport.getBounds(),bounds="undefined"!=typeof an.bounds?an.bounds:{};"undefined"!=typeof bounds.x&&(currentBounds.x=bounds.x),"undefined"!=typeof bounds.y&&(currentBounds.y=bounds.y),"undefined"!=typeof bounds.width&&(currentBounds.width=bounds.width),"undefined"!=typeof bounds.height&&(currentBounds.height=bounds.height),annotator.osda.viewer.drawer.viewport.fitBounds(currentBounds)}$("html,body").animate({scrollTop:$(annotator.osda.viewer.element).offset().top},"slow")}else setTimeout(waitingOsda,200)}function waitingOsda(){if(isOpenViewer="undefined"!=typeof annotator.osda&&"undefined"!=typeof annotator.osda.viewer){annotator.plugins.Store.annotations.push(an),annotator.osda.viewer.annotationInstance.drawRect(an),$(an.highlights).addClass("api");var currentBounds=annotator.osda.viewer.drawer.viewport.getBounds(),bounds="undefined"!=typeof an.bounds?an.bounds:{};"undefined"!=typeof bounds.x&&(currentBounds.x=bounds.x),"undefined"!=typeof bounds.y&&(currentBounds.y=bounds.y),"undefined"!=typeof bounds.width&&(currentBounds.width=bounds.width),"undefined"!=typeof bounds.height&&(currentBounds.height=bounds.height),annotator.osda.viewer.drawer.viewport.fitBounds(currentBounds),$("html,body").animate({scrollTop:$(annotator.osda.viewer.element).offset().top},"slow")}else setTimeout(waitingOsda,200)}var mplayer,osda,wrapper=$(".annotator-wrapper").parent()[0],self=this;if($.data(wrapper,"annotator",self.annotator),annotator=window.annotator=$.data(wrapper,"annotator"),mplayer="undefined"!=typeof annotator.mplayer?annotator.mplayer:[],osda="undefined"!=typeof annotator.osda?annotator.osda:[],"undefined"!=typeof API&&"undefined"!=typeof API.method&&(1===parseInt(API.method,10)||2===parseInt(API.method,10)))if(1===parseInt(API.method,10)){var allannotations=annotator.plugins.Store.annotations,ovaId=parseInt(decodeURIComponent(API.ovaId),10);for(var item in allannotations){var olditem,an=allannotations[item];if("undefined"!=typeof an.id&&parseInt(an.id,10)===ovaId)if(self._isVideo(an)){if("undefined"!=typeof mplayer[an.target.container]){var player=mplayer[an.target.container];if(player.id_===an.target.container){var anFound=an;videojs(player.id_).ready(function(){"Youtube"!==player.techName&&player.preload("auto"),player.autoPlayAPI=anFound,player.play()})}}}else if("image"===an.media){if($("div#"+an.target.container).length){var isOpenViewer="undefined"!=typeof annotator.osda&&"undefined"!=typeof annotator.osda.viewer;waitingOsda()}}else{var hasRanges="undefined"!=typeof an.ranges&&"undefined"!=typeof an.ranges[0],startOffset=hasRanges?an.ranges[0].startOffset:"",endOffset=hasRanges?an.ranges[0].endOffset:"";"undefined"!=typeof startOffset&&"undefined"!=typeof endOffset&&($(an.highlights).addClass("api"),$("html,body").animate({scrollTop:$(an.highlights[0]).offset().top},"slow"))}}}else if(2===parseInt(API.method,10)){if("undefined"!=typeof mplayer){var container=decodeURIComponent(API.container),player=mplayer[container],isVideo="undefined"!=typeof player&&container===player.id_,isNumber=!isNaN(parseFloat(API.start))&&isFinite(API.start)&&!isNaN(parseFloat(API.end))&&isFinite(API.end),isSource=!1;if(isVideo){var src=decodeURIComponent(API.src),targetSrc=src.substring(0,src.lastIndexOf(".")),playerSrc=""===player.tech.options_.source.src?player.tag.currentSrc:player.tech.options_.source.src;playerSrc=playerSrc.substring(0,playerSrc.lastIndexOf(".")),isSource=targetSrc===playerSrc}if(isVideo&&isNumber&&isSource){var annotation={rangeTime:{start:API.start,end:API.end},created:(new Date).toISOString(),updated:(new Date).toISOString(),target:{container:container,src:src},media:"video",text:decodeURIComponent(API.text),user:decodeURIComponent(API.user)};videojs(player.id_).ready(function(){"Youtube"!==player.techName&&player.preload("auto"),player.autoPlayAPI=annotation,player.play()})}}var startOffset=API.startOffset,endOffset=API.endOffset;if(!isVideo&&"undefined"!=typeof startOffset&&"undefined"!=typeof endOffset){var annotation={ranges:[{start:decodeURIComponent(API.start),end:decodeURIComponent(API.end),startOffset:decodeURIComponent(API.startOffset),endOffset:decodeURIComponent(API.endOffset)}],created:(new Date).toISOString(),updated:(new Date).toISOString(),media:"text",text:decodeURIComponent(API.text),user:decodeURIComponent(API.user)};annotator.setupAnnotation(annotation),$(annotation.highlights).addClass("api"),$("html, body").animate({scrollTop:$(annotation.highlights[0]).offset().top},"slow")}var Left=API.Left,Top=API.Top,Width=API.Width,Height=API.Height,leftZoom=API.leftZoom,topZoom=API.topZoom,widthZoom=API.widthZoom,heightZoom=API.heightZoom;if(!isVideo&&"undefined"!=typeof Left&&"undefined"!=typeof Top&&"undefined"!=typeof Width&&"undefined"!=typeof Height&&"undefined"!=typeof leftZoom&&"undefined"!=typeof topZoom&&"undefined"!=typeof widthZoom&&"undefined"!=typeof heightZoom){var an={rangePosition:{width:parseFloat(decodeURIComponent(API.Width)),top:parseFloat(decodeURIComponent(API.Top)),left:parseFloat(decodeURIComponent(API.Left)),height:parseFloat(decodeURIComponent(API.Height))},bounds:{width:parseFloat(decodeURIComponent(API.widthZoom)),x:parseFloat(decodeURIComponent(API.leftZoom)),y:parseFloat(decodeURIComponent(API.topZoom)),height:parseFloat(decodeURIComponent(API.heightZoom))},target:{container:API.container,src:API.src},created:(new Date).toISOString(),updated:(new Date).toISOString(),media:"image",text:decodeURIComponent(API.text),user:decodeURIComponent(API.user)},isOpenViewer="undefined"!=typeof annotator.osda&&"undefined"!=typeof annotator.osda.viewer;waitingOsda()}}annotator.isShareLoaded=!0,annotator.publish("shareloaded")},Share.prototype.runAPI=function(API){var self=this,func=function(annotations){self.runningAPI(annotations,API),self.annotator.unsubscribe("annotationsLoaded",func)};this.annotator.subscribe("annotationsLoaded",func)},Share.prototype._isVideo=function(an){var an=an||{},rt=an.rangeTime,isVideo="undefined"!=typeof an.media&&"video"===an.media,hasContainer="undefined"!=typeof an.target&&"undefined"!=typeof an.target.container,isNumber="undefined"!=typeof rt&&!isNaN(parseFloat(rt.start))&&isFinite(rt.start)&&!isNaN(parseFloat(rt.end))&&isFinite(rt.end);return isVideo&&hasContainer&&isNumber},Share.prototype._isImage=function(){var wrapper=$(".annotator-wrapper").parent()[0],annotator=window.annotator=$.data(wrapper,"annotator"),rp=an.rangePosition,isOpenSeaDragon="undefined"!=typeof annotator.osda,isContainer="undefined"!=typeof an.target&&"undefined"!=typeof an.target.container,isImage="undefined"!=typeof an.media&&"image"===an.media,isRP="undefined"!=typeof rp;return isOpenSeaDragon&&isContainer&&isImage&&isRP},Share.prototype.getParameterByName=function(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec("?"+window.location.href.split("?")[1]);return null===results?"":decodeURIComponent(results[1].replace(/\+/g," "))},Share.prototype.removeVariableFromURL=function(url_string,variable_name){var URL=String(url_string),regex=new RegExp("\\?"+variable_name+"=[^&]*&?","gi");return URL=URL.replace(regex,"?"),regex=new RegExp("\\&"+variable_name+"=[^&]*&?","gi"),URL=URL.replace(regex,"&"),URL=URL.replace(/(\?|&)$/,""),regex=null,URL},Share.prototype.updateViewer=function(field,annotation){this.annotation=annotation;var self=this,field=$(field),ret=field.addClass("share-viewer-annotator").html(function(){return self.buildHTMLShareButton("Share:",self.getSource("ovaId"))});return this.buttonsActions(field[0],1,this.options.baseUrl),ret},Share}(Annotator.Plugin);var _ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Annotator.Plugin.RichText=function(_super){function RichText(){return _ref=RichText.__super__.constructor.apply(this,arguments)}return __extends(RichText,_super),RichText.prototype.options={tinymce:{selector:"li.annotator-item textarea",skin:"studio-tmce4",formats:{code:{inline:"code"}},codemirror:{path:"/static/js/vendor"},plugins:"image link codemirror media",menubar:!1,toolbar_items_size:"small",extended_valid_elements:"iframe[src|frameborder|style|scrolling|class|width|height|name|align|id]",toolbar:"insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image media | code ",resize:"both"}},RichText.prototype.pluginInit=function(){console.log("RichText-pluginInit");var annotator=this.annotator,editor=this.annotator.editor;Annotator.supported()&&(annotator.editor.addField({type:"input",submit:this.submitEditor,load:this.updateEditor}),annotator.viewer.addField({load:this.updateViewer}),annotator.subscribe("annotationEditorShown",function(){$(annotator.editor.element).find(".mce-tinymce")[0].style.display="block",annotator.editor.checkOrientation()}),annotator.subscribe("annotationEditorHidden",function(){$(annotator.editor.element).find(".mce-tinymce")[0].style.display="none"}),this.options.tinymce.setup=function(ed){ed.on("change",function(){$(editor.element).find("textarea")[0].value=tinymce.activeEditor.getContent()}),ed.on("init",function(mceInstance){tinymce.dom.Event.bind(ed.getWin(),"resize",function(){$("#"+mceInstance.target.id+"_ifr").css("min-width","400px")})}),ed.addButton("rubric",{icon:"rubric",title:"Insert a rubric",onclick:function(){ed.windowManager.open({title:"Insert a public rubric of the website https://gteavirtual.org/rubric",body:[{type:"textbox",name:"url",label:"Url"}],onsubmit:function(e){var irb,url=e.data.url,name="irb";name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec(url);if(irb=null==results?"":decodeURIComponent(results[1].replace(/\+/g," ")),""==irb)ed.windowManager.alert("Error: The given webpage didn't have a irb variable in the url");else{var iframeRubric="<iframe src='https://gteavirtual.org/rubric/?mod=portal&scr=viewrb&evt=frame&irb="+irb+"' style='width:800px;height:600px;overflow-y: scroll;background:transparent' frameborder='0' ></iframe>";ed.setContent(ed.getContent()+iframeRubric),$(editor.element).find("textarea")[0].value=ed.getContent()}}}),ed.insertContent("Main button"),ed.label="My Button"}})},tinymce.editors.length>0&&tinymce.remove("li.annotator-item textarea"),tinymce.init(this.options.tinymce))},RichText.prototype.updateEditor=function(field,annotation){var text="undefined"!=typeof annotation.text?annotation.text:"";tinymce.activeEditor.setContent(text),$(field).remove()
},RichText.prototype.updateViewer=function(field,annotation){var textDiv=$(field.parentNode).find("div:first-of-type")[0];textDiv.innerHTML=annotation.text,$(textDiv).addClass("richText-annotation"),$(field).remove()},RichText.prototype.submitEditor=function(field,annotation){var tinymceText=tinymce.activeEditor.getContent();annotation.text!==tinymceText&&(annotation.text=tinymce.activeEditor.getContent())},RichText}(Annotator.Plugin);var _ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Annotator.Plugin.Reply=function(_super){function Reply(){return this.pluginSubmit=__bind(this.pluginSubmit,this),this.updateField=__bind(this.updateField,this),_ref=Reply.__super__.constructor.apply(this,arguments)}return __extends(Reply,_super),Reply.prototype.field=null,Reply.prototype.input=null,Reply.prototype.pluginInit=function(){if(console.log("Reply-pluginInit"),Annotator.supported()){this.field=this.annotator.editor.addField({type:"input",load:this.updateField,submit:this.pluginSubmit});var newfield=Annotator.$('<li class="annotator-item reply-item" style="display:none"><span class="parent-annotation">0</span></li>');Annotator.$(this.field).replaceWith(newfield),this.field=newfield[0];{this.annotator.viewer.addField({load:this.updateViewer})}return this.input=$(this.field).find(":input")}},Reply.prototype.pluginSubmit=function(field,annotation){var replyItem=$(this.annotator.editor.element).find(".reply-item span.parent-annotation"),parent=""!==replyItem.html()?replyItem.html():"0";return"0"!==parent&&(annotation.media="comment"),0/0===parseInt(parent,10)&&(parent="0"),annotation.parent=parent,annotation.parent},Reply.prototype.updateViewer=function(field,annotation){var self=this,field=$(field),ret=field.addClass("reply-viewer-annotator").html(function(){return self});return field.remove(),this.annotation=annotation,ret},Reply.prototype.updateField=function(){var replyItem=$(this.annotator.editor.element).find(".reply-item span.parent-annotation");return replyItem.html("0")},Reply}(Annotator.Plugin),function($){var DEFAULT_SETTINGS={method:"GET",contentType:"json",queryParam:"q",searchDelay:300,minChars:1,propertyToSearch:"name",jsonContainer:null,hintText:"Type in a search term",noResultsText:"Not Found. Hit ENTER to add a personal tag.",searchingText:"Searching...",deleteText:"&times;",animateDropdown:!0,tokenLimit:null,tokenDelimiter:",",preventDuplicates:!1,tokenValue:"id",prePopulate:null,processPrePopulate:!1,idPrefix:"token-input-",resultsFormatter:function(item){return"<li>"+item[this.propertyToSearch]+"</li>"},tokenFormatter:function(item){return"<li><p>"+item[this.propertyToSearch]+"</p></li>"},onResult:null,onAdd:null,onDelete:null,onReady:null},DEFAULT_CLASSES={tokenList:"token-input-list",token:"token-input-token",tokenDelete:"token-input-delete-token",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token"},POSITION={BEFORE:0,AFTER:1,END:2},KEY={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUMPAD_ENTER:108,COMMA:188},methods={init:function(url_or_data_or_function,options){var settings=$.extend({},DEFAULT_SETTINGS,options||{});return this.each(function(){$(this).data("tokenInputObject",new $.TokenList(this,url_or_data_or_function,settings))})},clear:function(){return this.data("tokenInputObject").clear(),this},add:function(item){return this.data("tokenInputObject").add(item),this},remove:function(item){return this.data("tokenInputObject").remove(item),this},get:function(){return this.data("tokenInputObject").getTokens()}};$.fn.tokenInput=function(method){return methods[method]?methods[method].apply(this,Array.prototype.slice.call(arguments,1)):methods.init.apply(this,arguments)},$.TokenList=function(input,url_or_data,settings){function checkTokenLimit(){return null!==settings.tokenLimit&&token_count>=settings.tokenLimit?(input_box.hide(),void hide_dropdown()):void 0}function resize_input(){if(input_val!==(input_val=input_box.val())){var escaped=input_val.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");input_resizer.html(escaped),input_box.width(input_resizer.width()+30)}}function insert_token(item){var this_token=settings.tokenFormatter(item);this_token=$(this_token).addClass(settings.classes.token).insertBefore(input_token),$("<span>"+settings.deleteText+"</span>").addClass(settings.classes.tokenDelete).appendTo(this_token).click(function(){return delete_token($(this).parent()),hidden_input.change(),!1});var token_data={id:item.id};return token_data[settings.propertyToSearch]=item[settings.propertyToSearch],$.data(this_token.get(0),"tokeninput",item),saved_tokens=saved_tokens.slice(0,selected_token_index).concat([token_data]).concat(saved_tokens.slice(selected_token_index)),selected_token_index++,update_hidden_input(saved_tokens,hidden_input),token_count+=1,null!==settings.tokenLimit&&token_count>=settings.tokenLimit&&(input_box.hide(),hide_dropdown()),this_token}function add_token(item){var callback=settings.onAdd;if(token_count>0&&settings.preventDuplicates){var found_existing_token=null;if(token_list.children().each(function(){var existing_token=$(this),existing_data=$.data(existing_token.get(0),"tokeninput");return existing_data&&existing_data.id===item.id?(found_existing_token=existing_token,!1):void 0}),found_existing_token)return select_token(found_existing_token),input_token.insertAfter(found_existing_token),void input_box.focus()}(null==settings.tokenLimit||token_count<settings.tokenLimit)&&(insert_token(item),checkTokenLimit()),input_box.val(""),hide_dropdown(),$.isFunction(callback)&&callback.call(hidden_input,item)}function select_token(token){token.addClass(settings.classes.selectedToken),selected_token=token.get(0),input_box.val(""),hide_dropdown()}function deselect_token(token,position){token.removeClass(settings.classes.selectedToken),selected_token=null,position===POSITION.BEFORE?(input_token.insertBefore(token),selected_token_index--):position===POSITION.AFTER?(input_token.insertAfter(token),selected_token_index++):(input_token.appendTo(token_list),selected_token_index=token_count),input_box.focus()}function toggle_select_token(token){var previous_selected_token=selected_token;selected_token&&deselect_token($(selected_token),POSITION.END),previous_selected_token===token.get(0)?deselect_token(token,POSITION.END):select_token(token)}function delete_token(token){var token_data=$.data(token.get(0),"tokeninput"),callback=settings.onDelete,index=token.prevAll().length;index>selected_token_index&&index--,token.remove(),selected_token=null,input_box.focus(),saved_tokens=saved_tokens.slice(0,index).concat(saved_tokens.slice(index+1)),selected_token_index>index&&selected_token_index--,update_hidden_input(saved_tokens,hidden_input),token_count-=1,null!==settings.tokenLimit&&input_box.show().val("").focus(),$.isFunction(callback)&&callback.call(hidden_input,token_data)}function update_hidden_input(saved_tokens,hidden_input){var token_values=$.map(saved_tokens,function(el){return el[settings.tokenValue]});hidden_input.val(token_values.join(settings.tokenDelimiter))}function hide_dropdown(){dropdown.hide().empty(),selected_dropdown_item=null}function show_dropdown(){dropdown.css({position:"absolute",top:$(token_list).offset().top+$(token_list).outerHeight(),left:$(token_list).offset().left,zindex:999}).show()}function show_dropdown_searching(){settings.searchingText&&(dropdown.html("<p>"+settings.searchingText+"</p>"),show_dropdown())}function show_dropdown_hint(){settings.hintText&&(dropdown.html("<p>"+settings.hintText+"</p>"),show_dropdown())}function highlight_term(value,term){return value.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+term+")(?![^<>]*>)(?![^&;]+;)","gi"),"<b>$1</b>")}function find_value_and_highlight_term(template,value,term){return template.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+value+")(?![^<>]*>)(?![^&;]+;)","g"),highlight_term(value,term))}function populate_dropdown(query,results){if(results&&results.length){dropdown.empty();var dropdown_ul=$("<ul>").appendTo(dropdown).mouseover(function(event){select_dropdown_item($(event.target).closest("li"))}).mousedown(function(event){return add_token($(event.target).closest("li").data("tokeninput")),hidden_input.change(),!1}).hide();$.each(results,function(index,value){var this_li=settings.resultsFormatter(value);this_li=find_value_and_highlight_term(this_li,value[settings.propertyToSearch],query),this_li=$(this_li).appendTo(dropdown_ul),this_li.addClass(index%2?settings.classes.dropdownItem:settings.classes.dropdownItem2),0===index&&select_dropdown_item(this_li),$.data(this_li.get(0),"tokeninput",value)}),show_dropdown(),settings.animateDropdown?dropdown_ul.slideDown("fast"):dropdown_ul.show()}else settings.noResultsText&&(dropdown.html("<p>"+settings.noResultsText+"</p>"),show_dropdown())}function select_dropdown_item(item){item&&(selected_dropdown_item&&deselect_dropdown_item($(selected_dropdown_item)),item.addClass(settings.classes.selectedDropdownItem),selected_dropdown_item=item.get(0))}function deselect_dropdown_item(item){item.removeClass(settings.classes.selectedDropdownItem),selected_dropdown_item=null}function do_search(){var query=input_box.val().toLowerCase();query&&query.length&&(selected_token&&deselect_token($(selected_token),POSITION.AFTER),query.length>=settings.minChars?(show_dropdown_searching(),clearTimeout(timeout),timeout=setTimeout(function(){run_search(query)},settings.searchDelay)):hide_dropdown())}function run_search(query){var cache_key=query+computeURL(),cached_results=cache.get(cache_key);if(cached_results)populate_dropdown(query,cached_results);else if(settings.url){var url=computeURL(),ajax_params={};if(ajax_params.data={},url.indexOf("?")>-1){var parts=url.split("?");ajax_params.url=parts[0];var param_array=parts[1].split("&");$.each(param_array,function(index,value){var kv=value.split("=");ajax_params.data[kv[0]]=kv[1]})}else ajax_params.url=url;ajax_params.data[settings.queryParam]=query,ajax_params.type=settings.method,ajax_params.dataType=settings.contentType,settings.crossDomain&&(ajax_params.dataType="jsonp"),ajax_params.success=function(results){$.isFunction(settings.onResult)&&(results=settings.onResult.call(hidden_input,results)),cache.add(cache_key,settings.jsonContainer?results[settings.jsonContainer]:results),input_box.val().toLowerCase()===query&&populate_dropdown(query,settings.jsonContainer?results[settings.jsonContainer]:results)},$.ajax(ajax_params)}else if(settings.local_data){var results=$.grep(settings.local_data,function(row){return row[settings.propertyToSearch].toLowerCase().indexOf(query.toLowerCase())>-1});$.isFunction(settings.onResult)&&(results=settings.onResult.call(hidden_input,results)),cache.add(cache_key,results),populate_dropdown(query,results)}}function computeURL(){var url=settings.url;return"function"==typeof settings.url&&(url=settings.url.call()),url}if("string"===$.type(url_or_data)||"function"===$.type(url_or_data)){settings.url=url_or_data;var url=computeURL();void 0===settings.crossDomain&&(settings.crossDomain=-1===url.indexOf("://")?!1:location.href.split(/\/+/g)[1]!==url.split(/\/+/g)[1])}else"object"==typeof url_or_data&&(settings.local_data=url_or_data);settings.classes?settings.classes=$.extend({},DEFAULT_CLASSES,settings.classes):settings.theme?(settings.classes={},$.each(DEFAULT_CLASSES,function(key,value){settings.classes[key]=value+"-"+settings.theme})):settings.classes=DEFAULT_CLASSES;var timeout,input_val,saved_tokens=[],token_count=0,cache=new $.TokenList.Cache,input_box=$('<input type="text"  autocomplete="off">').css({outline:"none"}).attr("id",settings.idPrefix+input.id).focus(function(){(null===settings.tokenLimit||settings.tokenLimit!==token_count)&&show_dropdown_hint()}).blur(function(){hide_dropdown(),$(this).val("")}).bind("keyup keydown blur update",resize_input).keydown(function(event){var previous_token,next_token;switch(event.keyCode){case KEY.LEFT:case KEY.RIGHT:case KEY.UP:case KEY.DOWN:if($(this).val()){var dropdown_item=null;return dropdown_item=event.keyCode===KEY.DOWN||event.keyCode===KEY.RIGHT?$(selected_dropdown_item).next():$(selected_dropdown_item).prev(),dropdown_item.length&&select_dropdown_item(dropdown_item),!1}previous_token=input_token.prev(),next_token=input_token.next(),previous_token.length&&previous_token.get(0)===selected_token||next_token.length&&next_token.get(0)===selected_token?event.keyCode===KEY.LEFT||event.keyCode===KEY.UP?deselect_token($(selected_token),POSITION.BEFORE):deselect_token($(selected_token),POSITION.AFTER):event.keyCode!==KEY.LEFT&&event.keyCode!==KEY.UP||!previous_token.length?event.keyCode!==KEY.RIGHT&&event.keyCode!==KEY.DOWN||!next_token.length||select_token($(next_token.get(0))):select_token($(previous_token.get(0)));break;case KEY.BACKSPACE:if(previous_token=input_token.prev(),!$(this).val().length)return selected_token?(delete_token($(selected_token)),hidden_input.change()):previous_token.length&&select_token($(previous_token.get(0))),!1;1===$(this).val().length?hide_dropdown():setTimeout(function(){do_search()},5);break;case KEY.TAB:case KEY.ENTER:case KEY.NUMPAD_ENTER:case KEY.COMMA:if(selected_dropdown_item)return add_token($(selected_dropdown_item).data("tokeninput")),annotator.publish("colorEditorTags"),hidden_input.change(),!1;add_token({id:$(this).val(),name:$(this).val()}),hidden_input.change();break;case KEY.ESCAPE:return hide_dropdown(),!0;default:String.fromCharCode(event.which)&&setTimeout(function(){do_search()},5)}}),hidden_input=$(input).hide().val("").focus(function(){input_box.focus()}).blur(function(){input_box.blur()}),selected_token=null,selected_token_index=0,selected_dropdown_item=null,token_list=$("<ul />").addClass(settings.classes.tokenList).click(function(event){var li=$(event.target).closest("li");li&&li.get(0)&&$.data(li.get(0),"tokeninput")?toggle_select_token(li):(selected_token&&deselect_token($(selected_token),POSITION.END),input_box.focus())}).mouseover(function(event){var li=$(event.target).closest("li");li&&selected_token!==this&&li.addClass(settings.classes.highlightedToken)}).mouseout(function(event){var li=$(event.target).closest("li");li&&selected_token!==this&&li.removeClass(settings.classes.highlightedToken)}).insertBefore(hidden_input),input_token=$("<li />").addClass(settings.classes.inputToken).appendTo(token_list).append(input_box),dropdown=$("<div>").addClass(settings.classes.dropdown).appendTo("body").hide(),input_resizer=$("<tester/>").insertAfter(input_box).css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:input_box.css("fontSize"),fontFamily:input_box.css("fontFamily"),fontWeight:input_box.css("fontWeight"),letterSpacing:input_box.css("letterSpacing"),whiteSpace:"nowrap"});hidden_input.val("");var li_data=settings.prePopulate||hidden_input.data("pre");settings.processPrePopulate&&$.isFunction(settings.onResult)&&(li_data=settings.onResult.call(hidden_input,li_data)),li_data&&li_data.length&&$.each(li_data,function(index,value){insert_token(value),checkTokenLimit()}),$.isFunction(settings.onReady)&&settings.onReady.call(),this.clear=function(){token_list.children("li").each(function(){0===$(this).children("input").length&&delete_token($(this))})},this.add=function(item){add_token(item)},this.remove=function(item){token_list.children("li").each(function(){if(0===$(this).children("input").length){var currToken=$(this).data("tokeninput"),match=!0;for(var prop in item)if(item[prop]!==currToken[prop]){match=!1;break}match&&delete_token($(this))}})},this.getTokens=function(){return saved_tokens}},$.TokenList.Cache=function(options){var settings=$.extend({max_size:500},options),data={},size=0,flush=function(){data={},size=0};this.add=function(query,results){size>settings.max_size&&flush(),data[query]||(size+=1),data[query]=results},this.get=function(query){return data[query]}}}(jQuery);var _ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Annotator.Plugin.HighlightTags=function(_super){function HighlightTags(element,options){return this.pluginSubmit=__bind(this.pluginSubmit,this),this.updateViewer=__bind(this.updateViewer,this),this.colorize=__bind(this.colorize,this),this.updateField=__bind(this.updateField,this),this.externalCall=__bind(this.externalCall,this),this.colorizeEditorTags=__bind(this.colorizeEditorTags,this),this.options=options,_ref=HighlightTags.__super__.constructor.apply(this,arguments)}return __extends(HighlightTags,_super),HighlightTags.prototype.options=null,HighlightTags.prototype.field=null,HighlightTags.prototype.input=null,HighlightTags.prototype.colors=null,HighlightTags.prototype.isFirstTime=!0,HighlightTags.prototype.pluginInit=function(){if(console.log("HighlightTags-pluginInit"),Annotator.supported()){this.field=this.annotator.editor.addField({type:"input",load:this.updateField,submit:this.pluginSubmit});var self=this,newfield=Annotator.$('<li class="annotator-item"><div><input placeholder ="Add tags" type="text" id="tag-input" name="tags" /></div></li>');Annotator.$(self.field).replaceWith(newfield),self.field=newfield[0];{this.annotator.viewer.addField({load:this.updateViewer})}this.colors=this.getHighlightTags();var self=this;this.annotator.subscribe("annotationsLoaded",function(){setTimeout(function(){self.colorize()},1e3)}),this.annotator.subscribe("annotationUpdated",function(){setTimeout(function(){self.colorize()},1e3)}),this.annotator.subscribe("flaggedAnnotation",this.updateViewer),this.annotator.subscribe("annotationCreated",function(){setTimeout(function(){self.colorize()},1e3)}),this.annotator.subscribe("externalCallToHighlightTags",function(){setTimeout(function(){self.externalCall()},1e3)}),this.annotator.subscribe("colorEditorTags",this.colorizeEditorTags)}},HighlightTags.prototype.getHighlightTags=function(){if("undefined"!=typeof this.options.tag){var self=this,final={},prelim=this.options.tag.split(",");return prelim.forEach(function(item){var temp=item.split(":");final[temp[0]]=self.getRGB(temp[1])}),final}return{}},HighlightTags.prototype.getRGB=function(item){function getColorValues(color){var values={red:null,green:null,blue:null,alpha:null};if("string"==typeof color)if(0===color.indexOf("#"))color=color.substr(1),values=3==color.length?{red:parseInt(color[0]+color[0],16),green:parseInt(color[1]+color[1],16),blue:parseInt(color[2]+color[2],16),alpha:.3}:{red:parseInt(color.substr(0,2),16),green:parseInt(color.substr(2,2),16),blue:parseInt(color.substr(4,2),16),alpha:.3};else if(0===color.indexOf("rgb(")){var pars=color.indexOf(",");values={red:parseInt(color.substr(4,pars)),green:parseInt(color.substr(pars+1,color.indexOf(",",pars))),blue:parseInt(color.substr(color.indexOf(",",pars+1)+1,color.indexOf(")"))),alpha:.3}}else if(0===color.indexOf("rgba(")){var pars=color.indexOf(","),repars=color.indexOf(",",pars+1);values={red:parseInt(color.substr(5,pars)),green:parseInt(color.substr(pars+1,repars)),blue:parseInt(color.substr(color.indexOf(",",pars+1)+1,color.indexOf(",",repars))),alpha:parseFloat(color.substr(color.indexOf(",",repars+1)+1,color.indexOf(")")))}}else{var stdCol={acqua:"#0ff",teal:"#008080",blue:"#00f",navy:"#000080",yellow:"#ff0",olive:"#808000",lime:"#0f0",green:"#008000",fuchsia:"#f0f",purple:"#800080",red:"#f00",maroon:"#800000",white:"#fff",gray:"#808080",silver:"#c0c0c0",black:"#000"};void 0!=stdCol[color]&&(values=getColorValues(stdCol[color]))}return values}return getColorValues(item)},HighlightTags.prototype.colorize=function(){var annotations=Array.prototype.slice.call($(".annotator-hl"));for(annNum=0;annNum<annotations.length;++annNum){var anns=$.data(annotations[annNum],"annotation");if("undefined"!=typeof anns.tags&&0==anns.tags.length&&("image"!==anns.media?$(annotations[annNum]).css("background-color",""):($(annotations[annNum]).css("border","2px solid rgb(255, 255, 255)"),$(annotations[annNum]).css("outline","2px solid rgb(0, 0, 0)"))),"undefined"!=typeof anns.tags&&this.colors!=={}){for(var index=0;index<anns.tags.length;++index)if(-1==anns.tags[index].indexOf("flagged-"))if("undefined"!=typeof this.colors[anns.tags[index]]){var finalcolor=this.colors[anns.tags[index]];"image"!==anns.media?$(annotations[annNum]).css("background","rgba("+finalcolor.red+", "+finalcolor.green+", "+finalcolor.blue+", 0.3)"):$(annotations[annNum]).css("outline","2px solid rgb("+finalcolor.red+", "+finalcolor.green+", "+finalcolor.blue+")")}else"image"!==anns.media&&$(annotations[annNum]).css("background","")}else"image"!==anns.media&&$(annotations[annNum]).css("background","")}this.annotator.publish("colorizeCompleted")},HighlightTags.prototype.updateField=function(field,annotation){if(this.isFirstTime){var tags=this.options.tag.split(","),tokensavailable=[];tags.forEach(function(tagnames){lonename=tagnames.split(":"),tokensavailable.push({id:lonename[0],name:lonename[0]})}),$("#tag-input").tokenInput(tokensavailable),this.isFirstTime=!1}if($("#token-input-tag-input").attr("placeholder","Add tags..."),$("#tag-input").tokenInput("clear"),"undefined"!=typeof annotation.tags)for(tagnum=0;tagnum<annotation.tags.length;tagnum++){var n=annotation.tags[tagnum];"undefined"!=typeof this.annotator.plugins.HighlightTags?-1==annotation.tags[tagnum].indexOf("flagged-")&&$("#tag-input").tokenInput("add",{id:n,name:n}):$("#tag-input").tokenInput("add",{id:n,name:n})}this.colorizeEditorTags()},HighlightTags.prototype.colorizeEditorTags=function(){var self=this;$.each($(".annotator-editor .token-input-token"),function(key,tagdiv){var rgbColor="",textColor="color:#000;",par=$(tagdiv).find("p");if("undefined"!=typeof self.colors[par.html()]){var finalcolor=self.colors[par.html()];rgbColor="background-color:rgba("+finalcolor.red+", "+finalcolor.green+", "+finalcolor.blue+", 0.5);",textColor="color:#fff;"}$(tagdiv).attr("style",rgbColor),par.attr("style",textColor)})},HighlightTags.prototype.pluginSubmit=function(field,annotation){var tokens=Array.prototype.slice.call($(".token-input-input-token").parent().find(".token-input-token")),arr=[];tokens.forEach(function(element){tag=element.firstChild.firstChild,arr.push(tag.nodeValue)}),annotation.tags=arr},HighlightTags.prototype.updateViewer=function(field,annotation){if("undefined"!=typeof annotation.tags){if(0==annotation.tags.length)return void $(field).remove();var nonFlagTags=!0,tokenList='<ul class="token-input-list">';for(tagnum=0;tagnum<annotation.tags.length;++tagnum)if("undefined"!=typeof this.annotator.plugins.Flagging){if(-1==annotation.tags[tagnum].indexOf("flagged-")){var rgbColor="",textColor="#000";if("undefined"!=typeof this.colors[annotation.tags[tagnum]]){var finalcolor=this.colors[annotation.tags[tagnum]];rgbColor='style="background-color:rgba('+finalcolor.red+", "+finalcolor.green+", "+finalcolor.blue+', 0.5);"',textColor="#fff"}tokenList+='<li class="token-input-token"'+rgbColor+'><p style="color: '+textColor+';">'+annotation.tags[tagnum]+"</p></span></li>",nonFlagTags=!1}}else tokenList+='<li class="token-input-token"><p>'+annotation.tags[tagnum]+"</p></span></li>";tokenList+="</ul>",$(field).append(tokenList),nonFlagTags&&$(field).remove()}else $(field).remove();this.annotator.publish("finishedDrawingTags")},HighlightTags.prototype.externalCall=function(){this.colorize(),this.annotator.publish("finishedExternalCallToHighlightTags")},HighlightTags}(Annotator.Plugin);var _ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Annotator.Plugin.Flagging=function(_super){function Flagging(element,options){return this.updateViewer=__bind(this.updateViewer,this),this.updateField=__bind(this.updateField,this),this.submitField=__bind(this.submitField,this),this.flagAnnotation=__bind(this.flagAnnotation,this),this.unflagAnnotation=__bind(this.unflagAnnotation,this),this.getTotalFlaggingTags=__bind(this.getTotalFlaggingTags,this),this.options=options,_ref=Flagging.__super__.constructor.apply(this,arguments)}return __extends(Flagging,_super),Flagging.prototype.options=null,Flagging.prototype.field=null,Flagging.prototype.input=null,Flagging.prototype.hasPressed=!1,Flagging.prototype.activeAnnotation=null,Flagging.prototype.mixedTags=null,Flagging.prototype.pluginInit=function(){if(console.log("Flagging-pluginInit"),Annotator.supported()){this.field=this.annotator.editor.addField({type:"checkbox",load:this.updateField,label:Annotator._t(gettext("Check the box to remove all flags.")),submit:this.submitField});{this.annotator.viewer.addField({load:this.updateViewer})}return this.input=$(this.field).find(":input")}},Flagging.prototype.getTotalFlaggingTags=function(annotation){var tags="undefined"!=typeof annotation.tags?annotation.tags.slice():[];return $.grep(tags,function(tag){return-1!==tag.indexOf("flagged")}).length},Flagging.prototype.updateField=function(field,annotation){var user_email="image"===annotation.media||"undefined"==typeof ova?osda.options.optionsAnnotator.permissions.user.id:ova.options.optionsAnnotator.permissions.user.id,totalFlags=this.getTotalFlaggingTags(annotation);this.mixedTags=annotation.tags;var self=this;if(Catch.options.instructor_email===user_email&&totalFlags>0){var message=ngettext("Check the box to remove %(totalFlags)s flag.","Check the box to remove %(totalFlags)s flags.",totalFlags);$(field).find("label")[0].innerHTML=interpolate(message,{totalFlags:totalFlags},!0),this.activeAnnotation=annotation,$(field).find("input").change(function(){if($(field).find("input:checkbox:checked").val())$(field).find("label")[0].innerHTML=gettext("All flags have been removed. To undo, uncheck the box.");else{var count=self.getTotalFlaggingTags(self.activeAnnotation),message=ngettext("Check the box to remove %(count)s flag.","Check the box to remove %(count)s flags.",count);$(field).find("label")[0].innerHTML=interpolate(message,{count:count},!0)}}),$(field).show()}else $(field).hide()},Flagging.prototype.submitField=function(field,annotation){$(field).find("input:checkbox:checked").val()||(annotation.tags=this.mixedTags)},Flagging.prototype.updateViewer=function(field,annotation){var self=this;this.hasPressed=!1;var tags="undefined"!=typeof annotation.tags?annotation.tags:[],user=this.annotator.plugins.Permissions.user.id;tags.forEach(function(t){if(t.indexOf("flagged")>=0){var usertest=t.replace("flagged-","");usertest==user&&(self.hasPressed=!0)}});var fieldControl=$(this.annotator.viewer.element.find(".annotator-controls")).parent();if(this.hasPressed){var message=gettext("You have already reported this annotation.");fieldControl.prepend('<button title="'+message+'" class="flag-icon-used" id="'+annotation.id+'">');var flagEl=fieldControl.find(".flag-icon-used#"+annotation.id),self=this;flagEl.click(function(){self.unflagAnnotation(annotation,user,flagEl,field)})}else{var message=gettext("Report annotation as inappropriate or offensive.");fieldControl.prepend('<button title="'+message+'" class="flag-icon" id="'+annotation.id+'">');var flagEl=fieldControl.find(".flag-icon#"+annotation.id),self=this;flagEl.click(function(){self.flagAnnotation(annotation,user,flagEl,field)})}var user_email="image"===annotation.media?osda.options.optionsAnnotator.permissions.user.id:ova.options.optionsAnnotator.permissions.user.id,totalFlags=this.getTotalFlaggingTags(annotation);if(Catch.options.instructor_email===user_email&&totalFlags>0){var message=ngettext("This annotation has %(count)s flag.","This annotation has %(count)s flags.",totalFlags);$(field).append('<div class="flag-count">'+interpolate(message,{count:totalFlags},!0)+"</div>")}else $(field).remove()},Flagging.prototype.flagAnnotation=function(annotation,userId,flagElement,field){flagElement.attr("class","flag-icon-used"),flagElement.attr("title",gettext("You have already reported this annotation.")),"undefined"==typeof annotation.tags?annotation.tags=["flagged-"+userId]:annotation.tags.push("flagged-"+userId),this.annotator.plugins.Store.annotationUpdated(annotation),this.annotator.publish("flaggedAnnotation",[field,annotation]),flagElement.click(function(){self.unflagAnnotation(annotation,userId,flagElement,field)})},Flagging.prototype.unflagAnnotation=function(annotation,userId,flagElement,field){flagElement.attr("class","flag-icon"),flagElement.attr("title",gettext("Report annotation as inappropriate or offensive.")),annotation.tags.splice(annotation.tags.indexOf("flagged-"+userId)),this.annotator.plugins.Store.annotationUpdated(annotation),this.annotator.publish("flaggedAnnotation",[field,annotation]),flagElement.click(function(){self.unflagAnnotation(annotation,userId,flagElement,field)})},Flagging}(Annotator.Plugin);var _ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Annotator.Plugin.Diacritics=function(_super){function Diacritics(element,options){return this.pluginSubmit=__bind(this.pluginSubmit,this),this.updateDiacritics=__bind(this.updateDiacritics,this),this.updateViewer=__bind(this.updateViewer,this),this.getDiacritics=__bind(this.getDiacritics,this),this.getPos=__bind(this.getPos,this),this.putMarkAtLocation=__bind(this.putMarkAtLocation,this),this.updateEditorForDiacritics=__bind(this.updateEditorForDiacritics,this),this.options=options,this.diacriticmarks=this.getDiacritics(),_ref=Diacritics.__super__.constructor.apply(this,arguments)}return __extends(Diacritics,_super),Diacritics.prototype.options=null,Diacritics.prototype.diacriticmarks=null,Diacritics.prototype.field=null,Diacritics.prototype.input=null,Diacritics.prototype.pluginInit=function(){if(Annotator.supported()){var di=this.diacriticmarks,self=this;return"undefined"!=di&&($.each(di,function(item){self.field=self.annotator.editor.addField({type:"checkbox",label:Annotator._t(item),submit:self.pluginSubmit})}),this.annotator.viewer.addField({load:this.updateViewer}),this.annotator.subscribe("annotationsLoaded",this.updateDiacritics),this.annotator.subscribe("annotationUploaded",this.updateDiacritics),this.annotator.subscribe("annotationDeleted",this.updateDiacritics),this.annotator.subscribe("annotationUpdated",this.updateDiacritics),this.annotator.subscribe("annotationEditorShown",this.updateEditorForDiacritics,this.field),$(window).resize(this.updateDiacritics.bind(this))),this.input=$(this.field).find(":input")}},Diacritics.prototype.pluginSubmit=function(field,annotation){var checkedItems=$(this.field).find(":input"),self=this;$.each(checkedItems,function(item){if("undefined"!=typeof annotation.tags){var index=$.inArray(checkedItems[item].placeholder,annotation.tags);if(-1!=index){annotation.tags.splice(index,1);var annotatorWrapper=$(".annotator-wrapper").first(),element=annotatorWrapper.find("div."+annotation.id);
element.length||(element=annotatorWrapper.find("div.undefined")),element.remove()}checkedItems[item].checked===!0&&(annotation.tags.unshift(checkedItems[item].placeholder),self.putMarkAtLocation(annotation,checkedItems[item].placeholder))}else checkedItems[item].checked===!0&&(annotation.tags=[checkedItems[item].placeholder],self.putMarkAtLocation(annotation,checkedItems[item].placeholder))})},Diacritics.prototype.putMarkAtLocation=function(annotation,mark){var top,loc=this.getPos(annotation.highlights[0]),alignment=this.diacriticmarks[mark][1],imgurl=this.diacriticmarks[mark][0];switch(alignment){case"top":top=loc.y-5;break;case"bottom":top=loc.y+loc.height-5;break;default:top=loc.y}$("<div></div>").addClass("mark "+annotation.id).css({top:top,left:loc.x+.5*loc.width-5,"background-image":"url("+imgurl+")"}).appendTo(".annotator-wrapper")},Diacritics.prototype.getDiacritics=function(){var diacriticsList,diacritics={};return"undefined"!=typeof this.options.diacritics&&(diacriticsList=this.options.diacritics.split(","),$.each(diacriticsList,function(key,item){var temp=item.split(";");temp.length>2&&(diacritics[temp[0]]=[temp[1],temp[2]])})),diacritics},Diacritics.prototype.getPos=function(el){var element=$(el),elementOffset=element.offset(),annotatorOffset=$(".annotator-wrapper").offset();return{x:elementOffset.left-annotatorOffset.left,y:elementOffset.top-annotatorOffset.top,width:element.width(),height:element.height()}},Diacritics.prototype.updateDiacritics=function(){$(".mark").remove();var annotations=this.annotator.plugins.Store.annotations,self=this;$.each(annotations,function(key,annotation){$.each(self.diacriticmarks,function(tag){-1!=$.inArray(tag,annotation.tags)&&self.putMarkAtLocation(annotation,tag)})})},Diacritics.prototype.updateViewer=function(field){$(field).remove()},Diacritics.prototype.updateEditorForDiacritics=function(field,annotation){if("undefined"!=typeof annotation.tags){var inputItems=$(this.field).find(":input"),dictOfItems={},self=this;$.each(inputItems,function(key,item){item.checked=!1,dictOfItems[item.placeholder]=item}),$.each(annotation.tags,function(key,tag){self.diacriticmarks[tag]&&(dictOfItems[tag].checked=!0)})}},Diacritics}(Annotator.Plugin);var _ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Annotator.Plugin.Grouping=function(_super){function Grouping(element,options){return this.pluginInit=__bind(this.pluginInit,this),this.reloadAnnotations=__bind(this.reloadAnnotations,this),this.groupAndColor=__bind(this.groupAndColor,this),this.clearGrouping=__bind(this.clearGrouping,this),this.getPos=__bind(this.getPos,this),this.groupingButtonPressed=__bind(this.groupingButtonPressed,this),this.options=options,_ref=Grouping.__super__.constructor.apply(this,arguments)}return __extends(Grouping,_super),Grouping.prototype.options=null,Grouping.prototype.unfilteredAnnotations=null,Grouping.prototype.groupedAnnotations=null,Grouping.prototype.groupthreshold=0,Grouping.prototype.useGrouping=1,Grouping.prototype.getPos=function(el){var off=$(el).offset(),wrapperOff=$($(".annotator-wrapper")[0]).offset();return{x:off.left,y:off.top-wrapperOff.top}},Grouping.prototype.pluginInit=function(){if(!Annotator.supported())return void console.log("Annotator is not supported");this.annotator.subscribe("annotationsLoaded",this.reloadAnnotations),this.annotator.subscribe("annotationUploaded",this.reloadAnnotations),this.annotator.subscribe("annotationDeleted",this.reloadAnnotations),this.annotator.subscribe("annotationCreated",this.reloadAnnotations),this.annotator.subscribe("changedTabsInCatch",this.groupingButtonPressed);var newdiv=document.createElement("div"),className="onOffGroupButton";newdiv.setAttribute("class",className),"public"===options.optionsOVA.default_tab.toLowerCase()?(newdiv.innerHTML="Annotation Grouping: ON",this.useGrouping=1,this.annotator.subscribe("colorizeCompleted",this.reloadAnnotations)):(newdiv.innerHTML="Annotation Grouping: OFF",$(newdiv).addClass("buttonOff"),this.useGrouping=0),$($(".annotator-wrapper")[0]).prepend(newdiv),$(newdiv).click(this.groupingButtonPressed);var self=this;$(window).resize(function(){self.reloadAnnotations()})},Grouping.prototype.clearGrouping=function(){$(".groupButton").remove(),$.each(this.unfilteredAnnotations,function(val){void 0!==val.highlights&&$.each(val.highlights,function(high){$(high).css("background-color","inherit")})})},Grouping.prototype.groupAndColor=function(){annotations=this.unfilteredAnnotations,lineAnnDict={};var self=this;annotations.forEach(function(annot){if(void 0!==annot.highlights){var loc=Math.round(self.getPos(annot.highlights[0]).y);return void 0===lineAnnDict[loc]?void(lineAnnDict[loc]=[annot]):void lineAnnDict[loc].push(annot)}}),this.groupedAnnotations=null,this.groupedAnnotations=lineAnnDict;var self=this;$.each(lineAnnDict,function(key,val){val.forEach(val.length>self.groupthreshold?function(anno){void 0!==anno.highlights&&$.each(anno.highlights,function(key,anno){$(anno).css("background-color","inherit")})}:function(anno){void 0!==anno.highlights&&$.each(anno.highlights,function(key,anno){$(anno).css("background-color","rgba(255, 255, 10, .3)")})})})},Grouping.prototype.reloadAnnotations=function(){var annotations=this.annotator.plugins.Store.annotations;if(this.unfilteredAnnotations=annotations,this.clearGrouping(),0!==this.useGrouping){this.groupAndColor();var self=this;$.each(this.groupedAnnotations,function(key,val){if(val.length>self.groupthreshold){var newdiv=document.createElement("div"),className="groupButton";newdiv.setAttribute("class",className),$(newdiv).css("top",""+key+"px"),newdiv.innerHTML=val.length,$(newdiv).attr("data-selected","0"),$(".annotator-wrapper")[0].appendChild(newdiv),$(newdiv).click(function(evt){"0"===$(evt.srcElement).attr("data-selected")?(annotations.forEach(function(annot){void 0!==annot.highlights&&$.each(annot.highlights,function(key,ann){$(ann).css("background-color","inherit")})}),self.groupedAnnotations[$(evt.srcElement).css("top").replace("px","")].forEach(function(item){void 0!==item.highlights&&$.each(item.highlights,function(key,ann){$(ann).css("background-color","rgba(255, 255, 10, 0.3)")})}),$(evt.srcElement).attr("data-selected","1")):(annotations.forEach(function(item){$(item).css("background-color","inherit")}),self.groupAndColor(),$(evt.srcElement).attr("data-selected","0"))})}});var self=this,old=self.unfilteredAnnotations.length;setTimeout(function(){old!==self.unfilteredAnnotations.length&&self.reloadAnnotations()},500)}},Grouping.prototype.groupingButtonPressed=function(){1===this.useGrouping?(this.useGrouping=0,this.clearGrouping(),this.annotator.unsubscribe("annotationsLoaded",this.reloadAnnotations),this.annotator.unsubscribe("annotationUploaded",this.reloadAnnotations),this.annotator.unsubscribe("annotationDeleted",this.reloadAnnotations),this.annotator.unsubscribe("annotationCreated",this.reloadAnnotations),$(".onOffGroupButton").html("Annotation Grouping: OFF"),$(".onOffGroupButton").addClass("buttonOff"),this.annotator.plugins.Store.annotations.forEach(function(annot){void 0!==annot.highlights&&$.each(annot.highlights,function(key,ann){$(ann).css("background-color","")})}),this.annotator.publish("externalCallToHighlightTags"),this.annotator.unsubscribe("colorizeCompleted",this.reloadAnnotations)):(this.useGrouping=1,this.reloadAnnotations(),this.annotator.subscribe("annotationsLoaded",this.reloadAnnotations),this.annotator.subscribe("annotationUploaded",this.reloadAnnotations),this.annotator.subscribe("annotationDeleted",this.reloadAnnotations),this.annotator.subscribe("annotationCreated",this.reloadAnnotations),$(".onOffGroupButton").html("Annotation Grouping: ON"),$(".onOffGroupButton").removeClass("buttonOff"),this.annotator.subscribe("colorizeCompleted",this.reloadAnnotations))},Grouping}(Annotator.Plugin),function($){$.extend($.fn,{watch:function(props,options,callback){var element=document.createElement("div"),isEventSupported=function(eventName,el){eventName="on"+eventName;var supported=eventName in el;return supported||(el.setAttribute(eventName,"return;"),supported="function"==typeof el[eventName]),supported};"function"==typeof options&&(callback=options,options={}),"function"!=typeof callback&&(callback=function(){}),options=$.extend({},{throttle:10},options);var check=function(el){for(var temp,data=el.data(),changed=!1,length="undefined"!=typeof data&&"undefined"!=typeof data.props?data.props.length:0,i=0;length>i;i++)if(temp=el.css(data.props[i]),data.vals[i]!=temp){data.vals[i]=temp,changed=!0;break}changed&&data.cb&&data.cb.call(el,data)};return this.each(function(){var el=$(this),cb=function(){check.call(this,el)},data={props:props.split(","),cb:callback,vals:[]};$.each(data.props,function(i){data.vals[i]=el.css(data.props[i])}),el.data(data),isEventSupported("DOMAttrModified",element)?el.on("DOMAttrModified",callback):isEventSupported("propertychange",element)?el.on("propertychange",callback):setInterval(cb,options.throttle)})}})}(jQuery),window.OpenSeadragon=window.OpenSeadragon||function(options){return new OpenSeadragon.Viewer(options)},function($){var class2type={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},toString=Object.prototype.toString,hasOwn=Object.prototype.hasOwnProperty;if($.isFunction=function(obj){return"function"===$.type(obj)},$.isArray=Array.isArray||function(obj){return"array"===$.type(obj)},$.isWindow=function(obj){return obj&&"object"==typeof obj&&"setInterval"in obj},$.type=function(obj){return null===obj||void 0===obj?String(obj):class2type[toString.call(obj)]||"object"},$.isPlainObject=function(obj){if(!obj||"object"!==OpenSeadragon.type(obj)||obj.nodeType||$.isWindow(obj))return!1;if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return!1;var key;for(key in obj);return void 0===key||hasOwn.call(obj,key)},$.isEmptyObject=function(obj){for(var name in obj)return!1;return!0},window.addEventListener)$._addEvent=function(element,eventName,handler,useCapture){element=$.getElement(element),element.addEventListener(eventName,handler,useCapture)};else{if(!window.attachEvent)throw new Error("No known event model.");$._addEvent=function(element,eventName,handler,useCapture){element=$.getElement(element),element.attachEvent("on"+eventName,handler),useCapture&&element.setCapture&&element.setCapture()}}if(window.removeEventListener)$._removeEvent=function(element,eventName,handler,useCapture){element=$.getElement(element),element.removeEventListener(eventName,handler,useCapture)};else{if(!window.detachEvent)throw new Error("No known event model.");$._removeEvent=function(element,eventName,handler,useCapture){element=$.getElement(element),element.detachEvent("on"+eventName,handler),useCapture&&element.releaseCapture&&element.releaseCapture()}}}(OpenSeadragon),function($){function getOffsetParent(element,isFixed){return isFixed&&element!=document.body?document.body:element.offsetParent}$.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},length=arguments.length,deep=!1,i=1;for("boolean"==typeof target&&(deep=target,target=arguments[1]||{},i=2),"object"==typeof target||OpenSeadragon.isFunction(target)||(target={}),length===i&&(target=this,--i);length>i;i++)if(options=arguments[i],null!==options||void 0!==options)for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(OpenSeadragon.isPlainObject(copy)||(copyIsArray=OpenSeadragon.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&OpenSeadragon.isArray(src)?src:[]):clone=src&&OpenSeadragon.isPlainObject(src)?src:{},target[name]=OpenSeadragon.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},$.extend($,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,springStiffness:7,clickTimeThreshold:300,clickDistThreshold:5,zoomPerClick:2,zoomPerScroll:1.2,zoomPerSecond:1,animationTime:1.2,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,pixelsPerWheelLine:40,showSequenceControl:!0,preserveViewport:!1,showNavigationControl:!0,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorId:null,navigatorHeight:null,navigatorWidth:null,navigatorPosition:null,navigatorSizeRatio:.2,degrees:0,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,onPageChange:null,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,prefixUrl:"${settings.STATIC_URL}js/vendor/ova/images",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},navPrevNextWrap:!1,debugMode:!1,debugGridColor:"#437AB2"},SIGNAL:"----seadragon----",delegate:function(object,method){return function(){var args=arguments;return void 0===args&&(args=[]),method.apply(object,args)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5},getElement:function(element){return"string"==typeof element&&(element=document.getElementById(element)),element},getElementPosition:function(element){var isFixed,offsetParent,result=new $.Point;for(element=$.getElement(element),isFixed="fixed"==$.getElementStyle(element).position,offsetParent=getOffsetParent(element,isFixed);offsetParent;)result.x+=element.offsetLeft,result.y+=element.offsetTop,isFixed&&(result=result.plus($.getPageScroll())),element=offsetParent,isFixed="fixed"==$.getElementStyle(element).position,offsetParent=getOffsetParent(element,isFixed);return result},getElementOffset:function(element){element=$.getElement(element);var docElement,win,doc=element&&element.ownerDocument,boundingRect={top:0,left:0};return doc?(docElement=doc.documentElement,"undefined"!=typeof element.getBoundingClientRect&&(boundingRect=element.getBoundingClientRect()),win=doc==doc.window?doc:9===doc.nodeType?doc.defaultView||doc.parentWindow:!1,new $.Point(boundingRect.left+(win.pageXOffset||docElement.scrollLeft)-(docElement.clientLeft||0),boundingRect.top+(win.pageYOffset||docElement.scrollTop)-(docElement.clientTop||0))):new $.Point},getElementSize:function(element){return element=$.getElement(element),new $.Point(element.clientWidth,element.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(element){return element=$.getElement(element),element.currentStyle}:function(element){return element=$.getElement(element),window.getComputedStyle(element,"")},getEvent:function(event){return $.getEvent=event?function(event){return event}:function(){return window.event},$.getEvent(event)},getMousePosition:function(event){if("number"==typeof event.pageX)$.getMousePosition=function(event){var result=new $.Point;return event=$.getEvent(event),result.x=event.pageX,result.y=event.pageY,result};else{if("number"!=typeof event.clientX)throw new Error("Unknown event mouse position, no known technique.");$.getMousePosition=function(event){var result=new $.Point;return event=$.getEvent(event),result.x=event.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,result.y=event.clientY+document.body.scrollTop+document.documentElement.scrollTop,result}}return $.getMousePosition(event)},getPageScroll:function(){var docElement=document.documentElement||{},body=document.body||{};return $.getPageScroll="number"==typeof window.pageXOffset?function(){return new $.Point(window.pageXOffset,window.pageYOffset)}:body.scrollLeft||body.scrollTop?function(){return new $.Point(document.body.scrollLeft,document.body.scrollTop)}:docElement.scrollLeft||docElement.scrollTop?function(){return new $.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)}:function(){return new $.Point(0,0)},$.getPageScroll()},getWindowSize:function(){var docElement=document.documentElement||{},body=document.body||{};if("number"==typeof window.innerWidth)$.getWindowSize=function(){return new $.Point(window.innerWidth,window.innerHeight)};else if(docElement.clientWidth||docElement.clientHeight)$.getWindowSize=function(){return new $.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else{if(!body.clientWidth&&!body.clientHeight)throw new Error("Unknown window size, no known technique.");$.getWindowSize=function(){return new $.Point(document.body.clientWidth,document.body.clientHeight)}}return $.getWindowSize()},makeCenteredNode:function(element){element=$.getElement(element);var wrappers=[$.makeNeutralElement("div"),$.makeNeutralElement("div"),$.makeNeutralElement("div")];return $.extend(wrappers[0].style,{display:"table",height:"100%",width:"100%"}),$.extend(wrappers[1].style,{display:"table-row"}),$.extend(wrappers[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),wrappers[0].appendChild(wrappers[1]),wrappers[1].appendChild(wrappers[2]),wrappers[2].appendChild(element),wrappers[0]},makeNeutralElement:function(tagName){var element=document.createElement(tagName),style=element.style;return style.background="transparent none",style.border="none",style.margin="0px",style.padding="0px",style.position="static",element},now:function(){return $.now=Date.now?Date.now:function(){return(new Date).getTime()},$.now()},makeTransparentImage:function(src){return $.makeTransparentImage=function(src){var img=$.makeNeutralElement("img");return img.src=src,img},$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<7&&($.makeTransparentImage=function(src){var img=$.makeNeutralElement("img"),element=null;return element=$.makeNeutralElement("span"),element.style.display="inline-block",img.onload=function(){element.style.width=element.style.width||img.width+"px",element.style.height=element.style.height||img.height+"px",img.onload=null,img=null},img.src=src,element.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+src+"', sizingMethod='scale')",element}),$.makeTransparentImage(src)},setElementOpacity:function(element,opacity,usesAlpha){var ieOpacity,ieFilter;element=$.getElement(element),usesAlpha&&!$.Browser.alpha&&(opacity=Math.round(opacity)),$.Browser.opacity?element.style.opacity=1>opacity?opacity:"":1>opacity?(ieOpacity=Math.round(100*opacity),ieFilter="alpha(opacity="+ieOpacity+")",element.style.filter=ieFilter):element.style.filter=""},addClass:function(element,className){element=$.getElement(element),element.className?-1===(" "+element.className+" ").indexOf(" "+className+" ")&&(element.className+=" "+className):element.className=className},removeClass:function(element,className){var oldClasses,i,newClasses=[];for(element=$.getElement(element),oldClasses=element.className.split(/\s+/),i=0;i<oldClasses.length;i++)oldClasses[i]&&oldClasses[i]!==className&&newClasses.push(oldClasses[i]);element.className=newClasses.join(" ")},addEvent:function(element,eventName,handler,useCapture){return $._addEvent(element,eventName,handler,useCapture)},removeEvent:function(element,eventName,handler,useCapture){return $._removeEvent(element,eventName,handler,useCapture)},cancelEvent:function(event){event=$.getEvent(event),$.cancelEvent=event.preventDefault?function(event){event.preventDefault()}:function(event){event=$.getEvent(event),event.cancel=!0,event.returnValue=!1},$.cancelEvent(event)},stopEvent:function(event){event=$.getEvent(event),$.stopEvent=event.stopPropagation?function(event){event.stopPropagation()}:function(event){event=$.getEvent(event),event.cancelBubble=!0},$.stopEvent(event)},createCallback:function(object,method){var i,initialArgs=[];for(i=2;i<arguments.length;i++)initialArgs.push(arguments[i]);return function(){var i,args=initialArgs.concat([]);for(i=0;i<arguments.length;i++)args.push(arguments[i]);return method.apply(object,args)}},getUrlParameter:function(key){var value=URLPARAMS[key];return value?value:null},createAjaxRequest:function(){var request;if(window.XMLHttpRequest)$.createAjaxRequest=function(){return new XMLHttpRequest},request=new XMLHttpRequest;else if(window.ActiveXObject)for(var i=0;i<ACTIVEX.length;i++)try{request=new ActiveXObject(ACTIVEX[i]),$.createAjaxRequest=function(){return new ActiveXObject(ACTIVEX[i])};break}catch(e){continue}if(!request)throw new Error("Browser doesn't support XMLHttpRequest.");return request},makeAjaxRequest:function(url,onSuccess,onError){var request=$.createAjaxRequest();if(!$.isFunction(onSuccess))throw new Error("makeAjaxRequest requires a success callback");request.onreadystatechange=function(){4==request.readyState&&(request.onreadystatechange=function(){},200==request.status?onSuccess(request):($.console.log("AJAX request returned %s: %s",request.status,url),$.isFunction(onError)&&onError(request)))};try{request.open("GET",url,!0),request.send(null)}catch(e){var msg=e.message,oldIE=$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<10;oldIE&&"undefined"!=typeof e.number&&-2147024891==e.number&&(msg+="\nSee http://msdn.microsoft.com/en-us/library/ms537505(v=vs.85).aspx#xdomain"),$.console.log("%s while making AJAX request: %s",e.name,msg),request.onreadystatechange=function(){},$.isFunction(onError)&&onError(request,e)}},jsonp:function(options){var script,url=options.url,head=document.head||document.getElementsByTagName("head")[0]||document.documentElement,jsonpCallback=options.callbackName||"openseadragon"+$.now(),previous=window[jsonpCallback],replace="$1"+jsonpCallback+"$2",callbackParam=options.param||"callback",callback=options.callback;url=url.replace(/(\=)\?(&|$)|\?\?/i,replace),url+=(/\?/.test(url)?"&":"?")+callbackParam+"="+jsonpCallback,window[jsonpCallback]=function(response){if(previous)window[jsonpCallback]=previous;else try{delete window[jsonpCallback]}catch(e){}callback&&$.isFunction(callback)&&callback(response)},script=document.createElement("script"),(void 0!==options.async||!1!==options.async)&&(script.async="async"),options.scriptCharset&&(script.charset=options.scriptCharset),script.src=url,script.onload=script.onreadystatechange=function(_,isAbort){(isAbort||!script.readyState||/loaded|complete/.test(script.readyState))&&(script.onload=script.onreadystatechange=null,head&&script.parentNode&&head.removeChild(script),script=void 0)},head.insertBefore(script,head.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(string){if(window.ActiveXObject)$.parseXml=function(string){var xmlDoc=null;return xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.async=!1,xmlDoc.loadXML(string),xmlDoc};else{if(!window.DOMParser)throw new Error("Browser doesn't support XML DOM.");$.parseXml=function(string){var parser,xmlDoc=null;return parser=new DOMParser,xmlDoc=parser.parseFromString(string,"text/xml")}}return $.parseXml(string)},imageFormatSupported:function(extension){return extension=extension?extension:"",!!FILEFORMATS[extension.toLowerCase()]}}),$.Browser={vendor:$.BROWSERS.UNKNOWN,version:0,alpha:!0};var ACTIVEX=["Msxml2.XMLHTTP","Msxml3.XMLHTTP","Microsoft.XMLHTTP"],FILEFORMATS={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},URLPARAMS={};!function(){var ver=(navigator.appName,navigator.appVersion),ua=navigator.userAgent;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(ua.substring(ua.indexOf("MSIE")+5,ua.indexOf(";",ua.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(ua.indexOf("Firefox")>=0?($.Browser.vendor=$.BROWSERS.FIREFOX,$.Browser.version=parseFloat(ua.substring(ua.indexOf("Firefox")+8))):ua.indexOf("Safari")>=0&&($.Browser.vendor=ua.indexOf("Chrome")>=0?$.BROWSERS.CHROME:$.BROWSERS.SAFARI,$.Browser.version=parseFloat(ua.substring(ua.substring(0,ua.indexOf("Safari")).lastIndexOf("/")+1,ua.indexOf("Safari")))));break;case"Opera":$.Browser.vendor=$.BROWSERS.OPERA,$.Browser.version=parseFloat(ver)}var part,sep,i,query=window.location.search.substring(1),parts=query.split("&");for(i=0;i<parts.length;i++)part=parts[i],sep=part.indexOf("="),sep>0&&(URLPARAMS[part.substring(0,sep)]=decodeURIComponent(part.substring(sep+1)));$.Browser.alpha=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9||$.Browser.vendor==$.BROWSERS.CHROME&&$.Browser.version<2),$.Browser.opacity=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9)}();var nullfunction=function(){};$.console=window.console||{log:nullfunction,debug:nullfunction,info:nullfunction,warn:nullfunction,error:nullfunction},function(w){var requestAnimationFrame=w.requestAnimationFrame||w.mozRequestAnimationFrame||w.webkitRequestAnimationFrame||w.msRequestAnimationFrame,cancelAnimationFrame=w.cancelAnimationFrame||w.mozCancelAnimationFrame||w.webkitCancelAnimationFrame||w.msCancelAnimationFrame;if(requestAnimationFrame&&cancelAnimationFrame)$.requestAnimationFrame=function(){return requestAnimationFrame.apply(w,arguments)},$.cancelAnimationFrame=function(){return cancelAnimationFrame.apply(w,arguments)};else{var iIntervalId,aAnimQueue=[],processing=[],iRequestId=0;$.requestAnimationFrame=function(callback){return aAnimQueue.push([++iRequestId,callback]),iIntervalId||(iIntervalId=setInterval(function(){if(aAnimQueue.length){var time=$.now(),temp=processing;for(processing=aAnimQueue,aAnimQueue=temp;processing.length;)processing.shift()[1](time)}else clearInterval(iIntervalId),iIntervalId=void 0},20)),iRequestId},$.cancelAnimationFrame=function(requestId){var i,j;for(i=0,j=aAnimQueue.length;j>i;i+=1)if(aAnimQueue[i][0]===requestId)return void aAnimQueue.splice(i,1);for(i=0,j=processing.length;j>i;i+=1)if(processing[i][0]===requestId)return void processing.splice(i,1)}}}(window),$._processDZIError=function(errorNode){var messageNode=errorNode.getElementsByTagName("Message")[0],message=messageNode.firstChild.nodeValue;throw new Error(message)}}(OpenSeadragon),function($){var fullScreenApi={supportsFullScreen:!1,isFullScreen:function(){return!1},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",prefix:""},browserPrefixes="webkit moz o ms khtml".split(" ");if("undefined"!=typeof document.cancelFullScreen)fullScreenApi.supportsFullScreen=!0;else for(var i=0,il=browserPrefixes.length;il>i;i++)if(fullScreenApi.prefix=browserPrefixes[i],"undefined"!=typeof document[fullScreenApi.prefix+"CancelFullScreen"]){fullScreenApi.supportsFullScreen=!0;break}fullScreenApi.supportsFullScreen?(fullScreenApi.fullScreenEventName=fullScreenApi.prefix+"fullscreenchange",fullScreenApi.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}},fullScreenApi.requestFullScreen=function(element){return""===this.prefix?element.requestFullScreen():element[this.prefix+"RequestFullScreen"]()},fullScreenApi.cancelFullScreen=function(){return""===this.prefix?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()}):"undefined"!=typeof window.ActiveXObject&&(fullScreenApi.requestFullScreen=function(){var wscript=new ActiveXObject("WScript.Shell");return null!==wscript&&wscript.SendKeys("{F11}"),!1},fullScreenApi.cancelFullScreen=fullScreenApi.requestFullScreen),$.extend($,fullScreenApi)}(OpenSeadragon),function($){$.EventSource=function(){this.events={}},$.EventSource.prototype={addHandler:function(eventName,handler,userData){var events=this.events[eventName];events||(this.events[eventName]=events=[]),handler&&$.isFunction(handler)&&(events[events.length]={handler:handler,userData:userData||null})},removeHandler:function(eventName,handler){var i,events=this.events[eventName],handlers=[];if(events&&$.isArray(events)){for(i=0;i<events.length;i++)events[i].handler!==handler&&handlers.push(events[i]);this.events[eventName]=handlers}},removeAllHandlers:function(eventName){if(eventName)this.events[eventName]=[];else for(var eventType in this.events)this.events[eventType]=[]},getHandler:function(eventName){var events=this.events[eventName];return events&&events.length?(events=1===events.length?[events[0]]:Array.apply(null,events),function(source,args){var i,length=events.length;for(i=0;length>i;i++)events[i]&&(args.eventSource=source,args.userData=events[i].userData,events[i].handler(args))}):null},raiseEvent:function(eventName,eventArgs){var handler=this.getHandler(eventName);handler&&(eventArgs||(eventArgs={}),handler(this,eventArgs))}}}(OpenSeadragon),function($){function startTracking(tracker){var event,i,events=["mouseover","mouseout","mousedown","mouseup","mousemove","click",$.MouseTracker.wheelEventName,"touchstart","touchmove","touchend","keypress","focus","blur"],delegate=THIS[tracker.hash];if("DOMMouseScroll"==$.MouseTracker.wheelEventName&&events.push("MozMousePixelScroll"),!delegate.tracking){for(i=0;i<events.length;i++)event=events[i],$.addEvent(tracker.element,event,delegate[event],!1);delegate.tracking=!0,ACTIVE[tracker.hash]=tracker}}function stopTracking(tracker){var event,i,events=["mouseover","mouseout","mousedown","mouseup","mousemove","click",$.MouseTracker.wheelEventName,"touchstart","touchmove","touchend","keypress","focus","blur"],delegate=THIS[tracker.hash];if("DOMMouseScroll"==$.MouseTracker.wheelEventName&&events.push("MozMousePixelScroll"),delegate.tracking){for(i=0;i<events.length;i++)event=events[i],$.removeEvent(tracker.element,event,delegate[event],!1);releaseMouse(tracker),delegate.tracking=!1,delete ACTIVE[tracker.hash]}}function hasMouse(tracker){return THIS[tracker.hash].insideElement}function captureMouse(tracker){var delegate=THIS[tracker.hash];delegate.capturing||($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9?($.removeEvent(tracker.element,"mouseup",delegate.mouseup,!1),$.addEvent(tracker.element,"mouseup",delegate.mouseupie,!0),$.addEvent(tracker.element,"mousemove",delegate.mousemovecapturedie,!0)):($.addEvent(window,"mouseup",delegate.mouseupcaptured,!0),$.addEvent(window,"mousemove",delegate.mousemovecaptured,!0)),delegate.capturing=!0)}function releaseMouse(tracker){var delegate=THIS[tracker.hash];delegate.capturing&&($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9?($.removeEvent(tracker.element,"mousemove",delegate.mousemovecapturedie,!0),$.removeEvent(tracker.element,"mouseup",delegate.mouseupie,!0),$.addEvent(tracker.element,"mouseup",delegate.mouseup,!1)):($.removeEvent(window,"mousemove",delegate.mousemovecaptured,!0),$.removeEvent(window,"mouseup",delegate.mouseupcaptured,!0)),delegate.capturing=!1)}function triggerOthers(tracker,handler,event,isTouch){var otherHash;for(otherHash in ACTIVE)ACTIVE.hasOwnProperty(otherHash)&&tracker.hash!=otherHash&&handler(ACTIVE[otherHash],event,isTouch)}function onFocus(tracker,event){var propagate;tracker.focusHandler&&(propagate=tracker.focusHandler({eventSource:tracker,originalEvent:event,userData:tracker.userData}),propagate===!1&&$.cancelEvent(event))
}function onBlur(tracker,event){var propagate;tracker.blurHandler&&(propagate=tracker.blurHandler({eventSource:tracker,originalEvent:event,userData:tracker.userData}),propagate===!1&&$.cancelEvent(event))}function onKeyPress(tracker,event){var propagate;tracker.keyHandler&&(propagate=tracker.keyHandler({eventSource:tracker,position:getMouseRelative(event,tracker.element),keyCode:event.keyCode?event.keyCode:event.charCode,shift:event.shiftKey,originalEvent:event,userData:tracker.userData}),propagate||$.cancelEvent(event))}function onMouseOver(tracker,event,isTouch){var propagate,delegate=THIS[tracker.hash];if(isTouch=isTouch||!1,event=$.getEvent(event),!isTouch){$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9&&delegate.capturing&&!isChild(event.srcElement,tracker.element)&&triggerOthers(tracker,onMouseOver,event,isTouch);var to=event.target?event.target:event.srcElement,from=event.relatedTarget?event.relatedTarget:event.fromElement;if(!isChild(tracker.element,to)||isChild(tracker.element,from))return}delegate.insideElement=!0,tracker.enterHandler&&(propagate=tracker.enterHandler({eventSource:tracker,position:getMouseRelative(isTouch?event.changedTouches[0]:event,tracker.element),insideElementPressed:delegate.insideElementPressed,buttonDownAny:IS_BUTTON_DOWN,isTouchEvent:isTouch,originalEvent:event,userData:tracker.userData}),propagate===!1&&$.cancelEvent(event))}function onMouseOut(tracker,event,isTouch){var propagate,delegate=THIS[tracker.hash];if(isTouch=isTouch||!1,event=$.getEvent(event),!isTouch){$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9&&delegate.capturing&&!isChild(event.srcElement,tracker.element)&&triggerOthers(tracker,onMouseOut,event,isTouch);var from=event.target?event.target:event.srcElement,to=event.relatedTarget?event.relatedTarget:event.toElement;if(!isChild(tracker.element,from)||isChild(tracker.element,to))return}delegate.insideElement=!1,tracker.exitHandler&&(propagate=tracker.exitHandler({eventSource:tracker,position:getMouseRelative(isTouch?event.changedTouches[0]:event,tracker.element),insideElementPressed:delegate.insideElementPressed,buttonDownAny:IS_BUTTON_DOWN,isTouchEvent:isTouch,originalEvent:event,userData:tracker.userData}),propagate===!1&&$.cancelEvent(event))}function onMouseDown(tracker,event,noCapture,isTouch){var propagate,delegate=THIS[tracker.hash];isTouch=isTouch||!1,event=$.getEvent(event);var eventOrTouchPoint=isTouch?event.touches[0]:event;2!=event.button&&(delegate.insideElementPressed=!0,delegate.lastPoint=getMouseAbsolute(eventOrTouchPoint),delegate.lastMouseDownPoint=delegate.lastPoint,delegate.lastMouseDownTime=$.now(),tracker.pressHandler&&(propagate=tracker.pressHandler({eventSource:tracker,position:getMouseRelative(eventOrTouchPoint,tracker.element),isTouchEvent:isTouch,originalEvent:event,userData:tracker.userData}),propagate===!1&&$.cancelEvent(event)),(tracker.pressHandler||tracker.dragHandler)&&$.cancelEvent(event),noCapture||(!isTouch&&$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9&&IS_CAPTURING?$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9&&CAPTURING.push(tracker):(captureMouse(tracker),IS_CAPTURING=!0,CAPTURING=[tracker])))}function onTouchStart(tracker,event){var touchA,touchB;1==event.touches.length&&1==event.targetTouches.length&&1==event.changedTouches.length&&(THIS[tracker.hash].lastTouch=event.touches[0],onMouseOver(tracker,event,!0),onMouseDown(tracker,event,!0,!0)),2==event.touches.length&&(touchA=getMouseAbsolute(event.touches[0]),touchB=getMouseAbsolute(event.touches[1]),THIS[tracker.hash].lastPinchDelta=Math.abs(touchA.x-touchB.x)+Math.abs(touchA.y-touchB.y),THIS[tracker.hash].pinchMidpoint=new $.Point((touchA.x+touchB.x)/2,(touchA.y+touchB.y)/2)),event.preventDefault()}function onMouseUp(tracker,event,isTouch){var propagate,delegate=THIS[tracker.hash],insideElementPressed=delegate.insideElementPressed,insideElementReleased=delegate.insideElement;isTouch=isTouch||!1,event=$.getEvent(event),2!=event.button&&(delegate.insideElementPressed=!1,tracker.releaseHandler&&(propagate=tracker.releaseHandler({eventSource:tracker,position:getMouseRelative(isTouch?event.changedTouches[0]:event,tracker.element),insideElementPressed:insideElementPressed,insideElementReleased:insideElementReleased,isTouchEvent:isTouch,originalEvent:event,userData:tracker.userData}),propagate===!1&&$.cancelEvent(event)),insideElementPressed&&insideElementReleased&&handleMouseClick(tracker,event,isTouch))}function onTouchEnd(tracker,event){0===event.touches.length&&0===event.targetTouches.length&&1==event.changedTouches.length&&(THIS[tracker.hash].lastTouch=null,onMouseUpCaptured(tracker,event,!0,!0),onMouseOut(tracker,event,!0)),event.touches.length+event.changedTouches.length==2&&(THIS[tracker.hash].lastPinchDelta=null,THIS[tracker.hash].pinchMidpoint=null),event.preventDefault()}function onMouseUpIE(tracker,event){var othertracker,i;if(event=$.getEvent(event),2!=event.button){for(i=0;i<CAPTURING.length;i++)othertracker=CAPTURING[i],hasMouse(othertracker)||onMouseUp(othertracker,event,!1);releaseMouse(tracker),IS_CAPTURING=!1,event.srcElement.fireEvent("on"+event.type,document.createEventObject(event)),$.stopEvent(event)}}function onMouseUpCaptured(tracker,event,noRelease,isTouch){isTouch=isTouch||!1,(!THIS[tracker.hash].insideElement||isTouch)&&onMouseUp(tracker,event,isTouch),noRelease||releaseMouse(tracker)}function onMouseMove(tracker,event){if(tracker.moveHandler){event=$.getEvent(event);var propagate=tracker.moveHandler({eventSource:tracker,position:getMouseRelative(event,tracker.element),isTouchEvent:!1,originalEvent:event,userData:tracker.userData});propagate===!1&&$.cancelEvent(event)}tracker.stopHandler&&(clearTimeout(tracker.stopTimeOut),tracker.stopTimeOut=setTimeout(function(){onMouseStop(tracker,event)},tracker.stopDelay))}function onMouseStop(tracker,originalMoveEvent){tracker.stopHandler&&tracker.stopHandler({eventSource:tracker,position:getMouseRelative(originalMoveEvent,tracker.element),isTouchEvent:!1,originalEvent:originalMoveEvent,userData:tracker.userData})}function onMouseClick(tracker,event){tracker.clickHandler&&$.cancelEvent(event)}function onWheel(tracker,event){handleWheelEvent(tracker,event,event,!1)}function onMouseWheel(tracker,event){event=event||window.event;var simulatedEvent={target:event.target||event.srcElement,type:"wheel",shiftKey:event.shiftKey||!1,clientX:event.clientX,clientY:event.clientY,pageX:event.pageX?event.pageX:event.clientX,pageY:event.pageY?event.pageY:event.clientY,deltaMode:"MozMousePixelScroll"==event.type?0:1,deltaX:0,deltaZ:0};simulatedEvent.deltaY="mousewheel"==$.MouseTracker.wheelEventName?-1/$.DEFAULT_SETTINGS.pixelsPerWheelLine*event.wheelDelta:event.detail,handleWheelEvent(tracker,simulatedEvent,event,!1)}function handleWheelEvent(tracker,event,originalEvent,isTouch){var propagate,nDelta=0;isTouch=isTouch||!1,nDelta=event.deltaY<0?1:-1,tracker.scrollHandler&&(propagate=tracker.scrollHandler({eventSource:tracker,position:getMouseRelative(event,tracker.element),scroll:nDelta,shift:event.shiftKey,isTouchEvent:isTouch,originalEvent:originalEvent,userData:tracker.userData}),propagate===!1&&$.cancelEvent(originalEvent))}function handleMouseClick(tracker,event,isTouch){var propagate,delegate=THIS[tracker.hash];isTouch=isTouch||!1,event=$.getEvent(event);var eventOrTouchPoint=isTouch?event.changedTouches[0]:event;if(2!=event.button){var time=$.now()-delegate.lastMouseDownTime,point=getMouseAbsolute(eventOrTouchPoint),distance=delegate.lastMouseDownPoint.distanceTo(point),quick=time<=tracker.clickTimeThreshold&&distance<=tracker.clickDistThreshold;tracker.clickHandler&&(propagate=tracker.clickHandler({eventSource:tracker,position:getMouseRelative(eventOrTouchPoint,tracker.element),quick:quick,shift:event.shiftKey,isTouchEvent:isTouch,originalEvent:event,userData:tracker.userData}),propagate===!1&&$.cancelEvent(event))}}function onMouseMoveCaptured(tracker,event,isTouch){var delta,propagate,point,delegate=THIS[tracker.hash];isTouch=isTouch||!1,event=$.getEvent(event);var eventOrTouchPoint=isTouch?event.touches[0]:event;point=getMouseAbsolute(eventOrTouchPoint),delta=point.minus(delegate.lastPoint),delegate.lastPoint=point,tracker.dragHandler&&(propagate=tracker.dragHandler({eventSource:tracker,position:getMouseRelative(eventOrTouchPoint,tracker.element),delta:delta,shift:event.shiftKey,isTouchEvent:isTouch,originalEvent:event,userData:tracker.userData}),propagate===!1&&$.cancelEvent(event))}function onTouchMove(tracker,event){var touchA,touchB,pinchDelta;if(THIS[tracker.hash].lastTouch){if(1===event.touches.length&&1===event.targetTouches.length&&1===event.changedTouches.length&&THIS[tracker.hash].lastTouch.identifier===event.touches[0].identifier)onMouseMoveCaptured(tracker,event,!0);else if(2===event.touches.length&&(touchA=getMouseAbsolute(event.touches[0]),touchB=getMouseAbsolute(event.touches[1]),pinchDelta=Math.abs(touchA.x-touchB.x)+Math.abs(touchA.y-touchB.y),Math.abs(THIS[tracker.hash].lastPinchDelta-pinchDelta)>75)){var simulatedEvent={target:event.target||event.srcElement,type:"wheel",shiftKey:event.shiftKey||!1,clientX:THIS[tracker.hash].pinchMidpoint.x,clientY:THIS[tracker.hash].pinchMidpoint.y,pageX:THIS[tracker.hash].pinchMidpoint.x,pageY:THIS[tracker.hash].pinchMidpoint.y,deltaMode:1,deltaX:0,deltaY:THIS[tracker.hash].lastPinchDelta>pinchDelta?1:-1,deltaZ:0};handleWheelEvent(tracker,simulatedEvent,event,!0),THIS[tracker.hash].lastPinchDelta=pinchDelta}event.preventDefault()}}function onMouseMoveCapturedIE(tracker,event){var i;for(i=0;i<CAPTURING.length;i++)onMouseMoveCaptured(CAPTURING[i],event,!1);$.stopEvent(event)}function getMouseAbsolute(event){return $.getMousePosition(event)}function getMouseRelative(event,element){var mouse=$.getMousePosition(event),offset=$.getElementOffset(element);return mouse.minus(offset)}function isChild(elementA,elementB){for(var body=document.body;elementB&&elementA!=elementB&&body!=elementB;)try{elementB=elementB.parentNode}catch(e){return!1}return elementA==elementB}function onGlobalMouseDown(){IS_BUTTON_DOWN=!0}function onGlobalMouseUp(){IS_BUTTON_DOWN=!1}var IS_BUTTON_DOWN=!1,IS_CAPTURING=!1,ACTIVE={},CAPTURING=[],THIS={};$.MouseTracker=function(options){var args=arguments;$.isPlainObject(options)||(options={element:args[0],clickTimeThreshold:args[1],clickDistThreshold:args[2]}),this.hash=Math.random(),this.element=$.getElement(options.element),this.clickTimeThreshold=options.clickTimeThreshold,this.clickDistThreshold=options.clickDistThreshold,this.userData=options.userData||null,this.stopDelay=options.stopDelay||50,this.enterHandler=options.enterHandler||null,this.exitHandler=options.exitHandler||null,this.pressHandler=options.pressHandler||null,this.releaseHandler=options.releaseHandler||null,this.moveHandler=options.moveHandler||null,this.scrollHandler=options.scrollHandler||null,this.clickHandler=options.clickHandler||null,this.dragHandler=options.dragHandler||null,this.stopHandler=options.stopHandler||null,this.keyHandler=options.keyHandler||null,this.focusHandler=options.focusHandler||null,this.blurHandler=options.blurHandler||null;var _this=this;THIS[this.hash]={mouseover:function(event){onMouseOver(_this,event,!1)},mouseout:function(event){onMouseOut(_this,event,!1)},mousedown:function(event){onMouseDown(_this,event)},mouseup:function(event){onMouseUp(_this,event,!1)},mousemove:function(event){onMouseMove(_this,event)},click:function(event){onMouseClick(_this,event)},wheel:function(event){onWheel(_this,event)},mousewheel:function(event){onMouseWheel(_this,event)},DOMMouseScroll:function(event){onMouseWheel(_this,event)},MozMousePixelScroll:function(event){onMouseWheel(_this,event)},mouseupie:function(event){onMouseUpIE(_this,event)},mousemovecapturedie:function(event){onMouseMoveCapturedIE(_this,event)},mouseupcaptured:function(event){onMouseUpCaptured(_this,event)},mousemovecaptured:function(event){onMouseMoveCaptured(_this,event,!1)},touchstart:function(event){onTouchStart(_this,event)},touchmove:function(event){onTouchMove(_this,event)},touchend:function(event){onTouchEnd(_this,event)},keypress:function(event){onKeyPress(_this,event)},focus:function(event){onFocus(_this,event)},blur:function(event){onBlur(_this,event)},tracking:!1,capturing:!1,insideElementPressed:!1,insideElement:!1,lastPoint:null,lastMouseDownTime:null,lastMouseDownPoint:null,lastPinchDelta:0}},$.MouseTracker.prototype={destroy:function(){stopTracking(this),this.element=null},isTracking:function(){return THIS[this.hash].tracking},setTracking:function(track){return track?startTracking(this):stopTracking(this),this},enterHandler:function(){},exitHandler:function(){},pressHandler:function(){},releaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dragHandler:function(){},stopHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}},$.MouseTracker.wheelEventName=$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",function(){$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9?($.addEvent(document,"mousedown",onGlobalMouseDown,!1),$.addEvent(document,"mouseup",onGlobalMouseUp,!1)):($.addEvent(window,"mousedown",onGlobalMouseDown,!0),$.addEvent(window,"mouseup",onGlobalMouseUp,!0))}()}(OpenSeadragon),function($){$.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4},$.Control=function(element,options,container){var parent=element.parentNode;"number"==typeof options&&($.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),options={anchor:options}),options.attachToViewer="undefined"==typeof options.attachToViewer?!0:options.attachToViewer,this.autoFade="undefined"==typeof options.autoFade?!0:options.autoFade,this.element=element,this.anchor=options.anchor,this.container=container,this.wrapper=$.makeNeutralElement("span"),this.wrapper.style.display="inline-block",this.wrapper.appendChild(this.element),this.anchor==$.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%"),options.attachToViewer?this.anchor==$.ControlAnchor.TOP_RIGHT||this.anchor==$.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):parent.appendChild(this.wrapper)},$.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.container.removeChild(this.wrapper)},isVisible:function(){return"none"!=this.wrapper.style.display},setVisible:function(visible){this.wrapper.style.display=visible?"inline-block":"none"},setOpacity:function(opacity){this.element[$.SIGNAL]&&$.Browser.vendor==$.BROWSERS.IE?$.setElementOpacity(this.element,opacity,!0):$.setElementOpacity(this.wrapper,opacity,!0)}}}(OpenSeadragon),function($){function getControlIndex(dock,element){var i,controls=dock.controls;for(i=controls.length-1;i>=0;i--)if(controls[i].element==element)return i;return-1}$.ControlDock=function(options){var layout,i,layouts=["topleft","topright","bottomright","bottomleft"];for($.extend(!0,this,{id:"controldock-"+$.now()+"-"+Math.floor(1e6*Math.random()),container:$.makeNeutralElement("form"),controls:[]},options),this.container.onsubmit=function(){return!1},this.element&&(this.element=$.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),i=0;i<layouts.length;i++)layout=layouts[i],this.controls[layout]=$.makeNeutralElement("div"),this.controls[layout].style.position="absolute",layout.match("left")&&(this.controls[layout].style.left="0px"),layout.match("right")&&(this.controls[layout].style.right="0px"),layout.match("top")&&(this.controls[layout].style.top="0px"),layout.match("bottom")&&(this.controls[layout].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},$.ControlDock.prototype={addControl:function(element,controlOptions){element=$.getElement(element);var div=null;if(!(getControlIndex(this,element)>=0)){switch(controlOptions.anchor){case $.ControlAnchor.TOP_RIGHT:div=this.controls.topright,element.style.position="relative",element.style.paddingRight="0px",element.style.paddingTop="0px";break;case $.ControlAnchor.BOTTOM_RIGHT:div=this.controls.bottomright,element.style.position="relative",element.style.paddingRight="0px",element.style.paddingBottom="0px";break;case $.ControlAnchor.BOTTOM_LEFT:div=this.controls.bottomleft,element.style.position="relative",element.style.paddingLeft="0px",element.style.paddingBottom="0px";break;case $.ControlAnchor.TOP_LEFT:div=this.controls.topleft,element.style.position="relative",element.style.paddingLeft="0px",element.style.paddingTop="0px";break;default:case $.ControlAnchor.NONE:div=this.container,element.style.margin="0px",element.style.padding="0px"}this.controls.push(new $.Control(element,controlOptions,div)),element.style.display="inline-block"}},removeControl:function(element){element=$.getElement(element);var i=getControlIndex(this,element);return i>=0&&(this.controls[i].destroy(),this.controls.splice(i,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var i;for(i=this.controls.length-1;i>=0;i--)if(this.controls[i].isVisible())return!0;return!1},setControlsEnabled:function(enabled){var i;for(i=this.controls.length-1;i>=0;i--)this.controls[i].setVisible(enabled);return this}}}(OpenSeadragon),function($){function _getSafeElemSize(oElement){return oElement=$.getElement(oElement),new $.Point(0===oElement.clientWidth?1:oElement.clientWidth,0===oElement.clientHeight?1:oElement.clientHeight)}function openTileSource(viewer,source){var overlay,i,_this=viewer;for(_this.source&&_this.close(),_this.canvas.innerHTML="",THIS[_this.hash].prevContainerSize=_getSafeElemSize(_this.container),_this.collectionMode?(_this.source=new $.TileSourceCollection({rows:_this.collectionRows,layout:_this.collectionLayout,tileSize:_this.collectionTileSize,tileSources:_this.tileSources,tileMargin:_this.collectionTileMargin}),_this.viewport=_this.viewport?_this.viewport:new $.Viewport({collectionMode:!0,collectionTileSource:_this.source,containerSize:THIS[_this.hash].prevContainerSize,contentSize:_this.source.dimensions,springStiffness:_this.springStiffness,animationTime:_this.animationTime,showNavigator:!1,minZoomImageRatio:1,maxZoomPixelRatio:1,viewer:_this})):(source&&(_this.source=source),_this.viewport=_this.viewport?_this.viewport:new $.Viewport({containerSize:THIS[_this.hash].prevContainerSize,contentSize:_this.source.dimensions,springStiffness:_this.springStiffness,animationTime:_this.animationTime,minZoomImageRatio:_this.minZoomImageRatio,maxZoomPixelRatio:_this.maxZoomPixelRatio,visibilityRatio:_this.visibilityRatio,wrapHorizontal:_this.wrapHorizontal,wrapVertical:_this.wrapVertical,defaultZoomLevel:_this.defaultZoomLevel,minZoomLevel:_this.minZoomLevel,maxZoomLevel:_this.maxZoomLevel,viewer:_this})),_this.preserveViewport&&_this.viewport.resetContentSize(_this.source.dimensions),_this.source.overlays=_this.source.overlays||[],_this.drawer=new $.Drawer({viewer:_this,source:_this.source,viewport:_this.viewport,element:_this.canvas,overlays:[].concat(_this.overlays).concat(_this.source.overlays),maxImageCacheCount:_this.maxImageCacheCount,imageLoaderLimit:_this.imageLoaderLimit,minZoomImageRatio:_this.minZoomImageRatio,wrapHorizontal:_this.wrapHorizontal,wrapVertical:_this.wrapVertical,immediateRender:_this.immediateRender,blendTime:_this.blendTime,alwaysBlend:_this.alwaysBlend,minPixelRatio:_this.collectionMode?0:_this.minPixelRatio,timeout:_this.timeout,debugMode:_this.debugMode,debugGridColor:_this.debugGridColor}),_this.showNavigator&&!_this.collectionMode&&(_this.navigator?_this.navigator.open(source):_this.navigator=new $.Navigator({id:_this.navigatorId,position:_this.navigatorPosition,sizeRatio:_this.navigatorSizeRatio,height:_this.navigatorHeight,width:_this.navigatorWidth,tileSources:source,tileHost:_this.tileHost,prefixUrl:_this.prefixUrl,overlays:_this.overlays,viewer:_this})),_this.showReferenceStrip&&!_this.referenceStrip&&(_this.referenceStrip=new $.ReferenceStrip({id:_this.referenceStripElement,position:_this.referenceStripPosition,sizeRatio:_this.referenceStripSizeRatio,scroll:_this.referenceStripScroll,height:_this.referenceStripHeight,width:_this.referenceStripWidth,tileSources:_this.tileSources,tileHost:_this.tileHost,prefixUrl:_this.prefixUrl,overlays:_this.overlays,viewer:_this})),THIS[_this.hash].animating=!1,THIS[_this.hash].forceRedraw=!0,_this._updateRequestId=scheduleUpdate(_this,updateMulti),i=0;i<_this.overlayControls.length;i++)overlay=_this.overlayControls[i],overlay.point?_this.drawer.addOverlay(overlay.id,new $.Point(overlay.point.X,overlay.point.Y),$.OverlayPlacement.TOP_LEFT):_this.drawer.addOverlay(overlay.id,new $.Rect(overlay.rect.Point.X,overlay.rect.Point.Y,overlay.rect.Width,overlay.rect.Height),overlay.placement);return VIEWERS[_this.hash]=_this,_this.raiseEvent("open",{source:source}),_this}function scheduleUpdate(viewer,updateFunc){return $.requestAnimationFrame(function(){updateFunc(viewer)})}function scheduleControlsFade(viewer){$.requestAnimationFrame(function(){updateControlsFade(viewer)})}function beginControlsAutoHide(viewer){viewer.autoHideControls&&(viewer.controlsShouldFade=!0,viewer.controlsFadeBeginTime=$.now()+viewer.controlsFadeDelay,window.setTimeout(function(){scheduleControlsFade(viewer)},viewer.controlsFadeDelay))}function updateControlsFade(viewer){var currentTime,deltaTime,opacity,i;if(viewer.controlsShouldFade){for(currentTime=$.now(),deltaTime=currentTime-viewer.controlsFadeBeginTime,opacity=1-deltaTime/viewer.controlsFadeLength,opacity=Math.min(1,opacity),opacity=Math.max(0,opacity),i=viewer.controls.length-1;i>=0;i--)viewer.controls[i].autoFade&&viewer.controls[i].setOpacity(opacity);opacity>0&&scheduleControlsFade(viewer)}}function abortControlsAutoHide(viewer){var i;for(viewer.controlsShouldFade=!1,i=viewer.controls.length-1;i>=0;i--)viewer.controls[i].setOpacity(1)}function onFocus(){abortControlsAutoHide(this)}function onBlur(){beginControlsAutoHide(this)}function onCanvasClick(event){var zoomPerClick,factor;this.viewport&&event.quick&&(zoomPerClick=this.zoomPerClick,factor=event.shift?1/zoomPerClick:zoomPerClick,this.viewport.zoomBy(factor,this.viewport.pointFromPixel(event.position,!0)),this.viewport.applyConstraints()),this.raiseEvent("canvas-click",{tracker:event.eventSource,position:event.position,quick:event.quick,shift:event.shift,originalEvent:event.originalEvent})}function onCanvasDrag(event){this.viewport&&(this.panHorizontal||(event.delta.x=0),this.panVertical||(event.delta.y=0),this.viewport.panBy(this.viewport.deltaPointsFromPixels(event.delta.negate())),this.constrainDuringPan&&this.viewport.applyConstraints()),this.raiseEvent("canvas-drag",{tracker:event.eventSource,position:event.position,delta:event.delta,shift:event.shift,originalEvent:event.originalEvent})}function onCanvasRelease(event){event.insideElementPressed&&this.viewport&&this.viewport.applyConstraints(),this.raiseEvent("canvas-release",{tracker:event.eventSource,position:event.position,insideElementPressed:event.insideElementPressed,insideElementReleased:event.insideElementReleased,originalEvent:event.originalEvent})}function onCanvasScroll(event){var factor;return this.viewport&&(factor=Math.pow(this.zoomPerScroll,event.scroll),this.viewport.zoomBy(factor,this.viewport.pointFromPixel(event.position,!0)),this.viewport.applyConstraints()),this.raiseEvent("canvas-scroll",{tracker:event.eventSource,position:event.position,scroll:event.scroll,shift:event.shift,originalEvent:event.originalEvent}),!1}function onContainerExit(event){event.insideElementPressed||(THIS[this.hash].mouseInside=!1,THIS[this.hash].animating||beginControlsAutoHide(this)),this.raiseEvent("container-exit",{tracker:event.eventSource,position:event.position,insideElementPressed:event.insideElementPressed,buttonDownAny:event.buttonDownAny,originalEvent:event.originalEvent})}function onContainerRelease(event){event.insideElementReleased||(THIS[this.hash].mouseInside=!1,THIS[this.hash].animating||beginControlsAutoHide(this)),this.raiseEvent("container-release",{tracker:event.eventSource,position:event.position,insideElementPressed:event.insideElementPressed,insideElementReleased:event.insideElementReleased,originalEvent:event.originalEvent})}function onContainerEnter(event){THIS[this.hash].mouseInside=!0,abortControlsAutoHide(this),this.raiseEvent("container-enter",{tracker:event.eventSource,position:event.position,insideElementPressed:event.insideElementPressed,buttonDownAny:event.buttonDownAny,originalEvent:event.originalEvent})}function updateMulti(viewer){return viewer.source?(updateOnce(viewer),void(viewer.source&&(viewer._updateRequestId=scheduleUpdate(viewer,updateMulti)))):void(viewer._updateRequestId=null)}function updateOnce(viewer){var containerSize,animated;viewer.source&&(containerSize=_getSafeElemSize(viewer.container),containerSize.equals(THIS[viewer.hash].prevContainerSize)||(viewer.viewport.resize(containerSize,!0),THIS[viewer.hash].prevContainerSize=containerSize),animated=viewer.viewport.update(),viewer.referenceStrip&&(animated=viewer.referenceStrip.update(viewer.viewport)||animated),!THIS[viewer.hash].animating&&animated&&(viewer.raiseEvent("animation-start"),abortControlsAutoHide(viewer)),animated?(viewer.drawer.update(),viewer.navigator&&viewer.navigator.update(viewer.viewport),viewer.raiseEvent("animation")):(THIS[viewer.hash].forceRedraw||viewer.drawer.needsUpdate())&&(viewer.drawer.update(),viewer.navigator&&viewer.navigator.update(viewer.viewport),THIS[viewer.hash].forceRedraw=!1),THIS[viewer.hash].animating&&!animated&&(viewer.raiseEvent("animation-finish"),THIS[viewer.hash].mouseInside||beginControlsAutoHide(viewer)),THIS[viewer.hash].animating=animated)}function resolveUrl(prefix,url){return prefix?prefix+url:url}function beginZoomingIn(){THIS[this.hash].lastZoomTime=$.now(),THIS[this.hash].zoomFactor=this.zoomPerSecond,THIS[this.hash].zooming=!0,scheduleZoom(this)}function beginZoomingOut(){THIS[this.hash].lastZoomTime=$.now(),THIS[this.hash].zoomFactor=1/this.zoomPerSecond,THIS[this.hash].zooming=!0,scheduleZoom(this)}function endZooming(){THIS[this.hash].zooming=!1}function scheduleZoom(viewer){$.requestAnimationFrame($.delegate(viewer,doZoom))}function doZoom(){var currentTime,deltaTime,adjustedFactor;THIS[this.hash].zooming&&this.viewport&&(currentTime=$.now(),deltaTime=currentTime-THIS[this.hash].lastZoomTime,adjustedFactor=Math.pow(THIS[this.hash].zoomFactor,deltaTime/1e3),this.viewport.zoomBy(adjustedFactor),this.viewport.applyConstraints(),THIS[this.hash].lastZoomTime=currentTime,scheduleZoom(this))}function doSingleZoomIn(){this.viewport&&(THIS[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function doSingleZoomOut(){this.viewport&&(THIS[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function lightUp(){this.buttons.emulateEnter(),this.buttons.emulateExit()}function onHome(){this.viewport&&this.viewport.goHome()}function onFullPage(){this.setFullPage(!this.isFullPage()),this.buttons&&this.buttons.emulateExit(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function onPrevious(){var previous=THIS[this.hash].sequence-1;this.navPrevNextWrap&&0>previous&&(previous+=this.tileSources.length),this.goToPage(previous)}function onNext(){var next=THIS[this.hash].sequence+1;this.navPrevNextWrap&&next>=this.tileSources.length&&(next=0),this.goToPage(next)}var THIS={},VIEWERS={};$.Viewer=function(options){var i,args=arguments,_this=this;if($.isPlainObject(options)||(options={id:args[0],xmlPath:args.length>1?args[1]:void 0,prefixUrl:args.length>2?args[2]:void 0,controls:args.length>3?args[3]:void 0,overlays:args.length>4?args[4]:void 0,overlayControls:args.length>5?args[5]:void 0}),options.config&&($.extend(!0,options,options.config),delete options.config),$.extend(!0,this,{id:options.id,hash:options.hash||options.id,element:null,canvas:null,container:null,overlays:[],overlayControls:[],previousBody:[],customControls:[],source:null,drawer:null,drawers:[],viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttons:null,profiler:null},$.DEFAULT_SETTINGS,options),"undefined"==typeof this.hash)throw new Error("A hash must be defined, either by specifying options.id or options.hash.");"undefined"!=typeof THIS[this.hash]&&$.console.warn("Hash "+this.hash+" has already been used."),THIS[this.hash]={fsBoundsDelta:new $.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,sequenced:!1,sequence:0,fullPage:!1,onfullscreenchange:null},this._updateRequestId=null,$.EventSource.call(this),this.addHandler("open-failed",function(event){var msg=$.getString("Errors.OpenFailed",event.eventSource,event.message);_this._showMessage(msg)}),$.ControlDock.call(this,options);var initialTileSource;for(this.xmlPath&&(this.tileSources=[this.xmlPath]),this.tileSources&&($.isArray(this.tileSources)?(this.tileSources.length>1&&(THIS[this.hash].sequenced=!0),this.initialPage>this.tileSources.length-1&&(this.initialPage=this.tileSources.length-1),initialTileSource=this.tileSources[this.initialPage],THIS[this.hash].sequence=this.initialPage):initialTileSource=this.tileSources),this.element=this.element||document.getElementById(this.id),this.canvas=$.makeNeutralElement("div"),this.keyboardCommandArea=$.makeNeutralElement("textarea"),this.canvas.className="openseadragon-canvas",function(style){style.width="100%",style.height="100%",style.overflow="hidden",style.position="absolute",style.top="0px",style.left="0px"}(this.canvas.style),this.container.className="openseadragon-container",function(style){style.width="100%",style.height="100%",style.position="relative",style.overflow="hidden",style.left="0px",style.top="0px",style.textAlign="left"}(this.container.style),this.keyboardCommandArea.className="keyboard-command-area",function(style){style.width="100%",style.height="100%",style.overflow="hidden",style.position="absolute",style.top="0px",style.left="0px",style.resize="none"}(this.keyboardCommandArea.style),this.container.insertBefore(this.canvas,this.container.firstChild),this.container.insertBefore(this.keyboardCommandArea,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.keyboardCommandArea.innerTracker=new $.MouseTracker({_this:this,element:this.keyboardCommandArea,focusHandler:function(){var point=$.getElementPosition(this.element);window.scrollTo(0,point.y)},keyHandler:function(event){switch(event.keyCode){case 61:return _this.viewport.zoomBy(1.1),_this.viewport.applyConstraints(),!1;case 45:return _this.viewport.zoomBy(.9),_this.viewport.applyConstraints(),!1;case 48:return _this.viewport.goHome(),_this.viewport.applyConstraints(),!1;case 119:case 87:case 38:return event.shift?_this.viewport.zoomBy(1.1):_this.viewport.panBy(new $.Point(0,-.05)),_this.viewport.applyConstraints(),!1;case 115:case 83:case 40:return event.shift?_this.viewport.zoomBy(.9):_this.viewport.panBy(new $.Point(0,.05)),_this.viewport.applyConstraints(),!1;case 97:case 37:return _this.viewport.panBy(new $.Point(-.05,0)),_this.viewport.applyConstraints(),!1;
case 100:case 39:return _this.viewport.panBy(new $.Point(.05,0)),_this.viewport.applyConstraints(),!1;default:return!0}}}).setTracking(!0),this.innerTracker=new $.MouseTracker({element:this.canvas,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,clickHandler:$.delegate(this,onCanvasClick),dragHandler:$.delegate(this,onCanvasDrag),releaseHandler:$.delegate(this,onCanvasRelease),scrollHandler:$.delegate(this,onCanvasScroll)}).setTracking(this.mouseNavEnabled?!0:!1),this.outerTracker=new $.MouseTracker({element:this.container,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:$.delegate(this,onContainerEnter),exitHandler:$.delegate(this,onContainerExit),releaseHandler:$.delegate(this,onContainerRelease)}).setTracking(this.mouseNavEnabled?!0:!1),this.toolbar&&(this.toolbar=new $.ControlDock({element:this.toolbar})),this.bindStandardControls(),this.bindSequenceControls(),initialTileSource&&(this.open(initialTileSource),this.tileSources.length>1&&this._updateSequenceButtons(this.initialPage)),i=0;i<this.customControls.length;i++)this.addControl(this.customControls[i].id,{anchor:this.customControls[i].anchor});$.requestAnimationFrame(function(){beginControlsAutoHide(_this)})},$.extend($.Viewer.prototype,$.EventSource.prototype,$.ControlDock.prototype,{isOpen:function(){return!!this.source},openDzi:function(dzi){return this.open(dzi)},openTileSource:function(tileSource){return this.open(tileSource)},open:function(tileSource){var _this=this,customTileSource,readySource,$TileSource,options;return _this._hideMessage(),"string"==$.type(tileSource)&&(tileSource.match(/\s*<.*/)?tileSource=$.parseXml(tileSource):tileSource.match(/\s*[\{\[].*/)&&(tileSource=eval("("+tileSource+")"))),setTimeout(function(){if("string"==$.type(tileSource))tileSource=new $.TileSource(tileSource,function(event){openTileSource(_this,event.tileSource)}),tileSource.addHandler("open-failed",function(event){_this.raiseEvent("open-failed",event)});else if($.isPlainObject(tileSource)||tileSource.nodeType)if($.isFunction(tileSource.getTileUrl))customTileSource=new $.TileSource(tileSource),customTileSource.getTileUrl=tileSource.getTileUrl,openTileSource(_this,customTileSource);else{if($TileSource=$.TileSource.determineType(_this,tileSource),!$TileSource)return void _this.raiseEvent("open-failed",{message:"Unable to load TileSource",source:tileSource});options=$TileSource.prototype.configure.apply(_this,[tileSource]),readySource=new $TileSource(options),openTileSource(_this,readySource)}else openTileSource(_this,tileSource)},1),this},close:function(){return null!==this._updateRequestId&&($.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.navigator&&this.navigator.close(),this.drawer&&this.drawer.clearOverlays(),this.source=null,this.drawer=null,this.viewport=this.preserveViewport?this.viewport:null,this.canvas&&(this.canvas.innerHTML=""),VIEWERS[this.hash]=null,delete VIEWERS[this.hash],this.raiseEvent("close"),this},destroy:function(){if(this.close(),this.removeAllHandlers(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.keyboardCommandArea&&this.keyboardCommandArea.innerTracker.destroy(),this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),this.canvas=null,this.keyboardCommandArea=null,this.container=null,this.element=null},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(enabled){return this.innerTracker.setTracking(enabled),this.raiseEvent("mouse-enabled",{enabled:enabled}),this},areControlsEnabled:function(){var i,enabled=this.controls.length;for(i=0;i<this.controls.length;i++)enabled=enabled&&this.controls[i].isVisibile();return enabled},setControlsEnabled:function(enabled){return enabled?abortControlsAutoHide(this):beginControlsAutoHide(this),this.raiseEvent("controls-enabled",{enabled:enabled}),this},isFullPage:function(){return THIS[this.hash].fullPage},setFullPage:function(fullPage){var oldBounds,newBounds,viewer,hash,nodes,i,body=document.body,bodyStyle=body.style,docStyle=document.documentElement.style,canvasStyle=this.canvas.style,_this=this;if(fullPage!=this.isFullPage()){if(fullPage){for(this.bodyOverflow=bodyStyle.overflow,this.docOverflow=docStyle.overflow,bodyStyle.overflow="hidden",docStyle.overflow="hidden",this.bodyWidth=bodyStyle.width,this.bodyHeight=bodyStyle.height,bodyStyle.width="100%",bodyStyle.height="100%",this.previousBody=[],THIS[this.hash].prevElementParent=this.element.parentNode,THIS[this.hash].prevNextSibling=this.element.nextSibling,THIS[this.hash].prevElementWidth=this.element.style.width,THIS[this.hash].prevElementHeight=this.element.style.height,nodes=body.childNodes.length,i=0;nodes>i;i++)this.previousBody.push(body.childNodes[0]),body.removeChild(body.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,body.appendChild(this.toolbar.element),$.addClass(this.toolbar.element,"fullpage")),$.addClass(this.element,"fullpage"),body.appendChild(this.element),$.supportsFullScreen?(THIS[this.hash].onfullscreenchange=function(){_this.setFullPage($.isFullScreen()?!0:!1)},$.requestFullScreen(document.body),document.addEventListener($.fullScreenEventName,THIS[this.hash].onfullscreenchange),this.element.style.height="100%",this.element.style.width="100%"):(this.element.style.height=$.getWindowSize().y+"px",this.element.style.width=$.getWindowSize().x+"px"),this.toolbar&&this.toolbar.element&&(this.element.style.height=$.getElementSize(this.element).y-$.getElementSize(this.toolbar.element).y+"px"),THIS[this.hash].fullPage=!0,$.delegate(this,onContainerEnter)({})}else{for($.supportsFullScreen&&(document.removeEventListener($.fullScreenEventName,THIS[this.hash].onfullscreenchange),$.cancelFullScreen(document)),bodyStyle.overflow=this.bodyOverflow,docStyle.overflow=this.docOverflow,bodyStyle.width=this.bodyWidth,bodyStyle.height=this.bodyHeight,canvasStyle.backgroundColor="",canvasStyle.color="",body.removeChild(this.element),nodes=this.previousBody.length,i=0;nodes>i;i++)body.appendChild(this.previousBody.shift());$.removeClass(this.element,"fullpage"),THIS[this.hash].prevElementParent.insertBefore(this.element,THIS[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(body.removeChild(this.toolbar.element),$.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=THIS[this.hash].prevElementWidth,this.element.style.height=THIS[this.hash].prevElementHeight,THIS[this.hash].fullPage=!1,$.delegate(this,onContainerExit)({})}if(this.raiseEvent("fullpage",{fullpage:fullPage}),this.viewport){if(oldBounds=this.viewport.getBounds(),this.viewport.resize(THIS[this.hash].prevContainerSize),newBounds=this.viewport.getBounds(),fullPage)THIS[this.hash].fsBoundsDelta=new $.Point(newBounds.width/oldBounds.width,newBounds.height/oldBounds.height);else{this.viewport.update(),this.viewport.zoomBy(Math.max(THIS[this.hash].fsBoundsDelta.x,THIS[this.hash].fsBoundsDelta.y),null,!0);for(hash in VIEWERS)viewer=VIEWERS[hash],viewer!==this&&viewer!=this.navigator&&(viewer.open(viewer.source),viewer.navigator&&viewer.navigator.open(viewer.source))}THIS[this.hash].forceRedraw=!0,updateOnce(this)}return this}},isVisible:function(){return"hidden"!=this.container.style.visibility},setVisible:function(visible){return this.container.style.visibility=visible?"":"hidden",this.raiseEvent("visible",{visible:visible}),this},bindSequenceControls:function(){var onFocusHandler=$.delegate(this,onFocus),onBlurHandler=$.delegate(this,onBlur),onNextHandler=$.delegate(this,onNext),onPreviousHandler=$.delegate(this,onPrevious),navImages=this.navImages,useGroup=!0;return this.showSequenceControl&&THIS[this.hash].sequenced&&((this.previousButton||this.nextButton)&&(useGroup=!1),this.previousButton=new $.Button({element:this.previousButton?$.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:$.getString("Tooltips.PreviousPage"),srcRest:resolveUrl(this.prefixUrl,navImages.previous.REST),srcGroup:resolveUrl(this.prefixUrl,navImages.previous.GROUP),srcHover:resolveUrl(this.prefixUrl,navImages.previous.HOVER),srcDown:resolveUrl(this.prefixUrl,navImages.previous.DOWN),onRelease:onPreviousHandler,onFocus:onFocusHandler,onBlur:onBlurHandler}),this.nextButton=new $.Button({element:this.nextButton?$.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:$.getString("Tooltips.NextPage"),srcRest:resolveUrl(this.prefixUrl,navImages.next.REST),srcGroup:resolveUrl(this.prefixUrl,navImages.next.GROUP),srcHover:resolveUrl(this.prefixUrl,navImages.next.HOVER),srcDown:resolveUrl(this.prefixUrl,navImages.next.DOWN),onRelease:onNextHandler,onFocus:onFocusHandler,onBlur:onBlurHandler}),this.navPrevNextWrap||this.previousButton.disable(),useGroup&&(this.paging=new $.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:$.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:$.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var beginZoomingInHandler=$.delegate(this,beginZoomingIn),endZoomingHandler=$.delegate(this,endZooming),doSingleZoomInHandler=$.delegate(this,doSingleZoomIn),beginZoomingOutHandler=$.delegate(this,beginZoomingOut),doSingleZoomOutHandler=$.delegate(this,doSingleZoomOut),onHomeHandler=$.delegate(this,onHome),onFullPageHandler=$.delegate(this,onFullPage),onFocusHandler=$.delegate(this,onFocus),onBlurHandler=$.delegate(this,onBlur),navImages=this.navImages,buttons=[],useGroup=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton)&&(useGroup=!1),buttons.push(this.zoomInButton=new $.Button({element:this.zoomInButton?$.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:$.getString("Tooltips.ZoomIn"),srcRest:resolveUrl(this.prefixUrl,navImages.zoomIn.REST),srcGroup:resolveUrl(this.prefixUrl,navImages.zoomIn.GROUP),srcHover:resolveUrl(this.prefixUrl,navImages.zoomIn.HOVER),srcDown:resolveUrl(this.prefixUrl,navImages.zoomIn.DOWN),onPress:beginZoomingInHandler,onRelease:endZoomingHandler,onClick:doSingleZoomInHandler,onEnter:beginZoomingInHandler,onExit:endZoomingHandler,onFocus:onFocusHandler,onBlur:onBlurHandler})),buttons.push(this.zoomOutButton=new $.Button({element:this.zoomOutButton?$.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:$.getString("Tooltips.ZoomOut"),srcRest:resolveUrl(this.prefixUrl,navImages.zoomOut.REST),srcGroup:resolveUrl(this.prefixUrl,navImages.zoomOut.GROUP),srcHover:resolveUrl(this.prefixUrl,navImages.zoomOut.HOVER),srcDown:resolveUrl(this.prefixUrl,navImages.zoomOut.DOWN),onPress:beginZoomingOutHandler,onRelease:endZoomingHandler,onClick:doSingleZoomOutHandler,onEnter:beginZoomingOutHandler,onExit:endZoomingHandler,onFocus:onFocusHandler,onBlur:onBlurHandler})),buttons.push(this.homeButton=new $.Button({element:this.homeButton?$.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:$.getString("Tooltips.Home"),srcRest:resolveUrl(this.prefixUrl,navImages.home.REST),srcGroup:resolveUrl(this.prefixUrl,navImages.home.GROUP),srcHover:resolveUrl(this.prefixUrl,navImages.home.HOVER),srcDown:resolveUrl(this.prefixUrl,navImages.home.DOWN),onRelease:onHomeHandler,onFocus:onFocusHandler,onBlur:onBlurHandler})),buttons.push(this.fullPageButton=new $.Button({element:this.fullPageButton?$.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:$.getString("Tooltips.FullPage"),srcRest:resolveUrl(this.prefixUrl,navImages.fullpage.REST),srcGroup:resolveUrl(this.prefixUrl,navImages.fullpage.GROUP),srcHover:resolveUrl(this.prefixUrl,navImages.fullpage.HOVER),srcDown:resolveUrl(this.prefixUrl,navImages.fullpage.DOWN),onRelease:onFullPageHandler,onFocus:onFocusHandler,onBlur:onBlurHandler})),useGroup&&(this.buttons=new $.ButtonGroup({buttons:buttons,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttons.element,this.addHandler("open",$.delegate(this,lightUp)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:$.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:$.ControlAnchor.TOP_LEFT}))),this},currentPage:function(){return THIS[this.hash].sequence},goToPage:function(page){return this.raiseEvent("page",{page:page}),this.tileSources.length>page&&(THIS[this.hash].sequence=page,this._updateSequenceButtons(page),this.open(this.tileSources[page])),$.isFunction(this.onPageChange)&&this.onPageChange({page:page,viewer:this}),this.referenceStrip&&this.referenceStrip.setFocus(page),this},_updateSequenceButtons:function(page){this.nextButton&&(this.tileSources.length-1===page?this.navPrevNextWrap||this.nextButton.disable():this.nextButton.enable()),this.previousButton&&(page>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(message){this._hideMessage();var div=$.makeNeutralElement("div");div.appendChild(document.createTextNode(message)),this.messageDiv=$.makeCenteredNode(div),$.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var div=this.messageDiv;div&&(div.parentNode.removeChild(div),delete this.messageDiv)}})}(OpenSeadragon),function($){function onCanvasClick(event){var newBounds,viewerPosition,dimensions;this.drag?this.drag=!1:this.viewer.viewport&&(viewerPosition=this.viewport.deltaPointsFromPixels(event.position),dimensions=this.viewer.viewport.getBounds().getSize(),newBounds=new $.Rect(viewerPosition.x-dimensions.x/2,viewerPosition.y-dimensions.y/2,dimensions.x,dimensions.y),this.viewer.source.aspectRatio>this.viewer.viewport.getAspectRatio()?newBounds.y=newBounds.y-(this.viewerSizeInPoints.y-1/this.viewer.source.aspectRatio)/2:newBounds.x=newBounds.x-(this.viewerSizeInPoints.x-1)/2,this.viewer.viewport.fitBounds(newBounds),this.viewer.viewport.applyConstraints())}function onCanvasDrag(event){this.viewer.viewport&&(this.drag=!0,this.panHorizontal||(event.delta.x=0),this.panVertical||(event.delta.y=0),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(event.delta)))}function onCanvasRelease(event){event.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}$.Navigator=function(options){var unneededElement,viewer=options.viewer,viewerSize=$.getElementSize(viewer.element);options.id?(this.element=document.getElementById(options.id),options.controlOptions={anchor:$.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(options.id="navigator-"+$.now(),this.element=$.makeNeutralElement("div"),options.controlOptions={anchor:$.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:!0},options.position&&("BOTTOM_RIGHT"==options.position?options.controlOptions.anchor=$.ControlAnchor.BOTTOM_RIGHT:"BOTTOM_LEFT"==options.position?options.controlOptions.anchor=$.ControlAnchor.BOTTOM_LEFT:"TOP_RIGHT"==options.position?options.controlOptions.anchor=$.ControlAnchor.TOP_RIGHT:"TOP_LEFT"==options.position&&(options.controlOptions.anchor=$.ControlAnchor.TOP_LEFT))),this.element.id=options.id,this.element.className+=" navigator",options=$.extend(!0,{sizeRatio:$.DEFAULT_SETTINGS.navigatorSizeRatio},options,{element:this.element,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0}),options.minPixelRatio=this.minPixelRatio=viewer.minPixelRatio,this.viewerSizeInPoints=viewer.viewport.deltaPointsFromPixels(viewerSize),this.borderWidth=2,this.fudge=new $.Point(1,1),this.totalBorderWidths=new $.Point(2*this.borderWidth,2*this.borderWidth).minus(this.fudge),function(style,borderWidth){style.margin="0px",style.border=borderWidth+"px solid #555",style.padding="0px",style.background="#000",style.opacity=.8,style.overflow="hidden"}(this.element.style,this.borderWidth),this.displayRegion=$.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(style,borderWidth){style.position="relative",style.top="0px",style.left="0px",style.fontSize="0px",style.overflow="hidden",style.border=borderWidth+"px solid #900",style.margin="0px",style.padding="0px",style.background="transparent",style["float"]="left",style.cssFloat="left",style.styleFloat="left",style.zIndex=999999999,style.cursor="default"}(this.displayRegion.style,this.borderWidth),this.element.innerTracker=new $.MouseTracker({element:this.element,dragHandler:$.delegate(this,onCanvasDrag),clickHandler:$.delegate(this,onCanvasClick),releaseHandler:$.delegate(this,onCanvasRelease),scrollHandler:function(){return!1}}).setTracking(!0),viewer.addControl(this.element,options.controlOptions),options.width&&options.height?(this.element.style.width=options.width+"px",this.element.style.height=options.height+"px"):(this.element.style.width=viewerSize.x*options.sizeRatio+"px",this.element.style.height=viewerSize.y*options.sizeRatio+"px"),$.Viewer.apply(this,[options]),this.element.getElementsByTagName("form")[0].appendChild(this.displayRegion),unneededElement=this.element.getElementsByTagName("textarea")[0],unneededElement&&unneededElement.parentNode.removeChild(unneededElement)},$.extend($.Navigator.prototype,$.EventSource.prototype,$.Viewer.prototype,{update:function(viewport){var bounds,topleft,bottomright;viewport&&this.viewport&&(bounds=viewport.getBounds(!0),topleft=this.viewport.pixelFromPoint(bounds.getTopLeft()),bottomright=this.viewport.pixelFromPoint(bounds.getBottomRight()).minus(this.totalBorderWidths),function(style){style.top=topleft.y+"px",style.left=topleft.x+"px";var width=Math.abs(topleft.x-bottomright.x),height=Math.abs(topleft.y-bottomright.y);style.width=Math.max(width,0)+"px",style.height=Math.max(height,0)+"px"}(this.displayRegion.style))},open:function(source){var containerSize=this.viewer.viewport.containerSize.times(this.sizeRatio);return this.minPixelRatio=source.tileSize>containerSize.x||source.tileSize>containerSize.y?Math.min(containerSize.x,containerSize.y)/source.tileSize:this.viewer.minPixelRatio,$.Viewer.prototype.open.apply(this,[source])}})}(OpenSeadragon),function($){var I18N={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page"}};$.extend($,{getString:function(prop){var i,props=prop.split("."),string=null,args=arguments,container=I18N;for(i=0;i<props.length-1;i++)container=container[props[i]]||{};return string=container[props[i]],"string"!=typeof string&&($.console.debug("Untranslated source string:",prop),string=""),string.replace(/\{\d+\}/g,function(capture){var i=parseInt(capture.match(/\d+/),10)+1;return i<args.length?args[i]:""})},setString:function(prop,value){var i,props=prop.split("."),container=I18N;for(i=0;i<props.length-1;i++)container[props[i]]||(container[props[i]]={}),container=container[props[i]];container[props[i]]=value}})}(OpenSeadragon),function($){$.Point=function(x,y){this.x="number"==typeof x?x:0,this.y="number"==typeof y?y:0},$.Point.prototype={plus:function(point){return new $.Point(this.x+point.x,this.y+point.y)},minus:function(point){return new $.Point(this.x-point.x,this.y-point.y)},times:function(factor){return new $.Point(this.x*factor,this.y*factor)},divide:function(factor){return new $.Point(this.x/factor,this.y/factor)},negate:function(){return new $.Point(-this.x,-this.y)},distanceTo:function(point){return Math.sqrt(Math.pow(this.x-point.x,2)+Math.pow(this.y-point.y,2))},apply:function(func){return new $.Point(func(this.x),func(this.y))},equals:function(point){return point instanceof $.Point&&this.x===point.x&&this.y===point.y},rotate:function(degrees,pivot){var angle=degrees*Math.PI/180,x=Math.cos(angle)*(this.x-pivot.x)-Math.sin(angle)*(this.y-pivot.y)+pivot.x,y=Math.sin(angle)*(this.x-pivot.x)+Math.cos(angle)*(this.y-pivot.y)+pivot.y;return new $.Point(x,y)},toString:function(){return"("+Math.round(this.x)+","+Math.round(this.y)+")"}}}(OpenSeadragon),function($){function processResponse(xhr){var responseText=xhr.responseText,status=xhr.status,statusText,data;if(!xhr)throw new Error($.getString("Errors.Security"));if(200!==xhr.status&&0!==xhr.status)throw status=xhr.status,statusText=404==status?"Not Found":xhr.statusText,new Error($.getString("Errors.Status",status,statusText));if(responseText.match(/\s*<.*/))try{data=xhr.responseXML&&xhr.responseXML.documentElement?xhr.responseXML:$.parseXml(responseText)}catch(e){data=xhr.responseText}else data=responseText.match(/\s*[\{\[].*/)?eval("("+responseText+")"):responseText;return data}$.TileSource=function(width){var options,i,callback=null,args=arguments;for(options=$.isPlainObject(width)?width:{width:args[0],height:args[1],tileSize:args[2],tileOverlap:args[3],minLevel:args[4],maxLevel:args[5]},$.EventSource.call(this),$.extend(!0,this,options),i=0;i<arguments.length;i++)if($.isFunction(arguments[i])){callback=arguments[i],this.addHandler("ready",function(event){callback(event)});break}"string"==$.type(arguments[0])?(this.aspectRatio=1,this.dimensions=new $.Point(10,10),this.tileSize=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,console.log(arguments[0]),this.getImageInfo(arguments[0])):(this.ready=!0,this.aspectRatio=options.width&&options.height?options.width/options.height:1,this.dimensions=new $.Point(options.width,options.height),this.tileSize=options.tileSize?options.tileSize:0,this.tileOverlap=options.tileOverlap?options.tileOverlap:0,this.minLevel=options.minLevel?options.minLevel:0,this.maxLevel=void 0!==options.maxLevel&&null!==options.maxLevel?options.maxLevel:options.width&&options.height?Math.ceil(Math.log(Math.max(options.width,options.height))/Math.log(2)):0,callback&&$.isFunction(callback)&&callback(this))},$.TileSource.prototype={getLevelScale:function(level){var i,levelScaleCache={};for(i=0;i<=this.maxLevel;i++)levelScaleCache[i]=1/Math.pow(2,this.maxLevel-i);return this.getLevelScale=function(_level){return levelScaleCache[_level]},this.getLevelScale(level)},getNumTiles:function(level){var scale=this.getLevelScale(level),x=Math.ceil(scale*this.dimensions.x/this.tileSize),y=Math.ceil(scale*this.dimensions.y/this.tileSize);return new $.Point(x,y)},getPixelRatio:function(level){var imageSizeScaled=this.dimensions.times(this.getLevelScale(level)),rx=1/imageSizeScaled.x,ry=1/imageSizeScaled.y;return new $.Point(rx,ry)},getClosestLevel:function(rect){var i,tiles,tilesPerSide=Math.floor(Math.max(rect.x,rect.y)/this.tileSize);for(i=this.minLevel;i<this.maxLevel&&(tiles=this.getNumTiles(i),!(Math.max(tiles.x,tiles.y)+1>=tilesPerSide));i++);return Math.max(0,i-1)},getTileAtPoint:function(level,point){var pixel=point.times(this.dimensions.x).times(this.getLevelScale(level)),tx=Math.floor(pixel.x/this.tileSize),ty=Math.floor(pixel.y/this.tileSize);return new $.Point(tx,ty)},getTileBounds:function(level,x,y){var dimensionsScaled=this.dimensions.times(this.getLevelScale(level)),px=0===x?0:this.tileSize*x-this.tileOverlap,py=0===y?0:this.tileSize*y-this.tileOverlap,sx=this.tileSize+(0===x?1:2)*this.tileOverlap,sy=this.tileSize+(0===y?1:2)*this.tileOverlap,scale=1/dimensionsScaled.x;return sx=Math.min(sx,dimensionsScaled.x-px),sy=Math.min(sy,dimensionsScaled.y-py),new $.Rect(px*scale,py*scale,sx*scale,sy*scale)},getImageInfo:function(url){var callbackName,callback,readySource,options,urlParts,filename,lastDot,_this=this;url&&(urlParts=url.split("/"),filename=urlParts[urlParts.length-1],lastDot=filename.lastIndexOf("."),lastDot>-1&&(urlParts[urlParts.length-1]=filename.slice(0,lastDot))),callback=function(data){"string"==typeof data&&(data=$.parseXml(data));var $TileSource=$.TileSource.determineType(_this,data,url);return $TileSource?(options=$TileSource.prototype.configure.apply(_this,[data,url]),readySource=new $TileSource(options),_this.ready=!0,void _this.raiseEvent("ready",{tileSource:readySource})):void _this.raiseEvent("open-failed",{message:"Unable to load TileSource",source:url})},url.match(/\.js$/)?(callbackName=url.split("/").pop().replace(".js",""),$.jsonp({url:url,async:!1,callbackName:callbackName,callback:callback})):$.makeAjaxRequest(url,function(xhr){var data=processResponse(xhr);callback(data)},function(xhr,exc){var msg;try{msg="HTTP "+xhr.status+" attempting to load TileSource"}catch(e){var formattedExc;formattedExc="undefined"!=typeof exc&&exc.toString?exc.toString():"Unknown error",msg=formattedExc+" attempting to load TileSource"}_this.raiseEvent("open-failed",{message:msg,source:url})})},supports:function(){return!1},configure:function(){throw new Error("Method not implemented.")},getTileUrl:function(){throw new Error("Method not implemented.")},tileExists:function(level,x,y){var numTiles=this.getNumTiles(level);return level>=this.minLevel&&level<=this.maxLevel&&x>=0&&y>=0&&x<numTiles.x&&y<numTiles.y}},$.extend(!0,$.TileSource.prototype,$.EventSource.prototype),$.TileSource.determineType=function(tileSource,data,url){var property;for(property in OpenSeadragon)if(property.match(/.+TileSource$/)&&$.isFunction(OpenSeadragon[property])&&$.isFunction(OpenSeadragon[property].prototype.supports)&&OpenSeadragon[property].prototype.supports.call(tileSource,data,url))return OpenSeadragon[property];$.console.error("No TileSource was able to open %s %s",url,data)}}(OpenSeadragon),function($){function configureFromXML(tileSource,xmlDoc){if(!xmlDoc||!xmlDoc.documentElement)throw new Error($.getString("Errors.Xml"));var dispRectNodes,dispRectNode,rectNode,sizeNode,i,root=xmlDoc.documentElement,rootName=root.tagName,configuration=null,displayRects=[];if("Image"==rootName)try{if(sizeNode=root.getElementsByTagName("Size")[0],configuration={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:root.getAttribute("Url"),Format:root.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(root.getAttribute("Overlap"),10),TileSize:parseInt(root.getAttribute("TileSize"),10),Size:{Height:parseInt(sizeNode.getAttribute("Height"),10),Width:parseInt(sizeNode.getAttribute("Width"),10)}}},!$.imageFormatSupported(configuration.Image.Format))throw new Error($.getString("Errors.ImageFormat",configuration.Image.Format.toUpperCase()));for(dispRectNodes=root.getElementsByTagName("DisplayRect"),i=0;i<dispRectNodes.length;i++)dispRectNode=dispRectNodes[i],rectNode=dispRectNode.getElementsByTagName("Rect")[0],displayRects.push({Rect:{X:parseInt(rectNode.getAttribute("X"),10),Y:parseInt(rectNode.getAttribute("Y"),10),Width:parseInt(rectNode.getAttribute("Width"),10),Height:parseInt(rectNode.getAttribute("Height"),10),MinLevel:parseInt(dispRectNode.getAttribute("MinLevel"),10),MaxLevel:parseInt(dispRectNode.getAttribute("MaxLevel"),10)}});return displayRects.length&&(configuration.Image.DisplayRect=displayRects),configureFromObject(tileSource,configuration)}catch(e){throw e instanceof Error?e:new Error($.getString("Errors.Dzi"))}else{if("Collection"==rootName)throw new Error($.getString("Errors.Dzc"));if("Error"==rootName)return $._processDZIError(root)}throw new Error($.getString("Errors.Dzi"))}function configureFromObject(tileSource,configuration){var rectData,i,imageData=configuration.Image,tilesUrl=imageData.Url,fileFormat=imageData.Format,sizeData=imageData.Size,dispRectData=imageData.DisplayRect||[],width=parseInt(sizeData.Width,10),height=parseInt(sizeData.Height,10),tileSize=parseInt(imageData.TileSize,10),tileOverlap=parseInt(imageData.Overlap,10),displayRects=[];for(i=0;i<dispRectData.length;i++)rectData=dispRectData[i].Rect,displayRects.push(new $.DisplayRect(parseInt(rectData.X,10),parseInt(rectData.Y,10),parseInt(rectData.Width,10),parseInt(rectData.Height,10),parseInt(rectData.MinLevel,10),parseInt(rectData.MaxLevel,10)));return $.extend(!0,{width:width,height:height,tileSize:tileSize,tileOverlap:tileOverlap,minLevel:null,maxLevel:null,tilesUrl:tilesUrl,fileFormat:fileFormat,displayRects:displayRects},configuration)}$.DziTileSource=function(width){var i,rect,level,options;if(options=$.isPlainObject(width)?width:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=options.tilesUrl,this.fileFormat=options.fileFormat,this.displayRects=options.displayRects,this.displayRects)for(i=this.displayRects.length-1;i>=0;i--)for(rect=this.displayRects[i],level=rect.minLevel;level<=rect.maxLevel;level++)this._levelRects[level]||(this._levelRects[level]=[]),this._levelRects[level].push(rect);$.TileSource.apply(this,[options])},$.extend($.DziTileSource.prototype,$.TileSource.prototype,{supports:function(data){var ns;return data.Image?ns=data.Image.xmlns:data.documentElement&&"Image"==data.documentElement.tagName&&(ns=data.documentElement.namespaceURI),"http://schemas.microsoft.com/deepzoom/2008"==ns||"http://schemas.microsoft.com/deepzoom/2009"==ns},configure:function(data,url){var options;return options=$.isPlainObject(data)?configureFromObject(this,data):configureFromXML(this,data),url&&!options.tilesUrl&&(options.tilesUrl=url.replace(/([^\/]+)\.(dzi|xml|js)$/,"$1_files/")),options},getTileUrl:function(level,x,y){return[this.tilesUrl,level,"/",x,"_",y,".",this.fileFormat].join("")},tileExists:function(level,x,y){var rect,scale,xMin,yMin,xMax,yMax,i,rects=this._levelRects[level];if(!rects||!rects.length)return!0;for(i=rects.length-1;i>=0;i--)if(rect=rects[i],!(level<rect.minLevel||level>rect.maxLevel)&&(scale=this.getLevelScale(level),xMin=rect.x*scale,yMin=rect.y*scale,xMax=xMin+rect.width*scale,yMax=yMin+rect.height*scale,xMin=Math.floor(xMin/this.tileSize),yMin=Math.floor(yMin/this.tileSize),xMax=Math.ceil(xMax/this.tileSize),yMax=Math.ceil(yMax/this.tileSize),x>=xMin&&xMax>x&&y>=yMin&&yMax>y))return!0;return!1}})}(OpenSeadragon),function($){function configureFromXml(tileSource,xmlDoc){if(!xmlDoc||!xmlDoc.documentElement)throw new Error($.getString("Errors.Xml"));var root=xmlDoc.documentElement,rootName=root.tagName,configuration=null;if("info"==rootName)try{return configuration={ns:root.namespaceURI},parseXML(root,configuration),configureFromObject(tileSource,configuration)}catch(e){throw e instanceof Error?e:new Error($.getString("Errors.IIIF"))}throw new Error($.getString("Errors.IIIF"))}function parseXML(node,configuration,property){var i,value;if(3==node.nodeType&&property)value=node.nodeValue.trim(),value.match(/^\d*$/)&&(value=Number(value)),configuration[property]?($.isArray(configuration[property])||(configuration[property]=[configuration[property]]),configuration[property].push(value)):configuration[property]=value;else if(1==node.nodeType)for(i=0;i<node.childNodes.length;i++)parseXML(node.childNodes[i],configuration,node.nodeName)}function configureFromObject(tileSource,configuration){return configuration.image_host&&(configuration.tilesUrl=configuration.image_host),configuration
}$.IIIFTileSource=function(options){if($.extend(!0,this,options),!(this.height&&this.width&&this.identifier&&this.tilesUrl))throw new Error("IIIF required parameters not provided.");if(options.tileSize=this.tile_width,!options.maxLevel){var mf=-1,scfs=this.scale_factors||this.scale_factor;if(scfs instanceof Array)for(var i=0;i<scfs.length;i++){var cf=Number(scfs[i]);!isNaN(cf)&&cf>mf&&(mf=cf)}options.maxLevel=0>mf?Number(Math.ceil(Math.log(Math.max(this.width,this.height),2))):mf}$.TileSource.apply(this,[options])},$.extend($.IIIFTileSource.prototype,$.TileSource.prototype,{supports:function(data){return data.ns&&"http://library.stanford.edu/iiif/image-api/ns/"==data.ns||data.profile&&("http://library.stanford.edu/iiif/image-api/compliance.html#level1"==data.profile||"http://library.stanford.edu/iiif/image-api/compliance.html#level2"==data.profile||"http://library.stanford.edu/iiif/image-api/compliance.html#level3"==data.profile||"http://library.stanford.edu/iiif/image-api/compliance.html"==data.profile)||data.documentElement&&"info"==data.documentElement.tagName&&"http://library.stanford.edu/iiif/image-api/ns/"==data.documentElement.namespaceURI},configure:function(data,url){var service,options,host;return options=$.isPlainObject(data)?configureFromObject(this,data):configureFromXml(this,data),url&&!options.tilesUrl&&(service=url.split("/"),service.pop(),service=service.join("/"),"http"!==url.substring(0,4)&&(host=location.protocol+"//"+location.host,service=host+service),options.tilesUrl=service.replace(data.identifier,"")),options},getTileUrl:function(level,x,y){var iiif_region,iiif_tile_x,iiif_tile_y,iiif_tile_w,iiif_tile_h,iiif_size,IIIF_ROTATION="0",IIIF_QUALITY="native.jpg",scale=Math.pow(.5,this.maxLevel-level),level_width=Math.ceil(this.width*scale),level_height=Math.ceil(this.height*scale),iiif_tile_size_width=Math.ceil(this.tileSize/scale),iiif_tile_size_height=Math.ceil(this.tileSize/scale);return level_width<this.tile_width&&level_height<this.tile_height?(iiif_size=level_width+",",iiif_region="full"):(iiif_tile_x=x*iiif_tile_size_width,iiif_tile_y=y*iiif_tile_size_height,iiif_tile_w=Math.min(iiif_tile_size_width,this.width-iiif_tile_x),iiif_tile_h=Math.min(iiif_tile_size_height,this.height-iiif_tile_y),iiif_size=Math.ceil(iiif_tile_w*scale)+",",iiif_region=[iiif_tile_x,iiif_tile_y,iiif_tile_w,iiif_tile_h].join(",")),[this.tilesUrl,this.identifier,iiif_region,iiif_size,IIIF_ROTATION,IIIF_QUALITY].join("/")}})}(OpenSeadragon),function($){$.IIIF1_1TileSource=function(options){if($.extend(!0,this,options),!(this.height&&this.width&&this["@id"]))throw new Error("IIIF required parameters not provided.");if(options.tileSize=this.tile_width,!options.maxLevel){var mf=-1,scfs=this.scale_factors||this.scale_factor;if(scfs instanceof Array)for(var i=0;i<scfs.length;i++){var cf=Number(scfs[i]);!isNaN(cf)&&cf>mf&&(mf=cf)}options.maxLevel=0>mf?Number(Math.ceil(Math.log(Math.max(this.width,this.height),2))):mf}$.TileSource.apply(this,[options])},$.extend($.IIIF1_1TileSource.prototype,$.TileSource.prototype,{supports:function(data){return data.profile&&("http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0"==data.profile||"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1"==data.profile||"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2"==data.profile||"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level3"==data.profile||"http://library.stanford.edu/iiif/image-api/1.1/compliance.html"==data.profile)},configure:function(data){return data},getTileUrl:function(level,x,y){var iiif_region,iiif_tile_x,iiif_tile_y,iiif_tile_w,iiif_tile_h,iiif_size,uri,IIIF_ROTATION="0",IIIF_QUALITY="native.jpg",scale=Math.pow(.5,this.maxLevel-level),level_width=Math.ceil(this.width*scale),level_height=Math.ceil(this.height*scale),iiif_tile_size_width=Math.ceil(this.tileSize/scale),iiif_tile_size_height=Math.ceil(this.tileSize/scale);return level_width<this.tile_width&&level_height<this.tile_height?(iiif_size=level_width+",",iiif_region="full"):(iiif_tile_x=x*iiif_tile_size_width,iiif_tile_y=y*iiif_tile_size_height,iiif_tile_w=Math.min(iiif_tile_size_width,this.width-iiif_tile_x),iiif_tile_h=Math.min(iiif_tile_size_height,this.height-iiif_tile_y),iiif_size=Math.ceil(iiif_tile_w*scale)+",",iiif_region=[iiif_tile_x,iiif_tile_y,iiif_tile_w,iiif_tile_h].join(",")),uri=[this["@id"],iiif_region,iiif_size,IIIF_ROTATION,IIIF_QUALITY].join("/")}})}(OpenSeadragon),function($){$.OsmTileSource=function(width){var options;options=$.isPlainObject(width)?width:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]},options.width&&options.height||(options.width=65572864,options.height=65572864),options.tileSize||(options.tileSize=256,options.tileOverlap=0),options.tilesUrl||(options.tilesUrl="http://tile.openstreetmap.org/"),options.minLevel=8,$.TileSource.apply(this,[options])},$.extend($.OsmTileSource.prototype,$.TileSource.prototype,{supports:function(data){return data.type&&"openstreetmaps"==data.type},configure:function(data){return data},getTileUrl:function(level,x,y){return this.tilesUrl+(level-8)+"/"+x+"/"+y+".png"}})}(OpenSeadragon),function($){$.TmsTileSource=function(width){var options;options=$.isPlainObject(width)?width:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var max,bufferedWidth=256*Math.ceil(options.width/256),bufferedHeight=256*Math.ceil(options.height/256);max=bufferedWidth>bufferedHeight?bufferedWidth/256:bufferedHeight/256,options.maxLevel=Math.ceil(Math.log(max)/Math.log(2))-1,options.tileSize=256,options.width=bufferedWidth,options.height=bufferedHeight,$.TileSource.apply(this,[options])},$.extend($.TmsTileSource.prototype,$.TileSource.prototype,{supports:function(data){return data.type&&"tiledmapservice"==data.type},configure:function(data){return data},getTileUrl:function(level,x,y){var yTiles=this.getNumTiles(level).y-1;return this.tilesUrl+level+"/"+x+"/"+(yTiles-y)+".png"}})}(OpenSeadragon),function($){function filterFiles(files){var file,i,filtered=[];for(i=0;i<files.length;i++)file=files[i],file.height&&file.width&&file.url&&(file.url.toLowerCase().match(/^.*\.(png|jpg|jpeg|gif)$/)||file.mimetype&&file.mimetype.toLowerCase().match(/^.*\/(png|jpg|jpeg|gif)$/))?filtered.push({url:file.url,width:Number(file.width),height:Number(file.height)}):$.console.error("Unsupported image format: %s",file.url?file.url:"<no URL>");return filtered.sort(function(a,b){return a.height-b.height})}function configureFromXML(tileSource,xmlDoc){if(!xmlDoc||!xmlDoc.documentElement)throw new Error($.getString("Errors.Xml"));var level,i,root=xmlDoc.documentElement,rootName=root.tagName,conf=null,levels=[];if("image"==rootName)try{for(conf={type:root.getAttribute("type"),levels:[]},levels=root.getElementsByTagName("level"),i=0;i<levels.length;i++)level=levels[i],conf.levels.push({url:level.getAttribute("url"),width:parseInt(level.getAttribute("width"),10),height:parseInt(level.getAttribute("height"),10)});return configureFromObject(tileSource,conf)}catch(e){throw e instanceof Error?e:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if("collection"==rootName)throw new Error("Legacy Image Pyramid Collections not yet supported.");if("error"==rootName)throw new Error("Error: "+xmlDoc)}throw new Error("Unknown element "+rootName)}function configureFromObject(tileSource,configuration){return configuration.levels}$.LegacyTileSource=function(levels){var options,width,height;$.isArray(levels)&&(options={type:"legacy-image-pyramid",levels:levels}),options.levels=filterFiles(options.levels),options.levels.length>0?(width=options.levels[options.levels.length-1].width,height=options.levels[options.levels.length-1].height):(width=0,height=0,$.console.error("No supported image formats found")),$.extend(!0,options,{width:width,height:height,tileSize:Math.max(height,width),tileOverlap:0,minLevel:0,maxLevel:options.levels.length>0?options.levels.length-1:0}),$.TileSource.apply(this,[options]),this.levels=options.levels},$.extend($.LegacyTileSource.prototype,$.TileSource.prototype,{supports:function(data){return data.type&&"legacy-image-pyramid"==data.type||data.documentElement&&"legacy-image-pyramid"==data.documentElement.getAttribute("type")},configure:function(configuration){var options;return options=$.isPlainObject(configuration)?configureFromObject(this,configuration):configureFromXML(this,configuration)},getLevelScale:function(level){var levelScale=0/0;return this.levels.length>0&&level>=this.minLevel&&level<=this.maxLevel&&(levelScale=this.levels[level].width/this.levels[this.maxLevel].width),levelScale},getNumTiles:function(level){var scale=this.getLevelScale(level);return scale?new $.Point(1,1):new $.Point(0,0)},getTileAtPoint:function(){return new $.Point(0,0)},getTileUrl:function(level){var url=null;return this.levels.length>0&&level>=this.minLevel&&level<=this.maxLevel&&(url=this.levels[level].url),url}})}(OpenSeadragon),function($){$.TileSourceCollection=function(tileSize){var options;options=$.isPlainObject(tileSize)?tileSize:{tileSize:arguments[0],tileSources:arguments[1],rows:arguments[2],layout:arguments[3]},options.layout||(options.layout="horizontal");var minLevel=0,levelSize=1,tilesPerRow=Math.ceil(options.tileSources.length/options.rows),longSide=tilesPerRow>=options.rows?tilesPerRow:options.rows;for("horizontal"==options.layout?(options.width=options.tileSize*tilesPerRow,options.height=options.tileSize*options.rows):(options.height=options.tileSize*tilesPerRow,options.width=options.tileSize*options.rows),options.tileOverlap=-options.tileMargin,options.tilesPerRow=tilesPerRow;levelSize<options.tileSize*longSide;)levelSize=2*levelSize,minLevel++;options.minLevel=minLevel,$.TileSource.apply(this,[options])},$.extend($.TileSourceCollection.prototype,$.TileSource.prototype,{getTileBounds:function(level,x,y){var dimensionsScaled=this.dimensions.times(this.getLevelScale(level)),px=this.tileSize*x-this.tileOverlap,py=this.tileSize*y-this.tileOverlap,sx=this.tileSize+1*this.tileOverlap,sy=this.tileSize+1*this.tileOverlap,scale=1/dimensionsScaled.x;return sx=Math.min(sx,dimensionsScaled.x-px),sy=Math.min(sy,dimensionsScaled.y-py),new $.Rect(px*scale,py*scale,sx*scale,sy*scale)},configure:function(){},getTileUrl:function(){return null}})}(OpenSeadragon),function($){function scheduleFade(button){$.requestAnimationFrame(function(){updateFade(button)})}function updateFade(button){var currentTime,deltaTime,opacity;button.shouldFade&&(currentTime=$.now(),deltaTime=currentTime-button.fadeBeginTime,opacity=1-deltaTime/button.fadeLength,opacity=Math.min(1,opacity),opacity=Math.max(0,opacity),button.imgGroup&&$.setElementOpacity(button.imgGroup,opacity,!0),opacity>0&&scheduleFade(button))}function beginFading(button){button.shouldFade=!0,button.fadeBeginTime=$.now()+button.fadeDelay,window.setTimeout(function(){scheduleFade(button)},button.fadeDelay)}function stopFading(button){button.shouldFade=!1,button.imgGroup&&$.setElementOpacity(button.imgGroup,1,!0)}function inTo(button,newState){button.element.disabled||(newState>=$.ButtonState.GROUP&&button.currentState==$.ButtonState.REST&&(stopFading(button),button.currentState=$.ButtonState.GROUP),newState>=$.ButtonState.HOVER&&button.currentState==$.ButtonState.GROUP&&(button.imgHover&&(button.imgHover.style.visibility=""),button.currentState=$.ButtonState.HOVER),newState>=$.ButtonState.DOWN&&button.currentState==$.ButtonState.HOVER&&(button.imgDown&&(button.imgDown.style.visibility=""),button.currentState=$.ButtonState.DOWN))}function outTo(button,newState){button.element.disabled||(newState<=$.ButtonState.HOVER&&button.currentState==$.ButtonState.DOWN&&(button.imgDown&&(button.imgDown.style.visibility="hidden"),button.currentState=$.ButtonState.HOVER),newState<=$.ButtonState.GROUP&&button.currentState==$.ButtonState.HOVER&&(button.imgHover&&(button.imgHover.style.visibility="hidden"),button.currentState=$.ButtonState.GROUP),newState<=$.ButtonState.REST&&button.currentState==$.ButtonState.GROUP&&(beginFading(button),button.currentState=$.ButtonState.REST))}$.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},$.Button=function(options){var _this=this;$.EventSource.call(this),$.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:$.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:$.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null},options),this.element=options.element||$.makeNeutralElement("button"),this.element.href=this.element.href||"#",options.element||(this.imgRest=$.makeTransparentImage(this.srcRest),this.imgGroup=$.makeTransparentImage(this.srcGroup),this.imgHover=$.makeTransparentImage(this.srcHover),this.imgDown=$.makeTransparentImage(this.srcDown),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",$.Browser.vendor==$.BROWSERS.FIREFOX&&$.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="")),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=$.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new $.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(event){event.insideElementPressed?(inTo(_this,$.ButtonState.DOWN),_this.raiseEvent("enter",{originalEvent:event.originalEvent})):event.buttonDownAny||inTo(_this,$.ButtonState.HOVER)},focusHandler:function(event){this.enterHandler(event),_this.raiseEvent("focus",{originalEvent:event.originalEvent})},exitHandler:function(event){outTo(_this,$.ButtonState.GROUP),event.insideElementPressed&&_this.raiseEvent("exit",{originalEvent:event.originalEvent})},blurHandler:function(event){this.exitHandler(event),_this.raiseEvent("blur",{originalEvent:event.originalEvent})},pressHandler:function(event){inTo(_this,$.ButtonState.DOWN),_this.raiseEvent("press",{originalEvent:event.originalEvent})},releaseHandler:function(event){event.insideElementPressed&&event.insideElementReleased?(outTo(_this,$.ButtonState.HOVER),_this.raiseEvent("release",{originalEvent:event.originalEvent})):event.insideElementPressed?outTo(_this,$.ButtonState.GROUP):inTo(_this,$.ButtonState.HOVER)},clickHandler:function(event){event.quick&&_this.raiseEvent("click",{originalEvent:event.originalEvent})},keyHandler:function(event){return 13===event.keyCode?(_this.raiseEvent("click",{originalEvent:event.originalEvent}),_this.raiseEvent("release",{originalEvent:event.originalEvent}),!1):!0}}).setTracking(!0),outTo(this,$.ButtonState.REST)},$.extend($.Button.prototype,$.EventSource.prototype,{notifyGroupEnter:function(){inTo(this,$.ButtonState.GROUP)},notifyGroupExit:function(){outTo(this,$.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,$.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,$.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()}})}(OpenSeadragon),function($){$.ButtonGroup=function(options){$.extend(!0,this,{buttons:[],clickTimeThreshold:$.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:$.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},options);var i,buttons=this.buttons.concat([]),_this=this;if(this.element=options.element||$.makeNeutralElement("fieldgroup"),!options.group)for(this.label=$.makeNeutralElement("label"),this.element.style.display="inline-block",this.element.appendChild(this.label),i=0;i<buttons.length;i++)this.element.appendChild(buttons[i].element);this.tracker=new $.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(){var i;for(i=0;i<_this.buttons.length;i++)_this.buttons[i].notifyGroupEnter()},exitHandler:function(event){var i;if(!event.insideElementPressed)for(i=0;i<_this.buttons.length;i++)_this.buttons[i].notifyGroupExit()},releaseHandler:function(event){var i;if(!event.insideElementReleased)for(i=0;i<_this.buttons.length;i++)_this.buttons[i].notifyGroupExit()}}).setTracking(!0)},$.ButtonGroup.prototype={emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateExit:function(){this.tracker.exitHandler({eventSource:this.tracker})}}}(OpenSeadragon),function($){$.Rect=function(x,y,width,height){this.x="number"==typeof x?x:0,this.y="number"==typeof y?y:0,this.width="number"==typeof width?width:0,this.height="number"==typeof height?height:0},$.Rect.prototype={getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new $.Point(this.x,this.y)},getBottomRight:function(){return new $.Point(this.x+this.width,this.y+this.height)},getTopRight:function(){return new $.Point(this.x+this.width,this.y)},getBottomLeft:function(){return new $.Point(this.x,this.y+this.height)},getCenter:function(){return new $.Point(this.x+this.width/2,this.y+this.height/2)},getSize:function(){return new $.Point(this.width,this.height)},equals:function(other){return other instanceof $.Rect&&this.x===other.x&&this.y===other.y&&this.width===other.width&&this.height===other.height},rotate:function(degrees,pivot){var newTopLeft,width=this.width,height=this.height;if(degrees=(degrees+360)%360,degrees%90!==0)throw new Error("Currently only 0, 90, 180, and 270 degrees are supported.");if(0===degrees)return new $.Rect(this.x,this.y,this.width,this.height);switch(pivot=pivot||this.getCenter(),degrees){case 90:newTopLeft=this.getBottomLeft(),width=this.height,height=this.width;break;case 180:newTopLeft=this.getBottomRight();break;case 270:newTopLeft=this.getTopRight(),width=this.height,height=this.width;break;default:newTopLeft=this.getTopLeft()}return newTopLeft=newTopLeft.rotate(degrees,pivot),new $.Rect(newTopLeft.x,newTopLeft.y,width,height)},toString:function(){return"["+Math.round(100*this.x)+","+Math.round(100*this.y)+","+Math.round(100*this.width)+"x"+Math.round(100*this.height)+"]"}}}(OpenSeadragon),function($){function onStripDrag(event){var offsetLeft=Number(this.element.style.marginLeft.replace("px","")),offsetTop=Number(this.element.style.marginTop.replace("px","")),scrollWidth=Number(this.element.style.width.replace("px","")),scrollHeight=Number(this.element.style.height.replace("px","")),viewerSize=$.getElementSize(this.viewer.canvas);return this.dragging=!0,this.element&&("horizontal"==this.scroll?-event.delta.x>0?offsetLeft>-(scrollWidth-viewerSize.x)&&(this.element.style.marginLeft=offsetLeft+2*event.delta.x+"px",loadPanels(this,viewerSize.x,offsetLeft+2*event.delta.x)):-event.delta.x<0&&0>offsetLeft&&(this.element.style.marginLeft=offsetLeft+2*event.delta.x+"px",loadPanels(this,viewerSize.x,offsetLeft+2*event.delta.x)):-event.delta.y>0?offsetTop>-(scrollHeight-viewerSize.y)&&(this.element.style.marginTop=offsetTop+2*event.delta.y+"px",loadPanels(this,viewerSize.y,offsetTop+2*event.delta.y)):-event.delta.y<0&&0>offsetTop&&(this.element.style.marginTop=offsetTop+2*event.delta.y+"px",loadPanels(this,viewerSize.y,offsetTop+2*event.delta.y))),!1}function onStripScroll(event){var offsetLeft=Number(this.element.style.marginLeft.replace("px","")),offsetTop=Number(this.element.style.marginTop.replace("px","")),scrollWidth=Number(this.element.style.width.replace("px","")),scrollHeight=Number(this.element.style.height.replace("px","")),viewerSize=$.getElementSize(this.viewer.canvas);return this.element&&("horizontal"==this.scroll?event.scroll>0?offsetLeft>-(scrollWidth-viewerSize.x)&&(this.element.style.marginLeft=offsetLeft-60*event.scroll+"px",loadPanels(this,viewerSize.x,offsetLeft-60*event.scroll)):event.scroll<0&&0>offsetLeft&&(this.element.style.marginLeft=offsetLeft-60*event.scroll+"px",loadPanels(this,viewerSize.x,offsetLeft-60*event.scroll)):event.scroll<0?offsetTop>viewerSize.y-scrollHeight&&(this.element.style.marginTop=offsetTop+60*event.scroll+"px",loadPanels(this,viewerSize.y,offsetTop+60*event.scroll)):event.scroll>0&&0>offsetTop&&(this.element.style.marginTop=offsetTop+60*event.scroll+"px",loadPanels(this,viewerSize.y,offsetTop+60*event.scroll))),!1}function loadPanels(strip,viewerSize,scroll){var panelSize,activePanelsStart,activePanelsEnd,miniViewer,style,i,element;for(panelSize="horizontal"==strip.scroll?strip.panelWidth:strip.panelHeight,activePanelsStart=Math.ceil(viewerSize/panelSize)+5,activePanelsEnd=Math.ceil((Math.abs(scroll)+viewerSize)/panelSize)+1,activePanelsStart=activePanelsEnd-activePanelsStart,activePanelsStart=0>activePanelsStart?0:activePanelsStart,i=activePanelsStart;activePanelsEnd>i&&i<strip.panels.length;i++)element=strip.panels[i],element.activePanel||(miniViewer=new $.Viewer({id:element.id,tileSources:[strip.viewer.tileSources[i]],element:element,navigatorSizeRatio:strip.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0}),miniViewer.displayRegion=$.makeNeutralElement("textarea"),miniViewer.displayRegion.id=element.id+"-displayregion",miniViewer.displayRegion.className="displayregion",style=miniViewer.displayRegion.style,style.position="relative",style.top="0px",style.left="0px",style.fontSize="0px",style.overflow="hidden",style.float="left",style.cssFloat="left",style.styleFloat="left",style.zIndex=999999999,style.cursor="default",style.width=strip.panelWidth-4+"px",style.height=strip.panelHeight-4+"px",miniViewer.displayRegion.innerTracker=new $.MouseTracker({element:miniViewer.displayRegion}),element.getElementsByTagName("form")[0].appendChild(miniViewer.displayRegion),element.activePanel=!0)}function onStripEnter(event){var element=event.eventSource.element;return"horizontal"==this.scroll?element.style.marginBottom="0px":element.style.marginLeft="0px",!1}function onStripExit(event){var element=event.eventSource.element;return"horizontal"==this.scroll?element.style.marginBottom="-"+$.getElementSize(element).y/2+"px":element.style.marginLeft="-"+$.getElementSize(element).x/2+"px",!1}function onKeyPress(event){switch(event.keyCode){case 61:return onStripScroll.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 45:return onStripScroll.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 48:case 119:case 87:case 38:return onStripScroll.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 115:case 83:case 40:return onStripScroll.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 97:case 37:return onStripScroll.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 100:case 39:return onStripScroll.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}}var THIS={};$.ReferenceStrip=function(options){var element,style,i,_this=this,viewer=options.viewer,viewerSize=$.getElementSize(viewer.element);for(options.id||(options.id="referencestrip-"+$.now(),this.element=$.makeNeutralElement("div"),this.element.id=options.id,this.element.className="referencestrip"),options=$.extend(!0,{sizeRatio:$.DEFAULT_SETTINGS.referenceStripSizeRatio,position:$.DEFAULT_SETTINGS.referenceStripPosition,scroll:$.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:$.DEFAULT_SETTINGS.clickTimeThreshold},options,{element:this.element,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1}),$.extend(this,options),THIS[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,style=this.element.style,style.marginTop="0px",style.marginRight="0px",style.marginBottom="0px",style.marginLeft="0px",style.left="0px",style.bottom="0px",style.border="0px",style.background="#000",style.position="relative",$.setElementOpacity(this.element,.8),this.viewer=viewer,this.innerTracker=new $.MouseTracker({element:this.element,dragHandler:$.delegate(this,onStripDrag),scrollHandler:$.delegate(this,onStripScroll),enterHandler:$.delegate(this,onStripEnter),exitHandler:$.delegate(this,onStripExit),keyHandler:$.delegate(this,onKeyPress)}).setTracking(!0),options.width&&options.height?(this.element.style.width=options.width+"px",this.element.style.height=options.height+"px",viewer.addControl(this.element,{anchor:$.ControlAnchor.BOTTOM_LEFT})):"horizontal"==options.scroll?(this.element.style.width=viewerSize.x*options.sizeRatio*viewer.tileSources.length+12*viewer.tileSources.length+"px",this.element.style.height=viewerSize.y*options.sizeRatio+"px",viewer.addControl(this.element,{anchor:$.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=viewerSize.y*options.sizeRatio*viewer.tileSources.length+12*viewer.tileSources.length+"px",this.element.style.width=viewerSize.x*options.sizeRatio+"px",viewer.addControl(this.element,{anchor:$.ControlAnchor.TOP_LEFT})),this.panelWidth=viewerSize.x*this.sizeRatio+8,this.panelHeight=viewerSize.y*this.sizeRatio+8,this.panels=[],i=0;i<viewer.tileSources.length;i++)element=$.makeNeutralElement("div"),element.id=this.element.id+"-"+i,element.style.width=_this.panelWidth+"px",element.style.height=_this.panelHeight+"px",element.style.display="inline",element.style.float="left",element.style.cssFloat="left",element.style.styleFloat="left",element.style.padding="2px",element.innerTracker=new $.MouseTracker({element:element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,pressHandler:function(event){event.eventSource.dragging=$.now()},releaseHandler:function(event){var tracker=event.eventSource,id=tracker.element.id,page=Number(id.split("-")[2]),now=$.now();event.insideElementPressed&&event.insideElementReleased&&tracker.dragging&&now-tracker.dragging<tracker.clickTimeThreshold&&(tracker.dragging=null,viewer.goToPage(page))}}).setTracking(!0),this.element.appendChild(element),element.activePanel=!1,this.panels.push(element);loadPanels(this,"vertical"==this.scroll?viewerSize.y:viewerSize.y,0),this.setFocus(0)},$.extend($.ReferenceStrip.prototype,$.EventSource.prototype,$.Viewer.prototype,{setFocus:function(page){var offset,element=$.getElement(this.element.id+"-"+page),viewerSize=$.getElementSize(this.viewer.canvas),scrollWidth=Number(this.element.style.width.replace("px","")),scrollHeight=Number(this.element.style.height.replace("px","")),offsetLeft=-Number(this.element.style.marginLeft.replace("px","")),offsetTop=-Number(this.element.style.marginTop.replace("px",""));this.currentSelected!==element&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=element,this.currentSelected.style.background="#999","horizontal"==this.scroll?(offset=Number(page)*(this.panelWidth+3),offset>offsetLeft+viewerSize.x-this.panelWidth?(offset=Math.min(offset,scrollWidth-viewerSize.x),this.element.style.marginLeft=-offset+"px",loadPanels(this,viewerSize.x,-offset)):offsetLeft>offset&&(offset=Math.max(0,offset-viewerSize.x/2),this.element.style.marginLeft=-offset+"px",loadPanels(this,viewerSize.x,-offset))):(offset=Number(page)*(this.panelHeight+3),offset>offsetTop+viewerSize.y-this.panelHeight?(offset=Math.min(offset,scrollHeight-viewerSize.y),this.element.style.marginTop=-offset+"px",loadPanels(this,viewerSize.y,-offset)):offsetTop>offset&&(offset=Math.max(0,offset-viewerSize.y/2),this.element.style.marginTop=-offset+"px",loadPanels(this,viewerSize.y,-offset))),this.currentPage=page,$.getElement(element.id+"-displayregion").focus(),onStripEnter.call(this,{eventSource:this.innerTracker}))},update:function(){return THIS[this.id].animating?($.console.log("image reference strip update"),!0):!1}})}(OpenSeadragon),function($){$.DisplayRect=function(x,y,width,height,minLevel,maxLevel){$.Rect.apply(this,[x,y,width,height]),this.minLevel=minLevel,this.maxLevel=maxLevel},$.extend($.DisplayRect.prototype,$.Rect.prototype)}(OpenSeadragon),function($){function transform(stiffness,x){return(1-Math.exp(stiffness*-x))/(1-Math.exp(-stiffness))}$.Spring=function(options){var args=arguments;"object"!=typeof options&&(options={initial:args.length&&"number"==typeof args[0]?args[0]:0,springStiffness:args.length>1?args[1].springStiffness:5,animationTime:args.length>1?args[1].animationTime:1.5}),$.extend(!0,this,options),this.current={value:"number"==typeof this.initial?this.initial:0,time:$.now()},this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time}},$.Spring.prototype={resetTo:function(target){this.target.value=target,this.target.time=this.current.time,this.start.value=this.target.value,this.start.time=this.target.time},springTo:function(target){this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=target,this.target.time=this.start.time+1e3*this.animationTime},shiftBy:function(delta){this.start.value+=delta,this.target.value+=delta},update:function(){this.current.time=$.now(),this.current.value=this.current.time>=this.target.time?this.target.value:this.start.value+(this.target.value-this.start.value)*transform(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time))}}}(OpenSeadragon),function($){var TILE_CACHE={};$.Tile=function(level,x,y,bounds,exists,url){this.level=level,this.x=x,this.y=y,this.bounds=bounds,this.exists=exists,this.url=url,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.image=null,this.style=null,this.position=null,this.size=null,this.blendStart=null,this.opacity=null,this.distance=null,this.visibility=null,this.beingDrawn=!1,this.lastTouchTime=0},$.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},drawHTML:function(container){return this.loaded&&this.image?(this.element||(this.element=$.makeNeutralElement("div"),this.imgElement=$.makeNeutralElement("img"),this.imgElement.src=this.url,this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"),this.element.parentNode!=container&&container.appendChild(this.element),this.imgElement.parentNode!=this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",void $.setElementOpacity(this.element,this.opacity)):void $.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString())},drawCanvas:function(context){var rendered,canvas,position=this.position,size=this.size;return this.loaded&&(this.image||TILE_CACHE[this.url])?(context.globalAlpha=this.opacity,1==context.globalAlpha&&this.url.match(".png")&&context.clearRect(position.x+1,position.y+1,size.x-2,size.y-2),TILE_CACHE[this.url]||(canvas=document.createElement("canvas"),canvas.width=this.image.width,canvas.height=this.image.height,rendered=canvas.getContext("2d"),rendered.drawImage(this.image,0,0),TILE_CACHE[this.url]=rendered,this.image=null),rendered=TILE_CACHE[this.url],void context.drawImage(rendered.canvas,0,0,rendered.canvas.width,rendered.canvas.height,position.x,position.y,size.x,size.y)):void $.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString())
},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),TILE_CACHE[this.url]&&delete TILE_CACHE[this.url],this.element=null,this.imgElement=null,this.image=null,this.loaded=!1,this.loading=!1}}}(OpenSeadragon),function($){$.OverlayPlacement={CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8},$.Overlay=function(element,location,placement){var options;options=$.isPlainObject(element)?element:{element:element,location:location,placement:placement},this.element=options.element,this.scales=options.location instanceof $.Rect,this.bounds=new $.Rect(options.location.x,options.location.y,options.location.width,options.location.height),this.position=new $.Point(options.location.x,options.location.y),this.size=new $.Point(options.location.width,options.location.height),this.style=options.element.style,this.placement=options.location instanceof $.Point?options.placement:$.OverlayPlacement.TOP_LEFT,this.onDraw=options.onDraw},$.Overlay.prototype={adjust:function(position,size){switch(this.placement){case $.OverlayPlacement.TOP_LEFT:break;case $.OverlayPlacement.TOP:position.x-=size.x/2;break;case $.OverlayPlacement.TOP_RIGHT:position.x-=size.x;break;case $.OverlayPlacement.RIGHT:position.x-=size.x,position.y-=size.y/2;break;case $.OverlayPlacement.BOTTOM_RIGHT:position.x-=size.x,position.y-=size.y;break;case $.OverlayPlacement.BOTTOM:position.x-=size.x/2,position.y-=size.y;break;case $.OverlayPlacement.BOTTOM_LEFT:position.y-=size.y;break;case $.OverlayPlacement.LEFT:position.y-=size.y/2;break;default:case $.OverlayPlacement.CENTER:position.x-=size.x/2,position.y-=size.y/2}},destroy:function(){var element=this.element,style=this.style;element.parentNode&&(element.parentNode.removeChild(element),element.prevElementParent&&(style.display="none",document.body.appendChild(element))),this.onDraw=null,style.top="",style.left="",style.position="",this.scales&&(style.width="",style.height="")},drawHTML:function(container,viewport){var position,size,overlayCenter,element=this.element,style=this.style,scales=this.scales,drawerCenter=new $.Point(viewport.viewer.drawer.canvas.width/2,viewport.viewer.drawer.canvas.height/2),degrees=viewport.degrees;element.parentNode!=container&&(element.prevElementParent=element.parentNode,element.prevNextSibling=element.nextSibling,container.appendChild(element)),scales||(this.size=$.getElementSize(element)),position=this.position,size=this.size,this.adjust(position,size),position=position.apply(Math.floor),size=size.apply(Math.ceil),0!==degrees&&this.scales&&(overlayCenter=new $.Point(size.x/2,size.y/2),position=position.plus(overlayCenter).rotate(degrees,drawerCenter).minus(overlayCenter),size=size.rotate(degrees,new $.Point(0,0)),size=new $.Point(Math.abs(size.x),Math.abs(size.y))),this.onDraw?this.onDraw(position,size,element):(style.left=position.x+"px",style.top=position.y+"px",style.position="absolute",style.display="block",scales&&(style.width=size.x+"px",style.height=size.y+"px"))},update:function(location,placement){this.scales=location instanceof $.Rect,this.bounds=new $.Rect(location.x,location.y,location.width,location.height),this.placement=location instanceof $.Point?placement:$.OverlayPlacement.TOP_LEFT}}}(OpenSeadragon),function($){function addOverlayFromConfiguration(drawer,overlay){var element=null,rect=overlay.height&&overlay.width?new $.Rect(overlay.x||overlay.px,overlay.y||overlay.py,overlay.width,overlay.height):new $.Point(overlay.x||overlay.px,overlay.y||overlay.py),id=overlay.id?overlay.id:"openseadragon-overlay-"+Math.floor(1e7*Math.random());return element=$.getElement(overlay.id),element||(element=document.createElement("a"),element.href="#/overlay/"+id),element.id=id,$.addClass(element,overlay.className?overlay.className:"openseadragon-overlay"),void 0!==overlay.px&&(rect=drawer.viewport.imageToViewportRectangle(rect)),new $.Overlay(overlay.placement?{element:element,location:drawer.viewport.pointFromPixel(rect),placement:$.OverlayPlacement[overlay.placement.toUpperCase()],onDraw:overlay.onDraw}:{element:element,location:rect,onDraw:overlay.onDraw})}function updateViewport(drawer){drawer.updateAgain=!1,drawer.viewer&&drawer.viewer.raiseEvent("update-viewport",{});for(var tile,level,renderPixelRatioC,renderPixelRatioT,zeroRatioT,optimalRatio,levelOpacity,levelVisibility,best=null,haveDrawn=!1,currentTime=$.now(),viewportSize=drawer.viewport.getContainerSize(),viewportBounds=drawer.viewport.getBounds(!0),viewportTL=viewportBounds.getTopLeft(),viewportBR=viewportBounds.getBottomRight(),zeroRatioC=drawer.viewport.deltaPixelsFromPoints(drawer.source.getPixelRatio(0),!0).x,lowestLevel=Math.max(drawer.source.minLevel,Math.floor(Math.log(drawer.minZoomImageRatio)/Math.log(2))),highestLevel=Math.min(Math.abs(drawer.source.maxLevel),Math.abs(Math.floor(Math.log(zeroRatioC/drawer.minPixelRatio)/Math.log(2)))),degrees=drawer.viewport.degrees;drawer.lastDrawn.length>0;)tile=drawer.lastDrawn.pop(),tile.beingDrawn=!1;if(drawer.canvas.innerHTML="",USE_CANVAS&&((drawer.canvas.width!=viewportSize.x||drawer.canvas.height!=viewportSize.y)&&(drawer.canvas.width=viewportSize.x,drawer.canvas.height=viewportSize.y),drawer.context.clearRect(0,0,viewportSize.x,viewportSize.y)),90===degrees||270===degrees){var rotatedBounds=viewportBounds.rotate(degrees);viewportTL=rotatedBounds.getTopLeft(),viewportBR=rotatedBounds.getBottomRight()}if(!(!drawer.wrapHorizontal&&(viewportBR.x<0||viewportTL.x>1)||!drawer.wrapVertical&&(viewportBR.y<0||viewportTL.y>drawer.normHeight))){drawer.wrapHorizontal||(viewportTL.x=Math.max(viewportTL.x,0),viewportBR.x=Math.min(viewportBR.x,1)),drawer.wrapVertical||(viewportTL.y=Math.max(viewportTL.y,0),viewportBR.y=Math.min(viewportBR.y,drawer.normHeight)),lowestLevel=Math.min(lowestLevel,highestLevel);var drawLevel;for(level=highestLevel;level>=lowestLevel;level--){if(drawLevel=!1,renderPixelRatioC=drawer.viewport.deltaPixelsFromPoints(drawer.source.getPixelRatio(level),!0).x,!haveDrawn&&renderPixelRatioC>=drawer.minPixelRatio||level==lowestLevel)drawLevel=!0,haveDrawn=!0;else if(!haveDrawn)continue;if(renderPixelRatioT=drawer.viewport.deltaPixelsFromPoints(drawer.source.getPixelRatio(level),!1).x,zeroRatioT=drawer.viewport.deltaPixelsFromPoints(drawer.source.getPixelRatio(Math.max(drawer.source.getClosestLevel(drawer.viewport.containerSize)-1,0)),!1).x,optimalRatio=drawer.immediateRender?1:zeroRatioT,levelOpacity=Math.min(1,(renderPixelRatioC-.5)/.5),levelVisibility=optimalRatio/Math.abs(optimalRatio-renderPixelRatioT),best=updateLevel(drawer,haveDrawn,drawLevel,level,levelOpacity,levelVisibility,viewportTL,viewportBR,currentTime,best),providesCoverage(drawer.coverage,level))break}drawTiles(drawer,drawer.lastDrawn),drawOverlays(drawer.viewport,drawer.overlays,drawer.container),best&&(loadTile(drawer,best,currentTime),drawer.updateAgain=!0)}}function updateLevel(drawer,haveDrawn,drawLevel,level,levelOpacity,levelVisibility,viewportTL,viewportBR,currentTime,best){var x,y,tileTL,tileBR,numberOfTiles,viewportCenter=drawer.viewport.pixelFromPoint(drawer.viewport.getCenter());for(drawer.viewer&&drawer.viewer.raiseEvent("update-level",{havedrawn:haveDrawn,level:level,opacity:levelOpacity,visibility:levelVisibility,topleft:viewportTL,bottomright:viewportBR,currenttime:currentTime,best:best}),tileTL=drawer.source.getTileAtPoint(level,viewportTL),tileBR=drawer.source.getTileAtPoint(level,viewportBR),numberOfTiles=drawer.source.getNumTiles(level),resetCoverage(drawer.coverage,level),drawer.wrapHorizontal||(tileBR.x=Math.min(tileBR.x,numberOfTiles.x-1)),drawer.wrapVertical||(tileBR.y=Math.min(tileBR.y,numberOfTiles.y-1)),x=tileTL.x;x<=tileBR.x;x++)for(y=tileTL.y;y<=tileBR.y;y++)best=updateTile(drawer,drawLevel,haveDrawn,x,y,level,levelOpacity,levelVisibility,viewportCenter,numberOfTiles,currentTime,best);return best}function updateTile(drawer,drawLevel,haveDrawn,x,y,level,levelOpacity,levelVisibility,viewportCenter,numberOfTiles,currentTime,best){var tile=getTile(x,y,level,drawer.source,drawer.tilesMatrix,currentTime,numberOfTiles,drawer.normHeight),drawTile=drawLevel;if(drawer.viewer&&drawer.viewer.raiseEvent("update-tile",{tile:tile}),setCoverage(drawer.coverage,level,x,y,!1),!tile.exists)return best;if(haveDrawn&&!drawTile&&(isCovered(drawer.coverage,level,x,y)?setCoverage(drawer.coverage,level,x,y,!0):drawTile=!0),!drawTile)return best;if(positionTile(tile,drawer.source.tileOverlap,drawer.viewport,viewportCenter,levelVisibility),tile.loaded){var needsUpdate=blendTile(drawer,tile,x,y,level,levelOpacity,currentTime);needsUpdate&&(drawer.updateAgain=!0)}else tile.loading||(best=compareTiles(best,tile));return best}function getTile(x,y,level,tileSource,tilesMatrix,time,numTiles,normHeight){var xMod,yMod,bounds,exists,url,tile;return tilesMatrix[level]||(tilesMatrix[level]={}),tilesMatrix[level][x]||(tilesMatrix[level][x]={}),tilesMatrix[level][x][y]||(xMod=(numTiles.x+x%numTiles.x)%numTiles.x,yMod=(numTiles.y+y%numTiles.y)%numTiles.y,bounds=tileSource.getTileBounds(level,xMod,yMod),exists=tileSource.tileExists(level,xMod,yMod),url=tileSource.getTileUrl(level,xMod,yMod),bounds.x+=1*(x-xMod)/numTiles.x,bounds.y+=normHeight*(y-yMod)/numTiles.y,tilesMatrix[level][x][y]=new $.Tile(level,x,y,bounds,exists,url)),tile=tilesMatrix[level][x][y],tile.lastTouchTime=time,tile}function loadTile(drawer,tile,time){drawer.viewport.collectionMode?(drawer.midUpdate=!1,onTileLoad(drawer,tile,time)):tile.loading=drawer.loadImage(tile.url,function(image){onTileLoad(drawer,tile,time,image)})}function onTileLoad(drawer,tile,time,image){var insertionIndex,cutoff,worstTile,worstTime,worstLevel,worstTileIndex,prevTile,prevTime,prevLevel,i;if(tile.loading=!1,drawer.midUpdate)return void $.console.warn("Tile load callback in middle of drawing routine.");if(image||drawer.viewport.collectionMode){if(time<drawer.lastResetTime)return void $.console.log("Ignoring tile %s loaded before reset: %s",tile,tile.url)}else if($.console.log("Tile %s failed to load: %s",tile,tile.url),!drawer.debugMode)return void(tile.exists=!1);if(tile.loaded=!0,tile.image=image,insertionIndex=drawer.tilesLoaded.length,drawer.tilesLoaded.length>=drawer.maxImageCacheCount){for(cutoff=Math.ceil(Math.log(drawer.source.tileSize)/Math.log(2)),worstTile=null,worstTileIndex=-1,i=drawer.tilesLoaded.length-1;i>=0;i--)prevTile=drawer.tilesLoaded[i],prevTile.level<=drawer.cutoff||prevTile.beingDrawn||(worstTile?(prevTime=prevTile.lastTouchTime,worstTime=worstTile.lastTouchTime,prevLevel=prevTile.level,worstLevel=worstTile.level,(worstTime>prevTime||prevTime==worstTime&&prevLevel>worstLevel)&&(worstTile=prevTile,worstTileIndex=i)):(worstTile=prevTile,worstTileIndex=i));worstTile&&worstTileIndex>=0&&(worstTile.unload(),insertionIndex=worstTileIndex)}drawer.tilesLoaded[insertionIndex]=tile,drawer.updateAgain=!0}function positionTile(tile,overlap,viewport,viewportCenter,levelVisibility){var boundsTL=tile.bounds.getTopLeft(),boundsSize=tile.bounds.getSize(),positionC=viewport.pixelFromPoint(boundsTL,!0),positionT=viewport.pixelFromPoint(boundsTL,!1),sizeC=viewport.deltaPixelsFromPoints(boundsSize,!0),sizeT=viewport.deltaPixelsFromPoints(boundsSize,!1),tileCenter=positionT.plus(sizeT.divide(2)),tileDistance=viewportCenter.distanceTo(tileCenter);overlap||(sizeC=sizeC.plus(new $.Point(1,1))),tile.position=positionC,tile.size=sizeC,tile.distance=tileDistance,tile.visibility=levelVisibility}function blendTile(drawer,tile,x,y,level,levelOpacity,currentTime){var deltaTime,opacity,blendTimeMillis=1e3*drawer.blendTime;if(tile.blendStart||(tile.blendStart=currentTime),deltaTime=currentTime-tile.blendStart,opacity=blendTimeMillis?Math.min(1,deltaTime/blendTimeMillis):1,drawer.alwaysBlend&&(opacity*=levelOpacity),tile.opacity=opacity,drawer.lastDrawn.push(tile),1==opacity)setCoverage(drawer.coverage,level,x,y,!0);else if(blendTimeMillis>deltaTime)return!0;return!1}function clearTiles(drawer){drawer.tilesMatrix={},drawer.tilesLoaded=[]}function providesCoverage(coverage,level,x,y){var rows,cols,i,j;if(!coverage[level])return!1;if(void 0===x||void 0===y){rows=coverage[level];for(i in rows)if(rows.hasOwnProperty(i)){cols=rows[i];for(j in cols)if(cols.hasOwnProperty(j)&&!cols[j])return!1}return!0}return void 0===coverage[level][x]||void 0===coverage[level][x][y]||coverage[level][x][y]===!0}function isCovered(coverage,level,x,y){return void 0===x||void 0===y?providesCoverage(coverage,level+1):providesCoverage(coverage,level+1,2*x,2*y)&&providesCoverage(coverage,level+1,2*x,2*y+1)&&providesCoverage(coverage,level+1,2*x+1,2*y)&&providesCoverage(coverage,level+1,2*x+1,2*y+1)}function setCoverage(coverage,level,x,y,covers){return coverage[level]?(coverage[level][x]||(coverage[level][x]={}),void(coverage[level][x][y]=covers)):void $.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",level)}function resetCoverage(coverage,level){coverage[level]={}}function getOverlayIndex(overlays,element){var i;for(i=overlays.length-1;i>=0;i--)if(overlays[i].element==element)return i;return-1}function compareTiles(previousBest,tile){return previousBest?tile.visibility>previousBest.visibility?tile:tile.visibility==previousBest.visibility&&tile.distance<previousBest.distance?tile:previousBest:tile}function finishLoadingImage(image,callback,successful,jobid){image.onload=null,image.onabort=null,image.onerror=null,jobid&&window.clearTimeout(jobid),$.requestAnimationFrame(function(){callback(image.src,successful?image:null)})}function drawOverlays(viewport,overlays,container){var i,length=overlays.length;for(i=0;length>i;i++)drawOverlay(viewport,overlays[i],container)}function drawOverlay(viewport,overlay,container){overlay.position=viewport.pixelFromPoint(overlay.bounds.getTopLeft(),!0),overlay.size=viewport.deltaPixelsFromPoints(overlay.bounds.getSize(),!0),overlay.drawHTML(container,viewport)}function drawTiles(drawer,lastDrawn){var i,tile,tileKey,viewer,viewport,position,tileSource,collectionTileSource;for(i=lastDrawn.length-1;i>=0;i--){if(tile=lastDrawn[i],drawer.viewport.collectionMode?(tileKey=tile.x+"/"+tile.y,viewport=drawer.viewport,collectionTileSource=viewport.collectionTileSource,drawer.collectionOverlays[tileKey]?(viewer=drawer.collectionOverlays[tileKey],viewer.viewport&&(viewer.viewport.resize(tile.size,!0),viewer.viewport.goHome(!0))):(position="horizontal"==collectionTileSource.layout?tile.y+tile.x*collectionTileSource.rows:tile.x+tile.y*collectionTileSource.rows,tileSource=position<collectionTileSource.tileSources.length?collectionTileSource.tileSources[position]:null,tileSource&&(drawer.collectionOverlays[tileKey]=viewer=new $.Viewer({hash:viewport.viewer.hash+"-"+tileKey,element:$.makeNeutralElement("div"),mouseNavEnabled:!1,showNavigator:!1,showSequenceControl:!1,showNavigationControl:!1,tileSources:[tileSource]}),SUBPIXEL_RENDERING&&(viewer.element.style.border="1px solid rgba(255,255,255,0.38)",viewer.element.style["-webkit-box-reflect"]="below 0px -webkit-gradient(linear,left top,left bottom,from(transparent),color-stop(62%,transparent),to(rgba(255,255,255,0.62)))"),drawer.addOverlay(viewer.element,tile.bounds)))):(USE_CANVAS?0!==drawer.viewport.degrees?(offsetForRotation(tile,drawer.canvas,drawer.context,drawer.viewport.degrees),tile.drawCanvas(drawer.context),restoreRotationChanges(tile,drawer.canvas,drawer.context)):tile.drawCanvas(drawer.context):tile.drawHTML(drawer.canvas),tile.beingDrawn=!0),drawer.debugMode)try{drawDebugInfo(drawer,tile,lastDrawn.length,i)}catch(e){$.console.error(e)}drawer.viewer&&drawer.viewer.raiseEvent("tile-drawn",{tile:tile})}}function offsetForRotation(tile,canvas,context,degrees){var cx=canvas.width/2,cy=canvas.height/2,px=tile.position.x-cx,py=tile.position.y-cy;context.save(),context.translate(cx,cy),context.rotate(Math.PI/180*degrees),tile.position.x=px,tile.position.y=py}function restoreRotationChanges(tile,canvas,context){var cx=canvas.width/2,cy=canvas.height/2,px=tile.position.x+cx,py=tile.position.y+cy;tile.position.x=px,tile.position.y=py,context.restore()}function drawDebugInfo(drawer,tile,count,i){USE_CANVAS&&(drawer.context.save(),drawer.context.lineWidth=2,drawer.context.font="small-caps bold 13px ariel",drawer.context.strokeStyle=drawer.debugGridColor,drawer.context.fillStyle=drawer.debugGridColor,drawer.context.strokeRect(tile.position.x,tile.position.y,tile.size.x,tile.size.y),0===tile.x&&0===tile.y&&(drawer.context.fillText("Zoom: "+drawer.viewport.getZoom(),tile.position.x,tile.position.y-30),drawer.context.fillText("Pan: "+drawer.viewport.getBounds().toString(),tile.position.x,tile.position.y-20)),drawer.context.fillText("Level: "+tile.level,tile.position.x+10,tile.position.y+20),drawer.context.fillText("Column: "+tile.x,tile.position.x+10,tile.position.y+30),drawer.context.fillText("Row: "+tile.y,tile.position.x+10,tile.position.y+40),drawer.context.fillText("Order: "+i+" of "+count,tile.position.x+10,tile.position.y+50),drawer.context.fillText("Size: "+tile.size.toString(),tile.position.x+10,tile.position.y+60),drawer.context.fillText("Position: "+tile.position.toString(),tile.position.x+10,tile.position.y+70),drawer.context.restore())}var DEVICE_SCREEN=$.getWindowSize(),BROWSER=$.Browser.vendor,BROWSER_VERSION=$.Browser.version,SUBPIXEL_RENDERING=BROWSER==$.BROWSERS.FIREFOX||BROWSER==$.BROWSERS.OPERA||BROWSER==$.BROWSERS.SAFARI&&BROWSER_VERSION>=4||BROWSER==$.BROWSERS.CHROME&&BROWSER_VERSION>=2||BROWSER==$.BROWSERS.IE&&BROWSER_VERSION>=9,USE_CANVAS=SUBPIXEL_RENDERING&&!(DEVICE_SCREEN.x<=400||DEVICE_SCREEN.y<=400)&&!navigator.appVersion.match("Mobile")&&$.isFunction(document.createElement("canvas").getContext);$.Drawer=function(options){var i,args=arguments;for($.isPlainObject(options)||(options={source:args[0],viewport:args[1],element:args[2]}),$.extend(!0,this,{viewer:null,downloading:0,tilesMatrix:{},tilesLoaded:[],coverage:{},lastDrawn:[],lastResetTime:0,midUpdate:!1,updateAgain:!0,overlays:[],collectionOverlays:{},maxImageCacheCount:$.DEFAULT_SETTINGS.maxImageCacheCount,imageLoaderLimit:$.DEFAULT_SETTINGS.imageLoaderLimit,minZoomImageRatio:$.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:$.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:$.DEFAULT_SETTINGS.wrapVertical,immediateRender:$.DEFAULT_SETTINGS.immediateRender,blendTime:$.DEFAULT_SETTINGS.blendTime,alwaysBlend:$.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:$.DEFAULT_SETTINGS.minPixelRatio,debugMode:$.DEFAULT_SETTINGS.debugMode,timeout:$.DEFAULT_SETTINGS.timeout},options),this.container=$.getElement(this.element),this.canvas=$.makeNeutralElement(USE_CANVAS?"canvas":"div"),this.context=USE_CANVAS?this.canvas.getContext("2d"):null,this.normHeight=this.source.dimensions.y/this.source.dimensions.x,this.element=this.container,this.container.dir="ltr",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",this.container.style.textAlign="left",this.container.appendChild(this.canvas),i=0;i<this.overlays.length;i++)$.isPlainObject(this.overlays[i])?this.overlays[i]=addOverlayFromConfiguration(this,this.overlays[i]):$.isFunction(this.overlays[i])},$.Drawer.prototype={addOverlay:function(element,location,placement,onDraw){var options;return options=$.isPlainObject(element)?element:{element:element,location:location,placement:placement,onDraw:onDraw},element=$.getElement(options.element),getOverlayIndex(this.overlays,element)>=0?void 0:(this.overlays.push(new $.Overlay({element:element,location:options.location,placement:options.placement,onDraw:options.onDraw})),this.updateAgain=!0,this.viewer&&this.viewer.raiseEvent("add-overlay",{element:element,location:options.location,placement:options.placement}),this)},updateOverlay:function(element,location,placement){var i;return element=$.getElement(element),i=getOverlayIndex(this.overlays,element),i>=0&&(this.overlays[i].update(location,placement),this.updateAgain=!0),this.viewer&&this.viewer.raiseEvent("update-overlay",{element:element,location:location,placement:placement}),this},removeOverlay:function(element){var i;return element=$.getElement(element),i=getOverlayIndex(this.overlays,element),i>=0&&(this.overlays[i].destroy(),this.overlays.splice(i,1),this.updateAgain=!0),this.viewer&&this.viewer.raiseEvent("remove-overlay",{element:element}),this},clearOverlays:function(){for(;this.overlays.length>0;)this.overlays.pop().destroy(),this.updateAgain=!0;return this.viewer&&this.viewer.raiseEvent("clear-overlay",{}),this},needsUpdate:function(){return this.updateAgain},numTilesLoaded:function(){return this.tilesLoaded.length},reset:function(){return clearTiles(this),this.lastResetTime=$.now(),this.updateAgain=!0,this},update:function(){return this.midUpdate=!0,updateViewport(this),this.midUpdate=!1,this},loadImage:function(src,callback){var image,jobid,complete,_this=this,loading=!1;return(!this.imageLoaderLimit||this.downloading<this.imageLoaderLimit)&&(this.downloading++,image=new Image,complete=function(imagesrc,resultingImage){if(_this.downloading--,"function"==typeof callback)try{callback(resultingImage)}catch(e){$.console.error("%s while executing %s callback: %s",e.name,src,e.message,e)}},image.onload=function(){finishLoadingImage(image,complete,!0,jobid)},image.onabort=image.onerror=function(){finishLoadingImage(image,complete,!1,jobid)},jobid=window.setTimeout(function(){finishLoadingImage(image,complete,!1,jobid)},this.timeout),loading=!0,image.src=src),loading},canRotate:function(){return USE_CANVAS}}}(OpenSeadragon),function($){$.Viewport=function(options){var args=arguments;args.length&&args[0]instanceof $.Point&&(options={containerSize:args[0],contentSize:args[1],config:args[2]}),options.config&&($.extend(!0,options,options.config),delete options.config),$.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,viewer:null,springStiffness:$.DEFAULT_SETTINGS.springStiffness,animationTime:$.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:$.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:$.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:$.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:$.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:$.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:$.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:$.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:$.DEFAULT_SETTINGS.maxZoomLevel,degrees:$.DEFAULT_SETTINGS.degrees},options),this.centerSpringX=new $.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new $.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new $.Spring({initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.resetContentSize(this.contentSize),this.goHome(!0),this.update()},$.Viewport.prototype={resetContentSize:function(contentSize){return this.contentSize=contentSize,this.contentAspectX=this.contentSize.x/this.contentSize.y,this.contentAspectY=this.contentSize.y/this.contentSize.x,this.fitWidthBounds=new $.Rect(0,0,1,this.contentAspectY),this.fitHeightBounds=new $.Rect(0,0,this.contentAspectY,this.contentAspectY),this.homeBounds=new $.Rect(0,0,1,this.contentAspectY),this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:contentSize}),this},getHomeZoom:function(){var aspectFactor=this.contentAspectX/this.getAspectRatio();return this.defaultZoomLevel?this.defaultZoomLevel:aspectFactor>=1?1:aspectFactor},getHomeBounds:function(){var center=this.homeBounds.getCenter(),width=1/this.getHomeZoom(),height=width/this.getAspectRatio();return new $.Rect(center.x-width/2,center.y-height/2,width,height)},goHome:function(immediately){return this.viewer&&this.viewer.raiseEvent("home",{immediately:immediately}),this.fitBounds(this.getHomeBounds(),immediately)},getMinZoom:function(){var homeZoom=this.getHomeZoom(),zoom=this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*homeZoom;return Math.min(zoom,homeZoom)},getMaxZoom:function(){var zoom=this.maxZoomLevel?this.maxZoomLevel:this.contentSize.x*this.maxZoomPixelRatio/this.containerSize.x;return Math.max(zoom,this.getHomeZoom())},getAspectRatio:function(){return this.containerSize.x/this.containerSize.y},getContainerSize:function(){return new $.Point(this.containerSize.x,this.containerSize.y)},getBounds:function(current){var center=this.getCenter(current),width=1/this.getZoom(current),height=width/this.getAspectRatio();return new $.Rect(center.x-width/2,center.y-height/2,width,height)},getCenter:function(current){var oldZoomPixel,zoom,width,height,bounds,newZoomPixel,deltaZoomPixels,deltaZoomPoints,centerCurrent=new $.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),centerTarget=new $.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return current?centerCurrent:this.zoomPoint?(oldZoomPixel=this.pixelFromPoint(this.zoomPoint,!0),zoom=this.getZoom(),width=1/zoom,height=width/this.getAspectRatio(),bounds=new $.Rect(centerCurrent.x-width/2,centerCurrent.y-height/2,width,height),newZoomPixel=this.zoomPoint.minus(bounds.getTopLeft()).times(this.containerSize.x/bounds.width),deltaZoomPixels=newZoomPixel.minus(oldZoomPixel),deltaZoomPoints=deltaZoomPixels.divide(this.containerSize.x*zoom),centerTarget.plus(deltaZoomPoints)):centerTarget},getZoom:function(current){return current?this.zoomSpring.current.value:this.zoomSpring.target.value},applyConstraints:function(immediately){var bounds,horizontalThreshold,verticalThreshold,left,right,top,bottom,actualZoom=this.getZoom(),constrainedZoom=Math.max(Math.min(actualZoom,this.getMaxZoom()),this.getMinZoom()),dx=0,dy=0;return actualZoom!=constrainedZoom&&this.zoomTo(constrainedZoom,this.zoomPoint,immediately),bounds=this.getBounds(),horizontalThreshold=this.visibilityRatio*bounds.width,verticalThreshold=this.visibilityRatio*bounds.height,left=bounds.x+bounds.width,right=1-bounds.x,top=bounds.y+bounds.height,bottom=this.contentAspectY-bounds.y,this.wrapHorizontal||(horizontalThreshold>left&&(dx=horizontalThreshold-left),horizontalThreshold>right&&(dx=dx?(dx+right-horizontalThreshold)/2:right-horizontalThreshold)),this.wrapVertical||(verticalThreshold>top&&(dy=verticalThreshold-top),verticalThreshold>bottom&&(dy=dy?(dy+bottom-verticalThreshold)/2:bottom-verticalThreshold)),(dx||dy||immediately)&&(bounds.x+=dx,bounds.y+=dy,bounds.width>1&&(bounds.x=.5-bounds.width/2),bounds.height>this.contentAspectY&&(bounds.y=this.contentAspectY/2-bounds.height/2),this.fitBounds(bounds,immediately)),this.viewer&&this.viewer.raiseEvent("constrain",{immediately:immediately}),this},ensureVisible:function(immediately){return this.applyConstraints(immediately)},fitBounds:function(bounds,immediately){var oldBounds,oldZoom,newZoom,referencePoint,aspect=this.getAspectRatio(),center=bounds.getCenter(),newBounds=new $.Rect(bounds.x,bounds.y,bounds.width,bounds.height);return newBounds.getAspectRatio()>=aspect?(newBounds.height=bounds.width/aspect,newBounds.y=center.y-newBounds.height/2):(newBounds.width=bounds.height*aspect,newBounds.x=center.x-newBounds.width/2),this.panTo(this.getCenter(!0),!0),this.zoomTo(this.getZoom(!0),null,!0),oldBounds=this.getBounds(),oldZoom=this.getZoom(),newZoom=1/newBounds.width,newZoom==oldZoom||newBounds.width==oldBounds.width?this.panTo(center,immediately):(referencePoint=oldBounds.getTopLeft().times(this.containerSize.x/oldBounds.width).minus(newBounds.getTopLeft().times(this.containerSize.x/newBounds.width)).divide(this.containerSize.x/oldBounds.width-this.containerSize.x/newBounds.width),this.zoomTo(newZoom,referencePoint,immediately))},fitVertically:function(immediately){var center=this.getCenter();return this.wrapHorizontal&&(center.x=(1+center.x%1)%1,this.centerSpringX.resetTo(center.x),this.centerSpringX.update()),this.wrapVertical&&(center.y=(this.contentAspectY+center.y%this.contentAspectY)%this.contentAspectY,this.centerSpringY.resetTo(center.y),this.centerSpringY.update()),this.fitBounds(this.fitHeightBounds,immediately)},fitHorizontally:function(immediately){var center=this.getCenter();return this.wrapHorizontal&&(center.x=(this.contentAspectX+center.x%this.contentAspectX)%this.contentAspectX,this.centerSpringX.resetTo(center.x),this.centerSpringX.update()),this.wrapVertical&&(center.y=(1+center.y%1)%1,this.centerSpringY.resetTo(center.y),this.centerSpringY.update()),this.fitBounds(this.fitWidthBounds,immediately)},panBy:function(delta,immediately){var center=new $.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return delta=delta.rotate(-this.degrees,new $.Point(0,0)),this.panTo(center.plus(delta),immediately)},panTo:function(center,immediately){return immediately?(this.centerSpringX.resetTo(center.x),this.centerSpringY.resetTo(center.y)):(this.centerSpringX.springTo(center.x),this.centerSpringY.springTo(center.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:center,immediately:immediately}),this},zoomBy:function(factor,refPoint,immediately){return refPoint instanceof $.Point&&!isNaN(refPoint.x)&&!isNaN(refPoint.y)&&(refPoint=refPoint.rotate(-this.degrees,new $.Point(this.centerSpringX.target.value,this.centerSpringY.target.value))),this.zoomTo(this.zoomSpring.target.value*factor,refPoint,immediately)},zoomTo:function(zoom,refPoint,immediately){return this.zoomPoint=refPoint instanceof $.Point&&!isNaN(refPoint.x)&&!isNaN(refPoint.y)?refPoint:null,immediately?this.zoomSpring.resetTo(zoom):this.zoomSpring.springTo(zoom),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:zoom,refPoint:refPoint,immediately:immediately}),this},setRotation:function(degrees){if(!this.viewer||!this.viewer.drawer.canRotate())return this;if(degrees=(degrees+360)%360,degrees%90!==0)throw new Error("Currently only 0, 90, 180, and 270 degrees are supported.");return this.degrees=degrees,this.viewer.drawer.update(),this},getRotation:function(){return this.degrees},resize:function(newContainerSize,maintain){var oldBounds=this.getBounds(),newBounds=oldBounds,widthDeltaFactor=newContainerSize.x/this.containerSize.x;return this.containerSize=new $.Point(newContainerSize.x,newContainerSize.y),maintain&&(newBounds.width=oldBounds.width*widthDeltaFactor,newBounds.height=newBounds.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:newContainerSize,maintain:maintain}),this.fitBounds(newBounds,!0)},update:function(){var oldZoomPixel,newZoomPixel,deltaZoomPixels,deltaZoomPoints,oldCenterX=this.centerSpringX.current.value,oldCenterY=this.centerSpringY.current.value,oldZoom=this.zoomSpring.current.value;return this.zoomPoint&&(oldZoomPixel=this.pixelFromPoint(this.zoomPoint,!0)),this.zoomSpring.update(),this.zoomPoint&&this.zoomSpring.current.value!=oldZoom?(newZoomPixel=this.pixelFromPoint(this.zoomPoint,!0),deltaZoomPixels=newZoomPixel.minus(oldZoomPixel),deltaZoomPoints=this.deltaPointsFromPixels(deltaZoomPixels,!0),this.centerSpringX.shiftBy(deltaZoomPoints.x),this.centerSpringY.shiftBy(deltaZoomPoints.y)):this.zoomPoint=null,this.centerSpringX.update(),this.centerSpringY.update(),this.centerSpringX.current.value!=oldCenterX||this.centerSpringY.current.value!=oldCenterY||this.zoomSpring.current.value!=oldZoom},deltaPixelsFromPoints:function(deltaPoints,current){return deltaPoints.times(this.containerSize.x*this.getZoom(current))},deltaPointsFromPixels:function(deltaPixels,current){return deltaPixels.divide(this.containerSize.x*this.getZoom(current))},pixelFromPoint:function(point,current){var bounds=this.getBounds(current);return point.minus(bounds.getTopLeft()).times(this.containerSize.x/bounds.width)},pointFromPixel:function(pixel,current){var bounds=this.getBounds(current);return pixel.divide(this.containerSize.x/bounds.width).plus(bounds.getTopLeft())},viewportToImageCoordinates:function(viewerX,viewerY){return 1==arguments.length?this.viewportToImageCoordinates(viewerX.x,viewerX.y):new $.Point(viewerX*this.contentSize.x,viewerY*this.contentSize.y*this.contentAspectX)
},imageToViewportCoordinates:function(imageX,imageY){return 1==arguments.length?this.imageToViewportCoordinates(imageX.x,imageX.y):new $.Point(imageX/this.contentSize.x,imageY/this.contentSize.y/this.contentAspectX)},imageToViewportRectangle:function(imageX,imageY,pixelWidth,pixelHeight){var coordA,coordB,rect;return 1==arguments.length?(rect=imageX,this.imageToViewportRectangle(rect.x,rect.y,rect.width,rect.height)):(coordA=this.imageToViewportCoordinates(imageX,imageY),coordB=this.imageToViewportCoordinates(pixelWidth,pixelHeight),new $.Rect(coordA.x,coordA.y,coordB.x,coordB.y))},viewportToImageRectangle:function(viewerX,viewerY,pointWidth,pointHeight){var coordA,coordB,rect;return 1==arguments.length?(rect=viewerX,this.viewportToImageRectangle(rect.x,rect.y,rect.width,rect.height)):(coordA=this.viewportToImageCoordinates(viewerX,viewerY),coordB=this.viewportToImageCoordinates(pointWidth,pointHeight),new $.Rect(coordA.x,coordA.y,coordB.x,coordB.y))},viewerElementToImageCoordinates:function(pixel){var point=this.pointFromPixel(pixel,!0);return this.viewportToImageCoordinates(point)},imageToViewerElementCoordinates:function(point){var pixel=this.pixelFromPoint(point,!0);return this.imageToViewportCoordinates(pixel)},windowToImageCoordinates:function(pixel){var viewerCoordinates=pixel.minus(OpenSeadragon.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(viewerCoordinates)},imageToWindowCoordinates:function(pixel){var viewerCoordinates=this.imageToViewerElementCoordinates(pixel);return viewerCoordinates.plus(OpenSeadragon.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(pixel){return this.pointFromPixel(pixel,!0)},viewportToViewerElementCoordinates:function(point){return this.pixelFromPoint(point,!0)},windowToViewportCoordinates:function(pixel){var viewerCoordinates=pixel.minus(OpenSeadragon.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(viewerCoordinates)},viewportToWindowCoordinates:function(point){var viewerCoordinates=this.viewportToViewerElementCoordinates(point);return viewerCoordinates.plus(OpenSeadragon.getElementPosition(this.viewer.element))},viewportToImageZoom:function(viewportZoom){var imageWidth=this.viewer.source.dimensions.x,containerWidth=this.getContainerSize().x,viewportToImageZoomRatio=containerWidth/imageWidth;return viewportZoom*viewportToImageZoomRatio},imageToViewportZoom:function(imageZoom){var imageWidth=this.viewer.source.dimensions.x,containerWidth=this.getContainerSize().x,viewportToImageZoomRatio=imageWidth/containerWidth;return imageZoom*viewportToImageZoomRatio}}}(OpenSeadragon),function($){function beginControlsAutoHide(viewer){viewer.autoHideControls&&(viewer.controlsShouldFade=!0,viewer.controlsFadeBeginTime=$.now()+viewer.controlsFadeDelay,window.setTimeout(function(){scheduleControlsFade(viewer)},viewer.controlsFadeDelay))}function abortControlsAutoHide(viewer){var i;for(viewer.controlsShouldFade=!1,i=viewer.controls.length-1;i>=0;i--)viewer.controls[i].setOpacity(1)}function onFocus(){abortControlsAutoHide(this.viewer)}function onBlur(){beginControlsAutoHide(this.viewer)}$.Viewer.prototype.annotation=function(){var wrapper=jQuery(".annotator-wrapper").parent()[0],annotator=jQuery.data(wrapper,"annotator"),self=this,isOpenViewer=!1;this.addHandler("open",function(){isOpenViewer=!0,"undefined"!=typeof self.annotationInstance&&self.annotationInstance.refreshDisplay()}),annotator.subscribe("annotationsLoaded",function(){function refreshDisplay(){isOpenViewer?self.annotationInstance.refreshDisplay():setTimeout(refreshDisplay,200)}self.annotationInstance?self.annotationInstance.refreshDisplay():(self.annotationInstance=new $._annotation({viewer:self,annotator:annotator}),annotator.osda=self.annotationInstance,refreshDisplay())})},$._annotation=function(options){if(options=options||{},!options.viewer)throw new Error("A viewer must be specified.");this.viewer=options.viewer,this.annotator=options.annotator,this.options=options,this.isAnnotating=!1,this.isDrawing=!1,this.rectPosition=void 0,this.init()},$._annotation.prototype={init:function(){var viewer=this.viewer;this._createNewButton();var onCanvasMouseDown=this.__bind(this._onCanvasMouseDown,this),onCanvasMouseMove=this.__bind(this._onCanvasMouseMove,this),onDocumentMouseUp=this.__bind(this._onDocumentMouseUp,this);$.addEvent(viewer.canvas,"mousedown",onCanvasMouseDown,!0),$.addEvent(viewer.canvas,"mousemove",onCanvasMouseMove,!0),$.addEvent(document,"mouseup",onDocumentMouseUp,!0)},newAnnotation:function(){var annotator=this.annotator;annotator.editor.OpenSeaDragon=this.viewer.id,annotator.adder.show(),this._setOverShape(annotator.adder),annotator.onAdderClick()},editAnnotation:function(annotation,editor){if(this._isOpenSeaDragon(annotation)){var editor=editor||this.annotator.editor;this._setOverShape(editor.element),editor.checkOrientation(),editor.OpenSeaDragon=this.viewer.id}},refreshDisplay:function(){var allannotations=this.annotator.plugins.Store.annotations,annotator=this.annotator;this._sortByDate(allannotations),this.viewer.drawer.clearOverlays();for(var item in allannotations){var an=allannotations[item];this._isOpenSeaDragon(an)&&this.drawRect(an)}annotator.publish("externalCallToHighlightTags",[an])},modeAnnotation:function(e){this._reset();var viewer=this.viewer;this.isAnnotating?(jQuery(".openseadragon1").css("cursor","all-scroll"),jQuery(".openseadragon1").css("border","inherit"),e.eventSource.imgGroup.src=this.resolveUrl(viewer.prefixUrl,"newan_grouphover.png"),e.eventSource.imgRest.src=this.resolveUrl(viewer.prefixUrl,"newan_rest.png"),e.eventSource.imgHover.src=this.resolveUrl(viewer.prefixUrl,"newan_hover.png")):(jQuery(".openseadragon1").css("cursor","crosshair"),jQuery(".openseadragon1").css("border","2px solid rgb(51,204,102)"),e.eventSource.imgGroup.src=this.resolveUrl(viewer.prefixUrl,"newan_hover.png"),e.eventSource.imgRest.src=this.resolveUrl(viewer.prefixUrl,"newan_hover.png"),e.eventSource.imgHover.src=this.resolveUrl(viewer.prefixUrl,"newan_grouphover.png")),this.isAnnotating=this.isAnnotating?!1:!0},drawRect:function(an){if("undefined"!=typeof an.rangePosition){var span=document.createElement("span"),rectPosition=an.rangePosition;span.className="annotator-hl",span.style.border="2px solid rgb(255, 255, 255)",span.style.outline="2px solid rgb(0, 0, 0)",span.style.background="rgba(0,0,0,0)";var onAnnotationMouseMove=this.__bind(this._onAnnotationMouseMove,this),onAnnotationClick=this.__bind(this._onAnnotationClick,this);$.addEvent(span,"mousemove",onAnnotationMouseMove,!0),$.addEvent(span,"click",onAnnotationClick,!0),jQuery.data(span,"annotation",an),an.highlights=jQuery(span);var olRect=new OpenSeadragon.Rect(rectPosition.left,rectPosition.top,rectPosition.width,rectPosition.height);return this.viewer.drawer.addOverlay({element:span,location:olRect,placement:OpenSeadragon.OverlayPlacement.TOP_LEFT})}return!1},setRectPosition:function(){var left=parseInt(this.rect.style.left),top=parseInt(this.rect.style.top),width=parseInt(this.rect.style.left)+parseInt(this.rect.style.width),height=parseInt(this.rect.style.top)+parseInt(this.rect.style.height),startPoint=new $.Point(left,top),endPoint=new $.Point(width,height);this.rectPosition={left:this._physicalToLogicalXY(startPoint).x,top:this._physicalToLogicalXY(startPoint).y,width:this._physicalToLogicalXY(endPoint).x-this._physicalToLogicalXY(startPoint).x,height:this._physicalToLogicalXY(endPoint).y-this._physicalToLogicalXY(startPoint).y}},_onCanvasMouseDown:function(event){if(this.isAnnotating){var viewer=this.viewer;event.preventDefault(),this._reset(),this.isDrawing=!0;var mouse=$.getMousePosition(event),elementPosition=$.getElementPosition(viewer.canvas),position=mouse.minus(elementPosition);viewer.innerTracker.setTracking(!1),this.rect=document.createElement("div"),this.rect.style.background="rgba(0,0,0,0)",this.rect.style.border="2px solid rgb(255, 255, 255)",this.rect.style.outline="2px solid rgb(0, 0, 0)",this.rect.style.position="absolute",this.rect.className="DrawingRect",this.rect.style.top=position.y+"px",this.rect.style.left=position.x+"px",this.rect.style.width="1px",this.rect.style.height="1px",this.startPosition=position,this.setRectPosition(),viewer.canvas.appendChild(this.rect)}},_onCanvasMouseMove:function(event){if(this.isAnnotating&&this.isDrawing){var viewer=this.viewer,mouse=$.getMousePosition(event),elementPosition=$.getElementPosition(viewer.canvas),endPosition=mouse.minus(elementPosition),startPosition=this.startPosition,newWidth=endPosition.x-startPosition.x,newHeight=endPosition.y-startPosition.y;this.rect.style.width=0>newWidth?-1*newWidth+"px":newWidth+"px",this.rect.style.left=0>newWidth?startPosition.x+newWidth+"px":startPosition.x+"px",this.rect.style.height=0>newHeight?-1*newHeight+"px":newHeight+"px",this.rect.style.top=0>newHeight?startPosition.y+newHeight+"px":startPosition.y+"px",this.setRectPosition(),this.annotator.editor.element[0].style.display="none",this._setOverShape(this.annotator.adder)}},_onDocumentMouseUp:function(){if(this.isAnnotating&&this.isDrawing){var viewer=this.viewer;viewer.innerTracker.setTracking(!0),this.isDrawing=!1,this.setRectPosition(),this.newAnnotation(),this.annotator.editor.element[0].style.display="block",this._setOverShape(this.annotator.editor.element),this.annotator.editor.checkOrientation()}},_onAnnotationMouseMove:function(event){var annotator=this.annotator,elem=jQuery(event.target).parents(".annotator-hl").andSelf();if("undefined"!=typeof annotator&&elem.hasClass("annotator-hl")&&!this.isDrawing){annotator.viewer.hide();var annotations=jQuery(event.target.parentNode).find(".annotator-hl").map(function(){var self=jQuery(this),offset=self.offset(),l=offset.left,t=offset.top,h=self.height(),w=self.width(),x=$.getMousePosition(event).x,y=$.getMousePosition(event).y,maxx=l+w,maxy=t+h;return this.style.background=maxy>=y&&y>=t&&maxx>=x&&x>=l?"rgba(255, 255, 10, 0.05)":"rgba(0, 0, 0, 0)",maxy>=y&&y>=t&&maxx>=x&&x>=l?jQuery(this).data("annotation"):null}),mousePosition={top:$.getMousePosition(event).y,left:$.getMousePosition(event).x};annotations.length>0&&annotator.showViewer(jQuery.makeArray(annotations),mousePosition)}},_onAnnotationClick:function(event){var an=jQuery.data(event.target,"annotation"),bounds="undefined"!=typeof an.bounds?an.bounds:{},currentBounds=this.viewer.drawer.viewport.getBounds();"undefined"!=typeof bounds.x&&(currentBounds.x=bounds.x),"undefined"!=typeof bounds.y&&(currentBounds.y=bounds.y),"undefined"!=typeof bounds.width&&(currentBounds.width=bounds.width),"undefined"!=typeof bounds.height&&(currentBounds.height=bounds.height),this.viewer.drawer.viewport.fitBounds(currentBounds)},_sortByDate:function(annotations,type){var type=type||"asc";annotations.sort(function(a,b){return a=new Date("undefined"!=typeof a.updated?createDateFromISO8601(a.updated):""),b=new Date("undefined"!=typeof b.updated?createDateFromISO8601(b.updated):""),"asc"==type?a>b?-1:b>a?1:0:b>a?-1:a>b?1:0})},_createNewButton:function(){var viewer=this.viewer,onFocusHandler=$.delegate(this,onFocus),onBlurHandler=$.delegate(this,onBlur),onModeAnnotationHandler=$.delegate(this,this.modeAnnotation),viewer=this.viewer,self=this;viewer.modeAnnotation=new $.Button({element:viewer.modeAnnotation?$.getElement(viewer.modeAnnotation):null,clickTimeThreshold:viewer.clickTimeThreshold,clickDistThreshold:viewer.clickDistThreshold,tooltip:"New Annotation",srcRest:self.resolveUrl(viewer.prefixUrl,"newan_rest.png"),srcGroup:self.resolveUrl(viewer.prefixUrl,"newan_grouphover.png"),srcHover:self.resolveUrl(viewer.prefixUrl,"newan_hover.png"),srcDown:self.resolveUrl(viewer.prefixUrl,"newan_pressed.png"),onRelease:onModeAnnotationHandler,onFocus:onFocusHandler,onBlur:onBlurHandler}),viewer.wrapperAnnotation=new $.ButtonGroup({buttons:[viewer.modeAnnotation],clickTimeThreshold:viewer.clickTimeThreshold,clickDistThreshold:viewer.clickDistThreshold}),("everyone"==this.options.viewer.annotation_mode||this.options.viewer.flags)&&(viewer.annotatorControl=viewer.wrapperAnnotation.element,viewer.toolbar?viewer.toolbar.addControl(viewer.annotatorControl,{anchor:$.ControlAnchor.BOTTOM_RIGHT}):viewer.addControl(viewer.annotatorControl,{anchor:$.ControlAnchor.TOP_LEFT}))},_reset:function(){this._removeElemsByClass("DrawingRect",this.viewer.canvas),this.annotator.editor.element[0].style.display="none"},__bind:function(fn,me){return function(){return fn.apply(me,arguments)}},_removeElemsByClass:function(className,inElement){var className=className||"",inElement=inElement||{};divs=inElement.getElementsByClassName(className);for(var i=0;i<divs.length;i++)divs[i].remove()},_isOpenSeaDragon:function(an){var annotator=this.annotator,rp=an.rangePosition,isOpenSeaDragon="undefined"!=typeof annotator.osda,isContainer="undefined"!=typeof an.target&&an.target.container==this.viewer.id,isImage="undefined"!=typeof an.media&&"image"==an.media,isRP="undefined"!=typeof rp,isSource=!1,sourceId=this.viewer.source["@id"],targetThumb=an.target?an.target.thumb:!1;return isContainer&&(isSource=targetThumb?-1!==targetThumb.indexOf(sourceId):!0),isOpenSeaDragon&&isContainer&&isImage&&isRP&&isSource},_setOverShape:function(elem){var rectPosition=this.rectPosition||{},startPoint=this._logicalToPhysicalXY(new $.Point(rectPosition.left,rectPosition.top)),endPoint=this._logicalToPhysicalXY(new $.Point(rectPosition.left+rectPosition.width,rectPosition.top+rectPosition.height)),wrapper=jQuery(".annotator-wrapper")[0],positionAnnotator=$.getElementPosition(wrapper),positionCanvas=$.getElementPosition(this.viewer.canvas),positionAdder={};startPoint=startPoint.plus(positionCanvas),endPoint=endPoint.plus(positionCanvas),elem[0].style.display="block",positionAdder.left=startPoint.x-positionAnnotator.x+(endPoint.x-startPoint.x)/2,positionAdder.top=startPoint.y-positionAnnotator.y+(endPoint.y-startPoint.y)/2,elem.css(positionAdder)},resolveUrl:function(prefix,url){return prefix?prefix+url:url},_physicalToLogicalXY:function(point){var point="undefined"!=typeof point?point:{},boundX=this.viewer.viewport.getBounds(!0).x,boundY=this.viewer.viewport.getBounds(!0).y,boundWidth=this.viewer.viewport.getBounds(!0).width,boundHeight=this.viewer.viewport.getBounds(!0).height,containerSizeX=this.viewer.viewport.getContainerSize().x,containerSizeY=this.viewer.viewport.getContainerSize().y,x="undefined"!=typeof point.x?point.x:0,y="undefined"!=typeof point.y?point.y:0;return x=boundX+x/containerSizeX*boundWidth,y=boundY+y/containerSizeY*boundHeight,new $.Point(x,y)},_logicalToPhysicalXY:function(point){var point="undefined"!=typeof point?point:{},boundX=this.viewer.viewport.getBounds(!0).x,boundY=this.viewer.viewport.getBounds(!0).y,boundWidth=this.viewer.viewport.getBounds(!0).width,boundHeight=this.viewer.viewport.getBounds(!0).height,containerSizeX=this.viewer.viewport.getContainerSize().x,containerSizeY=this.viewer.viewport.getContainerSize().y,x="undefined"!=typeof point.x?point.x:0,y="undefined"!=typeof point.y?point.y:0;return x=(x-boundX)*containerSizeX/boundWidth,y=(y-boundY)*containerSizeY/boundHeight,new $.Point(x,y)}}}(OpenSeadragon),Annotator.Plugin.OpenSeaDragon=function(_super){function OpenSeaDragon(){return this.pluginSubmit=__bind(this.pluginSubmit,this),_ref=OpenSeaDragon.__super__.constructor.apply(this,arguments),this.__indexOf=[].indexOf,this.__indexOf||(this.__indexOf=function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1}),_ref}return __extends(OpenSeaDragon,_super),OpenSeaDragon.prototype.field=null,OpenSeaDragon.prototype.input=null,OpenSeaDragon.prototype.pluginInit=function(){if(Annotator.supported()){this.field=this.annotator.editor.addField({id:"osd-input-rangePosition-annotations",type:"input",submit:this.pluginSubmit,EditOpenSeaDragonAn:this.EditOpenSeaDragonAn});var select='<li><span id="osd-input-rangePosition-annotations"></span></li>',newfield=Annotator.$(select);return Annotator.$(this.field).replaceWith(newfield),this.field=newfield[0],this.initListeners(),this.input=$(this.field).find(":input")}},OpenSeaDragon.prototype.pluginSubmit=function(field,annotation){if(this.EditOpenSeaDragonAn()){var annotator=this.annotator,osda=annotator.osda,position=osda.rectPosition||{},isNew="undefined"==typeof annotation.media;if(isNew){"undefined"==typeof annotation.media&&(annotation.media="image"),annotation.target=annotation.target||{},annotation.target.container=osda.viewer.id||"";var source=osda.viewer.source,tilesUrl="undefined"!=typeof source.tilesUrl?source.tilesUrl:"",functionUrl="undefined"!=typeof source.getTileUrl?source.getTileUrl:"";annotation.target.src=""!=tilesUrl?tilesUrl:(""+functionUrl).replace(/\s+/g," "),annotation.target.ext=source.fileFormat||"",annotation.bounds=osda.viewer.drawer.viewport.getBounds()||{};var finalimagelink=source["@id"].replace("/info.json",""),highlightX=Math.round(position.left*source.width),highlightY=Math.round(position.top*source.width),highlightWidth=Math.round(position.width*source.width),highlightHeight=Math.round(position.height*source.width);annotation.target.thumb=finalimagelink+"/"+highlightX+","+highlightY+","+highlightWidth+","+highlightHeight+"/full/0/native."+source.formats[0],isNew&&(annotation.rangePosition=position||{}),annotation.updated=(new Date).toISOString(),"undefined"==typeof annotation.created&&(annotation.created=annotation.updated)}}return annotation.media},OpenSeaDragon.prototype.EditOpenSeaDragonAn=function(){var wrapper=$(".annotator-wrapper").parent()[0],annotator=window.annotator=$.data(wrapper,"annotator"),isOpenSeaDragon="undefined"!=typeof annotator.osda,OpenSeaDragon=annotator.editor.OpenSeaDragon;return isOpenSeaDragon&&"undefined"!=typeof OpenSeaDragon&&-1!==OpenSeaDragon},OpenSeaDragon.prototype.isOpenSeaDragon=function(an){var annotator=this.annotator,rp=an.rangePosition,isOpenSeaDragon="undefined"!=typeof annotator.osda,isContainer="undefined"!=typeof an.target&&an.target.container==osda.viewer.id,isImage="undefined"!=typeof an.media&&"image"==an.media,isRP="undefined"!=typeof rp,isSource=!1,source=osda.viewer.source,tilesUrl="undefined"!=typeof source.tilesUrl?source.tilesUrl:"",functionUrl="undefined"!=typeof source.getTileUrl?source.getTileUrl:"",compareUrl=""!=tilesUrl?tilesUrl:(""+functionUrl).replace(/\s+/g," ");return isContainer&&(isSource=an.target.src==compareUrl),isOpenSeaDragon&&isContainer&&isImage&&isRP&&isSource},OpenSeaDragon.prototype._deleteAnnotation=function(an){var annotations=this.annotator.plugins.Store.annotations;annotations.indexOf(an)>-1&&annotations.splice(annotations.indexOf(an),1),this.annotator.osda.refreshDisplay()},OpenSeaDragon.prototype.initListeners=function(){function annotationEditorHidden(){EditOpenSeaDragonAn()&&(annotator.osda._reset(),annotator.osda.refreshDisplay()),annotator.editor.OpenSeaDragon=-1,annotator.unsubscribe("annotationEditorHidden",annotationEditorHidden)}function annotationEditorShown(editor,annotation){annotator.osda.editAnnotation(annotation,editor),annotator.subscribe("annotationEditorHidden",annotationEditorHidden)}function annotationDeleted(annotation){isOpenSeaDragon(annotation)&&self._deleteAnnotation(annotation)}function hideViewer(){jQuery(annotator.osda.viewer.canvas.parentNode).find(".annotator-hl").map(function(){return this.style.background="rgba(0, 0, 0, 0)"}),annotator.viewer.unsubscribe("hide",hideViewer)}function annotationViewerShown(viewer){var wrapper=jQuery(".annotator-wrapper").offset(),startPoint={x:parseFloat(viewer.element[0].style.left),y:parseFloat(viewer.element[0].style.top)},separation=viewer.element.hasClass(viewer.classes.invert.y)?5:-5,newpos={top:startPoint.y-wrapper.top+separation,left:startPoint.x-wrapper.left};viewer.element.css(newpos),viewer.element.find(".annotator-controls").removeClass(viewer.classes.showControls),annotator.viewer.subscribe("hide",hideViewer)}var wrapper=$(".annotator-wrapper").parent()[0],annotator=$.data(wrapper,"annotator"),EditOpenSeaDragonAn=this.EditOpenSeaDragonAn,isOpenSeaDragon=this.isOpenSeaDragon,self=this;annotator.subscribe("annotationEditorShown",annotationEditorShown).subscribe("annotationDeleted",annotationDeleted).subscribe("annotationViewerShown",annotationViewerShown)},OpenSeaDragon}(Annotator.Plugin),OpenSeadragonAnnotation="OpenSeadragonAnnotation"in window?OpenSeadragonAnnotation:{},OpenSeadragonAnnotation=function(element,options){function reloadEditor(){tinymce.EditorManager.execCommand("mceRemoveEditor",!0,"annotator-field-0"),tinymce.EditorManager.execCommand("mceAddEditor",!0,"annotator-field-0"),annotator.editor.hide()}var $=jQuery,options=options||{};options.optionsOpenSeadragon=options.optionsOpenSeadragon||{},options.optionsOSDA=options.optionsOSDA||{},options.optionsAnnotator=options.optionsAnnotator||{},"undefined"==typeof options.optionsAnnotator.store&&(options.optionsAnnotator.store={});var store=options.optionsAnnotator.store;if("undefined"==typeof store.annotationData&&(store.annotationData={}),"undefined"==typeof store.annotationData.uri){var uri=location.protocol+"//"+location.host+location.pathname;store.annotationData.store={uri:uri}}"undefined"==typeof store.loadFromSearch&&(store.loadFromSearch={}),"undefined"==typeof store.loadFromSearch.uri&&(store.loadFromSearch.uri=uri),"undefined"==typeof store.loadFromSearch.limit&&(store.loadFromSearch.limit=1e4),this.currentUser=null,this.annotator=$(element).annotator(options.optionsAnnotator.annotator).data("annotator"),"undefined"!=typeof options.optionsAnnotator.auth&&this.annotator.addPlugin("Auth",options.optionsAnnotator.auth),"undefined"!=typeof options.optionsAnnotator.permissions&&this.annotator.addPlugin("Permissions",options.optionsAnnotator.permissions),"undefined"!=typeof options.optionsAnnotator.store&&this.annotator.addPlugin("Store",options.optionsAnnotator.store),"function"==typeof Annotator.Plugin.Geolocation&&this.annotator.addPlugin("Geolocation",options.optionsAnnotator.geolocation),"function"==typeof Annotator.Plugin.Share&&this.annotator.addPlugin("Share",options.optionsAnnotator.share),"function"==typeof Annotator.Plugin.RichText&&this.annotator.addPlugin("RichText",options.optionsAnnotator.richText),"function"==typeof Annotator.Plugin.Reply&&this.annotator.addPlugin("Reply"),"function"==typeof Annotator.Plugin.OpenSeaDragon&&this.annotator.addPlugin("OpenSeaDragon"),"function"==typeof Annotator.Plugin.Flagging&&this.annotator.addPlugin("Flagging"),"function"==typeof Annotator.Plugin.HighlightTags&&this.annotator.addPlugin("HighlightTags",options.optionsAnnotator.highlightTags),this.viewer=OpenSeadragon(options.optionsOpenSeadragon),this.viewer.annotation(options.optionsOSDA),this.annotator.editor.OpenSeaDragon=-1,this.annotator.osda=this;return document.addEventListener("fullscreenchange",function(){reloadEditor()},!1),document.addEventListener("mozfullscreenchange",function(){reloadEditor()},!1),document.addEventListener("webkitfullscreenchange",function(){reloadEditor()},!1),document.addEventListener("msfullscreenchange",function(){reloadEditor()},!1),$(document).keyup(function(e){27==e.keyCode&&reloadEditor()}),this.options=options,this};var _ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},createDateFromISO8601=function(string){var d,date,offset,regexp,time,_ref;return regexp="([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(\\.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?",d=string.match(new RegExp(regexp)),offset=0,date=new Date(d[1],0,1),d[3]&&date.setMonth(d[3]-1),d[5]&&date.setDate(d[5]),d[7]&&date.setHours(d[7]),d[8]&&date.setMinutes(d[8]),d[10]&&date.setSeconds(d[10]),d[12]&&date.setMilliseconds(1e3*Number("0."+d[12])),d[14]&&(offset=60*Number(d[16])+Number(d[17]),offset*=null!=(_ref="-"===d[15])?_ref:{1:-1}),offset-=date.getTimezoneOffset(),time=Number(date)+60*offset*1e3,date.setTime(Number(time)),date},Util="undefined"!=typeof Util?Util:{};Util.mousePosition=function(e,offsetEl){var offset,_ref1;return"absolute"!==(_ref1=$(offsetEl).css("position"))&&"fixed"!==_ref1&&"relative"!==_ref1&&(offsetEl=$(offsetEl).offsetParent()[0]),offset=$(offsetEl).offset(),{top:e.pageY-offset.top,left:e.pageX-offset.left}},function(){function vjsAnnotation_(options){function initialVideoFinished(event){var wrapper=$(".annotator-wrapper").parent()[0],annotator=$.data(wrapper,"annotator");if("function"==typeof Annotator.Plugin.Share){if("undefined"==typeof annotator.isShareLoaded||!annotator.isShareLoaded)return annotator.subscribe("shareloaded",initialVideoFinished),!1;annotator.unsubscribe("shareloaded",initialVideoFinished)}var plugin=player.annotations;for(var index in plugin.components)plugin.components[index].init_();player.annotations.BigNewAn.show(),plugin.setposBigNew(plugin.options.posBigNew),options.showDisplay||plugin.hideDisplay(),options.showStatistics||plugin.hideStatistics(),player.annotator=annotator,plugin.annotator=annotator;annotator.plugins.Store.annotations;if(plugin.refreshDisplay(),player.rangeslider.rstb.on("mousedown",function(){plugin._onMouseDownRS(event)}),player.autoPlayAPI){var OnePlay=function(){player.annotations.showAnnotation(player.autoPlayAPI),$("html, body").animate({scrollTop:$("#"+player.id_).offset().top},"slow")};"Youtube"==player.techName?setTimeout(OnePlay,100):OnePlay()}plugin.refreshDesignPanel(),player.on("fullscreenchange",function(){player.isFullScreen?$(player.annotator.wrapper[0]).addClass("vjs-fullscreen"):$(player.annotator.wrapper[0]).removeClass("vjs-fullscreen"),plugin.refreshDesignPanel()}),plugin.loaded=!0}var player=this;player.annotations=new vjsAnnotation(player,options),player.one("loadedRangeSlider",initialVideoFinished),console.log("Loaded Annotation Plugin")}function vjsAnnotation(player,options){var player=player||this;this.player=player,this.components={},options=options||{},options.hasOwnProperty("posBigNew")||(options.posBigNew="none"),options.hasOwnProperty("showDisplay")||(options.showDisplay=!1),options.hasOwnProperty("showStatistics")||(options.showStatistics=!1),this.options=options,this.init()}videojs.plugin("annotations",vjsAnnotation_),vjsAnnotation.prototype={init:function(){{var player=this.player||{},controlBar=player.controlBar;player.controlBar.progressControl.seekBar}this.updatePrecision=3,this.BigNewAn=this.components.BigNewAnnotation=player.BigNewAnnotation,this.AnConBut=this.components.AnContainerButtons=controlBar.AnContainerButtons,this.ShowSt=this.components.ShowStatistics=this.AnConBut.ShowStatistics,this.NewAn=this.components.NewAnnotation=this.AnConBut.NewAnnotation,this.ShowAn=this.components.ShowAnnotations=this.AnConBut.ShowAnnotations,this.BackAnDisplay=this.components.BackAnDisplay=controlBar.BackAnDisplay,this.AnDisplay=this.components.AnDisplay=controlBar.BackAnDisplay.AnDisplay,this.AnStat=this.components.AnStat=controlBar.BackAnDisplay.AnStat,this.BackAnDisplayScroll=this.components.BackAnDisplayScroll=controlBar.BackAnDisplayScroll,this.backDSBar=this.components.BackAnDisplayScrollBar=this.BackAnDisplayScroll.BackAnDisplayScrollBar,this.backDSBarSel=this.components.ScrollBarSelector=this.backDSBar.ScrollBarSelector,this.backDSTime=this.components.BackAnDisplayScrollTime=this.BackAnDisplayScroll.BackAnDisplayScrollTime,this.rsd=this.components.RangeSelectorDisplay=controlBar.BackAnDisplay.RangeSelectorDisplay,this.rsdl=this.components.RangeSelectorLeft=this.rsd.RangeSelectorLeft,this.rsdr=this.components.RangeSelectorRight=this.rsd.RangeSelectorRight,this.rsdb=this.components.RangeSelectorBar=this.rsd.RangeSelectorBar,this.rsdbl=this.components.RangeSelectorBarL=this.rsdb.RangeSelectorBarL,this.rsdbr=this.components.RangeSelectorBarR=this.rsdb.RangeSelectorBarR,this.rs=player.rangeslider,this.editing=!1;var wrapper=$(".annotator-wrapper").parent()[0],annotator=$.data(wrapper,"annotator"),self=this;annotator.subscribe("annotationsLoaded",function(){self.loaded&&self.refreshDisplay()}),annotator.subscribe("annotationUpdated",function(){self.loaded&&self.refreshDisplay()}),annotator.subscribe("annotationDeleted",function(){var annotations=annotator.plugins.Store.annotations,tot="undefined"!=typeof annotations?annotations.length:0,attempts=0,ischanged=function(){var new_tot=annotator.plugins.Store.annotations.length;100>attempts&&setTimeout(function(){new_tot!==tot?self.loaded&&self.refreshDisplay():(attempts++,ischanged())},100)};ischanged()}),this.BigNewAn.hide()},newan:function(start,end){var player=this.player,annotator=this.annotator,sumPercent=10,currentTime=player.currentTime(),lastTime=this._sumPercent(currentTime,sumPercent),start="undefined"!=typeof start?start:currentTime,end="undefined"!=typeof end?end:lastTime;this._reset(),player.showSlider(),player.pause(),player.setValueSlider(start,end),annotator.editor.VideoJS=this.player.id_,annotator.adder.show(),this._setOverRS(annotator.adder),annotator.onAdderClick()},showDisplay:function(){this._reset(),this.BackAnDisplay.removeClass("disable"),this.BackAnDisplayScroll.removeClass("disable"),this.ShowAn.addClass("active"),this.options.showDisplay=!0},hideDisplay:function(){this.BackAnDisplay.addClass("disable"),this.BackAnDisplayScroll.addClass("disable"),videojs.removeClass(this.ShowAn.el_,"active"),this.options.showDisplay=!1},showStatistics:function(){this._reset(),this.BackAnDisplay.removeClass("disable"),this.AnStat.removeClass("disable"),this.BackAnDisplay.addClass("statistics"),this.AnStat.paintCanvas(),this.ShowSt.addClass("active"),this.options.showStatistics=!0},hideStatistics:function(){this.BackAnDisplay.addClass("disable"),this.AnStat.addClass("disable"),this.BackAnDisplay.removeClass("statistics"),this.ShowSt.removeClass("active"),this.options.showStatistics=!1},showAnnotation:function(annotation){var isVideo=this._isVideoJS(annotation);if(isVideo){var start=annotation.rangeTime.start,end=annotation.rangeTime.end,duration=this.player.duration(),isPoint=videojs.round(start,3)==videojs.round(end,3);this._reset(),this.rs.show(),this.rs.setValues(start,end),this.rs.lock(),isPoint||this.rs.playBetween(start,end);var width=100*Math.min(1,Math.max(.005,this.rs._percent(end-start)));this.rs.bar.el_.style.width=width+"%";var bar=isPoint?this.rs[.1>(duration-start)/duration?"left":"right"].el_:this.rs.bar.el_,holder=$(this.rs.left.el_).parent()[0];$(holder).append('<span class="annotator-hl"></div>'),$(bar).appendTo($(holder).find(".annotator-hl"));var span=$(bar).parent()[0];$.data(span,"annotation",annotation),this._setOverRS(this.annotator.editor.element),this.annotator.editor.checkOrientation(),this.rs.hidePanel()}},hideAnnotation:function(){this.rs.hide(),this.rs.showPanel();var holder=$(this.rs.left.el_).parent()[0],holderRight=$(this.rs.right.el_).parent()[0];$(holder).find(".annotator-hl").length>0?($($(holder).find(".annotator-hl")[0].children[0]).appendTo(holder),$(holder).find(".annotator-hl").remove()):$(holderRight).find(".annotator-hl").length>0&&($($(holderRight).find(".annotator-hl")[0].children[0]).appendTo(holderRight),$(holderRight).find(".annotator-hl").remove())},editAnnotation:function(annotation,editor){if(this._isVideoJS(annotation)){this.hideDisplay();var player=this.player,editor=editor||this.annotator.editor;player.showSlider(),player.unlockSlider(),player.setValueSlider(annotation.rangeTime.start,annotation.rangeTime.end),player.showSliderPanel(),this._setOverRS(editor.element),editor.checkOrientation(),editor.VideoJS=player.id_}},refreshDisplay:function(){var count=0,allannotations=this.annotator.plugins.Store.annotations;this._sortByDate(allannotations),$(this.AnDisplay.el_).find("span").remove(),$(this.player.el_).find(".vjs-anpanel-annotation .annotation").remove();
for(var item in allannotations){var an=allannotations[item];if(this._isVideoJS(an)){var width,div=document.createElement("div"),span=document.createElement("span"),start=100*this.rs._percent(an.rangeTime.start),end=100*this.rs._percent(an.rangeTime.end);span.appendChild(div),span.className="annotator-hl",width=Math.min(100,Math.max(.2,end-start)),div.className="annotation",div.id=count,div.style.top=count+"em",div.style.left=start+"%",div.style.width=width+"%",div.start=an.rangeTime.start,div.end=an.rangeTime.end,this.AnDisplay.el_.appendChild(span),videojs.round(start,0)==videojs.round(end,0)&&($(div).css("width",""),$(div).addClass("point")),$.data(span,"annotation",an),an.highlights=$(span),count++}}var start=this.rs._seconds(parseFloat(this.rsdl.el_.style.left)/100),end=this.rs._seconds(parseFloat(this.rsdr.el_.style.left)/100);this.showBetween(start,end,this.rsdl.include,this.rsdr.include)},showBetween:function(start,end,includeLeft,includeRight){var duration=this.player.duration(),start=start||0,end=end||duration,annotationsHTML=$.makeArray($(this.player.el_).find(".vjs-anpanel-annotation .annotator-hl")),count=0;for(var index in annotationsHTML){var an=$.data(annotationsHTML[index],"annotation"),expressionLeft=includeLeft?an.rangeTime.end>=start:an.rangeTime.start>=start,expressionRight=includeRight?an.rangeTime.start<=end:an.rangeTime.end<=end;if(this._isVideoJS(an)&&expressionLeft&&expressionRight&&"undefined"!=typeof an.highlights[0]){var annotationHTML=an.highlights[0].children[0];annotationHTML.style.marginTop=-1*parseFloat(annotationHTML.style.top)+count+"em",$(an.highlights[0]).show(),count++}else this._isVideoJS(an)&&"undefined"!=typeof an.highlights[0]&&($(an.highlights[0]).hide(),an.highlights[0].children[0].style.marginTop="")}this.backDSTime.setTimes()},setposBigNew:function(pos){var pos=pos||"ul",el=this.player.BigNewAnnotation.el_;videojs.removeClass(el,"ul"),videojs.removeClass(el,"ur"),videojs.removeClass(el,"c"),videojs.removeClass(el,"bl"),videojs.removeClass(el,"br"),videojs.addClass(el,pos)},pressedKey:function(key){{var player=this.player;this.player.rs}if("undefined"!=typeof key&&73==key)this._reset(),this.rs.show(),this.rs._reset(),this.rs.setValue(0,player.currentTime()),this.rs.right.el_.style.visibility="hidden",this.rs.tpr.el_.style.visibility="hidden",this.rs.ctpr.el_.style.visibility="hidden",this.rs.bar.el_.style.visibility="hidden",this.lastStartbyKey=player.currentTime();else if("undefined"!=typeof key&&79==key)if("hidden"==this.rs.bar.el_.style.visibility){var start="undefined"!=this.lastStartbyKey?this.lastStartbyKey:0;this.newan(start,player.currentTime())}else this.newan(player.currentTime(),player.currentTime())},refreshDesignPanel:function(){var player=this.player,emtoPx=parseFloat($(this.backDSBar.el_).css("width")),playerHeight=parseFloat($(player.el_).css("height")),controlBarHeight=parseFloat($(player.controlBar.el_).css("height")),newHeight=(playerHeight-controlBarHeight)/emtoPx-5;this.BackAnDisplay.el_.style.height=this.backDSBar.el_.style.height=newHeight+"em",this.BackAnDisplay.el_.style.top=this.backDSBar.el_.style.top="-"+(newHeight+3+"em"),this.BackAnDisplayScroll.el_.children[0].style.top="-"+(newHeight+5+"em"),this.backDSTime.el_.children[0].style.top="-"+(newHeight+5+"em")},_reset:function(){this.hideDisplay(),this.hideAnnotation(),this.hideStatistics(),this.player.annotator.adder.hide(),this.player.annotator.editor.hide(),this.player.annotator.viewer.hide(),this.rs.right.el_.style.visibility="",this.rs.tpr.el_.style.visibility="",this.rs.ctpr.el_.style.visibility="",this.rs.bar.el_.style.visibility="",this.rs.unlock(),this.rs.bar.suspendPlay(),this.refreshDesignPanel()},_setOverRS:function(elem){var wrapper=(this.player.annotator,$(".annotator-wrapper")[0]),positionLeft=videojs.findPosition(this.rs.left.el_),positionRight=videojs.findPosition(this.rs.right.el_),positionAnnotator=videojs.findPosition(wrapper),positionAdder={};elem[0].style.display="block",this.player.isFullScreen?(positionAdder.top=positionLeft.top,positionAdder.left=positionLeft.left+(positionRight.left-positionLeft.left)/2):(positionAdder.left=positionLeft.left+(positionRight.left-positionLeft.left)/2-positionAnnotator.left,positionAdder.top=positionLeft.top-positionAnnotator.top),elem.css(positionAdder)},_onMouseDownRS:function(event){event.preventDefault(),this.rs.options.locked||(videojs.on(document,"mousemove",videojs.bind(this,this._onMouseMoveRS)),videojs.on(document,"mouseup",videojs.bind(this,this._onMouseUpRS)))},_onMouseMoveRS:function(){var player=this.player,annotator=player.annotator,rs=player.rangeslider;annotator.editor.element[0].style.display="none",rs.show(),this._setOverRS(annotator.adder)},_onMouseUpRS:function(){videojs.off(document,"mousemove",this._onMouseMoveRS,!1),videojs.off(document,"mouseup",this._onMouseUpRS,!1);{var player=this.player,annotator=player.annotator;player.rangeslider}annotator.editor.element[0].style.display="block",this._setOverRS(annotator.editor.element)},_sumPercent:function(seconds,percent){var duration=this.player.duration(),seconds=seconds||0,percent=percent||10;return percent=Math.min(100,Math.max(0,percent)),isNaN(duration)?0:Math.min(duration,Math.max(0,seconds+duration*percent/100))},_EditVideoAn:function(){var annotator=this.annotator,isOpenVideojs="undefined"!=typeof this.player,VideoJS=annotator.editor.VideoJS;return isOpenVideojs&&"undefined"!=typeof VideoJS&&-1!==VideoJS},_isVideoJS:function(an){var player=this.player,rt=an.rangeTime,isOpenVideojs="undefined"!=typeof this.player,isVideo="undefined"!=typeof an.media&&("video"===an.media||"audio"===an.media),isContainer="undefined"!=typeof an.target&&an.target.container==player.id_,isNumber="undefined"!=typeof rt&&!isNaN(parseFloat(rt.start))&&isFinite(rt.start)&&!isNaN(parseFloat(rt.end))&&isFinite(rt.end),isSource=!1;if(isContainer){var isYoutube=isOpenVideojs&&"undefined"!=typeof this.player.techName?"Youtube"===this.player.techName:!1,targetSrc=isYoutube?an.target.src:an.target.src.substring(0,an.target.src.lastIndexOf(".")),playerSrc=isYoutube?player.options_.sources[0].src:player.options_.sources[0].src.substring(0,player.options_.sources[0].src.lastIndexOf("."));isSource=targetSrc===playerSrc}return isOpenVideojs&&isVideo&&isContainer&&isSource&&isNumber},_sortByDate:function(annotations,type){var type=type||"asc";annotations.sort(function(a,b){return a=new Date("undefined"!=typeof a.updated?createDateFromISO8601(a.updated):""),b=new Date("undefined"!=typeof b.updated?createDateFromISO8601(b.updated):""),"asc"==type?a>b?-1:b>a?1:0:b>a?-1:a>b?1:0})}},videojs.ControlBar.prototype.options_.children.AnContainerButtons={},videojs.ControlBar.prototype.options_.children.BackAnDisplay={},videojs.ControlBar.prototype.options_.children.BackAnDisplayScroll={},videojs.options.children.BigNewAnnotation={},videojs.BigNewAnnotation=videojs.Button.extend({init:function(player,options){videojs.Button.call(this,player,options)}}),videojs.BigNewAnnotation.prototype.init_=function(){this.an=this.player_.annotations;var opts=this.an.options.optionsAnnotator;"undefined"!=typeof opts&&"undefined"!=typeof opts.readOnly&&opts.readOnly&&this.hide()},videojs.BigNewAnnotation.prototype.createEl=function(){return videojs.Button.prototype.createEl.call(this,"div",{className:"vjs-big-new-annotation vjs-menu-button vjs-control",innerHTML:'<div class="vjs-big-menu-button vjs-control">A</div>',title:"New Annotation"})},videojs.BigNewAnnotation.prototype.onClick=function(){this.an.newan()},videojs.AnContainerButtons=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options)}}),videojs.AnContainerButtons.prototype.init_=function(){},videojs.AnContainerButtons.prototype.options_={children:{ShowStatistics:{},ShowAnnotations:{},NewAnnotation:{}}},videojs.AnContainerButtons.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-container-button-annotation vjs-menu-button vjs-control"})},videojs.ShowStatistics=videojs.Button.extend({init:function(player,options){videojs.Button.call(this,player,options)}}),videojs.ShowStatistics.prototype.init_=function(){this.an=this.player_.annotations},videojs.ShowStatistics.prototype.createEl=function(){return videojs.Button.prototype.createEl.call(this,"div",{className:"vjs-statistics-annotation vjs-menu-button vjs-control",title:"Show the Statistics"})},videojs.ShowStatistics.prototype.onClick=function(){this.an.options.showStatistics?this.an.hideStatistics():this.an.showStatistics()},videojs.ShowAnnotations=videojs.Button.extend({init:function(player,options){videojs.Button.call(this,player,options)}}),videojs.ShowAnnotations.prototype.init_=function(){this.an=this.player_.annotations},videojs.ShowAnnotations.prototype.createEl=function(){return videojs.Button.prototype.createEl.call(this,"div",{className:"vjs-showannotations-annotation vjs-menu-button vjs-control",title:"Show Annotations"})},videojs.ShowAnnotations.prototype.onClick=function(){this.an.options.showDisplay?this.an.hideDisplay():this.an.showDisplay()},videojs.NewAnnotation=videojs.Button.extend({init:function(player,options){videojs.Button.call(this,player,options)}}),videojs.NewAnnotation.prototype.init_=function(){this.an=this.player_.annotations;var opts=this.an.options.optionsAnnotator;"undefined"!=typeof opts&&"undefined"!=typeof opts.readOnly&&opts.readOnly&&this.hide()},videojs.NewAnnotation.prototype.createEl=function(){return videojs.Button.prototype.createEl.call(this,"div",{className:"vjs-new-annotation vjs-menu-button vjs-control",title:"New Annotation"})},videojs.NewAnnotation.prototype.onClick=function(){this.an.newan()},videojs.BackAnDisplay=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options)}}),videojs.BackAnDisplay.prototype.init_=function(){this.an=this.player_.annotations,self=this,$(this.el_).watch("font-size",function(){self.an.backDSBarSel.setPosition(self.an.BackAnDisplayScroll.currentValue,!1)})},videojs.BackAnDisplay.prototype.options_={children:{RangeSelectorDisplay:{},AnDisplay:{},AnStat:{}}},videojs.BackAnDisplay.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-back-anpanel-annotation"})},videojs.RangeSelectorDisplay=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options),this.on("mousedown",this.onMouseDown)}}),videojs.RangeSelectorDisplay.prototype.init_=function(){this.rs=this.player_.rangeslider,this.an=this.player_.annotations;var duration=this.an.player.duration();this.start=0,this.end=duration,this.setPosition(0,0,!1),this.setPosition(1,this.rs._percent(duration),!1)},videojs.RangeSelectorDisplay.prototype.options_={children:{RangeSelectorLeft:{},RangeSelectorRight:{},RangeSelectorBar:{}}},videojs.RangeSelectorDisplay.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-rangeselector-anpanel-annotation"})},videojs.RangeSelectorDisplay.prototype.onMouseDown=function(event){event.preventDefault(),videojs.on(document,"mousemove",videojs.bind(this,this.onMouseMove)),videojs.on(document,"mouseup",videojs.bind(this,this.onMouseUp)),videojs.removeClass(this.an.rsdb.el_,"disable")},videojs.RangeSelectorDisplay.prototype.onMouseUp=function(){videojs.off(document,"mousemove",this.onMouseMove,!1),videojs.off(document,"mouseup",this.onMouseUp,!1),videojs.addClass(this.an.rsdb.el_,"disable")},videojs.RangeSelectorDisplay.prototype.onMouseMove=function(event){var left=this.calculateDistance(event);this.an.rsdl.pressed?this.setPosition(0,left):this.an.rsdr.pressed&&this.setPosition(1,left),this.an.player.currentTime(this.rs._seconds(left))},videojs.RangeSelectorDisplay.prototype.calculateDistance=function(event){var rstbX=this.getRSTBX(),rstbW=this.getRSTBWidth(),handleW=this.getWidth();return rstbX+=handleW/2,rstbW-=handleW,Math.max(0,Math.min(1,(event.pageX-rstbX)/rstbW))},videojs.RangeSelectorDisplay.prototype.getRSTBWidth=function(){return this.el_.offsetWidth},videojs.RangeSelectorDisplay.prototype.getRSTBX=function(){return videojs.findPosition(this.el_).left},videojs.RangeSelectorDisplay.prototype.getWidth=function(){var arrow=$(this.an.rsdl.el_).find(".vjs-selector-arrow")[0];return arrow.offsetWidth},videojs.RangeSelectorDisplay.prototype.setPosition=function(index,left,changeTime){var index=index||0,changeTime="undefined"!=typeof changeTime?changeTime:!0;if(isNaN(left))return!1;if(0!==index&&1!==index)return!1;var ObjLeft=this.an.rsdl.el_,ObjRight=this.an.rsdr.el_,Obj=this.an[0===index?"rsdl":"rsdr"].el_;if(0===index?this.updateLeft(left):this.updateRight(left)){1===index?(Obj.style.left=100*left+"%",Obj.style.width=100*(1-left)+"%"):(Obj.style.left=100*left+"%",Obj.style.width=100*left+"%"),this[0===index?"start":"end"]=this.rs._seconds(left),$(ObjLeft).find(".vjs-selector-arrow")[0].style.zIndex=0===index&&100*left>=90?25:10;var rsdbl=this.an.rsdbl.el_,rsdbr=this.an.rsdbr.el_,distance=parseFloat(ObjRight.style.left)-parseFloat(ObjLeft.style.left);0===index?rsdbl.children[0].innerHTML=videojs.formatTime(this.rs._seconds(left)):rsdbr.children[0].innerHTML=videojs.formatTime(this.rs._seconds(left)),"undefined"!=typeof distance&&12.5>=distance?(parseFloat(ObjLeft.style.left)<7?(rsdbl.style.top="-1.5em",rsdbl.style.left="1em"):(rsdbl.style.left="-2.5em",rsdbl.style.top=""),parseFloat(ObjRight.style.left)>93?(rsdbr.style.top="-1.5em",rsdbr.style.right="1em"):(rsdbr.style.right="-2.5em",rsdbr.style.top="")):(rsdbl.style.left="1em",rsdbr.style.right="1em",rsdbl.style.top="",rsdbr.style.top="");var start=this.rs._seconds(parseFloat(ObjLeft.style.left)/100),end=this.rs._seconds(parseFloat(ObjRight.style.left)/100);changeTime&&this.an.showBetween(start,end,this.an.rsdl.include,this.an.rsdr.include)}return!0},videojs.RangeSelectorDisplay.prototype.updateLeft=function(left){var rightVal=""!==this.an.rsdr.el_.style.left?this.an.rsdr.el_.style.left:100,right=parseFloat(rightVal)/100,bar=this.an.rsdb.el_,width=videojs.round(right-left,this.an.updatePrecision);return right+1e-5>=left?(bar.style.left=100*left+"%",bar.style.width=100*width+"%",!0):!1},videojs.RangeSelectorDisplay.prototype.updateRight=function(right){var leftVal=""!==this.an.rsdl.el_.style.left?this.an.rsdl.el_.style.left:0,left=parseFloat(leftVal)/100,bar=this.an.rsdb.el_,width=videojs.round(right-left,this.an.updatePrecision);return right+1e-5>=left?(bar.style.width=100*width+"%",bar.style.left=100*(right-width)+"%",!0):!1},videojs.RangeSelectorLeft=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options),this.on("mousedown",this.onMouseDown),this.on("dblclick",this.ondblclick),this.pressed=!1,this.include=!0}}),videojs.RangeSelectorLeft.prototype.init_=function(){this.rs=this.player_.rangeslider,this.an=this.player_.annotations,videojs.addClass(this.el_,"include")},videojs.RangeSelectorLeft.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-leftselector-anpanel-annotation",innerHTML:'<div class="vjs-selector-arrow" title="Left Annotation Selector"></div><div class="vjs-leftselector-back"></div>'})},videojs.RangeSelectorLeft.prototype.onMouseDown=function(event){event.preventDefault(),this.pressed=!0,videojs.on(document,"mouseup",videojs.bind(this,this.onMouseUp)),videojs.addClass(this.el_,"active"),videojs.addClass(this.el_.parentNode,"active")},videojs.RangeSelectorLeft.prototype.onMouseUp=function(){videojs.off(document,"mouseup",this.onMouseUp,!1),videojs.removeClass(this.el_,"active"),videojs.removeClass(this.el_.parentNode,"active"),this.pressed=!1},videojs.RangeSelectorLeft.prototype.ondblclick=function(event){this.include?(this.include=!1,videojs.removeClass(this.el_,"include")):(this.include=!0,videojs.addClass(this.el_,"include"));var left=this.an.rsd.calculateDistance(event);this.an.rsd.setPosition(0,left)},videojs.RangeSelectorRight=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options),this.on("mousedown",this.onMouseDown),this.on("dblclick",this.ondblclick),this.pressed=!1,this.include=!0}}),videojs.RangeSelectorRight.prototype.init_=function(){this.rs=this.player_.rangeslider,this.an=this.player_.annotations,videojs.addClass(this.el_,"include")},videojs.RangeSelectorRight.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-rightselector-anpanel-annotation",innerHTML:'<div class="vjs-selector-arrow" title="Right Annotation Selector"></div><div class="vjs-rightselector-back"></div>'})},videojs.RangeSelectorRight.prototype.onMouseDown=function(event){event.preventDefault(),this.pressed=!0,videojs.on(document,"mouseup",videojs.bind(this,this.onMouseUp)),videojs.addClass(this.el_,"active"),videojs.addClass(this.el_.parentNode,"active")},videojs.RangeSelectorRight.prototype.onMouseUp=function(){videojs.off(document,"mouseup",this.onMouseUp,!1),videojs.removeClass(this.el_,"active"),videojs.removeClass(this.el_.parentNode,"active"),this.pressed=!1},videojs.RangeSelectorRight.prototype.ondblclick=function(event){this.include?(this.include=!1,videojs.removeClass(this.el_,"include")):(this.include=!0,videojs.addClass(this.el_,"include"));var left=this.an.rsd.calculateDistance(event);this.an.rsd.setPosition(1,left)},videojs.RangeSelectorBar=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options)}}),videojs.RangeSelectorBar.prototype.init_=function(){videojs.addClass(this.el_,"disable")},videojs.RangeSelectorBar.prototype.options_={children:{RangeSelectorBarL:{},RangeSelectorBarR:{}}},videojs.RangeSelectorBar.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-barselector-anpanel-annotation"})},videojs.RangeSelectorBarL=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options)}}),videojs.RangeSelectorBarL.prototype.init_=function(){},videojs.RangeSelectorBarL.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-barselector-left",innerHTML:'<span class="vjs-time-text">00:00</span>'})},videojs.RangeSelectorBarR=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options)}}),videojs.RangeSelectorBarR.prototype.init_=function(){},videojs.RangeSelectorBarR.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-barselector-right",innerHTML:'<span class="vjs-time-text">00:00</span>'})},videojs.AnDisplay=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options),this.on("mousedown",this.onMouseDown),this.on("mouseover",this.onMouseOver)}}),videojs.AnDisplay.prototype.init_=function(){this.rs=this.player_.rangeslider,this.an=this.player_.annotations,this.transition=!1},videojs.AnDisplay.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-anpanel-annotation"})},videojs.AnDisplay.prototype.onMouseDown=function(event){var elem=$(event.target).parents(".annotator-hl").andSelf();if(elem.hasClass("annotator-hl")){videojs.on(document,"mouseup",videojs.bind(this,this.onMouseUp));var boxup=document.createElement("div"),ElemTop=parseFloat(elem[1].style.top),ElemMargin=parseFloat(elem[1].style.marginTop),emtoPx=parseFloat($(elem[1]).css("height")),isPoint=$(elem[1]).hasClass("point");boxup.className=isPoint?"boxup-dashed-line point":"boxup-dashed-line",boxup.style.left=elem[1].style.left,boxup.style.width=elem[1].style.width,boxup.style.top=ElemTop+ElemMargin-this.el_.scrollTop/emtoPx+"em",elem[0].parentNode.parentNode.appendChild(boxup)}},videojs.AnDisplay.prototype.onMouseUp=function(){if("undefined"==typeof this.lastelem)return!1;var elem=this.lastelem,_self=this;if(elem.hasClass("annotator-hl")){{var annotation=elem.map(function(){return $(this).data("annotation")})[0],displayHeight=-1*parseFloat($(this.el_).parent()[0].style.top);parseFloat($(elem[1]).css("height"))}"undefined"!=typeof $(elem).parent().parent().find(".boxup-dashed-line")[0]&&($(elem).parent().parent().find(".boxup-dashed-line")[0].style.top=displayHeight-2+"em"),this.an.player.pause(),this.transition=!0,window.setTimeout(function(){_self.an.showAnnotation(annotation),_self.transition=!1,_self.onCloseViewer()},900)}videojs.off(document,"mouseup",this.onMouseUp,!1)},videojs.AnDisplay.prototype.onMouseOver=function(event){if(!this.transition&&!this.an.rsdl.pressed&&!this.an.rsdr.pressed){var annotator=this.an.annotator,elem=$(event.target).parents(".annotator-hl").andSelf();if("undefined"!=typeof annotator&&annotator.viewer.isShown()&&elem.hasClass("annotator-hl")){annotator.viewer.hide();var annotations=elem.map(function(){return $(this).data("annotation")});annotator.showViewer($.makeArray(annotations),Util.mousePosition(event,annotator.wrapper[0]))}if(elem.addClass("active"),"undefined"!=typeof elem&&$(elem[1]).hasClass("annotation")){var dashed=document.createElement("div"),boxdown=document.createElement("div"),DisplayHeight=parseFloat(this.an.BackAnDisplay.el_.style.height),ElemMarginTop=""!==elem[1].style.marginTop?parseFloat(elem[1].style.marginTop):0,ElemTop=parseFloat(elem[1].style.top)+ElemMarginTop,emtoPx=parseFloat($(elem[1]).css("height")),isPoint=$(elem[1]).hasClass("point");dashed.className=isPoint?"dashed-line point":"dashed-line",boxdown.className="box-dashed-line",dashed.style.left=boxdown.style.left=elem[1].style.left,dashed.style.width=boxdown.style.width=isPoint?"0":elem[1].style.width,dashed.style.top=ElemTop+1-this.el_.scrollTop/emtoPx+"em",dashed.style.height=DisplayHeight-ElemTop+2+this.el_.scrollTop/emtoPx+"em",boxdown.style.top=DisplayHeight+2+"em",elem[0].parentNode.parentNode.appendChild(dashed),elem[0].parentNode.parentNode.appendChild(boxdown),$(this.player).find(".vjs-play-progress").css("z-index",2),$(this.player).find(".vjs-seek-handle").css("z-index",2)}elem.hasClass("annotator-hl")&&(this.lastelem=elem)}},videojs.AnDisplay.prototype.onCloseViewer=function(){this.transition||("undefined"!=typeof this.lastelem&&this.lastelem.removeClass("active"),"undefined"!=typeof this.lastelem&&this.lastelem.hasClass("annotator-hl")&&($(this.lastelem).parent().parent().find(".dashed-line").remove(),$(this.lastelem).parent().parent().find(".box-dashed-line").remove(),$(this.lastelem).parent().parent().find(".boxup-dashed-line").remove(),$(this.player).find(".vjs-play-progress").css("z-index",""),$(this.player).find(".vjs-seek-handle").css("z-index","")))},videojs.AnDisplay.prototype.countVisibles=function(){var AnArray=$.makeArray(this.el_.children),count=0;for(var index in AnArray){var an=AnArray[index];"none"!==an.style.display&&count++}return count},videojs.AnStat=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options),this.marginTop=20,this.marginBottom=0}}),videojs.AnStat.prototype.init_=function(){this.rs=this.player_.rangeslider,this.an=this.player_.annotations,this.canvas=this.el_.children[0]},videojs.AnStat.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-anstat-annotation",innerHTML:'<canvas class="vjs-char-anstat-annotation">Your browser does not support the HTML5 canvas tag.</canvas>'})},videojs.AnStat.prototype.paintCanvas=function(){var ctx=this.canvas.getContext("2d"),points=this._getPoints(),w=this._getWeights(points),maxEn=this._getMaxArray(points,"entries"),TotAn=this.an.AnDisplay.el_.children.length,duration=this.an.player.duration();this.canvas.style.marginTop=Math.round(this.marginTop)+"px",0===$(this.canvas).parent().find(".vjs-totan-anstat-annotation").length&&($(this.canvas).parent().append('<div class="vjs-totan-anstat-annotation">'),$(this.canvas).parent().append('<div class="vjs-maxcon-anstat-annotation">'));var textCanvas=$(this.canvas).parent().find(".vjs-totan-anstat-annotation")[0];textCanvas.innerHTML=TotAn+" total annotations";var textCanvas=$(this.canvas).parent().find(".vjs-maxcon-anstat-annotation")[0];textCanvas.innerHTML="Max Annotations = "+maxEn,window.CanvasRenderingContext2D&&CanvasRenderingContext2D.prototype.lineTo&&(CanvasRenderingContext2D.prototype.dashedLine=function(x1,y1,x2,y2,dashLen){void 0===dashLen&&(dashLen=2),this.beginPath(),this.moveTo(x1,y1);for(var dX=x2-x1,dY=y2-y1,dashes=Math.floor(Math.sqrt(dX*dX+dY*dY)/dashLen),dashX=dX/dashes,dashY=dY/dashes,q=0;q++<dashes;)x1+=dashX,y1+=dashY,this[q%2==0?"moveTo":"lineTo"](x1,y1);this[q%2==0?"moveTo":"lineTo"](x2,y2),this.stroke(),this.closePath()}),this.canvas.height=this.an.AnDisplay.el_.offsetHeight-(this.marginTop+this.marginBottom),this.canvas.width=this.an.AnDisplay.el_.offsetWidth,ctx.beginPath(),ctx.strokeStyle="rgb(255, 163, 0)";var lastSe=0,lastEn=0;ctx.moveTo(0,maxEn*w.Y);for(var index in points){var p=points[index],x1=lastSe*w.X,y1=(maxEn-lastEn)*w.Y,x2=p.second*w.X,y2=(maxEn-p.entries)*w.Y;ctx.lineTo(x2,y1),ctx.moveTo(x2,y1),ctx.lineTo(x2,y2),ctx.moveTo(x2,y2),ctx.fillStyle="rgba(0, 0, 0, 0.5)",ctx.fillRect(x1,y1,x2-x1,maxEn*w.Y-y1),lastSe=p.second,lastEn=p.entries}ctx.lineTo(lastSe*w.X,maxEn*w.Y),ctx.moveTo(lastSe*w.X,maxEn*w.Y),ctx.lineTo(duration*w.X,maxEn*w.Y),ctx.stroke(),ctx.beginPath(),ctx.dashedLine(0,maxEn*w.Y,duration*w.X,maxEn*w.Y,8),ctx.stroke(),ctx.beginPath(),ctx.dashedLine(0,0,duration*w.X,0,8),ctx.stroke()},videojs.AnStat.prototype._getWeights=function(points){var weight={},panel=$(this.an.AnDisplay.el_),maxSe=this.an.player.duration(),maxEn=this._getMaxArray(points,"entries"),panelW=parseFloat(panel.css("width")),panelH=parseFloat(panel.css("height"))-(this.marginTop+this.marginBottom);return weight.X=0!=maxSe?panelW/maxSe:0,weight.Y=0!=maxEn?panelH/maxEn:0,weight},videojs.AnStat.prototype._getMaxArray=function(points,variable){var tmp,highest=0;for(var index in points)tmp=points[index][variable],tmp>highest&&(highest=tmp);return highest},videojs.AnStat.prototype._getPoints=function(){var points=[],allannotations=this.an.annotator.plugins.Store.annotations;for(var index in allannotations){var start,end,an=allannotations[index];this.an._isVideoJS(an)&&(start=an.rangeTime.start,end=an.rangeTime.end,this._isFound(points,start)||(points.push({second:an.rangeTime.start,entries:this._getNumberAnnotations(start)}),an.rangeTime.start==an.rangeTime.end&&points.push({second:an.rangeTime.end,entries:this._getNumberAnnotations(end,!0)})),this._isFound(points,end)||points.push({second:an.rangeTime.end,entries:this._getNumberAnnotations(end,!0)}),found=!1)}return points.sort(function(a,b){return parseFloat(a.second)-parseFloat(b.second)}),points},videojs.AnStat.prototype._isFound=function(array,elem){var found=!1;for(var indexA in array)"undefined"!=typeof array[indexA].second&&array[indexA].second==elem&&(found=!0);return found},videojs.AnStat.prototype._getNumberAnnotations=function(time,end){var num="undefined"!=typeof end&&end?-1:0,allannotations=this.an.annotator.plugins.Store.annotations;for(var index in allannotations){var an=allannotations[index];this.an._isVideoJS(an)&&an.rangeTime.start<=time&&an.rangeTime.end>=time&&num++}return num},videojs.BackAnDisplayScroll=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options),this.on("mousedown",this.onMouseDown),this.UpValue=.1,this.currentValue=0}}),videojs.BackAnDisplayScroll.prototype.init_=function(){this.rs=this.player_.rangeslider,this.an=this.player_.annotations,this.mousedownID=-1;var direction,self=this;$(this.an.AnDisplay.el_).bind("DOMMouseScroll",function(e){return direction=e.originalEvent.detail>0?self.UpValue:-self.UpValue,self.an.backDSBarSel.setPosition(self.getPercentScroll()+direction),!1}),$(this.an.AnDisplay.el_).bind("mousewheel",function(e){return direction=e.originalEvent.wheelDelta<0?self.UpValue:-self.UpValue,self.an.backDSBarSel.setPosition(self.getPercentScroll()+direction),!1})},videojs.BackAnDisplayScroll.prototype.options_={children:{BackAnDisplayScrollBar:{},BackAnDisplayScrollTime:{}}},videojs.BackAnDisplayScroll.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-scroll-anpanel-annotation",innerHTML:'<div class="vjs-up-scroll-annotation"></div><div class="vjs-down-scroll-annotation"></div>'})},videojs.BackAnDisplayScroll.prototype.onMouseDown=function(event){var self=this;if("vjs-scrollbar-anpanel-annotation"===event.target.className)return this.an.backDSBarSel.onMouseMove(event),!1;if("vjs-scrollbar-selector"===event.target.className)return!1;var direction="vjs-down-scroll-annotation"==event.target.className?this.UpValue:-this.UpValue;videojs.on(document,"mouseup",videojs.bind(this,this.onMouseUp)),-1===parseInt(this.mousedownID,10)&&(this.mousedownID=setInterval(function(){var pos=Math.max(0,Math.min(1,self.getPercentScroll()+direction));self.an.backDSBarSel.setPosition(pos)},100))},videojs.BackAnDisplayScroll.prototype.onMouseUp=function(){videojs.off(document,"mouseup",this.onMouseUp,!1);var self=this;-1!=parseInt(this.mousedownID,10)&&(clearInterval(this.mousedownID),self.mousedownID=-1)},videojs.BackAnDisplayScroll.prototype.getPercentScroll=function(){var scroll=this.an.AnDisplay.el_,maxscroll=scroll.scrollHeight-scroll.offsetHeight,currentValue=scroll.scrollTop;return Math.max(0,Math.min(1,0!==maxscroll?currentValue/maxscroll:0))},videojs.BackAnDisplayScroll.prototype.setPercentScroll=function(percent){var scroll=this.an.AnDisplay.el_,maxscroll=scroll.scrollHeight-scroll.offsetHeight;percent=Math.max(0,Math.min(1,percent?percent:0)),scroll.scrollTop=Math.round(maxscroll*percent)},videojs.BackAnDisplayScrollBar=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options)}}),videojs.BackAnDisplayScrollBar.prototype.init_=function(){},videojs.BackAnDisplayScrollBar.prototype.options_={children:{ScrollBarSelector:{}}},videojs.BackAnDisplayScrollBar.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-scrollbar-anpanel-annotation"})},videojs.ScrollBarSelector=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options),this.on("mousedown",this.onMouseDown)}}),videojs.ScrollBarSelector.prototype.init_=function(){this.rs=this.player_.rangeslider,this.an=this.player_.annotations,videojs.addClass(this.an.backDSBar.el_,"disable")},videojs.ScrollBarSelector.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-scrollbar-selector"})},videojs.ScrollBarSelector.prototype.onMouseDown=function(event){event.preventDefault(),videojs.on(document,"mousemove",videojs.bind(this,this.onMouseMove)),videojs.on(document,"mouseup",videojs.bind(this,this.onMouseUp))},videojs.ScrollBarSelector.prototype.onMouseUp=function(){videojs.off(document,"mousemove",this.onMouseMove,!1),videojs.off(document,"mouseup",this.onMouseUp,!1)},videojs.ScrollBarSelector.prototype.onMouseMove=function(event){var top=this.calculateDistance(event);top=this.parseMaxPercent(top),this.setPosition(top)},videojs.ScrollBarSelector.prototype.calculateDistance=function(event){var scrollY=this.getscrollY(),scrollH=this.getscrollHeight(),handleH=this.getHeight();return scrollY+=handleH,scrollH-=handleH,Math.max(0,Math.min(1,(event.pageY-scrollY)/scrollH))},videojs.ScrollBarSelector.prototype.getscrollHeight=function(){return this.el_.parentNode.offsetHeight},videojs.ScrollBarSelector.prototype.getscrollY=function(){return videojs.findPosition(this.el_.parentNode).top},videojs.ScrollBarSelector.prototype.getHeight=function(){return this.el_.offsetHeight},videojs.ScrollBarSelector.prototype.parseMaxHeight=function(top){var scrollH=this.getscrollHeight(),handleH=this.getHeight(),percent=handleH/scrollH;return Math.max(0,Math.min(1-percent,top))},videojs.ScrollBarSelector.prototype.parseMaxPercent=function(top){var scrollH=this.getscrollHeight(),handleH=this.getHeight(),percent=handleH/scrollH,newTop=top;
return top>=1-percent&&(newTop=1),newTop},videojs.ScrollBarSelector.prototype.setPosition=function(top,showBar){var showBar="undefined"!=typeof showBar?showBar:!0;if(isNaN(top))return!1;if(!this.isScrollable())return!1;showBar&&videojs.removeClass(this.an.backDSBar.el_,"disable");var Obj=this.el_,scroll=this.an.BackAnDisplayScroll,scrollTime=this.an.backDSTime;if(Obj.style.top=100*this.parseMaxHeight(top)+"%",scroll.setPercentScroll(top),scrollTime.setTimes(),showBar){var _self=this;"undefined"!=typeof this.Timeout&&clearTimeout(this.Timeout),this.Timeout=window.setTimeout(function(){videojs.addClass(_self.an.backDSBar.el_,"disable")},1e3)}return this.an.BackAnDisplayScroll.currentValue=top,!0},videojs.ScrollBarSelector.prototype.isScrollable=function(){var scroll=this.an.AnDisplay.el_,emtoPx=parseFloat($(scroll).find(".annotation").css("height")),minTop=parseInt(scroll.offsetHeight/emtoPx),count=this.an.AnDisplay.countVisibles();return count>minTop},videojs.BackAnDisplayScrollTime=videojs.Component.extend({init:function(player,options){videojs.Component.call(this,player,options)}}),videojs.BackAnDisplayScrollTime.prototype.init_=function(){this.rs=this.player_.rangeslider,this.an=this.player_.annotations},videojs.BackAnDisplayScrollTime.prototype.createEl=function(){return videojs.Component.prototype.createEl.call(this,"div",{className:"vjs-scrolltime-anpanel-annotation",innerHTML:'<div class="vjs-up-scrolltime-annotation"><span class="vjs-time-text"></span></div><div class="vjs-down-scrolltime-annotation"><span class="vjs-time-text"></span></div>'})},videojs.BackAnDisplayScrollTime.prototype.setTimes=function(){var AnPos=this.getAnnotationPosition(),AnEl=this.getElements(AnPos),AnTimes=this.getTimes(AnEl);"Invalid Date"!=AnTimes.top?($(this.el_).find(".vjs-up-scrolltime-annotation")[0].style.visibility="",$(this.el_).find(".vjs-up-scrolltime-annotation span")[0].innerHTML=AnTimes.top):$(this.el_).find(".vjs-up-scrolltime-annotation")[0].style.visibility="hidden","Invalid Date"!=AnTimes.bottom?($(this.el_).find(".vjs-down-scrolltime-annotation")[0].style.visibility="",$(this.el_).find(".vjs-down-scrolltime-annotation span")[0].innerHTML=AnTimes.bottom):$(this.el_).find(".vjs-down-scrolltime-annotation")[0].style.visibility="hidden"},videojs.BackAnDisplayScrollTime.prototype.getAnnotationPosition=function(){var backDSBarSel=this.an.backDSBarSel,percent=backDSBarSel.parseMaxPercent(parseFloat(backDSBarSel.el_.style.top)/100),scroll=this.an.AnDisplay.el_,maxTop=scroll.scrollHeight,minTop=scroll.offsetHeight,maxBottom=maxTop-minTop,minBottom=0,pos={};return percent=percent||0,pos.top=Math.max(minTop,Math.min(maxTop,maxBottom*percent+scroll.offsetHeight)),pos.bottom=Math.max(minBottom,Math.min(maxBottom,maxBottom*percent)),pos},videojs.BackAnDisplayScrollTime.prototype.getElements=function(AnPos){var AnPos=AnPos||{},scroll=this.an.AnDisplay.el_,emtoPx=parseFloat($(scroll).find(".annotation").css("height")),maxTop=parseInt(scroll.scrollHeight/emtoPx),minTop=parseInt(scroll.offsetHeight/emtoPx),maxBottom=maxTop-minTop,minBottom=0,AnEl={};return AnEl.top=Math.max(minTop,Math.min(maxTop,parseInt(AnPos.top/emtoPx))),AnEl.bottom=Math.max(minBottom,Math.min(maxBottom,parseInt(AnPos.bottom/emtoPx))),AnEl},videojs.BackAnDisplayScrollTime.prototype.getTimes=function(AnEl){var TopEl,BottomEl,AnTop,AnBottom,AnEl=AnEl||{},AnTimes={},AnArray=$.makeArray(this.an.AnDisplay.el_.children);AnEl.top=AnEl.top||0,AnEl.bottom=AnEl.bottom||0;var lastEl,count=0;for(var index in AnArray){var an=AnArray[index];"none"!==an.style.display&&(count==AnEl.bottom?TopEl=an:count==AnEl.top&&(BottomEl=an),lastEl=an,count++)}return"undefined"==typeof BottomEl&&(BottomEl=lastEl),AnTop="undefined"!=typeof TopEl?$.data(TopEl,"annotation"):void 0,AnBottom="undefined"!=typeof BottomEl?$.data(BottomEl,"annotation"):void 0,AnTimes.top="undefined"!=typeof AnTop&&"undefined"!=typeof AnTop.updated?AnTop.updated:"",AnTimes.bottom="undefined"!=typeof AnBottom&&"undefined"!=typeof AnBottom.updated?AnBottom.updated:"",AnTimes.top=new Date(""!==AnTimes.top?createDateFromISO8601(AnTimes.top):""),AnTimes.bottom=new Date(""!=AnTimes.bottom?createDateFromISO8601(AnTimes.bottom):""),AnTimes}}(),Annotator.Plugin.VideoJS=function(_super){function VideoJS(){return this.pluginSubmit=__bind(this.pluginSubmit,this),_ref=VideoJS.__super__.constructor.apply(this,arguments),this.__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1},_ref}return __extends(VideoJS,_super),VideoJS.prototype.field=null,VideoJS.prototype.input=null,VideoJS.prototype.pluginInit=function(){if(console.log("VideoJS-pluginInit"),Annotator.supported()){this.field=this.annotator.editor.addField({id:"vjs-input-rangeTime-annotations",type:"input",submit:this.pluginSubmit,EditVideoAn:this.EditVideoAn});var select='<li><span id="vjs-input-rangeTime-annotations"></span></li>',newfield=Annotator.$(select);return Annotator.$(this.field).replaceWith(newfield),this.field=newfield[0],this.initListeners(),this.input=$(this.field).find(":input")}},VideoJS.prototype.pluginSubmit=function(field,annotation){function afterFinish(){player.annotations.showAnnotation(annotation),annotator.unsubscribe(eventAn,afterFinish)}if(console.log("Plug-pluginSubmit"),this.EditVideoAn()){var ext,annotator=this.annotator,index=annotator.editor.VideoJS,player=annotator.mplayer[index],rs=player.rangeslider,time=rs.getValues(),isYoutube=player&&"undefined"!=typeof player.techName?"Youtube"===player.techName:!1,isNew="undefined"==typeof annotation.media,type=player.options_.sources[0].type.split("/")||"";isNew&&(annotation.media="undefined"!=typeof type[0]?type[0]:"video"),annotation.target=annotation.target||{},annotation.target.container=player.id_||"",annotation.target.src=player.options_.sources[0].src||"",ext=player.options_.sources[0].src.substring(player.options_.sources[0].src.lastIndexOf(".")).toLowerCase(),ext=isYoutube?"Youtube":ext,annotation.target.ext=ext||"",annotation.rangeTime=annotation.rangeTime||{},annotation.rangeTime.start=time.start||0,annotation.rangeTime.end=time.end||0,annotation.updated=(new Date).toISOString(),"undefined"==typeof annotation.created&&(annotation.created=annotation.updated);var eventAn=isNew?"annotationCreated":"annotationUpdated";annotator.subscribe(eventAn,afterFinish)}else"undefined"==typeof annotation.media&&(annotation.media="text"),annotation.updated=(new Date).toISOString(),"undefined"==typeof annotation.created&&(annotation.created=annotation.updated);return annotation.media},VideoJS.prototype.EditVideoAn=function(){var wrapper=$(".annotator-wrapper").parent()[0],annotator=window.annotator=$.data(wrapper,"annotator"),isOpenVideojs="undefined"!=typeof annotator.mplayer,VideoJS=annotator.editor.VideoJS;return isOpenVideojs&&"undefined"!=typeof VideoJS&&-1!==VideoJS},VideoJS.prototype.isVideoJS=function(an){var wrapper=$(".annotator-wrapper").parent()[0],annotator=window.annotator=$.data(wrapper,"annotator"),rt=an.rangeTime,isOpenVideojs="undefined"!=typeof annotator.mplayer,isVideo="undefined"!=typeof an.media&&("video"===an.media||"audio"===an.media),isNumber="undefined"!=typeof rt&&!isNaN(parseFloat(rt.start))&&isFinite(rt.start)&&!isNaN(parseFloat(rt.end))&&isFinite(rt.end);return isOpenVideojs&&isVideo&&isNumber},VideoJS.prototype._deleteAnnotation=function(an){var target=an.target||{},container=target.container||{},player=this.annotator.mplayer[container],annotator=this.annotator,annotations=annotator.plugins.Store.annotations,tot="undefined"!=typeof annotations?annotations.length:0,attempts=0,ischanged=function(){var new_tot=annotator.plugins.Store.annotations.length;100>attempts&&setTimeout(function(){new_tot!==tot?player.annotations.refreshDisplay():(attempts++,ischanged())},100)};ischanged(),player.rangeslider.hide()},VideoJS.prototype.initListeners=function(){function annotationEditorHidden(){if(EditVideoAn()){var index=annotator.editor.VideoJS;annotator.mplayer[index].rangeslider.hide(),annotator.an[index].refreshDisplay()}annotator.editor.VideoJS=-1,annotator.unsubscribe("annotationEditorHidden",annotationEditorHidden)}function annotationEditorShown(editor,annotation){for(var index in annotator.an)annotator.an[index].editAnnotation(annotation,editor);annotator.subscribe("annotationEditorHidden",annotationEditorHidden)}function annotationDeleted(annotation){isVideoJS(annotation)&&self._deleteAnnotation(annotation)}function hideViewer(){for(var index in annotator.an)annotator.an[index].AnDisplay.onCloseViewer();annotator.viewer.unsubscribe("hide",hideViewer)}function annotationViewerShown(viewer){var separation=viewer.element.hasClass(viewer.classes.invert.y)?5:-5,newpos={top:parseFloat(viewer.element[0].style.top)+separation,left:parseFloat(viewer.element[0].style.left)};viewer.element.css(newpos),viewer.element.find(".annotator-controls").removeClass(viewer.classes.showControls),annotator.viewer.subscribe("hide",hideViewer)}var wrapper=$(".annotator-wrapper").parent()[0],annotator=$.data(wrapper,"annotator"),EditVideoAn=this.EditVideoAn,isVideoJS=this.isVideoJS,self=this;annotator.subscribe("annotationEditorShown",annotationEditorShown).subscribe("annotationDeleted",annotationDeleted).subscribe("annotationViewerShown",annotationViewerShown)},VideoJS}(Annotator.Plugin),OpenVideoAnnotation="OpenVideoAnnotation"in window?OpenVideoAnnotation:{},OpenVideoAnnotation.Annotator=function(element,options){function onKeyUp(e){"textarea"!==e.target.nodeName.toLowerCase()&&mplayer[focusedPlayer].annotations.pressedKey(e.which)}var $=jQuery,options=options||{};options.optionsAnnotator=options.optionsAnnotator||{},options.optionsVideoJS=options.optionsVideoJS||{},options.optionsRS=options.optionsRS||{},options.optionsOVA=options.optionsOVA||{},"undefined"==typeof options.optionsAnnotator.store&&(options.optionsAnnotator.store={});var store=options.optionsAnnotator.store;if("undefined"==typeof store.annotationData&&(store.annotationData={}),"undefined"==typeof store.annotationData.uri){var uri=location.protocol+"//"+location.host+location.pathname;store.annotationData.store={uri:uri}}"undefined"==typeof store.loadFromSearch&&(store.loadFromSearch={}),"undefined"==typeof store.loadFromSearch.uri&&(store.loadFromSearch.uri=uri),"undefined"==typeof store.loadFromSearch.limit&&(store.loadFromSearch.limit=1e4),this.currentUser=null,this.annotator=$(element).annotator(options.optionsAnnotator.annotator).data("annotator"),options.optionsOVA.optionsAnnotator=options.optionsAnnotator.annotator;var mplayers=$(element).find("div .video-js").toArray(),mplayer=this.mplayer={};for(var index in mplayers){var id=mplayers[index].id,mplayer_=videojs(mplayers[index],options.optionsVideoJS);vjs.IS_FIREFOX&&"undefined"!=typeof options.optionsVideoJS.techOrder&&(mplayer_.options_.techOrder=options.optionsVideoJS.techOrder,mplayer_.src(mplayer_.options_.sources)),this.mplayer[id]=mplayer_}this.annotator.an={};for(var index in this.mplayer)this.mplayer[index].rangeslider($.extend(!0,{},options.optionsRS)),this.mplayer[index].annotations($.extend(!0,{},options.optionsOVA)),this.annotator.an[index]=this.mplayer[index].annotations;this.setCurrentUser=function(user){this.currentUser=user,this.annotator.plugins.Permissions.setUser(user)};var focusedPlayer=this.focusedPlayer="",lastfocusPlayer=this.lastfocusPlayer="";return(this._setupKeyboard=function(){$(document).mousedown(function(e){focusedPlayer="";for(var index in mplayer)$(mplayer[index].el_).find(e.target).length&&(focusedPlayer=mplayer[index].id_);lastfocusPlayer!==focusedPlayer&&($(document).off("keyup",onKeyUp),""!==focusedPlayer&&$(document).on("keyup",onKeyUp)),lastfocusPlayer=focusedPlayer})})(this),"undefined"!=typeof options.optionsAnnotator.auth&&this.annotator.addPlugin("Auth",options.optionsAnnotator.auth),"undefined"!=typeof options.optionsAnnotator.permissions&&this.annotator.addPlugin("Permissions",options.optionsAnnotator.permissions),"undefined"!=typeof options.optionsAnnotator.store&&this.annotator.addPlugin("Store",options.optionsAnnotator.store),"undefined"!=typeof options.optionsAnnotator.diacriticMarks&&"function"==typeof Annotator.Plugin.Diacritics&&this.annotator.addPlugin("Diacritics",options.optionsAnnotator.diacriticMarks),"function"==typeof Annotator.Plugin.Geolocation&&this.annotator.addPlugin("Geolocation",options.optionsAnnotator.geolocation),"function"==typeof Annotator.Plugin.Share&&this.annotator.addPlugin("Share",options.optionsAnnotator.share),this.annotator.addPlugin("VideoJS"),"function"==typeof Annotator.Plugin.RichText&&this.annotator.addPlugin("RichText",options.optionsAnnotator.richText),"function"==typeof Annotator.Plugin.Reply&&this.annotator.addPlugin("Reply"),"function"==typeof Annotator.Plugin.Flagging&&this.annotator.addPlugin("Flagging"),"undefined"!=typeof options.optionsAnnotator.highlightTags&&this.annotator.addPlugin("HighlightTags",options.optionsAnnotator.highlightTags),this.annotator.mplayer=this.mplayer,this.annotator.editor.VideoJS=-1,this.options=options,this},OpenVideoAnnotation.Annotator.prototype._isVideo=function(an){var an=an||{},rt=an.rangeTime,isVideo="undefined"!=typeof an.media&&("video"===an.media||"audio"===an.media),hasContainer="undefined"!=typeof an.target&&"undefined"!=typeof an.target.container,isNumber="undefined"!=typeof rt&&!isNaN(parseFloat(rt.start))&&isFinite(rt.start)&&!isNaN(parseFloat(rt.end))&&isFinite(rt.end);return isVideo&&hasContainer&&isNumber},OpenVideoAnnotation.Annotator.prototype._isloaded=function(idElem){return"undefined"!=typeof this.mplayer[idElem].annotations.loaded},OpenVideoAnnotation.Annotator.prototype.newVideoAn=function(idElem){var player=this.mplayer[idElem];"undefined"!=typeof player.play&&(player.play(),player.one("playing",function(){player.annotations.newan(),$("html, body").animate({scrollTop:$("#"+player.id_).offset().top},"slow"),player.pause()}))},OpenVideoAnnotation.Annotator.prototype.showDisplay=function(idElem){return this._isloaded(idElem)?this.mplayer[idElem].annotations.showDisplay():void 0},OpenVideoAnnotation.Annotator.prototype.hideDisplay=function(idElem){return this._isloaded(idElem)?this.mplayer[idElem].annotations.hideDisplay():void 0},OpenVideoAnnotation.Annotator.prototype.refreshDisplay=function(idElem){return this._isloaded(idElem)?this.mplayer[idElem].annotations.hideDisplay():void 0},OpenVideoAnnotation.Annotator.prototype.setposBigNew=function(idElem,position){return this._isloaded(idElem)?this.mplayer[idElem].annotations.setposBigNew(position):void 0},OpenVideoAnnotation.Annotator.prototype.playTarget=function(annotationId){var allannotations=this.annotator.plugins.Store.annotations,ovaId=annotationId,mplayer=this.mplayer;for(var item in allannotations){var an=allannotations[item];if("undefined"!=typeof an.id&&an.id==ovaId)if(this._isVideo(an))for(var index in mplayer){var player=mplayer[index];if(player.id_==an.target.container&&player.tech.options_.source.src===an.target.src){var anFound=an,playFunction=function(){if("Youtube"===player.techName){var startAPI=function(){player.annotations.showAnnotation(anFound)};player.annotations.loaded?startAPI():player.one("loadedRangeSlider",startAPI)}else player.annotations.showAnnotation(anFound);$("html, body").animate({scrollTop:$("#"+player.id_).offset().top},"slow")};return player.paused()?(player.play(),player.one("playing",playFunction)):playFunction(),!1}}else{var hasRanges="undefined"!=typeof an.ranges&&"undefined"!=typeof an.ranges[0],startOffset=hasRanges?an.ranges[0].startOffset:"",endOffset=hasRanges?an.ranges[0].endOffset:"";"undefined"!=typeof startOffset&&"undefined"!=typeof endOffset&&($(an.highlights).parent().find(".annotator-hl").removeClass("api"),$(an.highlights).addClass("api"),$("html, body").animate({scrollTop:$(an.highlights[0]).offset().top},"slow"))}}},window.CatchAnnotation="CatchAnnotation"in window?CatchAnnotation:{},window.CatchSources="CatchSources"in window?CatchSources:{},CatchSources.HTMLTEMPLATES=function(root){var root=root||"";return{annotationList:'<div class="annotationListButtons">{{{ PublicPrivate }}}</div><div class="annotationList">{{{ MediaSelector }}}<div class="header"><div class="annotationRow"><div class="expandableIcon field">&nbsp  <!-- TODO: better way to ensure width upon hide --></div><div class="annotatedBy field">'+gettext("User")+'</div><div class="body field">'+gettext("Annotation")+'</div>{{#if videoFormat}}<div class="start field">'+gettext("Start")+'</div><div class="end field">'+gettext("End")+'</div>{{/if}}<div class="totalreplies field">'+gettext("#Replies")+'</div><div class="annotatedAt field">'+gettext("Date posted")+'</div></div></div>{{#each annotationItems}}{{{ this }}}{{/each}}</div><div class="annotationListButtons"><div class="moreButtonCatch">'+gettext("More")+"</div></div>",annotationPublicPrivateInstructor:'<div class="selectors"><div class="PublicPrivate myNotes active">'+gettext("My Notes")+'<span class="action">myNotes</span></div><div class="PublicPrivate instructor"> '+gettext("Instructor")+'<span class="action">instructor</span></div><div class="PublicPrivate public"> '+gettext("Public")+'<span class="action">public</span></div></div><div class="searchbox"><div class="searchinst">'+gettext("Search")+'</div><select class="dropdown-list"><option>'+gettext("Users")+"</option><option>"+gettext("Tags")+"</option><option>"+gettext("Annotation Text")+'</option></select><input type="text" name="search"/><div class="search-icon" alt="Run search."></div><div class="clear-search-icon" alt="Clear search.">'+gettext("Clear")+"</div></div>",annotationPublicPrivate:'<div class="selectors"><div class="PublicPrivate myNotes active">'+gettext("My Notes")+'<span class="action">myNotes</span></div><div class="PublicPrivate public"> '+gettext("Public")+'<span class="action">public</span></div></div><div class="searchbox"><div class="searchinst">'+gettext("Search")+'</div><select class="dropdown-list"><option>'+gettext("Users")+"</option><option>"+gettext("Tags")+"</option><option>"+gettext("Annotation Text")+'</option></select><input type="text" name="search"/><div class="search-icon" alt="Run search."></div><div class="clear-search-icon" alt="Clear search.">'+gettext("Clear")+"</div></div>",annotationMediaSelector:'<ul class="ui-tabs-nav"><li class="ui-state-default" media="text">'+gettext("Text")+'</li><li class="ui-state-default" media="video">'+gettext("Video")+'</li><li class="ui-state-default" media="image">'+gettext("Image")+"</li></ul>",annotationItem:'<div class="annotationItem {{ evenOrOdd }} {{ openOrClosed }}" annotationId="{{ id }}">{{{ annotationRow }}}{{{ annotationDetail }}}</div>',annotationReply:'{{#if annotations}}{{#each annotations}}<blockquote class="replyItem" annotationId="{{this.id}}" style="font-size:90%"><p>On  {{ this.updated }} <!--<a href="index.php?r=user/user/view&id={{{this.user.id}}}">-->{{{ this.user.name }}}<!--</a>-->{{#if this.geolocation}}, wrote from {{/if}}{{#if geolocation}}<span class="geolocationIcon"><img src="'+root+'geolocation_icon.png"width="25" height="25" alt="Location Map" title="Show Location Map" data-dropdown="myLocationMap"/><span class="idAnnotation" style="display:none">{{{ this.id }}}</span><span class="latitude" style="display:none">{{{ this.geolocation.latitude }}}</span><span class="longitude" style="display:none">{{{ this.geolocation.longitude }}}</span></span><div id="myLocationMap" data-dropdown-content class="f-dropdown content"><div class="map"></div></div>{{/if}}<div class="deleteReply">'+gettext("Delete")+"</div></p><p>{{#if this.text}}{{{this.text}}}{{else}}-{{/if}}</p></blockquote>{{/each}}{{/if}}",annotationRow:'<div class="annotationRow item"><div class="expandableIcon field"><img src="'+root+'expandableIcon.png" alt="View Details" />&nbsp</div><div class="annotatedBy field">{{ user.name }}</div><div class="body field">{{#if plainText}}{{deparagraph plainText}}{{else}}-{{/if}}</div><div class="start field">{{ rangeTime.start }}</div><div class="end field">{{ rangeTime.end }}</div><div class="totalreplies field">{{ totalComments }}</div><div class="annotatedAt field">{{ updated }}</div></div>',annotationDetail:'{{#if mediatypeforgrid.text}}<div class="annotationDetail">{{/if}}{{#if mediatypeforgrid.video}}<div class="annotationDetail videoAnnotationDetail">{{/if}}{{#if mediatypeforgrid.image}}<div class="annotationDetail imageAnnotationDetail">{{/if}}<div class="detailHeader"><span class="closeDetailIcon"><img src="'+root+'closeIcon.png" alt="Hide Details" /></span>On  {{ updated }} <!--<a href="index.php?r=user/user/view&id={{{user.id}}}">-->{{{ user.name }}}<!--</a>-->{{#if geolocation}}, wrote from {{/if}}{{#if geolocation}}<span class="geolocationIcon"><img src="'+root+'geolocation_icon.png"width="25" height="25" alt="Location Map" title="Show Location Map" data-dropdown="myLocationMap"/><span class="idAnnotation" style="display:none">{{{ id }}}</span><span class="latitude" style="display:none">{{{ geolocation.latitude }}}</span><span class="longitude" style="display:none">{{{ geolocation.longitude }}}</span></span><div id="myLocationMap" data-dropdown-content class="f-dropdown content"><div class="map"></div></div>{{/if}}</div>{{#if mediatypeforgrid.text}}<div class="quote"><div style="text-align: center"><div class="quoteItem">“</div><div class="quoteText">{{{ quote }}}</div><div class="quoteItem">”</div></div><span class="idAnnotation" style="display:none">{{{ id }}}</span><span class="uri" style="display:none">{{{uri}}}</span></div>{{/if}}{{#if mediatypeforgrid.video}}<div class="playMediaButton">Play segment {{{ rangeTime.start }}} - {{{ rangeTime.end }}}<span class="idAnnotation" style="display:none">{{{ id }}}</span><span class="uri" style="display:none">{{{uri}}}</span><span class="container" style="display:none">{{{target.container}}}</span></div>{{/if}}{{#if mediatypeforgrid.image}}<div class="zoomToImageBounds"><img src="{{{ thumbnailLink }}}"><span class="idAnnotation" style="display:none">{{{ id }}}</span><span class="uri" style="display:none">{{{uri}}}</span></div>{{/if}}<div class="body">{{{ text }}}</div><div class="controlReplies"><div class="newReply" style="text-decoration:underline">'+gettext("Reply")+'</div>&nbsp;<div class="hideReplies" style="text-decoration:underline;display:{{#if hasReplies}}block{{else}}none{{/if}}">Show Replies</div>&nbsp;{{#if authToEditButton}}<div class="editAnnotation" style="text-decoration:underline">'+gettext("Edit")+'</div>{{/if}}{{#if authToDeleteButton}}<div class="deleteAnnotation" style="text-decoration:underline">'+gettext("Delete")+'</div>{{/if}}</div><div class="replies"></div>{{#if tags}}<div class="tags"><h3>'+gettext("Tags:")+'</h3>{{#each tags}}<div class="tag">{{this}}</div>{{/each}}</div>{{/if}}<div class="controlPanel"></div></div>'}},CatchAnnotation=function(element,options){var $=jQuery,options=options||{},defaultOptions={media:"text",userId:"",externalLink:!1,showMediaSelector:!0,showPublicPrivate:!0,pagination:50,flags:!1};this.options=$.extend(!0,defaultOptions,options),this.element=element,this.clean=!1,element.html('<div id="mainCatch" class="annotationListContainer"></div>'),this.current_tab=this.options.default_tab;var self=this;return $(document).ready(function(){self.init(),self.refreshCatch(!0);var moreBut=self.element.find(".annotationListButtons .moreButtonCatch");moreBut.hide()}),this},CatchAnnotation.prototype={init:function(){this.TEMPLATENAMES=["annotationList","annotationPublicPrivate","annotationPublicPrivateInstructor","annotationMediaSelector","annotationItem","annotationReply","annotationRow","annotationDetail"];var wrapper=$(".annotator-wrapper").parent()[0],annotator=$.data(wrapper,"annotator");this.annotator=annotator,this._subscribeAnnotator(),Handlebars.registerHelper("deparagraph",function(txt){var dpg=txt.replace("<p>","").replace("</p>","");return dpg}),this.HTMLTEMPLATES=CatchSources.HTMLTEMPLATES(this.options.imageUrlRoot),this.TEMPLATES={},this._compileTemplates(),"instructor"===this.options.default_tab.toLowerCase()&&this.changeUserId(this.options.instructor_email)},getTemplate:function(templateName){return this.TEMPLATES[templateName]()||""},refreshCatch:function(newInstance){var mediaType=this.options.media||"text",annotationItems=[],index=0,annotations=this.annotator.plugins.Store.annotations||[],el=$("#mainCatch.annotationListContainer"),self=this,newInstance=newInstance||!1;if(annotations.forEach(function(annotation){var isMedia=annotation.media===self.options.media,isUser="undefined"!=typeof self.options.userId&&""!==self.options.userId&&null!==self.options.userId?self.options.userId===annotation.user.id:!0,isInList=newInstance?!1:self._isInList(annotation);if(isMedia&&isUser&&!isInList){var item=jQuery.extend(!0,{},annotation);self._formatCatch(item);var permissions=self.annotator.plugins.Permissions,authorized=permissions.options.userAuthorize("delete",annotation,permissions.user),updateAuthorized=permissions.options.userAuthorize("update",annotation,permissions.user);item.authToDeleteButton=authorized,item.authToEditButton=updateAuthorized,item.hasReplies=item.totalComments>0;var html=self.TEMPLATES.annotationItem({item:item,id:item.id,evenOrOdd:index%2?"odd":"even",openOrClosed:"closed",annotationRow:self.TEMPLATES.annotationRow(item),annotationDetail:self.TEMPLATES.annotationDetail(item)});index++,annotationItems.push(html)}}),newInstance){var videoFormat="video"===mediaType?!0:!1;if(self.options.showPublicPrivate)var templateName=this.options.instructor_email?"annotationPublicPrivateInstructor":"annotationPublicPrivate";el.html(self.TEMPLATES.annotationList({annotationItems:annotationItems,videoFormat:videoFormat,PublicPrivate:this.getTemplate(templateName),MediaSelector:self.options.showMediaSelector?self.TEMPLATES.annotationMediaSelector():""}))}else{var list=$("#mainCatch .annotationList");annotationItems.forEach(function(annotation){list.append($(annotation))})}for(var SelButtons=el.find(".annotationList li").removeClass("active"),index=0;index<SelButtons.length;index++){var span=$(SelButtons[index]);span.attr("media")===this.options.media&&$(SelButtons[index]).addClass("active")}for(var PublicPrivateButtons=el.find(".annotationListButtons .PublicPrivate").removeClass("active"),index=0;index<PublicPrivateButtons.length;index++){var span=$(PublicPrivateButtons[index]).find("span");if(span.html().toLowerCase()===self.current_tab.toLowerCase()){switch(self.current_tab.toLowerCase()){case"public":self.options.userId="";break;case"instructor":self.options.userId=this.options.instructor_email;break;default:self.options.userId=this.annotator.plugins.Permissions.user.id}$(PublicPrivateButtons[index]).addClass("active")}}el.off();var openAnnotationItem=this.__bind(this._openAnnotationItem,this),closeAnnotationItem=this.__bind(this._closeAnnotationItem,this),onGeolocationClick=this.__bind(this._onGeolocationClick,this),onPlaySelectionClick=this.__bind(this._onPlaySelectionClick,this),onShareControlsClick=this.__bind(this._onShareControlsClick,this),onSelectionButtonClick=this.__bind(this._onSelectionButtonClick,this),onPublicPrivateButtonClick=this.__bind(this._onPublicPrivateButtonClick,this),onQuoteMediaButton=this.__bind(this._onQuoteMediaButton,this),onControlRepliesClick=this.__bind(this._onControlRepliesClick,this),onMoreButtonClick=this.__bind(this._onMoreButtonClick,this),onSearchButtonClick=this.__bind(this._onSearchButtonClick,this),onClearSearchButtonClick=this.__bind(this._onClearSearchButtonClick,this),onDeleteReplyButtonClick=this.__bind(this._onDeleteReplyButtonClick,this),onZoomToImageBoundsButtonClick=this.__bind(this._onZoomToImageBoundsButtonClick,this),openLoadingGIF=this.__bind(this.openLoadingGIF,this);el.on("click",".annotationItem .annotationRow",openAnnotationItem),el.on("click",".annotationItem .detailHeader",closeAnnotationItem),el.on("click",".annotationItem .detailHeader .geolocationIcon img",onGeolocationClick),el.on("click",".annotationItem .annotationDetail .controlPanel",onShareControlsClick),"video"===this.options.media&&el.on("click",".annotationItem .annotationDetail .playMediaButton",onPlaySelectionClick),"text"===this.options.media&&el.on("click",".annotationItem .annotationDetail .quote",onQuoteMediaButton),"image"===this.options.media&&el.on("click",".annotationItem .annotationDetail .zoomToImageBounds",onZoomToImageBoundsButtonClick),el.on("click",".annotationItem .controlReplies",onControlRepliesClick),el.on("click",".annotationList li",onSelectionButtonClick),el.on("click",".annotationListButtons .PublicPrivate",onPublicPrivateButtonClick),el.on("click",".annotationListButtons .moreButtonCatch",onMoreButtonClick),el.on("click",".searchbox .search-icon",onSearchButtonClick),$("input[name=search]").keyup(function(e){13==e.which&&onSearchButtonClick()}),el.on("click",".searchbox .clear-search-icon",onClearSearchButtonClick),el.on("click",".replies .replyItem .deleteReply",onDeleteReplyButtonClick),el.on("click",".annotationListButtons .PublicPrivate",openLoadingGIF)},changeMedia:function(media){var media=media||"text";this.options.media=media,this._refresh(),this.refreshCatch(!0),this.checkTotAnnotations()},changeUserId:function(userId){var userId=userId||"";this.options.userId=userId,this._refresh(),this.refreshCatch(!0),this.checkTotAnnotations()},cleanUpAnnotations:function(){var annotator=this.annotator,store=annotator.plugins.Store,annotations=store.annotations,self=this;$.each(annotations,function(key,value){""!==self.options.userId&&self.options.userId!==value.permissions.update[0]&&void 0!==value.highlights&&$.each(value.highlights,function(key1,value1){$(value1).removeClass("annotator-hl")})})},loadAnnotations:function(){var annotator=this.annotator,loadFromSearch=annotator.plugins.Store.options.loadFromSearch,loadedAn=this.element.find(".annotationList .annotationItem").length;loadedAn="undefined"!=typeof loadedAn?loadedAn:0,loadFromSearch.limit=this.options.pagination,loadFromSearch.offset=loadedAn,loadFromSearch.media=this.options.media,loadFromSearch.userid=this.options.userId,loadFromSearch.limit=this.options.pagination+loadedAn,loadFromSearch.offset=0,annotator.plugins.Store.loadAnnotationsFromSearch(loadFromSearch);var moreBut=this.element.find(".annotationListButtons .moreButtonCatch");moreBut.html("Please wait, loading...")},checkTotAnnotations:function(){var annotator=this.annotator,loadFromSearch=annotator.plugins.Store.options.loadFromSearch,oldLimit=loadFromSearch.limit,oldOffset=loadFromSearch.offset,self=this;loadFromSearch.limit=0,loadFromSearch.offset=0,loadFromSearch.media=this.options.media,loadFromSearch.userid=this.options.userId;var id,options,url,onSuccess=function(response){var totAn=self.element.find(".annotationList .annotationItem").length,maxAn=response.total,moreBut=self.element.find(".annotationListButtons .moreButtonCatch");maxAn>totAn&&totAn>0?moreBut.show():moreBut.hide()},obj=loadFromSearch,action="search";id=obj&&obj.id,url=annotator.plugins.Store._urlFor(action,id),options=annotator.plugins.Store._apiRequestOptions(action,obj,onSuccess),$.ajax(url,options),loadFromSearch.limit=oldLimit,loadFromSearch.offset=oldOffset;var moreBut=this.element.find(".annotationListButtons .moreButtonCatch");moreBut.html("More")},_subscribeAnnotator:function(){var self=this,annotator=this.annotator;annotator.subscribe("annotationsLoaded",function(){self.cleanUpAnnotations(),self.refreshCatch(self.clean),self.checkTotAnnotations()}),annotator.subscribe("annotationUpdated",function(){self.refreshCatch(!0),self.checkTotAnnotations()}),annotator.subscribe("annotationDeleted",function(annotation){var annotations=annotator.plugins.Store.annotations,tot="undefined"!=typeof annotations?annotations.length:0,attempts=0;if("image"===annotation.media)self.refreshCatch(!0),self.checkTotAnnotations();else{var ischanged=function(){var new_tot=annotator.plugins.Store.annotations.length;100>attempts&&setTimeout(function(){new_tot!==tot?(self.refreshCatch(!0),self.checkTotAnnotations()):(attempts++,ischanged())
},100)};ischanged()}}),annotator.subscribe("annotationCreated",function(annotation){var attempts=0,ischanged=function(){100>attempts&&setTimeout(function(){if("undefined"!=typeof annotation.id){if(self.refreshCatch(),"undefined"!=typeof annotation.parent&&"0"!==annotation.parent){var replies=$("[annotationid="+annotation.parent+"]").find(".controlReplies .hideReplies");replies.show(),replies.click(),replies.click()}}else attempts++,ischanged()},100)};ischanged()})},__bind:function(fn,me){return function(){return fn.apply(me,arguments)}},_compileTemplates:function(){var self=this;this.TEMPLATENAMES.forEach(function(templateName){self.TEMPLATES[templateName]=Handlebars.compile(self.HTMLTEMPLATES[templateName])})},_isVideoJS:function(an){var annotator=this.annotator,rt=an.rangeTime,isOpenVideojs="undefined"!=typeof annotator.mplayer,isVideo="undefined"!=typeof an.media&&"video"===an.media,isNumber="undefined"!=typeof rt&&!isNaN(parseFloat(rt.start))&&isFinite(rt.start)&&!isNaN(parseFloat(rt.end))&&isFinite(rt.end);return isOpenVideojs&&isVideo&&isNumber},_isInList:function(an){var isInList=(this.annotator,!1),list=$("#mainCatch .annotationList .annotationRow.item");for(_i=0,_len=list.length;_len>_i;_i++)parseInt($(list[_i]).parent().attr("annotationid"),10)===an.id&&(isInList=!0);return isInList},_formatCatch:function(item){var item=item||{};if(this._isVideoJS(item)&&(item.rangeTime.start="undefined"!=typeof vjs?vjs.formatTime(item.rangeTime.start):item.rangeTime.start,item.rangeTime.end="undefined"!=typeof vjs?vjs.formatTime(item.rangeTime.end):item.rangeTime.end),"undefined"!=typeof item.updated&&"undefined"!=typeof createDateFromISO8601&&(item.updated=createDateFromISO8601(item.updated)),"undefined"==typeof item.geolocation||"undefined"!=typeof item.geolocation.latitude&&""!==item.geolocation.latitude||delete item.geolocation,item.plainText=item.text.replace(/&(lt|gt);/g,function(strMatch,p1){return"lt"===p1?"<":">"}),item.plainText=item.plainText.replace(/<\/?[^>]+(>|$)/g,"").replace("&nbsp;",""),item.mediatypeforgrid={},item.mediatypeforgrid[item.media]=!0,item.mediatypeforgrid.image&&(item.thumbnailLink=item.target.thumb),!this.options.flags&&"undefined"!=typeof item.tags&&item.tags.length>0)for(var len=item.tags.length,index=len-1;index>=0;--index){var currTag=item.tags[index];-1!==currTag.indexOf("flagged-")&&item.tags.splice(index)}},_openAnnotationItem:function(evt){var isClosed=$(evt.currentTarget).closest(".annotationItem").hasClass("closed");if(isClosed){$(evt.currentTarget).closest(".annotationItem").removeClass("closed").addClass("open");var shareControl=$(evt.currentTarget).closest(".annotationItem").find(".annotationDetail .controlPanel:first"),annotator=this.annotator,idAnnotation=shareControl.parent().find(".idAnnotation").html(),uri=shareControl.parent().find(".uri").html();shareControl.find(".share-container-annotator").remove(),shareControl.append(annotator.plugins.Share.buildHTMLShareButton("",idAnnotation)),annotator.plugins.Share.buttonsActions(shareControl[0],1,uri)}else $(evt.currentTarget).closest(".annotationItem").removeClass("open").addClass("closed")},_closeAnnotationItem:function(evt){var existEvent="undefined"!=typeof evt.target&&"undefined"!=typeof evt.target.localName;existEvent&&"geolocationIcon"!==evt.target.parentNode.className&&this._openAnnotationItem(evt)},_onGeolocationClick:function(evt){var latitude=$(evt.target).parent().find(".latitude").html(),longitude=$(evt.target).parent().find(".longitude").html(),imgSrc='<img src="http://maps.googleapis.com/maps/api/staticmap?center='+latitude+","+longitude+"&zoom=14&size=500x500&sensor=false&markers=color:green%7Clabel:G%7C"+latitude+","+longitude+'">';$(evt.target).parents(".detailHeader:first").find("#myLocationMap .map").html(imgSrc)},_onPlaySelectionClick:function(evt){var id=parseInt($(evt.target).find(".idAnnotation").html(),10),uri=$(evt.target).find(".uri").html(),container=$(evt.target).find(".container").html();if(this.options.externalLink)uri+=uri.indexOf("?")>=0?"&ovaId="+id:"?ovaId="+id,location.href=uri;else{var isContainer="undefined"!=typeof this.annotator.an&&"undefined"!=typeof this.annotator.an[container],ovaInstance=isContainer?this.annotator.an[container]:null;if(null!==ovaInstance){var allannotations=this.annotator.plugins.Store.annotations,ovaId=id,player=ovaInstance.player;for(var item in allannotations){var an=allannotations[item];if("undefined"!=typeof an.id&&an.id===ovaId&&this._isVideoJS(an)&&player.id_===an.target.container&&player.tech.options_.source.src===an.target.src){var anFound=an,playFunction=function(){if("Youtube"===player.techName){var startAPI=function(){ovaInstance.showAnnotation(anFound)};ovaInstance.loaded?startAPI():player.one("loadedRangeSlider",startAPI)}else ovaInstance.showAnnotation(anFound);$("html, body").animate({scrollTop:$("#"+player.id_).offset().top},"slow")};return player.paused()?(player.play(),player.one("playing",playFunction)):playFunction(),!1}}}}},_onZoomToImageBoundsButtonClick:function(evt){var zoomToBounds=$(evt.target).hasClass("zoomToImageBounds")?$(evt.target):$(evt.target).parents(".zoomToImageBounds:first"),osdaId=parseInt(zoomToBounds.find(".idAnnotation").html(),10),uri=zoomToBounds.find(".uri").html(),allannotations=this.annotator.plugins.Store.annotations,osda=this.annotator.osda;this.options.externalLink&&(uri+=uri.indexOf("?")>=0?"&osdaId="+osdaId:"?osdaId="+osdaId,location.href=uri);for(var item in allannotations){var an=allannotations[item];if(an.highlights&&(an.highlights[0].style.background="rgba(0, 0, 0, 0)"),"undefined"!=typeof an.id&&an.id===osdaId){var bounds=new OpenSeadragon.Rect(an.bounds.x,an.bounds.y,an.bounds.width,an.bounds.height);osda.viewer.viewport.fitBounds(bounds,!1),$("html, body").animate({scrollTop:$("#"+an.target.container).offset().top},"slow"),void 0!==an.highlights&&(an.highlights[0].style.background="rgba(255, 255, 10, 0.2)")}}},_onQuoteMediaButton:function(evt){var quote=$(evt.target).hasClass("quote")?$(evt.target):$(evt.target).parents(".quote:first"),id=parseInt(quote.find(".idAnnotation").html(),10),uri=quote.find(".uri").html();if(("undefined"==typeof id||""===id)&&(this.refreshCatch(),this.checkTotAnnotations(),id=quote.find(".idAnnotation").html()),this.options.externalLink)uri+=uri.indexOf("?")>=0?"&ovaId="+id:"?ovaId="+id,location.href=uri;else{var allannotations=this.annotator.plugins.Store.annotations,ovaId=id;for(var item in allannotations){var an=allannotations[item];if("undefined"!=typeof an.id&&an.id===ovaId&&!this._isVideoJS(an)){var hasRanges="undefined"!=typeof an.ranges&&"undefined"!=typeof an.ranges[0],startOffset=hasRanges?an.ranges[0].startOffset:"",endOffset=hasRanges?an.ranges[0].endOffset:"";"undefined"!=typeof startOffset&&"undefined"!=typeof endOffset&&($(an.highlights).parent().find(".annotator-hl").removeClass("api"),$(an.highlights).addClass("api"),$("html, body").animate({scrollTop:$(an.highlights[0]).offset().top},"slow"))}}}},_refreshReplies:function(evt){var id,options,request,url,item=$(evt.target).parents(".annotationItem:first"),anId=parseInt(item.attr("annotationId"),10),replyElem=$(evt.target).parents(".annotationItem:first").find(".replies"),annotator=this.annotator,loadFromSearchURI=annotator.plugins.Store.options.loadFromSearch.uri,self=this,action="search",loadFromSearch={limit:-1,parentid:anId,uri:loadFromSearchURI},onSuccess=function(data){null===data&&(data={}),annotations=data.rows||[];var _i,_len;for(_i=0,_len=annotations.length;_len>_i;_i++)self._formatCatch(annotations[_i]);replyElem.html(self.TEMPLATES.annotationReply({annotations:annotations}));var replyItems=$(".replies .replyItem");"undefined"!=typeof replyItems&&replyItems.length>0&&annotations.forEach(function(ann){replyItems.each(function(item){var id=parseInt($(replyItems[item]).attr("annotationid"),10);if(id===ann.id){var perm=self.annotator.plugins.Permissions;perm.options.userAuthorize("delete",ann,perm.user)?$(replyItems[item]).data("annotation",ann):$(replyItems[item]).find(".deleteReply").remove()}})})},store=this.annotator.plugins.Store;id=loadFromSearch&&loadFromSearch.id,url=store._urlFor(action,id),options=store._apiRequestOptions(action,loadFromSearch,onSuccess),request=$.ajax(url,options),request._id=id,request._action=action},_onControlRepliesClick:function(evt){var action=$(evt.target)[0].className;if("newReply"===action){var item=$(evt.target).parents(".annotationItem:first"),id=item.attr("annotationId");this.annotator.adder.show();var replyElem=$(evt.target).parents(".annotationItem:first").find(".annotationDetail"),adder=this.annotator.adder,wrapper=$(".annotator-wrapper"),positionLeft=videojs.findPosition($(evt.target).parent().find(".newReply")[0]),positionAnnotator=videojs.findPosition(wrapper[0]),positionAdder={};positionAdder.display="block",positionAdder.left=positionLeft.left-positionAnnotator.left,positionAdder.top=positionLeft.top+20-positionAnnotator.top,adder.css(positionAdder),this.annotator.onAdderClick(),$(this.annotator.editor.element).css(positionAdder),this.annotator.editor.resetOrientation(),this.annotator.editor.invertY();var parentValue=$(this.annotator.editor.element).find(".reply-item span.parent-annotation");parentValue.html(id)}else if("hideReplies"===action){var oldAction=$(evt.target).html();if("Show Replies"!==oldAction){$(evt.target).html("Show Replies");var replyElem=$(evt.target).parents(".annotationItem:first").find(".replies");return replyElem.html(""),!1}$(evt.target).html("Hide Replies"),this._refreshReplies(evt)}else if("deleteAnnotation"===action){if(confirm("Would you like to delete the annotation?")){var annotation,annotator=this.annotator,item=$(evt.target).parents(".annotationItem:first"),id=parseInt(item.attr("annotationId"),10),store=annotator.plugins.Store,annotations=store.annotations,permissions=annotator.plugins.Permissions;annotations.forEach(function(ann){ann.id===id&&(annotation=ann)});var authorized=permissions.options.userAuthorize("delete",annotation,permissions.user);authorized&&annotator.deleteAnnotation(annotation)}}else if("editAnnotation"===action){var annotation,annotator=this.annotator,item=$(evt.target).parents(".annotationItem:first"),id=parseInt(item.attr("annotationId"),10),store=annotator.plugins.Store,annotations=store.annotations,permissions=annotator.plugins.Permissions;annotations.forEach(function(ann){ann.id===id&&(annotation=ann)});var authorized=permissions.options.userAuthorize("update",annotation,permissions.user);if(authorized){var wrapper=$(".annotator-wrapper"),positionLeft=videojs.findPosition($(evt.target).parent().find(".editAnnotation")[0]),positionAnnotator=videojs.findPosition(wrapper[0]),positionAdder={};positionAdder.left=positionLeft.left-positionAnnotator.left,positionAdder.top=positionLeft.top+20-positionAnnotator.top;var cleanup,offset,update,_this=this.annotator;offset=positionAdder,update=function(){return cleanup(),_this.updateAnnotation(annotation)},cleanup=function(){return _this.unsubscribe("annotationEditorHidden",cleanup),_this.unsubscribe("annotationEditorSubmit",update)},this.annotator.subscribe("annotationEditorHidden",cleanup),this.annotator.subscribe("annotationEditorSubmit",update),this.annotator.viewer.hide(),this.annotator.showEditor(annotation,offset)}}},_onShareControlsClick:function(evt){var action=$(evt.target)[0].className;if("privacy_button"===action);else if("groups_button"===action)alert("Coming soon...");else if("reply_button"===action){var item=$(evt.target).parents(".annotationItem:first"),id=item.attr("annotationId"),an=this.annotator.setupAnnotation(this.annotator.createAnnotation());an.text="010",an.parent=id}},_onPublicPrivateButtonClick:function(evt){var action=$(evt.target).find("span"),userId="";switch(action.html()){case"public":userId="";break;case"instructor":userId=this.options.instructor_email;break;default:userId=this.annotator.plugins.Permissions.user.id}this.current_tab=action.html(),"text"===this.options.media&&("undefined"!=typeof this.annotator.plugins.Grouping&&(this.annotator.plugins.Grouping.useGrouping="public"===this.current_tab?0:1),this.annotator.publish("changedTabsInCatch")),this.changeUserId(userId)},_onSelectionButtonClick:function(evt){var but=$(evt.target),action=but.attr("media");action.length<=0&&(action="text"),this.changeMedia(action)},_onMoreButtonClick:function(){this.clean=!1;var moreBut=this.element.find(".annotationListButtons .moreButtonCatch"),isLoading="More"===moreBut.html()?!1:!0;isLoading||this.loadAnnotations()},_refresh:function(searchtype,searchInput){var searchtype=searchtype||"",searchInput=searchInput||"";this.clean=!0,0===$("#notesHolder").length&&this._clearAnnotator();var annotator=this.annotator,loadFromSearch=annotator.plugins.Store.options.loadFromSearch;loadFromSearch.limit=this.options.pagination,loadFromSearch.offset=0,loadFromSearch.media=this.options.media,loadFromSearch.userid=this.options.userId,loadFromSearch.username="",loadFromSearch.tag="",loadFromSearch.text="","Users"===searchtype?loadFromSearch.username=searchInput:"Tags"===searchtype?loadFromSearch.tag=searchInput:loadFromSearch.text=searchInput,annotator.plugins.Store.loadAnnotationsFromSearch(loadFromSearch)},_onSearchButtonClick:function(){var searchtype=this.element.find(".searchbox .dropdown-list").val(),searchInput=this.element.find(".searchbox input").val();this._refresh(searchtype,searchInput)},_onClearSearchButtonClick:function(){this._refresh("","")},_clearAnnotator:function(){var annotator=this.annotator,store=annotator.plugins.Store,annotations=store.annotations.slice();annotations.forEach(function(ann){var child,h,_i,_len,_ref;if(void 0!==ann.highlights)for(_ref=ann.highlights,_i=0,_len=_ref.length;_len>_i;_i++)h=_ref[_i],void 0!==h.parentNode&&(child=h.childNodes[0],$(h).replaceWith(h.childNodes));store.unregisterAnnotation(ann)})},_onDeleteReplyButtonClick:function(evt){var annotator=this.annotator,item=$(evt.target).parents(".replyItem:first"),permissions=(item.attr("annotationid"),annotator.plugins.Permissions),annotation=item.data("annotation"),authorized=permissions.options.userAuthorize("delete",annotation,permissions.user);authorized&&confirm("Would you like to delete this reply?")&&(annotator.plugins.Store._apiRequest("destroy",annotation,function(){}),item.remove())},openLoadingGIF:function(){$("#mainCatch").append("<div class='annotations-loading-gif'><img src=\""+this.options.imageUrlRoot+'loading_bar.gif" /><br />Annotations Data Loading... Please Wait.</div>')}};var Handlebars=function(){var __module4__=function(){"use strict";function SafeString(string){this.string=string}var __exports__;return SafeString.prototype.toString=function(){return""+this.string},__exports__=SafeString}(),__module3__=function(__dependency1__){"use strict";function escapeChar(chr){return escape[chr]||"&amp;"}function extend(obj,value){for(var key in value)value.hasOwnProperty(key)&&(obj[key]=value[key])}function escapeExpression(string){return string instanceof SafeString?string.toString():string||0===string?(string=""+string,possible.test(string)?string.replace(badChars,escapeChar):string):""}function isEmpty(value){return value||0===value?isArray(value)&&0===value.length?!0:!1:!0}var __exports__={},SafeString=__dependency1__,escape={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},badChars=/[&<>"'`]/g,possible=/[&<>"'`]/;__exports__.extend=extend;var toString=Object.prototype.toString;__exports__.toString=toString;var isFunction=function(value){return"function"==typeof value};isFunction(/x/)&&(isFunction=function(value){return"function"==typeof value&&"[object Function]"===toString.call(value)});var isFunction;__exports__.isFunction=isFunction;var isArray=Array.isArray||function(value){return value&&"object"==typeof value?"[object Array]"===toString.call(value):!1};return __exports__.isArray=isArray,__exports__.escapeExpression=escapeExpression,__exports__.isEmpty=isEmpty,__exports__}(__module4__),__module5__=function(){"use strict";function Exception(){for(var tmp=Error.prototype.constructor.apply(this,arguments),idx=0;idx<errorProps.length;idx++)this[errorProps[idx]]=tmp[errorProps[idx]]}var __exports__,errorProps=["description","fileName","lineNumber","message","name","number","stack"];return Exception.prototype=new Error,__exports__=Exception}(),__module2__=function(__dependency1__,__dependency2__){"use strict";function HandlebarsEnvironment(helpers,partials){this.helpers=helpers||{},this.partials=partials||{},registerDefaultHelpers(this)}function registerDefaultHelpers(instance){instance.registerHelper("helperMissing",function(arg){if(2===arguments.length)return void 0;throw new Error("Missing helper: '"+arg+"'")}),instance.registerHelper("blockHelperMissing",function(context,options){var inverse=options.inverse||function(){},fn=options.fn;return isFunction(context)&&(context=context.call(this)),context===!0?fn(this):context===!1||null==context?inverse(this):isArray(context)?context.length>0?instance.helpers.each(context,options):inverse(this):fn(context)}),instance.registerHelper("each",function(context,options){var data,fn=options.fn,inverse=options.inverse,i=0,ret="";if(isFunction(context)&&(context=context.call(this)),options.data&&(data=createFrame(options.data)),context&&"object"==typeof context)if(isArray(context))for(var j=context.length;j>i;i++)data&&(data.index=i,data.first=0===i,data.last=i===context.length-1),ret+=fn(context[i],{data:data});else for(var key in context)context.hasOwnProperty(key)&&(data&&(data.key=key),ret+=fn(context[key],{data:data}),i++);return 0===i&&(ret=inverse(this)),ret}),instance.registerHelper("if",function(conditional,options){return isFunction(conditional)&&(conditional=conditional.call(this)),!options.hash.includeZero&&!conditional||Utils.isEmpty(conditional)?options.inverse(this):options.fn(this)}),instance.registerHelper("unless",function(conditional,options){return instance.helpers["if"].call(this,conditional,{fn:options.inverse,inverse:options.fn,hash:options.hash})}),instance.registerHelper("with",function(context,options){return isFunction(context)&&(context=context.call(this)),Utils.isEmpty(context)?void 0:options.fn(context)}),instance.registerHelper("log",function(context,options){var level=options.data&&null!=options.data.level?parseInt(options.data.level,10):1;instance.log(level,context)})}function log(level,obj){logger.log(level,obj)}var __exports__={},Utils=__dependency1__,Exception=__dependency2__,VERSION="1.1.2";__exports__.VERSION=VERSION;var COMPILER_REVISION=4;__exports__.COMPILER_REVISION=COMPILER_REVISION;var REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};__exports__.REVISION_CHANGES=REVISION_CHANGES;var isArray=Utils.isArray,isFunction=Utils.isFunction,toString=Utils.toString,objectType="[object Object]";__exports__.HandlebarsEnvironment=HandlebarsEnvironment,HandlebarsEnvironment.prototype={constructor:HandlebarsEnvironment,logger:logger,log:log,registerHelper:function(name,fn,inverse){if(toString.call(name)===objectType){if(inverse||fn)throw new Exception("Arg not supported with multiple helpers");Utils.extend(this.helpers,name)}else inverse&&(fn.not=inverse),this.helpers[name]=fn},registerPartial:function(name,str){toString.call(name)===objectType?Utils.extend(this.partials,name):this.partials[name]=str}};var logger={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(level,obj){if(logger.level<=level){var method=logger.methodMap[level];"undefined"!=typeof console&&console[method]&&console[method].call(console,obj)}}};__exports__.logger=logger,__exports__.log=log;var createFrame=function(object){var obj={};return Utils.extend(obj,object),obj};return __exports__.createFrame=createFrame,__exports__}(__module3__,__module5__),__module6__=function(__dependency1__,__dependency2__,__dependency3__){"use strict";function checkRevision(compilerInfo){var compilerRevision=compilerInfo&&compilerInfo[0]||1,currentRevision=COMPILER_REVISION;if(compilerRevision!==currentRevision){if(currentRevision>compilerRevision){var runtimeVersions=REVISION_CHANGES[currentRevision],compilerVersions=REVISION_CHANGES[compilerRevision];throw new Error("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+runtimeVersions+") or downgrade your runtime to an older version ("+compilerVersions+").")}throw new Error("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+compilerInfo[1]+").")}}function template(templateSpec,env){if(!env)throw new Error("No environment passed to template");var invokePartialWrapper;invokePartialWrapper=env.compile?function(partial,name,context,helpers,partials,data){var result=invokePartial.apply(this,arguments);if(result)return result;var options={helpers:helpers,partials:partials,data:data};return partials[name]=env.compile(partial,{data:void 0!==data},env),partials[name](context,options)}:function(partial,name){var result=invokePartial.apply(this,arguments);if(result)return result;throw new Exception("The partial "+name+" could not be compiled when running in runtime-only mode")};var container={escapeExpression:Utils.escapeExpression,invokePartial:invokePartialWrapper,programs:[],program:function(i,fn,data){var programWrapper=this.programs[i];return data?programWrapper=program(i,fn,data):programWrapper||(programWrapper=this.programs[i]=program(i,fn)),programWrapper},merge:function(param,common){var ret=param||common;return param&&common&&param!==common&&(ret={},Utils.extend(ret,common),Utils.extend(ret,param)),ret},programWithDepth:programWithDepth,noop:noop,compilerInfo:null};return function(context,options){options=options||{};var helpers,partials,namespace=options.partial?options:env;options.partial||(helpers=options.helpers,partials=options.partials);var result=templateSpec.call(container,namespace,context,helpers,partials,options.data);return options.partial||checkRevision(container.compilerInfo),result}}function programWithDepth(i,fn,data){var args=Array.prototype.slice.call(arguments,3),prog=function(context,options){return options=options||{},fn.apply(this,[context,options.data||data].concat(args))};return prog.program=i,prog.depth=args.length,prog}function program(i,fn,data){var prog=function(context,options){return options=options||{},fn(context,options.data||data)};return prog.program=i,prog.depth=0,prog}function invokePartial(partial,name,context,helpers,partials,data){var options={partial:!0,helpers:helpers,partials:partials,data:data};if(void 0===partial)throw new Exception("The partial "+name+" could not be found");return partial instanceof Function?partial(context,options):void 0}function noop(){return""}var __exports__={},Utils=__dependency1__,Exception=__dependency2__,COMPILER_REVISION=__dependency3__.COMPILER_REVISION,REVISION_CHANGES=__dependency3__.REVISION_CHANGES;return __exports__.template=template,__exports__.programWithDepth=programWithDepth,__exports__.program=program,__exports__.invokePartial=invokePartial,__exports__.noop=noop,__exports__}(__module3__,__module5__,__module2__),__module1__=function(__dependency1__,__dependency2__,__dependency3__,__dependency4__,__dependency5__){"use strict";var __exports__,base=__dependency1__,SafeString=__dependency2__,Exception=__dependency3__,Utils=__dependency4__,runtime=__dependency5__,create=function(){var hb=new base.HandlebarsEnvironment;return Utils.extend(hb,base),hb.SafeString=SafeString,hb.Exception=Exception,hb.Utils=Utils,hb.VM=runtime,hb.template=function(spec){return runtime.template(spec,hb)},hb},Handlebars=create();return Handlebars.create=create,__exports__=Handlebars}(__module2__,__module4__,__module5__,__module3__,__module6__),__module7__=function(__dependency1__){"use strict";function ProgramNode(statements,inverseStrip,inverse){this.type="program",this.statements=statements,this.strip={},inverse?(this.inverse=new ProgramNode(inverse,inverseStrip),this.strip.right=inverseStrip.left):inverseStrip&&(this.strip.left=inverseStrip.right)}function MustacheNode(rawParams,hash,open,strip){this.type="mustache",this.hash=hash,this.strip=strip;var escapeFlag=open[3]||open[2];this.escaped="{"!==escapeFlag&&"&"!==escapeFlag;var id=this.id=rawParams[0],params=this.params=rawParams.slice(1),eligibleHelper=this.eligibleHelper=id.isSimple;this.isHelper=eligibleHelper&&(params.length||hash)}function PartialNode(partialName,context,strip){this.type="partial",this.partialName=partialName,this.context=context,this.strip=strip}function BlockNode(mustache,program,inverse,close){if(mustache.id.original!==close.path.original)throw new Exception(mustache.id.original+" doesn't match "+close.path.original);this.type="block",this.mustache=mustache,this.program=program,this.inverse=inverse,this.strip={left:mustache.strip.left,right:close.strip.right},(program||inverse).strip.left=mustache.strip.right,(inverse||program).strip.right=close.strip.left,inverse&&!program&&(this.isInverse=!0)}function ContentNode(string){this.type="content",this.string=string}function HashNode(pairs){this.type="hash",this.pairs=pairs}function IdNode(parts){this.type="ID";for(var original="",dig=[],depth=0,i=0,l=parts.length;l>i;i++){var part=parts[i].part;if(original+=(parts[i].separator||"")+part,".."===part||"."===part||"this"===part){if(dig.length>0)throw new Exception("Invalid path: "+original);".."===part?depth++:this.isScoped=!0}else dig.push(part)}this.original=original,this.parts=dig,this.string=dig.join("."),this.depth=depth,this.isSimple=1===parts.length&&!this.isScoped&&0===depth,this.stringModeValue=this.string}function PartialNameNode(name){this.type="PARTIAL_NAME",this.name=name.original}function DataNode(id){this.type="DATA",this.id=id}function StringNode(string){this.type="STRING",this.original=this.string=this.stringModeValue=string}function IntegerNode(integer){this.type="INTEGER",this.original=this.integer=integer,this.stringModeValue=Number(integer)}function BooleanNode(bool){this.type="BOOLEAN",this.bool=bool,this.stringModeValue="true"===bool}function CommentNode(comment){this.type="comment",this.comment=comment}var __exports__={},Exception=__dependency1__;return __exports__.ProgramNode=ProgramNode,__exports__.MustacheNode=MustacheNode,__exports__.PartialNode=PartialNode,__exports__.BlockNode=BlockNode,__exports__.ContentNode=ContentNode,__exports__.HashNode=HashNode,__exports__.IdNode=IdNode,__exports__.PartialNameNode=PartialNameNode,__exports__.DataNode=DataNode,__exports__.StringNode=StringNode,__exports__.IntegerNode=IntegerNode,__exports__.BooleanNode=BooleanNode,__exports__.CommentNode=CommentNode,__exports__}(__module5__),__module9__=function(){"use strict";var __exports__,handlebars=function(){function stripFlags(open,close){return{left:"~"===open[2],right:"~"===close[0]||"~"===close[1]}}function Parser(){this.yy={}}var parser={trace:function(){},yy:{},symbols_:{error:2,root:3,statements:4,EOF:5,program:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,partial_option0:27,inMustache_repetition0:28,inMustache_option0:29,dataName:30,param:31,STRING:32,INTEGER:33,BOOLEAN:34,hash:35,hash_repetition_plus0:36,hashSegment:37,ID:38,EQUALS:39,DATA:40,pathSegments:41,SEP:42,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",32:"STRING",33:"INTEGER",34:"BOOLEAN",38:"ID",39:"EQUALS",40:"DATA",42:"SEP"},productions_:[0,[3,2],[3,1],[6,2],[6,3],[6,2],[6,1],[6,1],[6,0],[4,1],[4,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,4],[7,2],[17,3],[17,1],[31,1],[31,1],[31,1],[31,1],[31,1],[35,1],[37,3],[26,1],[26,1],[26,1],[30,2],[21,1],[41,3],[41,1],[27,0],[27,1],[28,0],[28,2],[29,0],[29,1],[36,1],[36,2]],performAction:function(yytext,yyleng,yylineno,yy,yystate,$$){var $0=$$.length-1;switch(yystate){case 1:return new yy.ProgramNode($$[$0-1]);case 2:return new yy.ProgramNode([]);case 3:this.$=new yy.ProgramNode([],$$[$0-1],$$[$0]);break;case 4:this.$=new yy.ProgramNode($$[$0-2],$$[$0-1],$$[$0]);break;case 5:this.$=new yy.ProgramNode($$[$0-1],$$[$0],[]);break;case 6:this.$=new yy.ProgramNode($$[$0]);break;case 7:this.$=new yy.ProgramNode([]);break;case 8:this.$=new yy.ProgramNode([]);break;case 9:this.$=[$$[$0]];break;case 10:$$[$0-1].push($$[$0]),this.$=$$[$0-1];break;case 11:this.$=new yy.BlockNode($$[$0-2],$$[$0-1].inverse,$$[$0-1],$$[$0]);break;case 12:this.$=new yy.BlockNode($$[$0-2],$$[$0-1],$$[$0-1].inverse,$$[$0]);break;case 13:this.$=$$[$0];break;case 14:this.$=$$[$0];break;case 15:this.$=new yy.ContentNode($$[$0]);break;case 16:this.$=new yy.CommentNode($$[$0]);break;case 17:this.$=new yy.MustacheNode($$[$0-1][0],$$[$0-1][1],$$[$0-2],stripFlags($$[$0-2],$$[$0]));break;case 18:this.$=new yy.MustacheNode($$[$0-1][0],$$[$0-1][1],$$[$0-2],stripFlags($$[$0-2],$$[$0]));break;case 19:this.$={path:$$[$0-1],strip:stripFlags($$[$0-2],$$[$0])};break;case 20:this.$=new yy.MustacheNode($$[$0-1][0],$$[$0-1][1],$$[$0-2],stripFlags($$[$0-2],$$[$0]));break;case 21:this.$=new yy.MustacheNode($$[$0-1][0],$$[$0-1][1],$$[$0-2],stripFlags($$[$0-2],$$[$0]));break;case 22:this.$=new yy.PartialNode($$[$0-2],$$[$0-1],stripFlags($$[$0-3],$$[$0]));break;case 23:this.$=stripFlags($$[$0-1],$$[$0]);break;case 24:this.$=[[$$[$0-2]].concat($$[$0-1]),$$[$0]];break;case 25:this.$=[[$$[$0]],null];break;case 26:this.$=$$[$0];break;case 27:this.$=new yy.StringNode($$[$0]);break;case 28:this.$=new yy.IntegerNode($$[$0]);break;case 29:this.$=new yy.BooleanNode($$[$0]);break;case 30:this.$=$$[$0];break;case 31:this.$=new yy.HashNode($$[$0]);break;case 32:this.$=[$$[$0-2],$$[$0]];break;case 33:this.$=new yy.PartialNameNode($$[$0]);break;case 34:this.$=new yy.PartialNameNode(new yy.StringNode($$[$0]));break;case 35:this.$=new yy.PartialNameNode(new yy.IntegerNode($$[$0]));break;case 36:this.$=new yy.DataNode($$[$0]);break;case 37:this.$=new yy.IdNode($$[$0]);break;case 38:$$[$0-2].push({part:$$[$0],separator:$$[$0-1]}),this.$=$$[$0-2];break;case 39:this.$=[{part:$$[$0]}];break;case 42:this.$=[];break;case 43:$$[$0-1].push($$[$0]);break;case 46:this.$=[$$[$0]];break;case 47:$$[$0-1].push($$[$0])}},table:[{3:1,4:2,5:[1,3],8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[3]},{5:[1,16],8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[2,2]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{4:20,6:18,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{4:20,6:22,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{17:23,21:24,30:25,38:[1,28],40:[1,27],41:26},{17:29,21:24,30:25,38:[1,28],40:[1,27],41:26},{17:30,21:24,30:25,38:[1,28],40:[1,27],41:26},{17:31,21:24,30:25,38:[1,28],40:[1,27],41:26},{21:33,26:32,32:[1,34],33:[1,35],38:[1,28],41:26},{1:[2,1]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{10:36,20:[1,37]},{4:38,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,7],22:[1,13],23:[1,14],25:[1,15]},{7:39,8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,6],22:[1,13],23:[1,14],25:[1,15]},{17:23,18:[1,40],21:24,30:25,38:[1,28],40:[1,27],41:26},{10:41,20:[1,37]},{18:[1,42]},{18:[2,42],24:[2,42],28:43,32:[2,42],33:[2,42],34:[2,42],38:[2,42],40:[2,42]},{18:[2,25],24:[2,25]},{18:[2,37],24:[2,37],32:[2,37],33:[2,37],34:[2,37],38:[2,37],40:[2,37],42:[1,44]},{21:45,38:[1,28],41:26},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],38:[2,39],40:[2,39],42:[2,39]},{18:[1,46]},{18:[1,47]},{24:[1,48]},{18:[2,40],21:50,27:49,38:[1,28],41:26},{18:[2,33],38:[2,33]},{18:[2,34],38:[2,34]},{18:[2,35],38:[2,35]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{21:51,38:[1,28],41:26},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,3],22:[1,13],23:[1,14],25:[1,15]},{4:52,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,5],22:[1,13],23:[1,14],25:[1,15]},{14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]},{18:[2,44],21:56,24:[2,44],29:53,30:60,31:54,32:[1,57],33:[1,58],34:[1,59],35:55,36:61,37:62,38:[1,63],40:[1,27],41:26},{38:[1,64]},{18:[2,36],24:[2,36],32:[2,36],33:[2,36],34:[2,36],38:[2,36],40:[2,36]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,65]},{18:[2,41]},{18:[1,66]},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],25:[1,15]},{18:[2,24],24:[2,24]},{18:[2,43],24:[2,43],32:[2,43],33:[2,43],34:[2,43],38:[2,43],40:[2,43]},{18:[2,45],24:[2,45]},{18:[2,26],24:[2,26],32:[2,26],33:[2,26],34:[2,26],38:[2,26],40:[2,26]},{18:[2,27],24:[2,27],32:[2,27],33:[2,27],34:[2,27],38:[2,27],40:[2,27]},{18:[2,28],24:[2,28],32:[2,28],33:[2,28],34:[2,28],38:[2,28],40:[2,28]},{18:[2,29],24:[2,29],32:[2,29],33:[2,29],34:[2,29],38:[2,29],40:[2,29]},{18:[2,30],24:[2,30],32:[2,30],33:[2,30],34:[2,30],38:[2,30],40:[2,30]},{18:[2,31],24:[2,31],37:67,38:[1,68]},{18:[2,46],24:[2,46],38:[2,46]},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],38:[2,39],39:[1,69],40:[2,39],42:[2,39]},{18:[2,38],24:[2,38],32:[2,38],33:[2,38],34:[2,38],38:[2,38],40:[2,38],42:[2,38]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{18:[2,47],24:[2,47],38:[2,47]},{39:[1,69]},{21:56,30:60,31:70,32:[1,57],33:[1,58],34:[1,59],38:[1,28],40:[1,27],41:26},{18:[2,32],24:[2,32],38:[2,32]}],defaultActions:{3:[2,2],16:[2,1],50:[2,41]},parseError:function(str){throw new Error(str)
},parse:function(input){function lex(){var token;return token=self.lexer.lex()||1,"number"!=typeof token&&(token=self.symbols_[token]||token),token}var self=this,stack=[0],vstack=[null],lstack=[],table=this.table,yytext="",yylineno=0,yyleng=0,recovering=0;this.lexer.setInput(input),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var yyloc=this.lexer.yylloc;lstack.push(yyloc);var ranges=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var symbol,preErrorSymbol,state,action,r,p,len,newState,expected,yyval={};;){if(state=stack[stack.length-1],this.defaultActions[state]?action=this.defaultActions[state]:((null===symbol||"undefined"==typeof symbol)&&(symbol=lex()),action=table[state]&&table[state][symbol]),"undefined"==typeof action||!action.length||!action[0]){var errStr="";if(!recovering){expected=[];for(p in table[state])this.terminals_[p]&&p>2&&expected.push("'"+this.terminals_[p]+"'");errStr=this.lexer.showPosition?"Parse error on line "+(yylineno+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+expected.join(", ")+", got '"+(this.terminals_[symbol]||symbol)+"'":"Parse error on line "+(yylineno+1)+": Unexpected "+(1==symbol?"end of input":"'"+(this.terminals_[symbol]||symbol)+"'"),this.parseError(errStr,{text:this.lexer.match,token:this.terminals_[symbol]||symbol,line:this.lexer.yylineno,loc:yyloc,expected:expected})}}if(action[0]instanceof Array&&action.length>1)throw new Error("Parse Error: multiple actions possible at state: "+state+", token: "+symbol);switch(action[0]){case 1:stack.push(symbol),vstack.push(this.lexer.yytext),lstack.push(this.lexer.yylloc),stack.push(action[1]),symbol=null,preErrorSymbol?(symbol=preErrorSymbol,preErrorSymbol=null):(yyleng=this.lexer.yyleng,yytext=this.lexer.yytext,yylineno=this.lexer.yylineno,yyloc=this.lexer.yylloc,recovering>0&&recovering--);break;case 2:if(len=this.productions_[action[1]][1],yyval.$=vstack[vstack.length-len],yyval._$={first_line:lstack[lstack.length-(len||1)].first_line,last_line:lstack[lstack.length-1].last_line,first_column:lstack[lstack.length-(len||1)].first_column,last_column:lstack[lstack.length-1].last_column},ranges&&(yyval._$.range=[lstack[lstack.length-(len||1)].range[0],lstack[lstack.length-1].range[1]]),r=this.performAction.call(yyval,yytext,yyleng,yylineno,this.yy,action[1],vstack,lstack),"undefined"!=typeof r)return r;len&&(stack=stack.slice(0,-1*len*2),vstack=vstack.slice(0,-1*len),lstack=lstack.slice(0,-1*len)),stack.push(this.productions_[action[1]][0]),vstack.push(yyval.$),lstack.push(yyval._$),newState=table[stack[stack.length-2]][stack[stack.length-1]],stack.push(newState);break;case 3:return!0}}return!0}},lexer=function(){var lexer={EOF:1,parseError:function(str,hash){if(!this.yy.parser)throw new Error(str);this.yy.parser.parseError(str,hash)},setInput:function(input){return this._input=input,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var ch=this._input[0];this.yytext+=ch,this.yyleng++,this.offset++,this.match+=ch,this.matched+=ch;var lines=ch.match(/(?:\r\n?|\n).*/g);return lines?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),ch},unput:function(ch){var len=ch.length,lines=ch.split(/(?:\r\n?|\n)/g);this._input=ch+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-len-1),this.offset-=len;var oldLines=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),lines.length-1&&(this.yylineno-=lines.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:lines?(lines.length===oldLines.length?this.yylloc.first_column:0)+oldLines[oldLines.length-lines.length].length-lines[0].length:this.yylloc.first_column-len},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-len]),this},more:function(){return this._more=!0,this},less:function(n){this.unput(this.match.slice(n))},pastInput:function(){var past=this.matched.substr(0,this.matched.length-this.match.length);return(past.length>20?"...":"")+past.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var next=this.match;return next.length<20&&(next+=this._input.substr(0,20-next.length)),(next.substr(0,20)+(next.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var pre=this.pastInput(),c=new Array(pre.length+1).join("-");return pre+this.upcomingInput()+"\n"+c+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var token,match,tempMatch,index,lines;this._more||(this.yytext="",this.match="");for(var rules=this._currentRules(),i=0;i<rules.length&&(tempMatch=this._input.match(this.rules[rules[i]]),!tempMatch||match&&!(tempMatch[0].length>match[0].length)||(match=tempMatch,index=i,this.options.flex));i++);return match?(lines=match[0].match(/(?:\r\n?|\n).*/g),lines&&(this.yylineno+=lines.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:lines?lines[lines.length-1].length-lines[lines.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+match[0].length},this.yytext+=match[0],this.match+=match[0],this.matches=match,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(match[0].length),this.matched+=match[0],token=this.performAction.call(this,this.yy,this,rules[index],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),token?token:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var r=this.next();return"undefined"!=typeof r?r:this.lex()},begin:function(condition){this.conditionStack.push(condition)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(condition){this.begin(condition)}};return lexer.options={},lexer.performAction=function(yy,yy_,$avoiding_name_collisions,YY_START){function strip(start,end){return yy_.yytext=yy_.yytext.substr(start,yy_.yyleng-end)}switch($avoiding_name_collisions){case 0:if("\\\\"===yy_.yytext.slice(-2)?(strip(0,1),this.begin("mu")):"\\"===yy_.yytext.slice(-1)?(strip(0,1),this.begin("emu")):this.begin("mu"),yy_.yytext)return 14;break;case 1:return 14;case 2:return"\\"!==yy_.yytext.slice(-1)&&this.popState(),"\\"===yy_.yytext.slice(-1)&&strip(0,1),14;case 3:return strip(0,4),this.popState(),15;case 4:return 25;case 5:return 16;case 6:return 20;case 7:return 19;case 8:return 19;case 9:return 23;case 10:return 22;case 11:this.popState(),this.begin("com");break;case 12:return strip(3,5),this.popState(),15;case 13:return 22;case 14:return 39;case 15:return 38;case 16:return 38;case 17:return 42;case 18:break;case 19:return this.popState(),24;case 20:return this.popState(),18;case 21:return yy_.yytext=strip(1,2).replace(/\\"/g,'"'),32;case 22:return yy_.yytext=strip(1,2).replace(/\\'/g,"'"),32;case 23:return 40;case 24:return 34;case 25:return 34;case 26:return 33;case 27:return 38;case 28:return yy_.yytext=strip(1,2),38;case 29:return"INVALID";case 30:return 5}},lexer.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s])))/,/^(?:false(?=([~}\s])))/,/^(?:-?[0-9]+(?=([~}\s])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],lexer.conditions={mu:{rules:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[3],inclusive:!1},INITIAL:{rules:[0,1,30],inclusive:!0}},lexer}();return parser.lexer=lexer,Parser.prototype=parser,parser.Parser=Parser,new Parser}();return __exports__=handlebars}(),__module8__=function(__dependency1__,__dependency2__){"use strict";function parse(input){return input.constructor===AST.ProgramNode?input:(parser.yy=AST,parser.parse(input))}var __exports__={},parser=__dependency1__,AST=__dependency2__;return __exports__.parser=parser,__exports__.parse=parse,__exports__}(__module9__,__module7__),__module11__=function(__dependency1__){"use strict";function Literal(value){this.value=value}function JavaScriptCompiler(){}var __exports__,COMPILER_REVISION=__dependency1__.COMPILER_REVISION,REVISION_CHANGES=__dependency1__.REVISION_CHANGES,log=__dependency1__.log;JavaScriptCompiler.prototype={nameLookup:function(parent,name){var wrap,ret;return 0===parent.indexOf("depth")&&(wrap=!0),ret=/^[0-9]+$/.test(name)?parent+"["+name+"]":JavaScriptCompiler.isValidJavaScriptVariableName(name)?parent+"."+name:parent+"['"+name+"']",wrap?"("+parent+" && "+ret+")":ret},appendToBuffer:function(string){return this.environment.isSimple?"return "+string+";":{appendToBuffer:!0,content:string,toString:function(){return"buffer += "+string+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(environment,options,context,asObject){this.environment=environment,this.options=options||{},log("debug",this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!context,this.context=context||{programs:[],environments:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.compileStack=[],this.inlineStack=[],this.compileChildren(environment,options);var opcode,opcodes=environment.opcodes;this.i=0;for(var l=opcodes.length;this.i<l;this.i++)opcode=opcodes[this.i],"DECLARE"===opcode.opcode?this[opcode.name]=opcode.value:this[opcode.opcode].apply(this,opcode.args),opcode.opcode!==this.stripNext&&(this.stripNext=!1);return this.pushSource(""),this.createFunctionContext(asObject)},preamble:function(){var out=[];if(this.isChild)out.push("");else{var namespace=this.namespace,copies="helpers = this.merge(helpers, "+namespace+".helpers);";this.environment.usePartial&&(copies=copies+" partials = this.merge(partials, "+namespace+".partials);"),this.options.data&&(copies+=" data = data || {};"),out.push(copies)}out.push(this.environment.isSimple?"":", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=out},createFunctionContext:function(asObject){var locals=this.stackVars.concat(this.registers.list);if(locals.length>0&&(this.source[1]=this.source[1]+", "+locals.join(", ")),!this.isChild)for(var alias in this.context.aliases)this.context.aliases.hasOwnProperty(alias)&&(this.source[1]=this.source[1]+", "+alias+"="+this.context.aliases[alias]);this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.pushSource("return buffer;");for(var params=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"],i=0,l=this.environment.depths.list.length;l>i;i++)params.push("depth"+this.environment.depths.list[i]);var source=this.mergeSource();if(!this.isChild){var revision=COMPILER_REVISION,versions=REVISION_CHANGES[revision];source="this.compilerInfo = ["+revision+",'"+versions+"'];\n"+source}if(asObject)return params.push(source),Function.apply(this,params);var functionSource="function "+(this.name||"")+"("+params.join(",")+") {\n  "+source+"}";return log("debug",functionSource+"\n\n"),functionSource},mergeSource:function(){for(var buffer,source="",i=0,len=this.source.length;len>i;i++){var line=this.source[i];line.appendToBuffer?buffer=buffer?buffer+"\n    + "+line.content:line.content:(buffer&&(source+="buffer += "+buffer+";\n  ",buffer=void 0),source+=line+"\n  ")}return source},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var params=["depth0"];this.setupParams(0,params),this.replaceStack(function(current){return params.splice(1,0,current),"blockHelperMissing.call("+params.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var params=["depth0"];this.setupParams(0,params);var current=this.topStack();params.splice(1,0,current),params[params.length-1]="options",this.pushSource("if (!"+this.lastHelper+") { "+current+" = blockHelperMissing.call("+params.join(", ")+"); }")},appendContent:function(content){this.pendingContent&&(content=this.pendingContent+content),this.stripNext&&(content=content.replace(/^\s+/,"")),this.pendingContent=content},strip:function(){this.pendingContent&&(this.pendingContent=this.pendingContent.replace(/\s+$/,"")),this.stripNext="strip"},append:function(){this.flushInline();var local=this.popStack();this.pushSource("if("+local+" || "+local+" === 0) { "+this.appendToBuffer(local)+" }"),this.environment.isSimple&&this.pushSource("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression",this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(depth){this.lastContext!==depth&&(this.lastContext=depth)},lookupOnContext:function(name){this.push(this.nameLookup("depth"+this.lastContext,name,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(current){return"typeof "+current+" === functionType ? "+current+".apply(depth0) : "+current})},lookup:function(name){this.replaceStack(function(current){return current+" == null || "+current+" === false ? "+current+" : "+this.nameLookup(current,name,"context")})},lookupData:function(){this.push("data")},pushStringParam:function(string,type){this.pushStackLiteral("depth"+this.lastContext),this.pushString(type),"string"==typeof string?this.pushString(string):this.pushStackLiteral(string)},emptyHash:function(){this.pushStackLiteral("{}"),this.options.stringParams&&(this.register("hashTypes","{}"),this.register("hashContexts","{}"))},pushHash:function(){this.hash={values:[],types:[],contexts:[]}},popHash:function(){var hash=this.hash;this.hash=void 0,this.options.stringParams&&(this.register("hashContexts","{"+hash.contexts.join(",")+"}"),this.register("hashTypes","{"+hash.types.join(",")+"}")),this.push("{\n    "+hash.values.join(",\n    ")+"\n  }")},pushString:function(string){this.pushStackLiteral(this.quotedString(string))},push:function(expr){return this.inlineStack.push(expr),expr},pushLiteral:function(value){this.pushStackLiteral(value)},pushProgram:function(guid){this.pushStackLiteral(null!=guid?this.programExpression(guid):null)},invokeHelper:function(paramSize,name){this.context.aliases.helperMissing="helpers.helperMissing";var helper=this.lastHelper=this.setupHelper(paramSize,name,!0),nonHelper=this.nameLookup("depth"+this.lastContext,name,"context");this.push(helper.name+" || "+nonHelper),this.replaceStack(function(name){return name+" ? "+name+".call("+helper.callParams+") : helperMissing.call("+helper.helperMissingParams+")"})},invokeKnownHelper:function(paramSize,name){var helper=this.setupHelper(paramSize,name);this.push(helper.name+".call("+helper.callParams+")")},invokeAmbiguous:function(name,helperCall){this.context.aliases.functionType='"function"',this.pushStackLiteral("{}");var helper=this.setupHelper(0,name,helperCall),helperName=this.lastHelper=this.nameLookup("helpers",name,"helper"),nonHelper=this.nameLookup("depth"+this.lastContext,name,"context"),nextStack=this.nextStack();this.pushSource("if ("+nextStack+" = "+helperName+") { "+nextStack+" = "+nextStack+".call("+helper.callParams+"); }"),this.pushSource("else { "+nextStack+" = "+nonHelper+"; "+nextStack+" = typeof "+nextStack+" === functionType ? "+nextStack+".call("+helper.callParams+") : "+nextStack+"; }")},invokePartial:function(name){var params=[this.nameLookup("partials",name,"partial"),"'"+name+"'",this.popStack(),"helpers","partials"];this.options.data&&params.push("data"),this.context.aliases.self="this",this.push("self.invokePartial("+params.join(", ")+")")},assignToHash:function(key){var context,type,value=this.popStack();this.options.stringParams&&(type=this.popStack(),context=this.popStack());var hash=this.hash;context&&hash.contexts.push("'"+key+"': "+context),type&&hash.types.push("'"+key+"': "+type),hash.values.push("'"+key+"': ("+value+")")},compiler:JavaScriptCompiler,compileChildren:function(environment,options){for(var child,compiler,children=environment.children,i=0,l=children.length;l>i;i++){child=children[i],compiler=new this.compiler;var index=this.matchExistingProgram(child);null==index?(this.context.programs.push(""),index=this.context.programs.length,child.index=index,child.name="program"+index,this.context.programs[index]=compiler.compile(child,options,this.context),this.context.environments[index]=child):(child.index=index,child.name="program"+index)}},matchExistingProgram:function(child){for(var i=0,len=this.context.environments.length;len>i;i++){var environment=this.context.environments[i];if(environment&&environment.equals(child))return i}},programExpression:function(guid){if(this.context.aliases.self="this",null==guid)return"self.noop";for(var depth,child=this.environment.children[guid],depths=child.depths.list,programParams=[child.index,child.name,"data"],i=0,l=depths.length;l>i;i++)depth=depths[i],programParams.push(1===depth?"depth0":"depth"+(depth-1));return(0===depths.length?"self.program(":"self.programWithDepth(")+programParams.join(", ")+")"},register:function(name,val){this.useRegister(name),this.pushSource(name+" = "+val+";")},useRegister:function(name){this.registers[name]||(this.registers[name]=!0,this.registers.list.push(name))},pushStackLiteral:function(item){return this.push(new Literal(item))},pushSource:function(source){this.pendingContent&&(this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent))),this.pendingContent=void 0),source&&this.source.push(source)},pushStack:function(item){this.flushInline();var stack=this.incrStack();return item&&this.pushSource(stack+" = "+item+";"),this.compileStack.push(stack),stack},replaceStack:function(callback){var stack,prefix="",inline=this.isInline();if(inline){var top=this.popStack(!0);if(top instanceof Literal)stack=top.value;else{var name=this.stackSlot?this.topStackName():this.incrStack();prefix="("+this.push(name)+" = "+top+"),",stack=this.topStack()}}else stack=this.topStack();var item=callback.call(this,stack);return inline?((this.inlineStack.length||this.compileStack.length)&&this.popStack(),this.push("("+prefix+item+")")):(/^stack/.test(stack)||(stack=this.nextStack()),this.pushSource(stack+" = ("+prefix+item+");")),stack},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var inlineStack=this.inlineStack;if(inlineStack.length){this.inlineStack=[];for(var i=0,len=inlineStack.length;len>i;i++){var entry=inlineStack[i];entry instanceof Literal?this.compileStack.push(entry):this.pushStack(entry)}}},isInline:function(){return this.inlineStack.length},popStack:function(wrapped){var inline=this.isInline(),item=(inline?this.inlineStack:this.compileStack).pop();return!wrapped&&item instanceof Literal?item.value:(inline||this.stackSlot--,item)},topStack:function(wrapped){var stack=this.isInline()?this.inlineStack:this.compileStack,item=stack[stack.length-1];return!wrapped&&item instanceof Literal?item.value:item},quotedString:function(str){return'"'+str.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(paramSize,name,missingParams){var params=[];this.setupParams(paramSize,params,missingParams);var foundHelper=this.nameLookup("helpers",name,"helper");return{params:params,name:foundHelper,callParams:["depth0"].concat(params).join(", "),helperMissingParams:missingParams&&["depth0",this.quotedString(name)].concat(params).join(", ")}},setupParams:function(paramSize,params,useRegister){var param,inverse,program,options=[],contexts=[],types=[];options.push("hash:"+this.popStack()),inverse=this.popStack(),program=this.popStack(),(program||inverse)&&(program||(this.context.aliases.self="this",program="self.noop"),inverse||(this.context.aliases.self="this",inverse="self.noop"),options.push("inverse:"+inverse),options.push("fn:"+program));for(var i=0;paramSize>i;i++)param=this.popStack(),params.push(param),this.options.stringParams&&(types.push(this.popStack()),contexts.push(this.popStack()));return this.options.stringParams&&(options.push("contexts:["+contexts.join(",")+"]"),options.push("types:["+types.join(",")+"]"),options.push("hashContexts:hashContexts"),options.push("hashTypes:hashTypes")),this.options.data&&options.push("data:data"),options="{"+options.join(",")+"}",useRegister?(this.register("options",options),params.push("options")):params.push(options),params.join(", ")}};for(var reservedWords="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),compilerWords=JavaScriptCompiler.RESERVED_WORDS={},i=0,l=reservedWords.length;l>i;i++)compilerWords[reservedWords[i]]=!0;return JavaScriptCompiler.isValidJavaScriptVariableName=function(name){return!JavaScriptCompiler.RESERVED_WORDS[name]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(name)?!0:!1},__exports__=JavaScriptCompiler}(__module2__),__module10__=function(__dependency1__,__dependency2__,__dependency3__,__dependency4__){"use strict";function Compiler(){}function precompile(input,options){if(null==input||"string"!=typeof input&&input.constructor!==AST.ProgramNode)throw new Exception("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+input);options=options||{},"data"in options||(options.data=!0);var ast=parse(input),environment=(new Compiler).compile(ast,options);return(new JavaScriptCompiler).compile(environment,options)}function compile(input,options,env){function compileInput(){var ast=parse(input),environment=(new Compiler).compile(ast,options),templateSpec=(new JavaScriptCompiler).compile(environment,options,void 0,!0);return env.template(templateSpec)}if(null==input||"string"!=typeof input&&input.constructor!==AST.ProgramNode)throw new Exception("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+input);options=options||{},"data"in options||(options.data=!0);var compiled;return function(context,options){return compiled||(compiled=compileInput()),compiled.call(this,context,options)}}var __exports__={},Exception=__dependency1__,parse=__dependency2__.parse,JavaScriptCompiler=__dependency3__,AST=__dependency4__;return __exports__.Compiler=Compiler,Compiler.prototype={compiler:Compiler,disassemble:function(){for(var opcode,params,param,opcodes=this.opcodes,out=[],i=0,l=opcodes.length;l>i;i++)if(opcode=opcodes[i],"DECLARE"===opcode.opcode)out.push("DECLARE "+opcode.name+"="+opcode.value);else{params=[];for(var j=0;j<opcode.args.length;j++)param=opcode.args[j],"string"==typeof param&&(param='"'+param.replace("\n","\\n")+'"'),params.push(param);out.push(opcode.opcode+" "+params.join(" "))}return out.join("\n")},equals:function(other){var len=this.opcodes.length;if(other.opcodes.length!==len)return!1;for(var i=0;len>i;i++){var opcode=this.opcodes[i],otherOpcode=other.opcodes[i];if(opcode.opcode!==otherOpcode.opcode||opcode.args.length!==otherOpcode.args.length)return!1;for(var j=0;j<opcode.args.length;j++)if(opcode.args[j]!==otherOpcode.args[j])return!1}if(len=this.children.length,other.children.length!==len)return!1;for(i=0;len>i;i++)if(!this.children[i].equals(other.children[i]))return!1;return!0},guid:0,compile:function(program,options){this.opcodes=[],this.children=[],this.depths={list:[]},this.options=options;var knownHelpers=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0},knownHelpers)for(var name in knownHelpers)this.options.knownHelpers[name]=knownHelpers[name];return this.accept(program)},accept:function(node){var ret,strip=node.strip||{};return strip.left&&this.opcode("strip"),ret=this[node.type](node),strip.right&&this.opcode("strip"),ret},program:function(program){for(var statements=program.statements,i=0,l=statements.length;l>i;i++)this.accept(statements[i]);return this.isSimple=1===l,this.depths.list=this.depths.list.sort(function(a,b){return a-b}),this},compileProgram:function(program){var depth,result=(new this.compiler).compile(program,this.options),guid=this.guid++;this.usePartial=this.usePartial||result.usePartial,this.children[guid]=result;for(var i=0,l=result.depths.list.length;l>i;i++)depth=result.depths.list[i],2>depth||this.addDepth(depth-1);return guid},block:function(block){var mustache=block.mustache,program=block.program,inverse=block.inverse;program&&(program=this.compileProgram(program)),inverse&&(inverse=this.compileProgram(inverse));var type=this.classifyMustache(mustache);"helper"===type?this.helperMustache(mustache,program,inverse):"simple"===type?(this.simpleMustache(mustache),this.opcode("pushProgram",program),this.opcode("pushProgram",inverse),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousMustache(mustache,program,inverse),this.opcode("pushProgram",program),this.opcode("pushProgram",inverse),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(hash){var pair,val,pairs=hash.pairs;this.opcode("pushHash");for(var i=0,l=pairs.length;l>i;i++)pair=pairs[i],val=pair[1],this.options.stringParams?(val.depth&&this.addDepth(val.depth),this.opcode("getContext",val.depth||0),this.opcode("pushStringParam",val.stringModeValue,val.type)):this.accept(val),this.opcode("assignToHash",pair[0]);this.opcode("popHash")},partial:function(partial){var partialName=partial.partialName;this.usePartial=!0,partial.context?this.ID(partial.context):this.opcode("push","depth0"),this.opcode("invokePartial",partialName.name),this.opcode("append")},content:function(content){this.opcode("appendContent",content.string)},mustache:function(mustache){var options=this.options,type=this.classifyMustache(mustache);"simple"===type?this.simpleMustache(mustache):"helper"===type?this.helperMustache(mustache):this.ambiguousMustache(mustache),this.opcode(mustache.escaped&&!options.noEscape?"appendEscaped":"append")},ambiguousMustache:function(mustache,program,inverse){var id=mustache.id,name=id.parts[0],isBlock=null!=program||null!=inverse;this.opcode("getContext",id.depth),this.opcode("pushProgram",program),this.opcode("pushProgram",inverse),this.opcode("invokeAmbiguous",name,isBlock)},simpleMustache:function(mustache){var id=mustache.id;"DATA"===id.type?this.DATA(id):id.parts.length?this.ID(id):(this.addDepth(id.depth),this.opcode("getContext",id.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperMustache:function(mustache,program,inverse){var params=this.setupFullMustacheParams(mustache,program,inverse),name=mustache.id.parts[0];if(this.options.knownHelpers[name])this.opcode("invokeKnownHelper",params.length,name);else{if(this.options.knownHelpersOnly)throw new Error("You specified knownHelpersOnly, but used the unknown helper "+name);this.opcode("invokeHelper",params.length,name)}},ID:function(id){this.addDepth(id.depth),this.opcode("getContext",id.depth);var name=id.parts[0];name?this.opcode("lookupOnContext",id.parts[0]):this.opcode("pushContext");for(var i=1,l=id.parts.length;l>i;i++)this.opcode("lookup",id.parts[i])},DATA:function(data){if(this.options.data=!0,data.id.isScoped||data.id.depth)throw new Exception("Scoped data references are not supported: "+data.original);this.opcode("lookupData");for(var parts=data.id.parts,i=0,l=parts.length;l>i;i++)this.opcode("lookup",parts[i])},STRING:function(string){this.opcode("pushString",string.string)},INTEGER:function(integer){this.opcode("pushLiteral",integer.integer)},BOOLEAN:function(bool){this.opcode("pushLiteral",bool.bool)},comment:function(){},opcode:function(name){this.opcodes.push({opcode:name,args:[].slice.call(arguments,1)})},declare:function(name,value){this.opcodes.push({opcode:"DECLARE",name:name,value:value})},addDepth:function(depth){if(isNaN(depth))throw new Error("EWOT");0!==depth&&(this.depths[depth]||(this.depths[depth]=!0,this.depths.list.push(depth)))},classifyMustache:function(mustache){var isHelper=mustache.isHelper,isEligible=mustache.eligibleHelper,options=this.options;if(isEligible&&!isHelper){var name=mustache.id.parts[0];options.knownHelpers[name]?isHelper=!0:options.knownHelpersOnly&&(isEligible=!1)}return isHelper?"helper":isEligible?"ambiguous":"simple"},pushParams:function(params){for(var param,i=params.length;i--;)param=params[i],this.options.stringParams?(param.depth&&this.addDepth(param.depth),this.opcode("getContext",param.depth||0),this.opcode("pushStringParam",param.stringModeValue,param.type)):this[param.type](param)},setupMustacheParams:function(mustache){var params=mustache.params;return this.pushParams(params),mustache.hash?this.hash(mustache.hash):this.opcode("emptyHash"),params},setupFullMustacheParams:function(mustache,program,inverse){var params=mustache.params;return this.pushParams(params),this.opcode("pushProgram",program),this.opcode("pushProgram",inverse),mustache.hash?this.hash(mustache.hash):this.opcode("emptyHash"),params}},__exports__.precompile=precompile,__exports__.compile=compile,__exports__}(__module5__,__module8__,__module11__,__module7__),__module0__=function(__dependency1__,__dependency2__,__dependency3__,__dependency4__,__dependency5__){"use strict";var __exports__,Handlebars=__dependency1__,AST=__dependency2__,Parser=__dependency3__.parser,parse=__dependency3__.parse,Compiler=__dependency4__.Compiler,compile=__dependency4__.compile,precompile=__dependency4__.precompile,JavaScriptCompiler=__dependency5__,_create=Handlebars.create,create=function(){var hb=_create();return hb.compile=function(input,options){return compile(input,options,hb)},hb.precompile=precompile,hb.AST=AST,hb.Compiler=Compiler,hb.JavaScriptCompiler=JavaScriptCompiler,hb.Parser=Parser,hb.parse=parse,hb};return Handlebars=create(),Handlebars.create=create,__exports__=Handlebars}(__module1__,__module7__,__module8__,__module10__,__module11__);return __module0__}();!function(e){function S(e){throw RangeError(g[e])}function x(e,t){for(var n=e.length;n--;)e[n]=t(e[n]);return e}function T(e,t){return x(e.split(m),t).join(".")}function N(e){for(var i,s,t=[],n=0,r=e.length;r>n;)i=e.charCodeAt(n++),i>=55296&&56319>=i&&r>n?(s=e.charCodeAt(n++),56320==(64512&s)?t.push(((1023&i)<<10)+(1023&s)+65536):(t.push(i),n--)):t.push(i);
return t}function C(e){return x(e,function(e){var t="";return e>65535&&(e-=65536,t+=w(e>>>10&1023|55296),e=56320|1023&e),t+=w(e)}).join("")}function k(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:o}function L(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function A(e,t,n){var r=0;for(e=n?b(e/l):e>>1,e+=b(e/t);e>y*a>>1;r+=o)e=b(e/y);return b(r+(y+1)*e/(e+f))}function O(e){var r,d,v,m,g,y,w,E,x,N,t=[],n=e.length,i=0,f=h,l=c;for(d=e.lastIndexOf(p),0>d&&(d=0),v=0;d>v;++v)e.charCodeAt(v)>=128&&S("not-basic"),t.push(e.charCodeAt(v));for(m=d>0?d+1:0;n>m;){for(g=i,y=1,w=o;m>=n&&S("invalid-input"),E=k(e.charCodeAt(m++)),(E>=o||E>b((s-i)/y))&&S("overflow"),i+=E*y,x=l>=w?u:w>=l+a?a:w-l,!(x>E);w+=o)N=o-x,y>b(s/N)&&S("overflow"),y*=N;r=t.length+1,l=A(i-g,r,0==g),b(i/r)>s-f&&S("overflow"),f+=b(i/r),i%=r,t.splice(i++,0,f)}return C(t)}function M(e){var t,n,r,i,f,l,d,v,m,g,y,x,T,C,k,E=[];for(e=N(e),x=e.length,t=h,n=0,f=c,l=0;x>l;++l)y=e[l],128>y&&E.push(w(y));for(r=i=E.length,i&&E.push(p);x>r;){for(d=s,l=0;x>l;++l)y=e[l],y>=t&&d>y&&(d=y);for(T=r+1,d-t>b((s-n)/T)&&S("overflow"),n+=(d-t)*T,t=d,l=0;x>l;++l)if(y=e[l],t>y&&++n>s&&S("overflow"),y==t){for(v=n,m=o;g=f>=m?u:m>=f+a?a:m-f,!(g>v);m+=o)k=v-g,C=o-g,E.push(w(L(g+k%C,0))),v=b(k/C);E.push(w(L(v,0))),f=A(n,T,r==i),n=0,++r}++n,++t}return E.join("")}function _(e){return T(e,function(e){return d.test(e)?O(e.slice(4).toLowerCase()):e})}function D(e){return T(e,function(e){return v.test(e)?"xn--"+M(e):e})}var t="object"==typeof exports&&exports,n="object"==typeof module&&module&&module.exports==t&&module,r="object"==typeof global&&global;(r.global===r||r.window===r)&&(e=r);var i,E,s=2147483647,o=36,u=1,a=26,f=38,l=700,c=72,h=128,p="-",d=/^xn--/,v=/[^ -~]/,m=/\x2E|\u3002|\uFF0E|\uFF61/g,g={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},y=o-u,b=Math.floor,w=String.fromCharCode;if(i={version:"1.2.3",ucs2:{decode:N,encode:C},decode:O,encode:M,toASCII:D,toUnicode:_},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",[],function(){return i});else if(t&&!t.nodeType)if(n)n.exports=i;else for(E in i)i.hasOwnProperty(E)&&(t[E]=i[E]);else e.punycode=i}(this),function(e,t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define("IPv6",t):e.IPv6=t(e)}(this,function(e){function n(e){var t=e.toLowerCase(),n=t.split(":"),r=n.length,i=8;""===n[0]&&""===n[1]&&""===n[2]?(n.shift(),n.shift()):""===n[0]&&""===n[1]?n.shift():""===n[r-1]&&""===n[r-2]&&n.pop(),r=n.length,-1!==n[r-1].indexOf(".")&&(i=7);var s;for(s=0;r>s&&""!==n[s];s++);if(i>s){for(n.splice(s,1,"0000");n.length<i;)n.splice(s,0,"0000");r=n.length}for(var o,u=0;i>u;u++){o=n[u].split("");for(var a=0;3>a&&("0"===o[0]&&o.length>1);a++)o.splice(0,1);n[u]=o.join("")}var f=-1,l=0,c=0,h=-1,p=!1;for(u=0;i>u;u++)p?"0"===n[u]?c+=1:(p=!1,c>l&&(f=h,l=c)):"0"==n[u]&&(p=!0,h=u,c=1);c>l&&(f=h,l=c),l>1&&n.splice(f,l,""),r=n.length;var d="";for(""===n[0]&&(beststr=":"),u=0;r>u&&(d+=n[u],u!==r-1);u++)d+=":";return""===n[r-1]&&(d+=":"),d}function r(){return e.IPv6===this&&(e.IPv6=t),this}var t=e&&e.IPv6;return{best:n,noConflict:r}}),function(e,t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define("SecondLevelDomains",t):e.SecondLevelDomains=t(e)}(this,function(e){var t=e&&e.SecondLevelDomains,n=Object.prototype.hasOwnProperty,r={list:{ac:"com|gov|mil|net|org",ae:"ac|co|gov|mil|name|net|org|pro|sch",af:"com|edu|gov|net|org",al:"com|edu|gov|mil|net|org",ao:"co|ed|gv|it|og|pb",ar:"com|edu|gob|gov|int|mil|net|org|tur",at:"ac|co|gv|or",au:"asn|com|csiro|edu|gov|id|net|org",ba:"co|com|edu|gov|mil|net|org|rs|unbi|unmo|unsa|untz|unze",bb:"biz|co|com|edu|gov|info|net|org|store|tv",bh:"biz|cc|com|edu|gov|info|net|org",bn:"com|edu|gov|net|org",bo:"com|edu|gob|gov|int|mil|net|org|tv",br:"adm|adv|agr|am|arq|art|ato|b|bio|blog|bmd|cim|cng|cnt|com|coop|ecn|edu|eng|esp|etc|eti|far|flog|fm|fnd|fot|fst|g12|ggf|gov|imb|ind|inf|jor|jus|lel|mat|med|mil|mus|net|nom|not|ntr|odo|org|ppg|pro|psc|psi|qsl|rec|slg|srv|tmp|trd|tur|tv|vet|vlog|wiki|zlg",bs:"com|edu|gov|net|org",bz:"du|et|om|ov|rg",ca:"ab|bc|mb|nb|nf|nl|ns|nt|nu|on|pe|qc|sk|yk",ck:"biz|co|edu|gen|gov|info|net|org",cn:"ac|ah|bj|com|cq|edu|fj|gd|gov|gs|gx|gz|ha|hb|he|hi|hl|hn|jl|js|jx|ln|mil|net|nm|nx|org|qh|sc|sd|sh|sn|sx|tj|tw|xj|xz|yn|zj",co:"com|edu|gov|mil|net|nom|org",cr:"ac|c|co|ed|fi|go|or|sa",cy:"ac|biz|com|ekloges|gov|ltd|name|net|org|parliament|press|pro|tm","do":"art|com|edu|gob|gov|mil|net|org|sld|web",dz:"art|asso|com|edu|gov|net|org|pol",ec:"com|edu|fin|gov|info|med|mil|net|org|pro",eg:"com|edu|eun|gov|mil|name|net|org|sci",er:"com|edu|gov|ind|mil|net|org|rochest|w",es:"com|edu|gob|nom|org",et:"biz|com|edu|gov|info|name|net|org",fj:"ac|biz|com|info|mil|name|net|org|pro",fk:"ac|co|gov|net|nom|org",fr:"asso|com|f|gouv|nom|prd|presse|tm",gg:"co|net|org",gh:"com|edu|gov|mil|org",gn:"ac|com|gov|net|org",gr:"com|edu|gov|mil|net|org",gt:"com|edu|gob|ind|mil|net|org",gu:"com|edu|gov|net|org",hk:"com|edu|gov|idv|net|org",id:"ac|co|go|mil|net|or|sch|web",il:"ac|co|gov|idf|k12|muni|net|org","in":"ac|co|edu|ernet|firm|gen|gov|i|ind|mil|net|nic|org|res",iq:"com|edu|gov|i|mil|net|org",ir:"ac|co|dnssec|gov|i|id|net|org|sch",it:"edu|gov",je:"co|net|org",jo:"com|edu|gov|mil|name|net|org|sch",jp:"ac|ad|co|ed|go|gr|lg|ne|or",ke:"ac|co|go|info|me|mobi|ne|or|sc",kh:"com|edu|gov|mil|net|org|per",ki:"biz|com|de|edu|gov|info|mob|net|org|tel",km:"asso|com|coop|edu|gouv|k|medecin|mil|nom|notaires|pharmaciens|presse|tm|veterinaire",kn:"edu|gov|net|org",kr:"ac|busan|chungbuk|chungnam|co|daegu|daejeon|es|gangwon|go|gwangju|gyeongbuk|gyeonggi|gyeongnam|hs|incheon|jeju|jeonbuk|jeonnam|k|kg|mil|ms|ne|or|pe|re|sc|seoul|ulsan",kw:"com|edu|gov|net|org",ky:"com|edu|gov|net|org",kz:"com|edu|gov|mil|net|org",lb:"com|edu|gov|net|org",lk:"assn|com|edu|gov|grp|hotel|int|ltd|net|ngo|org|sch|soc|web",lr:"com|edu|gov|net|org",lv:"asn|com|conf|edu|gov|id|mil|net|org",ly:"com|edu|gov|id|med|net|org|plc|sch",ma:"ac|co|gov|m|net|org|press",mc:"asso|tm",me:"ac|co|edu|gov|its|net|org|priv",mg:"com|edu|gov|mil|nom|org|prd|tm",mk:"com|edu|gov|inf|name|net|org|pro",ml:"com|edu|gov|net|org|presse",mn:"edu|gov|org",mo:"com|edu|gov|net|org",mt:"com|edu|gov|net|org",mv:"aero|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro",mw:"ac|co|com|coop|edu|gov|int|museum|net|org",mx:"com|edu|gob|net|org",my:"com|edu|gov|mil|name|net|org|sch",nf:"arts|com|firm|info|net|other|per|rec|store|web",ng:"biz|com|edu|gov|mil|mobi|name|net|org|sch",ni:"ac|co|com|edu|gob|mil|net|nom|org",np:"com|edu|gov|mil|net|org",nr:"biz|com|edu|gov|info|net|org",om:"ac|biz|co|com|edu|gov|med|mil|museum|net|org|pro|sch",pe:"com|edu|gob|mil|net|nom|org|sld",ph:"com|edu|gov|i|mil|net|ngo|org",pk:"biz|com|edu|fam|gob|gok|gon|gop|gos|gov|net|org|web",pl:"art|bialystok|biz|com|edu|gda|gdansk|gorzow|gov|info|katowice|krakow|lodz|lublin|mil|net|ngo|olsztyn|org|poznan|pwr|radom|slupsk|szczecin|torun|warszawa|waw|wroc|wroclaw|zgora",pr:"ac|biz|com|edu|est|gov|info|isla|name|net|org|pro|prof",ps:"com|edu|gov|net|org|plo|sec",pw:"belau|co|ed|go|ne|or",ro:"arts|com|firm|info|nom|nt|org|rec|store|tm|www",rs:"ac|co|edu|gov|in|org",sb:"com|edu|gov|net|org",sc:"com|edu|gov|net|org",sh:"co|com|edu|gov|net|nom|org",sl:"com|edu|gov|net|org",st:"co|com|consulado|edu|embaixada|gov|mil|net|org|principe|saotome|store",sv:"com|edu|gob|org|red",sz:"ac|co|org",tr:"av|bbs|bel|biz|com|dr|edu|gen|gov|info|k12|name|net|org|pol|tel|tsk|tv|web",tt:"aero|biz|cat|co|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|pro|tel|travel",tw:"club|com|ebiz|edu|game|gov|idv|mil|net|org",mu:"ac|co|com|gov|net|or|org",mz:"ac|co|edu|gov|org",na:"co|com",nz:"ac|co|cri|geek|gen|govt|health|iwi|maori|mil|net|org|parliament|school",pa:"abo|ac|com|edu|gob|ing|med|net|nom|org|sld",pt:"com|edu|gov|int|net|nome|org|publ",py:"com|edu|gov|mil|net|org",qa:"com|edu|gov|mil|net|org",re:"asso|com|nom",ru:"ac|adygeya|altai|amur|arkhangelsk|astrakhan|bashkiria|belgorod|bir|bryansk|buryatia|cbg|chel|chelyabinsk|chita|chukotka|chuvashia|com|dagestan|e-burg|edu|gov|grozny|int|irkutsk|ivanovo|izhevsk|jar|joshkar-ola|kalmykia|kaluga|kamchatka|karelia|kazan|kchr|kemerovo|khabarovsk|khakassia|khv|kirov|koenig|komi|kostroma|kranoyarsk|kuban|kurgan|kursk|lipetsk|magadan|mari|mari-el|marine|mil|mordovia|mosreg|msk|murmansk|nalchik|net|nnov|nov|novosibirsk|nsk|omsk|orenburg|org|oryol|penza|perm|pp|pskov|ptz|rnd|ryazan|sakhalin|samara|saratov|simbirsk|smolensk|spb|stavropol|stv|surgut|tambov|tatarstan|tom|tomsk|tsaritsyn|tsk|tula|tuva|tver|tyumen|udm|udmurtia|ulan-ude|vladikavkaz|vladimir|vladivostok|volgograd|vologda|voronezh|vrn|vyatka|yakutia|yamal|yekaterinburg|yuzhno-sakhalinsk",rw:"ac|co|com|edu|gouv|gov|int|mil|net",sa:"com|edu|gov|med|net|org|pub|sch",sd:"com|edu|gov|info|med|net|org|tv",se:"a|ac|b|bd|c|d|e|f|g|h|i|k|l|m|n|o|org|p|parti|pp|press|r|s|t|tm|u|w|x|y|z",sg:"com|edu|gov|idn|net|org|per",sn:"art|com|edu|gouv|org|perso|univ",sy:"com|edu|gov|mil|net|news|org",th:"ac|co|go|in|mi|net|or",tj:"ac|biz|co|com|edu|go|gov|info|int|mil|name|net|nic|org|test|web",tn:"agrinet|com|defense|edunet|ens|fin|gov|ind|info|intl|mincom|nat|net|org|perso|rnrt|rns|rnu|tourism",tz:"ac|co|go|ne|or",ua:"biz|cherkassy|chernigov|chernovtsy|ck|cn|co|com|crimea|cv|dn|dnepropetrovsk|donetsk|dp|edu|gov|if|in|ivano-frankivsk|kh|kharkov|kherson|khmelnitskiy|kiev|kirovograd|km|kr|ks|kv|lg|lugansk|lutsk|lviv|me|mk|net|nikolaev|od|odessa|org|pl|poltava|pp|rovno|rv|sebastopol|sumy|te|ternopil|uzhgorod|vinnica|vn|zaporizhzhe|zhitomir|zp|zt",ug:"ac|co|go|ne|or|org|sc",uk:"ac|bl|british-library|co|cym|gov|govt|icnet|jet|lea|ltd|me|mil|mod|national-library-scotland|nel|net|nhs|nic|nls|org|orgn|parliament|plc|police|sch|scot|soc",us:"dni|fed|isa|kids|nsn",uy:"com|edu|gub|mil|net|org",ve:"co|com|edu|gob|info|mil|net|org|web",vi:"co|com|k12|net|org",vn:"ac|biz|com|edu|gov|health|info|int|name|net|org|pro",ye:"co|com|gov|ltd|me|net|org|plc",yu:"ac|co|edu|gov|org",za:"ac|agric|alt|bourse|city|co|cybernet|db|edu|gov|grondar|iaccess|imt|inca|landesign|law|mil|net|ngo|nis|nom|olivetti|org|pix|school|tm|web",zm:"ac|co|com|edu|gov|net|org|sch"},has_expression:null,is_expression:null,has:function(e){return!!e.match(r.has_expression)},is:function(e){return!!e.match(r.is_expression)},get:function(e){var t=e.match(r.has_expression);return t&&t[1]||null},noConflict:function(){return e.SecondLevelDomains===this&&(e.SecondLevelDomains=t),this},init:function(){var e="";for(var t in r.list)if(n.call(r.list,t)){var i="("+r.list[t]+")."+t;e+="|("+i+")"}r.has_expression=new RegExp("\\.("+e.substr(1)+")$","i"),r.is_expression=new RegExp("^("+e.substr(1)+")$","i")}};return r.init(),r}),function(e,t){"object"==typeof exports?module.exports=t(require("./punycode"),require("./IPv6"),require("./SecondLevelDomains")):"function"==typeof define&&define.amd?define("URI",["./punycode","./IPv6","./SecondLevelDomains"],t):e.URI=t(e.punycode,e.IPv6,e.SecondLevelDomains,e)}(this,function(e,t,n,r){function s(e,t){return this instanceof s?(void 0===e&&(e="undefined"!=typeof location?location.href+"":""),this.href(e),void 0!==t?this.absoluteTo(t):this):new s(e,t)}function a(e){return e.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function f(e){return void 0===e?"Undefined":String(Object.prototype.toString.call(e)).slice(8,-1)}function l(e){return"Array"===f(e)}function c(e,t){var r,i,n={};if(l(t))for(r=0,i=t.length;i>r;r++)n[t[r]]=!0;else n[t]=!0;for(r=0,i=e.length;i>r;r++)void 0!==n[e[r]]&&(e.splice(r,1),i--,r--);return e}function h(e,t){var n,r;if(l(t)){for(n=0,r=t.length;r>n;n++)if(!h(e,t[n]))return!1;return!0}var i=f(t);for(n=0,r=e.length;r>n;n++)if("RegExp"===i){if("string"==typeof e[n]&&e[n].match(t))return!0}else if(e[n]===t)return!0;return!1}function p(e,t){if(!l(e)||!l(t))return!1;if(e.length!==t.length)return!1;e.sort(),t.sort();for(var n=0,r=e.length;r>n;n++)if(e[n]!==t[n])return!1;return!0}function d(e){return escape(e)}function v(e){return encodeURIComponent(e).replace(/[!'()*]/g,d).replace(/\*/g,"%2A")}var i=r&&r.URI,o=s.prototype,u=Object.prototype.hasOwnProperty;s._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,duplicateQueryParameters:s.duplicateQueryParameters,escapeQuerySpace:s.escapeQuerySpace}},s.duplicateQueryParameters=!1,s.escapeQuerySpace=!0,s.protocol_expression=/^[a-z][a-z0-9-+-]*$/i,s.idn_expression=/[^a-z0-9\.-]/i,s.punycode_expression=/(xn--)/i,s.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,s.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,s.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi,s.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},s.invalid_hostname_characters=/[^a-zA-Z0-9\.-]/,s.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src"},s.getDomAttribute=function(e){if(!e||!e.nodeName)return void 0;var t=e.nodeName.toLowerCase();return"input"===t&&"image"!==e.type?void 0:s.domAttributes[t]},s.encode=v,s.decode=decodeURIComponent,s.iso8859=function(){s.encode=escape,s.decode=unescape},s.unicode=function(){s.encode=v,s.decode=decodeURIComponent},s.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}}},s.encodeQuery=function(e,t){var n=s.encode(e+"");return t?n.replace(/%20/g,"+"):n},s.decodeQuery=function(e,t){e+="";try{return s.decode(t?e.replace(/\+/g,"%20"):e)}catch(n){return e}},s.recodePath=function(e){for(var t=(e+"").split("/"),n=0,r=t.length;r>n;n++)t[n]=s.encodePathSegment(s.decode(t[n]));return t.join("/")},s.decodePath=function(e){for(var t=(e+"").split("/"),n=0,r=t.length;r>n;n++)t[n]=s.decodePathSegment(t[n]);return t.join("/")};var g,m={encode:"encode",decode:"decode"},y=function(e,t){return function(n){return s[t](n+"").replace(s.characters[e][t].expression,function(n){return s.characters[e][t].map[n]})}};for(g in m)s[g+"PathSegment"]=y("pathname",m[g]);s.encodeReserved=y("reserved","encode"),s.parse=function(e,t){var n;return t||(t={}),n=e.indexOf("#"),n>-1&&(t.fragment=e.substring(n+1)||null,e=e.substring(0,n)),n=e.indexOf("?"),n>-1&&(t.query=e.substring(n+1)||null,e=e.substring(0,n)),"//"===e.substring(0,2)?(t.protocol=null,e=e.substring(2),e=s.parseAuthority(e,t)):(n=e.indexOf(":"),n>-1&&(t.protocol=e.substring(0,n)||null,t.protocol&&!t.protocol.match(s.protocol_expression)?t.protocol=void 0:"file"===t.protocol?e=e.substring(n+3):"//"===e.substring(n+1,n+3)?(e=e.substring(n+3),e=s.parseAuthority(e,t)):(e=e.substring(n+1),t.urn=!0))),t.path=e,t},s.parseHost=function(e,t){var r,i,n=e.indexOf("/");return-1===n&&(n=e.length),"["===e.charAt(0)?(r=e.indexOf("]"),t.hostname=e.substring(1,r)||null,t.port=e.substring(r+2,n)||null):e.indexOf(":")!==e.lastIndexOf(":")?(t.hostname=e.substring(0,n)||null,t.port=null):(i=e.substring(0,n).split(":"),t.hostname=i[0]||null,t.port=i[1]||null),t.hostname&&"/"!==e.substring(n).charAt(0)&&(n++,e="/"+e),e.substring(n)||"/"},s.parseAuthority=function(e,t){return e=s.parseUserinfo(e,t),s.parseHost(e,t)},s.parseUserinfo=function(e,t){var i,n=e.indexOf("/"),r=n>-1?e.lastIndexOf("@",n):e.indexOf("@");return r>-1&&(-1===n||n>r)?(i=e.substring(0,r).split(":"),t.username=i[0]?s.decode(i[0]):null,i.shift(),t.password=i[0]?s.decode(i.join(":")):null,e=e.substring(r+1)):(t.username=null,t.password=null),e},s.parseQuery=function(e,t){if(!e)return{};if(e=e.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,""),!e)return{};for(var o,u,a,n={},r=e.split("&"),i=r.length,f=0;i>f;f++)o=r[f].split("="),u=s.decodeQuery(o.shift(),t),a=o.length?s.decodeQuery(o.join("="),t):null,n[u]?("string"==typeof n[u]&&(n[u]=[n[u]]),n[u].push(a)):n[u]=a;return n},s.build=function(e){var t="";return e.protocol&&(t+=e.protocol+":"),!e.urn&&(t||e.hostname)&&(t+="//"),t+=s.buildAuthority(e)||"","string"==typeof e.path&&("/"!==e.path.charAt(0)&&"string"==typeof e.hostname&&(t+="/"),t+=e.path),"string"==typeof e.query&&e.query&&(t+="?"+e.query),"string"==typeof e.fragment&&e.fragment&&(t+="#"+e.fragment),t},s.buildHost=function(e){var t="";return e.hostname?(s.ip6_expression.test(e.hostname)?t+=e.port?"["+e.hostname+"]:"+e.port:e.hostname:(t+=e.hostname,e.port&&(t+=":"+e.port)),t):""},s.buildAuthority=function(e){return s.buildUserinfo(e)+s.buildHost(e)},s.buildUserinfo=function(e){var t="";return e.username&&(t+=s.encode(e.username),e.password&&(t+=":"+s.encode(e.password)),t+="@"),t},s.buildQuery=function(e,t,n){var i,o,a,f,r="";for(o in e)if(u.call(e,o)&&o)if(l(e[o]))for(i={},a=0,f=e[o].length;f>a;a++)void 0!==e[o][a]&&void 0===i[e[o][a]+""]&&(r+="&"+s.buildQueryParameter(o,e[o][a],n),t!==!0&&(i[e[o][a]+""]=!0));else void 0!==e[o]&&(r+="&"+s.buildQueryParameter(o,e[o],n));return r.substring(1)},s.buildQueryParameter=function(e,t,n){return s.encodeQuery(e,n)+(null!==t?"="+s.encodeQuery(t,n):"")},s.addQuery=function(e,t,n){if("object"==typeof t)for(var r in t)u.call(t,r)&&s.addQuery(e,r,t[r]);else{if("string"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===e[t])return void(e[t]=n);"string"==typeof e[t]&&(e[t]=[e[t]]),l(n)||(n=[n]),e[t]=e[t].concat(n)}},s.removeQuery=function(e,t,n){var r,i,o;if(l(t))for(r=0,i=t.length;i>r;r++)e[t[r]]=void 0;else if("object"==typeof t)for(o in t)u.call(t,o)&&s.removeQuery(e,o,t[o]);else{if("string"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the first parameter");void 0!==n?e[t]===n?e[t]=void 0:l(e[t])&&(e[t]=c(e[t],n)):e[t]=void 0}},s.hasQuery=function(e,t,n,r){if("object"==typeof t){for(var i in t)if(u.call(t,i)&&!s.hasQuery(e,i,t[i]))return!1;return!0}if("string"!=typeof t)throw new TypeError("URI.hasQuery() accepts an object, string as the name parameter");switch(f(n)){case"Undefined":return t in e;case"Boolean":var o=Boolean(l(e[t])?e[t].length:e[t]);return n===o;case"Function":return!!n(e[t],t,e);case"Array":if(!l(e[t]))return!1;var a=r?h:p;return a(e[t],n);case"RegExp":return l(e[t])?r?h(e[t],n):!1:Boolean(e[t]&&e[t].match(n));case"Number":n=String(n);case"String":return l(e[t])?r?h(e[t],n):!1:e[t]===n;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},s.commonPath=function(e,t){var r,n=Math.min(e.length,t.length);for(r=0;n>r;r++)if(e.charAt(r)!==t.charAt(r)){r--;break}return 1>r?e.charAt(0)===t.charAt(0)&&"/"===e.charAt(0)?"/":"":(("/"!==e.charAt(r)||"/"!==t.charAt(r))&&(r=e.substring(0,r).lastIndexOf("/")),e.substring(0,r+1))},s.withinString=function(e,t){return e.replace(s.find_uri_expression,t)},s.ensureValidHostname=function(t){if(t.match(s.invalid_hostname_characters)){if(!e)throw new TypeError("Hostname '"+t+"' contains characters other than [A-Z0-9.-] and Punycode.js is not available");if(e.toASCII(t).match(s.invalid_hostname_characters))throw new TypeError("Hostname '"+t+"' contains characters other than [A-Z0-9.-]")}},s.noConflict=function(e){if(e){var n={URI:this.noConflict()};return URITemplate&&"function"==typeof URITemplate.noConflict&&(n.URITemplate=URITemplate.noConflict()),t&&"function"==typeof t.noConflict&&(n.IPv6=t.noConflict()),SecondLevelDomains&&"function"==typeof SecondLevelDomains.noConflict&&(n.SecondLevelDomains=SecondLevelDomains.noConflict()),n}return r.URI===this&&(r.URI=i),this},o.build=function(e){return e===!0?this._deferred_build=!0:(void 0===e||this._deferred_build)&&(this._string=s.build(this._parts),this._deferred_build=!1),this},o.clone=function(){return new s(this)},o.valueOf=o.toString=function(){return this.build(!1)._string},m={protocol:"protocol",username:"username",password:"password",hostname:"hostname",port:"port"},y=function(e){return function(t,n){return void 0===t?this._parts[e]||"":(this._parts[e]=t||null,this.build(!n),this)}};for(g in m)o[g]=y(m[g]);m={query:"?",fragment:"#"},y=function(e,t){return function(n,r){return void 0===n?this._parts[e]||"":(null!==n&&(n+="",n.charAt(0)===t&&(n=n.substring(1))),this._parts[e]=n,this.build(!r),this)}};for(g in m)o[g]=y(g,m[g]);m={search:["?","query"],hash:["#","fragment"]},y=function(e,t){return function(n,r){var i=this[e](n,r);return"string"==typeof i&&i.length?t+i:i}};for(g in m)o[g]=y(m[g][1],m[g][0]);o.pathname=function(e,t){if(void 0===e||e===!0){var n=this._parts.path||(this._parts.hostname?"/":"");return e?s.decodePath(n):n}return this._parts.path=e?s.recodePath(e):"/",this.build(!t),this},o.path=o.pathname,o.href=function(e,t){var n;if(void 0===e)return this.toString();this._string="",this._parts=s._parts();var r=e instanceof s,i="object"==typeof e&&(e.hostname||e.path||e.pathname);if(e.nodeName){var o=s.getDomAttribute(e);e=e[o]||"",i=!1}if(!r&&i&&void 0!==e.pathname&&(e=e.toString()),"string"==typeof e)this._parts=s.parse(e,this._parts);else{if(!r&&!i)throw new TypeError("invalid input");var a=r?e._parts:e;for(n in a)u.call(this._parts,n)&&(this._parts[n]=a[n])}return this.build(!t),this},o.is=function(e){var t=!1,r=!1,i=!1,o=!1,u=!1,a=!1,f=!1,l=!this._parts.urn;switch(this._parts.hostname&&(l=!1,r=s.ip4_expression.test(this._parts.hostname),i=s.ip6_expression.test(this._parts.hostname),t=r||i,o=!t,u=o&&n&&n.has(this._parts.hostname),a=o&&s.idn_expression.test(this._parts.hostname),f=o&&s.punycode_expression.test(this._parts.hostname)),e.toLowerCase()){case"relative":return l;case"absolute":return!l;case"domain":case"name":return o;case"sld":return u;case"ip":return t;case"ip4":case"ipv4":case"inet4":return r;case"ip6":case"ipv6":case"inet6":return i;case"idn":return a;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return f}return null};var b=o.protocol,w=o.port,E=o.hostname;o.protocol=function(e,t){if(void 0!==e&&e&&(e=e.replace(/:(\/\/)?$/,""),e.match(/[^a-zA-z0-9\.+-]/)))throw new TypeError("Protocol '"+e+"' contains characters other than [A-Z0-9.+-]");return b.call(this,e,t)},o.scheme=o.protocol,o.port=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0!==e&&(0===e&&(e=null),e&&(e+="",":"===e.charAt(0)&&(e=e.substring(1)),e.match(/[^0-9]/))))throw new TypeError("Port '"+e+"' contains characters other than [0-9]");return w.call(this,e,t)},o.hostname=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0!==e){var n={};s.parseHost(e,n),e=n.hostname}return E.call(this,e,t)},o.host=function(e,t){return this._parts.urn?void 0===e?"":this:void 0===e?this._parts.hostname?s.buildHost(this._parts):"":(s.parseHost(e,this._parts),this.build(!t),this)},o.authority=function(e,t){return this._parts.urn?void 0===e?"":this:void 0===e?this._parts.hostname?s.buildAuthority(this._parts):"":(s.parseAuthority(e,this._parts),this.build(!t),this)},o.userinfo=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){if(!this._parts.username)return"";var n=s.buildUserinfo(this._parts);return n.substring(0,n.length-1)}return"@"!==e[e.length-1]&&(e+="@"),s.parseUserinfo(e,this._parts),this.build(!t),this},o.resource=function(e,t){var n;return void 0===e?this.path()+this.search()+this.hash():(n=s.parse(e),this._parts.path=n.path,this._parts.query=n.query,this._parts.fragment=n.fragment,this.build(!t),this)},o.subdomain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,n)||""}var r=this._parts.hostname.length-this.domain().length,i=this._parts.hostname.substring(0,r),o=new RegExp("^"+a(i));return e&&"."!==e.charAt(e.length-1)&&(e+="."),e&&s.ensureValidHostname(e),this._parts.hostname=this._parts.hostname.replace(o,e),this.build(!t),this},o.domain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.match(/\./g);if(n&&n.length<2)return this._parts.hostname;var r=this._parts.hostname.length-this.tld(t).length-1;return r=this._parts.hostname.lastIndexOf(".",r-1)+1,this._parts.hostname.substring(r)||""}if(!e)throw new TypeError("cannot set domain empty");if(s.ensureValidHostname(e),!this._parts.hostname||this.is("IP"))this._parts.hostname=e;else{var i=new RegExp(a(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(i,e)}return this.build(!t),this},o.tld=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var r=this._parts.hostname.lastIndexOf("."),i=this._parts.hostname.substring(r+1);return t!==!0&&n&&n.list[i.toLowerCase()]?n.get(this._parts.hostname)||i:i}var s;if(!e)throw new TypeError("cannot set TLD empty");if(e.match(/[^a-zA-Z0-9-]/)){if(!n||!n.is(e))throw new TypeError("TLD '"+e+"' contains characters other than [A-Z0-9]");s=new RegExp(a(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(s,e)}else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");s=new RegExp(a(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(s,e)}return this.build(!t),this},o.directory=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||e===!0){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var n=this._parts.path.length-this.filename().length-1,r=this._parts.path.substring(0,n)||(this._parts.hostname?"/":"");return e?s.decodePath(r):r}var i=this._parts.path.length-this.filename().length,o=this._parts.path.substring(0,i),u=new RegExp("^"+a(o));return this.is("relative")||(e||(e="/"),"/"!==e.charAt(0)&&(e="/"+e)),e&&"/"!==e.charAt(e.length-1)&&(e+="/"),e=s.recodePath(e),this._parts.path=this._parts.path.replace(u,e),this.build(!t),this},o.filename=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||e===!0){if(!this._parts.path||"/"===this._parts.path)return"";var n=this._parts.path.lastIndexOf("/"),r=this._parts.path.substring(n+1);return e?s.decodePathSegment(r):r}var i=!1;"/"===e.charAt(0)&&(e=e.substring(1)),e.match(/\.?\//)&&(i=!0);var o=new RegExp(a(this.filename())+"$");return e=s.recodePath(e),this._parts.path=this._parts.path.replace(o,e),i?this.normalizePath(t):this.build(!t),this},o.suffix=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||e===!0){if(!this._parts.path||"/"===this._parts.path)return"";var i,o,n=this.filename(),r=n.lastIndexOf(".");return-1===r?"":(i=n.substring(r+1),o=/^[a-z0-9%]+$/i.test(i)?i:"",e?s.decodePathSegment(o):o)}"."===e.charAt(0)&&(e=e.substring(1));var f,u=this.suffix();if(u)f=new RegExp(e?a(u)+"$":a("."+u)+"$");else{if(!e)return this;this._parts.path+="."+s.recodePath(e)}return f&&(e=s.recodePath(e),this._parts.path=this._parts.path.replace(f,e)),this.build(!t),this},o.segment=function(e,t,n){var r=this._parts.urn?":":"/",i=this.path(),s="/"===i.substring(0,1),o=i.split(r);if(void 0!==e&&"number"!=typeof e&&(n=t,t=e,e=void 0),void 0!==e&&"number"!=typeof e)throw new Error("Bad segment '"+e+"', must be 0-based integer");if(s&&o.shift(),0>e&&(e=Math.max(o.length+e,0)),void 0===t)return void 0===e?o:o[e];if(null===e||void 0===o[e])if(l(t)){o=[];for(var u=0,a=t.length;a>u;u++)(t[u].length||o.length&&o[o.length-1].length)&&(o.length&&!o[o.length-1].length&&o.pop(),o.push(t[u]))}else(t||"string"==typeof t)&&(""===o[o.length-1]?o[o.length-1]=t:o.push(t));else t||"string"==typeof t&&t.length?o[e]=t:o.splice(e,1);return s&&o.unshift(""),this.path(o.join(r),n)},o.segmentCoded=function(e,t,n){var r,i,o;if("number"!=typeof e&&(n=t,t=e,e=void 0),void 0===t){if(r=this.segment(e,t,n),l(r))for(i=0,o=r.length;o>i;i++)r[i]=s.decode(r[i]);else r=void 0!==r?s.decode(r):void 0;return r}if(l(t))for(i=0,o=t.length;o>i;i++)t[i]=s.decode(t[i]);else t="string"==typeof t?s.encode(t):t;return this.segment(e,t,n)};var S=o.query;return o.query=function(e,t){if(e===!0)return s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("function"==typeof e){var n=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace),r=e.call(this,n);return this._parts.query=s.buildQuery(r||n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this}return void 0!==e&&"string"!=typeof e?(this._parts.query=s.buildQuery(e,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this):S.call(this,e,t)},o.setQuery=function(e,t,n){var r=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("object"==typeof e)for(var i in e)u.call(e,i)&&(r[i]=e[i]);else{if("string"!=typeof e)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");r[e]=void 0!==t?t:null}return this._parts.query=s.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(n=t),this.build(!n),this},o.addQuery=function(e,t,n){var r=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return s.addQuery(r,e,void 0===t?null:t),this._parts.query=s.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(n=t),this.build(!n),this},o.removeQuery=function(e,t,n){var r=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return s.removeQuery(r,e,t),this._parts.query=s.buildQuery(r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(n=t),this.build(!n),this},o.hasQuery=function(e,t,n){var r=s.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return s.hasQuery(r,e,t,n)},o.setSearch=o.setQuery,o.addSearch=o.addQuery,o.removeSearch=o.removeQuery,o.hasSearch=o.hasQuery,o.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},o.normalizeProtocol=function(e){return"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!e)),this},o.normalizeHostname=function(n){return this._parts.hostname&&(this.is("IDN")&&e?this._parts.hostname=e.toASCII(this._parts.hostname):this.is("IPv6")&&t&&(this._parts.hostname=t.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!n)),this
},o.normalizePort=function(e){return"string"==typeof this._parts.protocol&&this._parts.port===s.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!e)),this},o.normalizePath=function(e){if(this._parts.urn)return this;if(!this._parts.path||"/"===this._parts.path)return this;var t,r,i,n=this._parts.path;for("/"!==n.charAt(0)&&(t=!0,n="/"+n),n=n.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/");r=n.indexOf("/../"),-1!==r;){if(0===r){n=n.substring(3);break}i=n.substring(0,r).lastIndexOf("/"),-1===i&&(i=r),n=n.substring(0,i)+n.substring(r+3)}return t&&this.is("relative")&&(n=n.substring(1)),n=s.recodePath(n),this._parts.path=n,this.build(!e),this},o.normalizePathname=o.normalizePath,o.normalizeQuery=function(e){return"string"==typeof this._parts.query&&(this._parts.query.length?this.query(s.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!e)),this},o.normalizeFragment=function(e){return this._parts.fragment||(this._parts.fragment=null,this.build(!e)),this},o.normalizeSearch=o.normalizeQuery,o.normalizeHash=o.normalizeFragment,o.iso8859=function(){var e=s.encode,t=s.decode;return s.encode=escape,s.decode=decodeURIComponent,this.normalize(),s.encode=e,s.decode=t,this},o.unicode=function(){var e=s.encode,t=s.decode;return s.encode=v,s.decode=unescape,this.normalize(),s.encode=e,s.decode=t,this},o.readable=function(){var t=this.clone();t.username("").password("").normalize();var n="";if(t._parts.protocol&&(n+=t._parts.protocol+"://"),t._parts.hostname&&(t.is("punycode")&&e?(n+=e.toUnicode(t._parts.hostname),t._parts.port&&(n+=":"+t._parts.port)):n+=t.host()),t._parts.hostname&&t._parts.path&&"/"!==t._parts.path.charAt(0)&&(n+="/"),n+=t.path(!0),t._parts.query){for(var r="",i=0,o=t._parts.query.split("&"),u=o.length;u>i;i++){var a=(o[i]||"").split("=");r+="&"+s.decodeQuery(a[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),void 0!==a[1]&&(r+="="+s.decodeQuery(a[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}n+="?"+r.substring(1)}return n+=s.decodeQuery(t.hash(),!0)},o.absoluteTo=function(e){var r,i,o,t=this.clone(),n=["protocol","username","password","hostname","port"];if(this._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e instanceof s||(e=new s(e)),t._parts.protocol||(t._parts.protocol=e._parts.protocol),this._parts.hostname)return t;for(i=0;o=n[i];i++)t._parts[o]=e._parts[o];for(n=["query","path"],i=0;o=n[i];i++)!t._parts[o]&&e._parts[o]&&(t._parts[o]=e._parts[o]);return"/"!==t.path().charAt(0)&&(r=e.directory(),t._parts.path=(r?r+"/":"")+t._parts.path,t.normalizePath()),t.build(),t},o.relativeTo=function(e){var n,r,i,o,u,t=this.clone().normalize();if(t._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e=new s(e).normalize(),n=t._parts,r=e._parts,o=t.path(),u=e.path(),"/"!==o.charAt(0))throw new Error("URI is already relative");if("/"!==u.charAt(0))throw new Error("Cannot calculate a URI relative to another relative URI");if(n.protocol===r.protocol&&(n.protocol=null),n.username!==r.username||n.password!==r.password)return t.build();if(null!==n.protocol||null!==n.username||null!==n.password)return t.build();if(n.hostname!==r.hostname||n.port!==r.port)return t.build();if(n.hostname=null,n.port=null,o===u)return n.path="",t.build();if(i=s.commonPath(t.path(),e.path()),!i)return t.build();var a=r.path.substring(i.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return n.path=a+n.path.substring(i.length),t.build()},o.equals=function(e){var a,f,c,t=this.clone(),n=new s(e),r={},i={},o={};if(t.normalize(),n.normalize(),t.toString()===n.toString())return!0;if(a=t.query(),f=n.query(),t.query(""),n.query(""),t.toString()!==n.toString())return!1;if(a.length!==f.length)return!1;r=s.parseQuery(a,this._parts.escapeQuerySpace),i=s.parseQuery(f,this._parts.escapeQuerySpace);for(c in r)if(u.call(r,c)){if(l(r[c])){if(!p(r[c],i[c]))return!1}else if(r[c]!==i[c])return!1;o[c]=!0}for(c in i)if(u.call(i,c)&&!o[c])return!1;return!0},o.duplicateQueryParameters=function(e){return this._parts.duplicateQueryParameters=!!e,this},o.escapeQuerySpace=function(e){return this._parts.escapeQuerySpace=!!e,this},s});